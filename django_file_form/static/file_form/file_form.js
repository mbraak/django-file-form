!function(){var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var n=function(t){return t&&t.Math==Math&&t},r=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||function(){return this}()||Function("return this")(),o=function(t){return"function"==typeof t},i=o,a="object"==typeof document&&document.all,s=void 0===a&&void 0!==a?function(t){return"object"==typeof t?null!==t:i(t)||t===a}:function(t){return"object"==typeof t?null!==t:i(t)},l=s,c=r.document,u=l(c)&&l(c.createElement),p=function(t){return u?c.createElement(t):{}},f=p("span").classList,d=f&&f.constructor&&f.constructor.prototype,h=d===Object.prototype?void 0:d,m=function(t){try{return!!t()}catch(t){return!0}},y=!m((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),g=y,v=Function.prototype,b=v.bind,x=v.call,_=g&&b.bind(x,x),w=g?function(t){return t&&_(t)}:function(t){return t&&function(){return x.apply(t,arguments)}},E=w,S=E({}.toString),A=E("".slice),R=function(t){return A(S(t),8,-1)},k=m,O=R,T=Object,C=w("".split),U=k((function(){return!T("z").propertyIsEnumerable(0)}))?function(t){return"String"==O(t)?C(t,""):T(t)}:T,I=function(t){return null==t},P=I,j=TypeError,L=function(t){if(P(t))throw j("Can't call method on "+t);return t},D=U,H=L,F=function(t){return D(H(t))},N={exports:{}},M=r,z=Object.defineProperty,B=function(t,e){try{z(M,t,{value:e,configurable:!0,writable:!0})}catch(n){M[t]=e}return e},q=B,G="__core-js_shared__",$=r[G]||q(G,{}),K=$;(N.exports=function(t,e){return K[t]||(K[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.25.0",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.0/LICENSE",source:"https://github.com/zloirock/core-js"});var X,W,V=L,Y=Object,Q=function(t){return Y(V(t))},Z=Q,J=w({}.hasOwnProperty),tt=Object.hasOwn||function(t,e){return J(Z(t),e)},et=w,nt=0,rt=Math.random(),ot=et(1..toString),it=function(t){return"Symbol("+(void 0===t?"":t)+")_"+ot(++nt+rt,36)},at=r,st=o,lt=function(t){return st(t)?t:void 0},ct=function(t,e){return arguments.length<2?lt(at[t]):at[t]&&at[t][e]},ut=ct("navigator","userAgent")||"",pt=r,ft=ut,dt=pt.process,ht=pt.Deno,mt=dt&&dt.versions||ht&&ht.version,yt=mt&&mt.v8;yt&&(W=(X=yt.split("."))[0]>0&&X[0]<4?1:+(X[0]+X[1])),!W&&ft&&(!(X=ft.match(/Edge\/(\d+)/))||X[1]>=74)&&(X=ft.match(/Chrome\/(\d+)/))&&(W=+X[1]);var gt=W,vt=gt,bt=m,xt=!!Object.getOwnPropertySymbols&&!bt((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&vt&&vt<41})),_t=xt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,wt=r,Et=N.exports,St=tt,At=it,Rt=xt,kt=_t,Ot=Et("wks"),Tt=wt.Symbol,Ct=Tt&&Tt.for,Ut=kt?Tt:Tt&&Tt.withoutSetter||At,It=function(t){if(!St(Ot,t)||!Rt&&"string"!=typeof Ot[t]){var e="Symbol."+t;Rt&&St(Tt,t)?Ot[t]=Tt[t]:Ot[t]=kt&&Ct?Ct(e):Ut(e)}return Ot[t]},Pt=s,jt=String,Lt=TypeError,Dt=function(t){if(Pt(t))return t;throw Lt(jt(t)+" is not an object")},Ht={},Ft=!m((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),Nt=Ft&&m((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Mt={},zt=p,Bt=!Ft&&!m((function(){return 7!=Object.defineProperty(zt("div"),"a",{get:function(){return 7}}).a})),qt=y,Gt=Function.prototype.call,$t=qt?Gt.bind(Gt):function(){return Gt.apply(Gt,arguments)},Kt=w({}.isPrototypeOf),Xt=ct,Wt=o,Vt=Kt,Yt=Object,Qt=_t?function(t){return"symbol"==typeof t}:function(t){var e=Xt("Symbol");return Wt(e)&&Vt(e.prototype,Yt(t))},Zt=String,Jt=function(t){try{return Zt(t)}catch(t){return"Object"}},te=o,ee=Jt,ne=TypeError,re=function(t){if(te(t))return t;throw ne(ee(t)+" is not a function")},oe=re,ie=I,ae=function(t,e){var n=t[e];return ie(n)?void 0:oe(n)},se=$t,le=o,ce=s,ue=TypeError,pe=$t,fe=s,de=Qt,he=ae,me=function(t,e){var n,r;if("string"===e&&le(n=t.toString)&&!ce(r=se(n,t)))return r;if(le(n=t.valueOf)&&!ce(r=se(n,t)))return r;if("string"!==e&&le(n=t.toString)&&!ce(r=se(n,t)))return r;throw ue("Can't convert object to primitive value")},ye=TypeError,ge=It("toPrimitive"),ve=function(t,e){if(!fe(t)||de(t))return t;var n,r=he(t,ge);if(r){if(void 0===e&&(e="default"),n=pe(r,t,e),!fe(n)||de(n))return n;throw ye("Can't convert object to primitive value")}return void 0===e&&(e="number"),me(t,e)},be=ve,xe=Qt,_e=function(t){var e=be(t,"string");return xe(e)?e:e+""},we=Ft,Ee=Bt,Se=Nt,Ae=Dt,Re=_e,ke=TypeError,Oe=Object.defineProperty,Te=Object.getOwnPropertyDescriptor,Ce="enumerable",Ue="configurable",Ie="writable";Mt.f=we?Se?function(t,e,n){if(Ae(t),e=Re(e),Ae(n),"function"==typeof t&&"prototype"===e&&"value"in n&&Ie in n&&!n.writable){var r=Te(t,e);r&&r.writable&&(t[e]=n.value,n={configurable:Ue in n?n.configurable:r.configurable,enumerable:Ce in n?n.enumerable:r.enumerable,writable:!1})}return Oe(t,e,n)}:Oe:function(t,e,n){if(Ae(t),e=Re(e),Ae(n),Ee)try{return Oe(t,e,n)}catch(t){}if("get"in n||"set"in n)throw ke("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var Pe=Math.ceil,je=Math.floor,Le=Math.trunc||function(t){var e=+t;return(e>0?je:Pe)(e)},De=function(t){var e=+t;return e!=e||0===e?0:Le(e)},He=De,Fe=Math.max,Ne=Math.min,Me=function(t,e){var n=He(t);return n<0?Fe(n+e,0):Ne(n,e)},ze=De,Be=Math.min,qe=function(t){return t>0?Be(ze(t),9007199254740991):0},Ge=qe,$e=function(t){return Ge(t.length)},Ke=F,Xe=Me,We=$e,Ve=function(t){return function(e,n,r){var o,i=Ke(e),a=We(i),s=Xe(r,a);if(t&&n!=n){for(;a>s;)if((o=i[s++])!=o)return!0}else for(;a>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},Ye={includes:Ve(!0),indexOf:Ve(!1)},Qe={},Ze=tt,Je=F,tn=Ye.indexOf,en=Qe,nn=w([].push),rn=function(t,e){var n,r=Je(t),o=0,i=[];for(n in r)!Ze(en,n)&&Ze(r,n)&&nn(i,n);for(;e.length>o;)Ze(r,n=e[o++])&&(~tn(i,n)||nn(i,n));return i},on=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],an=rn,sn=on,ln=Object.keys||function(t){return an(t,sn)},cn=Ft,un=Nt,pn=Mt,fn=Dt,dn=F,hn=ln;Ht.f=cn&&!un?Object.defineProperties:function(t,e){fn(t);for(var n,r=dn(e),o=hn(e),i=o.length,a=0;i>a;)pn.f(t,n=o[a++],r[n]);return t};var mn,yn=ct("document","documentElement"),gn=N.exports,vn=it,bn=gn("keys"),xn=function(t){return bn[t]||(bn[t]=vn(t))},_n=Dt,wn=Ht,En=on,Sn=Qe,An=yn,Rn=p,kn=xn("IE_PROTO"),On=function(){},Tn=function(t){return"<script>"+t+"</"+"script>"},Cn=function(t){t.write(Tn("")),t.close();var e=t.parentWindow.Object;return t=null,e},Un=function(){try{mn=new ActiveXObject("htmlfile")}catch(t){}var t,e;Un="undefined"!=typeof document?document.domain&&mn?Cn(mn):((e=Rn("iframe")).style.display="none",An.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(Tn("document.F=Object")),t.close(),t.F):Cn(mn);for(var n=En.length;n--;)delete Un.prototype[En[n]];return Un()};Sn[kn]=!0;var In=Object.create||function(t,e){var n;return null!==t?(On.prototype=_n(t),n=new On,On.prototype=null,n[kn]=t):n=Un(),void 0===e?n:wn.f(n,e)},Pn=It,jn=In,Ln=Mt.f,Dn=Pn("unscopables"),Hn=Array.prototype;null==Hn[Dn]&&Ln(Hn,Dn,{configurable:!0,value:jn(null)});var Fn,Nn,Mn,zn=function(t){Hn[Dn][t]=!0},Bn={},qn=o,Gn=r.WeakMap,$n=qn(Gn)&&/native code/.test(String(Gn)),Kn=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},Xn=Mt,Wn=Kn,Vn=Ft?function(t,e,n){return Xn.f(t,e,Wn(1,n))}:function(t,e,n){return t[e]=n,t},Yn=$n,Qn=r,Zn=w,Jn=s,tr=Vn,er=tt,nr=$,rr=xn,or=Qe,ir="Object already initialized",ar=Qn.TypeError,sr=Qn.WeakMap;if(Yn||nr.state){var lr=nr.state||(nr.state=new sr),cr=Zn(lr.get),ur=Zn(lr.has),pr=Zn(lr.set);Fn=function(t,e){if(ur(lr,t))throw ar(ir);return e.facade=t,pr(lr,t,e),e},Nn=function(t){return cr(lr,t)||{}},Mn=function(t){return ur(lr,t)}}else{var fr=rr("state");or[fr]=!0,Fn=function(t,e){if(er(t,fr))throw ar(ir);return e.facade=t,tr(t,fr,e),e},Nn=function(t){return er(t,fr)?t[fr]:{}},Mn=function(t){return er(t,fr)}}var dr={set:Fn,get:Nn,has:Mn,enforce:function(t){return Mn(t)?Nn(t):Fn(t,{})},getterFor:function(t){return function(e){var n;if(!Jn(e)||(n=Nn(e)).type!==t)throw ar("Incompatible receiver, "+t+" required");return n}}},hr={},mr={},yr={}.propertyIsEnumerable,gr=Object.getOwnPropertyDescriptor,vr=gr&&!yr.call({1:2},1);mr.f=vr?function(t){var e=gr(this,t);return!!e&&e.enumerable}:yr;var br=Ft,xr=$t,_r=mr,wr=Kn,Er=F,Sr=_e,Ar=tt,Rr=Bt,kr=Object.getOwnPropertyDescriptor;hr.f=br?kr:function(t,e){if(t=Er(t),e=Sr(e),Rr)try{return kr(t,e)}catch(t){}if(Ar(t,e))return wr(!xr(_r.f,t,e),t[e])};var Or={exports:{}},Tr=Ft,Cr=tt,Ur=Function.prototype,Ir=Tr&&Object.getOwnPropertyDescriptor,Pr=Cr(Ur,"name"),jr={EXISTS:Pr,PROPER:Pr&&"something"===function(){}.name,CONFIGURABLE:Pr&&(!Tr||Tr&&Ir(Ur,"name").configurable)},Lr=o,Dr=$,Hr=w(Function.toString);Lr(Dr.inspectSource)||(Dr.inspectSource=function(t){return Hr(t)});var Fr=Dr.inspectSource,Nr=m,Mr=o,zr=tt,Br=Ft,qr=jr.CONFIGURABLE,Gr=Fr,$r=dr.enforce,Kr=dr.get,Xr=Object.defineProperty,Wr=Br&&!Nr((function(){return 8!==Xr((function(){}),"length",{value:8}).length})),Vr=String(String).split("String"),Yr=Or.exports=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!zr(t,"name")||qr&&t.name!==e)&&(Br?Xr(t,"name",{value:e,configurable:!0}):t.name=e),Wr&&n&&zr(n,"arity")&&t.length!==n.arity&&Xr(t,"length",{value:n.arity});try{n&&zr(n,"constructor")&&n.constructor?Br&&Xr(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=$r(t);return zr(r,"source")||(r.source=Vr.join("string"==typeof e?e:"")),t};Function.prototype.toString=Yr((function(){return Mr(this)&&Kr(this).source||Gr(this)}),"toString");var Qr=o,Zr=Mt,Jr=Or.exports,to=B,eo=function(t,e,n,r){r||(r={});var o=r.enumerable,i=void 0!==r.name?r.name:e;if(Qr(n)&&Jr(n,i,r),r.global)o?t[e]=n:to(e,n);else{try{r.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=n:Zr.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},no={},ro=rn,oo=on.concat("length","prototype");no.f=Object.getOwnPropertyNames||function(t){return ro(t,oo)};var io={};io.f=Object.getOwnPropertySymbols;var ao,so,lo,co=ct,uo=no,po=io,fo=Dt,ho=w([].concat),mo=co("Reflect","ownKeys")||function(t){var e=uo.f(fo(t)),n=po.f;return n?ho(e,n(t)):e},yo=tt,go=mo,vo=hr,bo=Mt,xo=m,_o=o,wo=/#|\.prototype\./,Eo=function(t,e){var n=Ao[So(t)];return n==ko||n!=Ro&&(_o(e)?xo(e):!!e)},So=Eo.normalize=function(t){return String(t).replace(wo,".").toLowerCase()},Ao=Eo.data={},Ro=Eo.NATIVE="N",ko=Eo.POLYFILL="P",Oo=Eo,To=r,Co=hr.f,Uo=Vn,Io=eo,Po=B,jo=function(t,e,n){for(var r=go(e),o=bo.f,i=vo.f,a=0;a<r.length;a++){var s=r[a];yo(t,s)||n&&yo(n,s)||o(t,s,i(e,s))}},Lo=Oo,Do=function(t,e){var n,r,o,i,a,s=t.target,l=t.global,c=t.stat;if(n=l?To:c?To[s]||Po(s,{}):(To[s]||{}).prototype)for(r in e){if(i=e[r],o=t.dontCallGetSet?(a=Co(n,r))&&a.value:n[r],!Lo(l?r:s+(c?".":"#")+r,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;jo(i,o)}(t.sham||o&&o.sham)&&Uo(i,"sham",!0),Io(n,r,i,t)}},Ho=!m((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),Fo=tt,No=o,Mo=Q,zo=Ho,Bo=xn("IE_PROTO"),qo=Object,Go=qo.prototype,$o=zo?qo.getPrototypeOf:function(t){var e=Mo(t);if(Fo(e,Bo))return e[Bo];var n=e.constructor;return No(n)&&e instanceof n?n.prototype:e instanceof qo?Go:null},Ko=m,Xo=o,Wo=s,Vo=$o,Yo=eo,Qo=It("iterator"),Zo=!1;[].keys&&("next"in(lo=[].keys())?(so=Vo(Vo(lo)))!==Object.prototype&&(ao=so):Zo=!0);var Jo=!Wo(ao)||Ko((function(){var t={};return ao[Qo].call(t)!==t}));Jo&&(ao={}),Xo(ao[Qo])||Yo(ao,Qo,(function(){return this}));var ti={IteratorPrototype:ao,BUGGY_SAFARI_ITERATORS:Zo},ei=Mt.f,ni=tt,ri=It("toStringTag"),oi=function(t,e,n){t&&!n&&(t=t.prototype),t&&!ni(t,ri)&&ei(t,ri,{configurable:!0,value:e})},ii=ti.IteratorPrototype,ai=In,si=Kn,li=oi,ci=Bn,ui=function(){return this},pi=o,fi=String,di=TypeError,hi=w,mi=Dt,yi=function(t){if("object"==typeof t||pi(t))return t;throw di("Can't set "+fi(t)+" as a prototype")},gi=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=hi(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return mi(n),yi(r),e?t(n,r):n.__proto__=r,n}}():void 0),vi=Do,bi=$t,xi=o,_i=function(t,e,n,r){var o=e+" Iterator";return t.prototype=ai(ii,{next:si(+!r,n)}),li(t,o,!1),ci[o]=ui,t},wi=$o,Ei=gi,Si=oi,Ai=Vn,Ri=eo,ki=Bn,Oi=jr.PROPER,Ti=jr.CONFIGURABLE,Ci=ti.IteratorPrototype,Ui=ti.BUGGY_SAFARI_ITERATORS,Ii=It("iterator"),Pi="keys",ji="values",Li="entries",Di=function(){return this},Hi=F,Fi=zn,Ni=Bn,Mi=dr,zi=Mt.f,Bi=function(t,e,n,r,o,i,a){_i(n,e,r);var s,l,c,u=function(t){if(t===o&&m)return m;if(!Ui&&t in d)return d[t];switch(t){case Pi:case ji:case Li:return function(){return new n(this,t)}}return function(){return new n(this)}},p=e+" Iterator",f=!1,d=t.prototype,h=d[Ii]||d["@@iterator"]||o&&d[o],m=!Ui&&h||u(o),y="Array"==e&&d.entries||h;if(y&&(s=wi(y.call(new t)))!==Object.prototype&&s.next&&(wi(s)!==Ci&&(Ei?Ei(s,Ci):xi(s[Ii])||Ri(s,Ii,Di)),Si(s,p,!0)),Oi&&o==ji&&h&&h.name!==ji&&(Ti?Ai(d,"name",ji):(f=!0,m=function(){return bi(h,this)})),o)if(l={values:u(ji),keys:i?m:u(Pi),entries:u(Li)},a)for(c in l)(Ui||f||!(c in d))&&Ri(d,c,l[c]);else vi({target:e,proto:!0,forced:Ui||f},l);return d[Ii]!==m&&Ri(d,Ii,m,{name:o}),ki[e]=m,l},qi=Ft,Gi="Array Iterator",$i=Mi.set,Ki=Mi.getterFor(Gi),Xi=Bi(Array,"Array",(function(t,e){$i(this,{type:Gi,target:Hi(t),index:0,kind:e})}),(function(){var t=Ki(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values"),Wi=Ni.Arguments=Ni.Array;if(Fi("keys"),Fi("values"),Fi("entries"),qi&&"values"!==Wi.name)try{zi(Wi,"name",{value:"values"})}catch(t){}var Vi=r,Yi={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Qi=h,Zi=Xi,Ji=Vn,ta=It,ea=ta("iterator"),na=ta("toStringTag"),ra=Zi.values,oa=function(t,e){if(t){if(t[ea]!==ra)try{Ji(t,ea,ra)}catch(e){t[ea]=ra}if(t[na]||Ji(t,na,e),Yi[e])for(var n in Zi)if(t[n]!==Zi[n])try{Ji(t,n,Zi[n])}catch(e){t[n]=Zi[n]}}};for(var ia in Yi)oa(Vi[ia]&&Vi[ia].prototype,ia);oa(Qi,"DOMTokenList");const aa=t=>{const e=t.parentElement;return e?"FORM"===e.tagName?e:aa(e):null};function sa(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const la=(t,e)=>e?"".concat(e,"-").concat(t):t,ca=(t,e)=>e?t.slice(e.length+1):t,ua=(t,e,n)=>{const r=la(e,n),o=t.querySelector('[name="'.concat(r,'"]'));return o||null},pa=(t,e)=>"".concat(ca(t,e),"-uploads"),fa=(t,e,n)=>{var r;return null===(r=ua(t,e,n))||void 0===r?void 0:r.value};
/*!
	 * escape-html
	 * Copyright(c) 2012-2013 TJ Holowaychuk
	 * Copyright(c) 2015 Andreas Lubbe
	 * Copyright(c) 2015 Tiancheng "Timothy" Gu
	 * MIT Licensed
	 */
var da=/["'&<>]/,ha=function(t){var e,n=""+t,r=da.exec(n);if(!r)return n;var o="",i=0,a=0;for(i=r.index;i<n.length;i++){switch(n.charCodeAt(i)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#39;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}a!==i&&(o+=n.substring(a,i)),a=i+1,o+=e}return a!==i?o+n.substring(a,i):o};class ma{constructor(t){let{parent:e,input:n,skipRequired:r,translations:o}=t;sa(this,"container",void 0),sa(this,"input",void 0),sa(this,"translations",void 0),sa(this,"errors",void 0),sa(this,"createErrorContainer",(t=>{const e=document.createElement("div");return e.className="dff-invalid-files",t.appendChild(e),e})),sa(this,"createFilesContainer",(t=>{const e=document.createElement("div");return e.className="dff-files",t.appendChild(e),e})),this.container=this.createFilesContainer(e),this.errors=this.createErrorContainer(e),this.input=n,this.translations=o,r&&(this.input.required=!1)}addNewUpload(t,e){const n=this.addFile(t,e),r=document.createElement("span");r.className="dff-progress";const o=document.createElement("span");o.className="dff-progress-inner",r.appendChild(o),n.appendChild(r);const i=document.createElement("a");return i.className="dff-cancel",i.innerHTML=this.translations.Cancel,i.setAttribute("data-index","".concat(e)),i.href="#",n.appendChild(i),n}addUploadedFile(t,e,n){const r=this.addFile(t,e);return this.setSuccess(e,n),r}clearInput(){const{input:t}=this;t.value=""}deleteFile(t){const e=this.findFileDiv(t);e&&e.remove()}disableCancel(t){const e=this.findCancelSpan(t);e&&e.classList.add("dff-disabled")}disableDelete(t){const e=this.findDeleteLink(t);e&&e.classList.add("dff-disabled")}findFileDiv(t){return this.container.querySelector(".dff-file-id-".concat(t))}removeDropHint(){const t=this.container.querySelector(".dff-drop-hint");t&&t.remove()}renderDropHint(){if(this.container.querySelector(".dff-drop-hint"))return;const t=document.createElement("div");t.className="dff-drop-hint",t.innerHTML=this.translations["Drop your files here"],this.container.appendChild(t)}setDeleteFailed(t){this.setErrorMessage(t,this.translations["Delete failed"]),this.enableDelete(t)}setError(t){this.setErrorMessage(t,this.translations["Upload failed"]);const e=this.findFileDiv(t);e&&e.classList.add("dff-upload-fail"),this.removeProgress(t),this.removeCancel(t)}setErrorInvalidFiles(t){const e=document.createElement("ul");for(const n of t){const t=document.createElement("li");t.innerHTML="".concat(n.name,": ").concat(this.translations["Invalid file type"]),t.className="dff-error",e.appendChild(t)}this.errors.replaceChildren(e),this.clearInput()}setSuccess(t,e){const{translations:n}=this,r=this.findFileDiv(t);if(r){if(r.classList.add("dff-upload-success"),null!=e){const t=document.createElement("span");t.innerHTML=((t,e)=>{if(0===t)return"0 Bytes";const n=e<=0?0:e||2,r=Math.floor(Math.log(t)/Math.log(1024)),o=parseFloat((t/1024**r).toFixed(n)),i=["Bytes","KB","MB","GB"][r];return"".concat(o," ").concat(i)})(e,2),t.className="dff-filesize",r.appendChild(t)}const o=document.createElement("a");o.innerHTML=n.Delete,o.className="dff-delete",o.setAttribute("data-index","".concat(t)),o.href="#",r.appendChild(o)}this.removeProgress(t),this.removeCancel(t)}updateProgress(t,e){const n=this.container.querySelector(".dff-file-id-".concat(t));if(n){const t=n.querySelector(".dff-progress-inner");t&&(t.style.width="".concat(e,"%"))}}addFile(t,e){const n=document.createElement("div");n.className="dff-file dff-file-id-".concat(e);const r=document.createElement("span");return r.innerHTML=ha(t),n.appendChild(r),this.container.appendChild(n),this.input.required=!1,n}removeProgress(t){const e=this.findFileDiv(t);if(e){const t=e.querySelector(".dff-progress");t&&t.remove()}}removeCancel(t){const e=this.findCancelSpan(t);e&&e.remove()}findCancelSpan(t){const e=this.findFileDiv(t);return e?e.querySelector(".dff-cancel"):null}enableDelete(t){const e=this.findDeleteLink(t);e&&e.classList.remove("dff-disabled")}findDeleteLink(t){const e=this.findFileDiv(t);return e?e.querySelector(".dff-delete"):e}setErrorMessage(t,e){const n=this.findFileDiv(t);if(!n)return;const r=n.querySelector(".dff-error");r&&r.remove();const o=document.createElement("span");o.classList.add("dff-error"),o.innerHTML=e,n.appendChild(o)}}var ya=y,ga=Function.prototype,va=ga.apply,ba=ga.call,xa="object"==typeof Reflect&&Reflect.apply||(ya?ba.bind(va):function(){return ba.apply(va,arguments)}),_a={};_a[It("toStringTag")]="z";var wa,Ea,Sa="[object z]"===String(_a),Aa=o,Ra=R,ka=It("toStringTag"),Oa=Object,Ta="Arguments"==Ra(function(){return arguments}()),Ca=Sa?Ra:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Oa(t),ka))?n:Ta?Ra(e):"Object"==(r=Ra(e))&&Aa(e.callee)?"Arguments":r},Ua=Ca,Ia=String,Pa=function(t){if("Symbol"===Ua(t))throw TypeError("Cannot convert a Symbol value to a string");return Ia(t)},ja=Dt,La=function(){var t=ja(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},Da=m,Ha=r.RegExp,Fa=Da((function(){var t=Ha("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),Na=Fa||Da((function(){return!Ha("a","y").sticky})),Ma={BROKEN_CARET:Fa||Da((function(){var t=Ha("^r","gy");return t.lastIndex=2,null!=t.exec("str")})),MISSED_STICKY:Na,UNSUPPORTED_Y:Fa},za=m,Ba=r.RegExp,qa=za((function(){var t=Ba(".","s");return!(t.dotAll&&t.exec("\n")&&"s"===t.flags)})),Ga=m,$a=r.RegExp,Ka=Ga((function(){var t=$a("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})),Xa=$t,Wa=w,Va=Pa,Ya=La,Qa=Ma,Za=N.exports,Ja=In,ts=dr.get,es=qa,ns=Ka,rs=Za("native-string-replace",String.prototype.replace),os=RegExp.prototype.exec,is=os,as=Wa("".charAt),ss=Wa("".indexOf),ls=Wa("".replace),cs=Wa("".slice),us=(Ea=/b*/g,Xa(os,wa=/a/,"a"),Xa(os,Ea,"a"),0!==wa.lastIndex||0!==Ea.lastIndex),ps=Qa.BROKEN_CARET,fs=void 0!==/()??/.exec("")[1];(us||fs||ps||es||ns)&&(is=function(t){var e,n,r,o,i,a,s,l=this,c=ts(l),u=Va(t),p=c.raw;if(p)return p.lastIndex=l.lastIndex,e=Xa(is,p,u),l.lastIndex=p.lastIndex,e;var f=c.groups,d=ps&&l.sticky,h=Xa(Ya,l),m=l.source,y=0,g=u;if(d&&(h=ls(h,"y",""),-1===ss(h,"g")&&(h+="g"),g=cs(u,l.lastIndex),l.lastIndex>0&&(!l.multiline||l.multiline&&"\n"!==as(u,l.lastIndex-1))&&(m="(?: "+m+")",g=" "+g,y++),n=new RegExp("^(?:"+m+")",h)),fs&&(n=new RegExp("^"+m+"$(?!\\s)",h)),us&&(r=l.lastIndex),o=Xa(os,d?n:l,g),d?o?(o.input=cs(o.input,y),o[0]=cs(o[0],y),o.index=l.lastIndex,l.lastIndex+=o[0].length):l.lastIndex=0:us&&o&&(l.lastIndex=l.global?o.index+o[0].length:r),fs&&o&&o.length>1&&Xa(rs,o[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o&&f)for(o.groups=a=Ja(null),i=0;i<f.length;i++)a[(s=f[i])[0]]=o[s[1]];return o});var ds=is;Do({target:"RegExp",proto:!0,forced:/./.exec!==ds},{exec:ds});var hs=w,ms=eo,ys=ds,gs=m,vs=It,bs=Vn,xs=vs("species"),_s=RegExp.prototype,ws=w,Es=De,Ss=Pa,As=L,Rs=ws("".charAt),ks=ws("".charCodeAt),Os=ws("".slice),Ts=function(t){return function(e,n){var r,o,i=Ss(As(e)),a=Es(n),s=i.length;return a<0||a>=s?t?"":void 0:(r=ks(i,a))<55296||r>56319||a+1===s||(o=ks(i,a+1))<56320||o>57343?t?Rs(i,a):r:t?Os(i,a,a+2):o-56320+(r-55296<<10)+65536}},Cs={codeAt:Ts(!1),charAt:Ts(!0)}.charAt,Us=w,Is=Q,Ps=Math.floor,js=Us("".charAt),Ls=Us("".replace),Ds=Us("".slice),Hs=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Fs=/\$([$&'`]|\d{1,2})/g,Ns=$t,Ms=Dt,zs=o,Bs=R,qs=ds,Gs=TypeError,$s=xa,Ks=$t,Xs=w,Ws=function(t,e,n,r){var o=vs(t),i=!gs((function(){var e={};return e[o]=function(){return 7},7!=""[t](e)})),a=i&&!gs((function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[xs]=function(){return n},n.flags="",n[o]=/./[o]),n.exec=function(){return e=!0,null},n[o](""),!e}));if(!i||!a||n){var s=hs(/./[o]),l=e(o,""[t],(function(t,e,n,r,o){var a=hs(t),l=e.exec;return l===ys||l===_s.exec?i&&!o?{done:!0,value:s(e,n,r)}:{done:!0,value:a(n,e,r)}:{done:!1}}));ms(String.prototype,t,l[0]),ms(_s,o,l[1])}r&&bs(_s[o],"sham",!0)},Vs=m,Ys=Dt,Qs=o,Zs=I,Js=De,tl=qe,el=Pa,nl=L,rl=function(t,e,n){return e+(n?Cs(t,e).length:1)},ol=ae,il=function(t,e,n,r,o,i){var a=n+t.length,s=r.length,l=Fs;return void 0!==o&&(o=Is(o),l=Hs),Ls(i,l,(function(i,l){var c;switch(js(l,0)){case"$":return"$";case"&":return t;case"`":return Ds(e,0,n);case"'":return Ds(e,a);case"<":c=o[Ds(l,1,-1)];break;default:var u=+l;if(0===u)return i;if(u>s){var p=Ps(u/10);return 0===p?i:p<=s?void 0===r[p-1]?js(l,1):r[p-1]+js(l,1):i}c=r[u-1]}return void 0===c?"":c}))},al=function(t,e){var n=t.exec;if(zs(n)){var r=Ns(n,t,e);return null!==r&&Ms(r),r}if("RegExp"===Bs(t))return Ns(qs,t,e);throw Gs("RegExp#exec called on incompatible receiver")},sl=It("replace"),ll=Math.max,cl=Math.min,ul=Xs([].concat),pl=Xs([].push),fl=Xs("".indexOf),dl=Xs("".slice),hl="$0"==="a".replace(/./,"$0"),ml=!!/./[sl]&&""===/./[sl]("a","$0");function yl(){this._types=Object.create(null),this._extensions=Object.create(null);for(let t=0;t<arguments.length;t++)this.define(arguments[t]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}Ws("replace",(function(t,e,n){var r=ml?"$":"$0";return[function(t,n){var r=nl(this),o=Zs(t)?void 0:ol(t,sl);return o?Ks(o,t,r,n):Ks(e,el(r),t,n)},function(t,o){var i=Ys(this),a=el(t);if("string"==typeof o&&-1===fl(o,r)&&-1===fl(o,"$<")){var s=n(e,i,a,o);if(s.done)return s.value}var l=Qs(o);l||(o=el(o));var c=i.global;if(c){var u=i.unicode;i.lastIndex=0}for(var p=[];;){var f=al(i,a);if(null===f)break;if(pl(p,f),!c)break;""===el(f[0])&&(i.lastIndex=rl(a,tl(i.lastIndex),u))}for(var d,h="",m=0,y=0;y<p.length;y++){for(var g=el((f=p[y])[0]),v=ll(cl(Js(f.index),a.length),0),b=[],x=1;x<f.length;x++)pl(b,void 0===(d=f[x])?d:String(d));var _=f.groups;if(l){var w=ul([g],b,v,a);void 0!==_&&pl(w,_);var E=el($s(o,void 0,w))}else E=il(g,a,v,b,_,o);v>=m&&(h+=dl(a,m,v)+E,m=v+g.length)}return h+dl(a,m)}]}),!!Vs((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}))||!hl||ml),yl.prototype.define=function(t,e){for(let n in t){let r=t[n].map((function(t){return t.toLowerCase()}));n=n.toLowerCase();for(let t=0;t<r.length;t++){const o=r[t];if("*"!==o[0]){if(!e&&o in this._types)throw new Error('Attempt to change mapping for "'+o+'" extension from "'+this._types[o]+'" to "'+n+'". Pass `force=true` to allow this, otherwise remove "'+o+'" from the list of extensions for "'+n+'".');this._types[o]=n}}if(e||!this._extensions[n]){const t=r[0];this._extensions[n]="*"!==t[0]?t:t.substr(1)}}},yl.prototype.getType=function(t){let e=(t=String(t)).replace(/^.*[/\\]/,"").toLowerCase(),n=e.replace(/^.*\./,"").toLowerCase(),r=e.length<t.length;return(n.length<e.length-1||!r)&&this._types[n]||null},yl.prototype.getExtension=function(t){return(t=/^\s*([^;\s]*)/.test(t)&&RegExp.$1)&&this._extensions[t.toLowerCase()]||null};var gl=new yl({"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}),vl={exports:{}},bl=Or.exports,xl=Mt,_l=Ft,wl=function(t,e,n){return n.get&&bl(n.get,e,{getter:!0}),n.set&&bl(n.set,e,{setter:!0}),xl.f(t,e,n)},El=La,Sl=m,Al=r.RegExp,Rl=Al.prototype,kl=_l&&Sl((function(){var t=!0;try{Al(".","d")}catch(e){t=!1}var e={},n="",r=t?"dgimsy":"gimsy",o=function(t,r){Object.defineProperty(e,t,{get:function(){return n+=r,!0}})},i={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var a in t&&(i.hasIndices="d"),i)o(a,i[a]);return Object.getOwnPropertyDescriptor(Rl,"flags").get.call(e)!==r||n!==r}));kl&&wl(Rl,"flags",{configurable:!0,get:El});var Ol={basename:t=>{var e,n=0,r=-1,o=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!o){n=e+1;break}}else-1===r&&(o=!1,r=e+1);return-1===r?"":t.slice(n,r)}},Tl={};const Cl="\\\\/",Ul="[^".concat(Cl,"]"),Il="\\.",Pl="\\/",jl="[^/]",Ll="(?:".concat(Pl,"|$)"),Dl="(?:^|".concat(Pl,")"),Hl="".concat(Il,"{1,2}").concat(Ll),Fl={DOT_LITERAL:Il,PLUS_LITERAL:"\\+",QMARK_LITERAL:"\\?",SLASH_LITERAL:Pl,ONE_CHAR:"(?=.)",QMARK:jl,END_ANCHOR:Ll,DOTS_SLASH:Hl,NO_DOT:"(?!".concat(Il,")"),NO_DOTS:"(?!".concat(Dl).concat(Hl,")"),NO_DOT_SLASH:"(?!".concat(Il,"{0,1}").concat(Ll,")"),NO_DOTS_SLASH:"(?!".concat(Hl,")"),QMARK_NO_DOT:"[^.".concat(Pl,"]"),STAR:"".concat(jl,"*?"),START_ANCHOR:Dl},Nl={...Fl,SLASH_LITERAL:"[".concat(Cl,"]"),QMARK:Ul,STAR:"".concat(Ul,"*?"),DOTS_SLASH:"".concat(Il,"{1,2}(?:[").concat(Cl,"]|$)"),NO_DOT:"(?!".concat(Il,")"),NO_DOTS:"(?!(?:^|[".concat(Cl,"])").concat(Il,"{1,2}(?:[").concat(Cl,"]|$))"),NO_DOT_SLASH:"(?!".concat(Il,"{0,1}(?:[").concat(Cl,"]|$))"),NO_DOTS_SLASH:"(?!".concat(Il,"{1,2}(?:[").concat(Cl,"]|$))"),QMARK_NO_DOT:"[^.".concat(Cl,"]"),START_ANCHOR:"(?:^|[".concat(Cl,"])"),END_ANCHOR:"(?:[".concat(Cl,"]|$)")};var Ml={MAX_LENGTH:65536,POSIX_REGEX_SOURCE:{alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"},REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:"/",extglobChars:t=>({"!":{type:"negate",open:"(?:(?!(?:",close:"))".concat(t.STAR,")")},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}),globChars(){return!0===(arguments.length>0&&void 0!==arguments[0]&&arguments[0])?Nl:Fl}};!function(t){const{REGEX_BACKSLASH:e,REGEX_REMOVE_BACKSLASH:n,REGEX_SPECIAL_CHARS:r,REGEX_SPECIAL_CHARS_GLOBAL:o}=Ml;t.isObject=t=>null!==t&&"object"==typeof t&&!Array.isArray(t),t.hasRegexChars=t=>r.test(t),t.isRegexChar=e=>1===e.length&&t.hasRegexChars(e),t.escapeRegex=t=>t.replace(o,"\\$1"),t.toPosixSlashes=t=>t.replace(e,"/"),t.removeBackslashes=t=>t.replace(n,(t=>"\\"===t?"":t)),t.isWindows=t=>!(!t||"boolean"!=typeof t.windows)&&t.windows,t.escapeLast=(e,n,r)=>{const o=e.lastIndexOf(n,r);return-1===o?e:"\\"===e[o-1]?t.escapeLast(e,n,o-1):"".concat(e.slice(0,o),"\\").concat(e.slice(o))},t.removePrefix=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t;return n.startsWith("./")&&(n=n.slice(2),e.prefix="./"),n},t.wrapOutput=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=n.contains?"":"^",o=n.contains?"":"$";let i="".concat(r,"(?:").concat(t,")").concat(o);return!0===e.negated&&(i="(?:^(?!".concat(i,").*$)")),i}}(Tl);const zl=Tl,{CHAR_ASTERISK:Bl,CHAR_AT:ql,CHAR_BACKWARD_SLASH:Gl,CHAR_COMMA:$l,CHAR_DOT:Kl,CHAR_EXCLAMATION_MARK:Xl,CHAR_FORWARD_SLASH:Wl,CHAR_LEFT_CURLY_BRACE:Vl,CHAR_LEFT_PARENTHESES:Yl,CHAR_LEFT_SQUARE_BRACKET:Ql,CHAR_PLUS:Zl,CHAR_QUESTION_MARK:Jl,CHAR_RIGHT_CURLY_BRACE:tc,CHAR_RIGHT_PARENTHESES:ec,CHAR_RIGHT_SQUARE_BRACKET:nc}=Ml,rc=t=>t===Wl||t===Gl,oc=t=>{!0!==t.isPrefix&&(t.depth=t.isGlobstar?1/0:1)};var ic=(t,e)=>{const n=e||{},r=t.length-1,o=!0===n.parts||!0===n.scanToEnd,i=[],a=[],s=[];let l,c,u=t,p=-1,f=0,d=0,h=!1,m=!1,y=!1,g=!1,v=!1,b=!1,x=!1,_=!1,w=!1,E=!1,S=0,A={value:"",depth:0,isGlob:!1};const R=()=>p>=r,k=()=>(l=c,u.charCodeAt(++p));for(;p<r;){let t;if(c=k(),c!==Gl){if(!0===b||c===Vl){for(S++;!0!==R()&&(c=k());)if(c!==Gl)if(c!==Vl){if(!0!==b&&c===Kl&&(c=k())===Kl){if(h=A.isBrace=!0,y=A.isGlob=!0,E=!0,!0===o)continue;break}if(!0!==b&&c===$l){if(h=A.isBrace=!0,y=A.isGlob=!0,E=!0,!0===o)continue;break}if(c===tc&&(S--,0===S)){b=!1,h=A.isBrace=!0,E=!0;break}}else S++;else x=A.backslashes=!0,k();if(!0===o)continue;break}if(c!==Wl){if(!0!==n.noext){if(!0===(c===Zl||c===ql||c===Bl||c===Jl||c===Xl)&&u.charCodeAt(p+1)===Yl){if(y=A.isGlob=!0,g=A.isExtglob=!0,E=!0,c===Xl&&p===f&&(w=!0),!0===o){for(;!0!==R()&&(c=k());)if(c!==Gl){if(c===ec){y=A.isGlob=!0,E=!0;break}}else x=A.backslashes=!0,c=k();continue}break}}if(c===Bl){if(l===Bl&&(v=A.isGlobstar=!0),y=A.isGlob=!0,E=!0,!0===o)continue;break}if(c===Jl){if(y=A.isGlob=!0,E=!0,!0===o)continue;break}if(c===Ql){for(;!0!==R()&&(t=k());)if(t!==Gl){if(t===nc){m=A.isBracket=!0,y=A.isGlob=!0,E=!0;break}}else x=A.backslashes=!0,k();if(!0===o)continue;break}if(!0===n.nonegate||c!==Xl||p!==f){if(!0!==n.noparen&&c===Yl){if(y=A.isGlob=!0,!0===o){for(;!0!==R()&&(c=k());)if(c!==Yl){if(c===ec){E=!0;break}}else x=A.backslashes=!0,c=k();continue}break}if(!0===y){if(E=!0,!0===o)continue;break}}else _=A.negated=!0,f++}else{if(i.push(p),a.push(A),A={value:"",depth:0,isGlob:!1},!0===E)continue;if(l===Kl&&p===f+1){f+=2;continue}d=p+1}}else x=A.backslashes=!0,c=k(),c===Vl&&(b=!0)}!0===n.noext&&(g=!1,y=!1);let O=u,T="",C="";f>0&&(T=u.slice(0,f),u=u.slice(f),d-=f),O&&!0===y&&d>0?(O=u.slice(0,d),C=u.slice(d)):!0===y?(O="",C=u):O=u,O&&""!==O&&"/"!==O&&O!==u&&rc(O.charCodeAt(O.length-1))&&(O=O.slice(0,-1)),!0===n.unescape&&(C&&(C=zl.removeBackslashes(C)),O&&!0===x&&(O=zl.removeBackslashes(O)));const U={prefix:T,input:t,start:f,base:O,glob:C,isBrace:h,isBracket:m,isGlob:y,isExtglob:g,isGlobstar:v,negated:_,negatedExtglob:w};if(!0===n.tokens&&(U.maxDepth=0,rc(c)||a.push(A),U.tokens=a),!0===n.parts||!0===n.tokens){let e;for(let r=0;r<i.length;r++){const o=e?e+1:f,l=i[r],c=t.slice(o,l);n.tokens&&(0===r&&0!==f?(a[r].isPrefix=!0,a[r].value=T):a[r].value=c,oc(a[r]),U.maxDepth+=a[r].depth),0===r&&""===c||s.push(c),e=l}if(e&&e+1<t.length){const r=t.slice(e+1);s.push(r),n.tokens&&(a[a.length-1].value=r,oc(a[a.length-1]),U.maxDepth+=a[a.length-1].depth)}U.slashes=i,U.parts=s}return U},ac=Ye.includes,sc=zn;Do({target:"Array",proto:!0,forced:m((function(){return!Array(1).includes()}))},{includes:function(t){return ac(this,t,arguments.length>1?arguments[1]:void 0)}}),sc("includes");const lc=Ml,cc=Tl,{MAX_LENGTH:uc,POSIX_REGEX_SOURCE:pc,REGEX_NON_SPECIAL_CHARS:fc,REGEX_SPECIAL_CHARS_BACKREF:dc,REPLACEMENTS:hc}=lc,mc=(t,e)=>{if("function"==typeof e.expandRange)return e.expandRange(...t,e);t.sort();const n="[".concat(t.join("-"),"]");try{new RegExp(n)}catch(e){return t.map((t=>cc.escapeRegex(t))).join("..")}return n},yc=(t,e)=>"Missing ".concat(t,': "').concat(e,'" - use "\\\\').concat(e,'" to match literal characters'),gc=(t,e)=>{if("string"!=typeof t)throw new TypeError("Expected a string");t=hc[t]||t;const n={...e},r="number"==typeof n.maxLength?Math.min(uc,n.maxLength):uc;let o=t.length;if(o>r)throw new SyntaxError("Input length: ".concat(o,", exceeds maximum allowed length: ").concat(r));const i={type:"bos",value:"",output:n.prepend||""},a=[i],s=n.capture?"":"?:",l=lc.globChars(),c=lc.extglobChars(l),{DOT_LITERAL:u,PLUS_LITERAL:p,SLASH_LITERAL:f,ONE_CHAR:d,DOTS_SLASH:h,NO_DOT:m,NO_DOT_SLASH:y,NO_DOTS_SLASH:g,QMARK:v,QMARK_NO_DOT:b,STAR:x,START_ANCHOR:_}=l,w=t=>"(".concat(s,"(?:(?!").concat(_).concat(t.dot?h:u,").)*?)"),E=n.dot?"":m,S=n.dot?v:b;let A=!0===n.bash?w(n):x;n.capture&&(A="(".concat(A,")")),"boolean"==typeof n.noext&&(n.noextglob=n.noext);const R={input:t,index:-1,start:0,dot:!0===n.dot,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};t=cc.removePrefix(t,R),o=t.length;const k=[],O=[],T=[];let C,U=i;const I=()=>R.index===o-1,P=R.peek=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return t[R.index+e]},j=R.advance=()=>t[++R.index]||"",L=()=>t.slice(R.index+1),D=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;R.consumed+=t,R.index+=e},H=t=>{R.output+=null!=t.output?t.output:t.value,D(t.value)},F=()=>{let t=1;for(;"!"===P()&&("("!==P(2)||"?"===P(3));)j(),R.start++,t++;return t%2!=0&&(R.negated=!0,R.start++,!0)},N=t=>{R[t]++,T.push(t)},M=t=>{R[t]--,T.pop()},z=t=>{if("globstar"===U.type){const e=R.braces>0&&("comma"===t.type||"brace"===t.type),n=!0===t.extglob||k.length&&("pipe"===t.type||"paren"===t.type);"slash"===t.type||"paren"===t.type||e||n||(R.output=R.output.slice(0,-U.output.length),U.type="star",U.value="*",U.output=A,R.output+=U.output)}if(k.length&&"paren"!==t.type&&(k[k.length-1].inner+=t.value),(t.value||t.output)&&H(t),U&&"text"===U.type&&"text"===t.type)return U.value+=t.value,void(U.output=(U.output||"")+t.value);t.prev=U,a.push(t),U=t},B=(t,e)=>{const r={...c[e],conditions:1,inner:""};r.prev=U,r.parens=R.parens,r.output=R.output;const o=(n.capture?"(":"")+r.open;N("parens"),z({type:t,value:e,output:R.output?"":d}),z({type:"paren",extglob:!0,value:j(),output:o}),k.push(r)},q=t=>{let r,o=t.close+(n.capture?")":"");if("negate"===t.type){let i=A;if(t.inner&&t.inner.length>1&&t.inner.includes("/")&&(i=w(n)),(i!==A||I()||/^\)+$/.test(L()))&&(o=t.close=")$))".concat(i)),t.inner.includes("*")&&(r=L())&&/^\.[^\\/.]+$/.test(r)){const n=gc(r,{...e,fastpaths:!1}).output;o=t.close=")".concat(n,")").concat(i,")")}"bos"===t.prev.type&&(R.negatedExtglob=!0)}z({type:"paren",extglob:!0,value:C,output:o}),M("parens")};if(!1!==n.fastpaths&&!/(^[*!]|[/()[\]{}"])/.test(t)){let r=!1,o=t.replace(dc,((t,e,n,o,i,a)=>"\\"===o?(r=!0,t):"?"===o?e?e+o+(i?v.repeat(i.length):""):0===a?S+(i?v.repeat(i.length):""):v.repeat(n.length):"."===o?u.repeat(n.length):"*"===o?e?e+o+(i?A:""):A:e?t:"\\".concat(t)));return!0===r&&(o=!0===n.unescape?o.replace(/\\/g,""):o.replace(/\\+/g,(t=>t.length%2==0?"\\\\":t?"\\":""))),o===t&&!0===n.contains?(R.output=t,R):(R.output=cc.wrapOutput(o,R,e),R)}for(;!I();){if(C=j(),"\0"===C)continue;if("\\"===C){const t=P();if("/"===t&&!0!==n.bash)continue;if("."===t||";"===t)continue;if(!t){C+="\\",z({type:"text",value:C});continue}const e=/^\\+/.exec(L());let r=0;if(e&&e[0].length>2&&(r=e[0].length,R.index+=r,r%2!=0&&(C+="\\")),!0===n.unescape?C=j():C+=j(),0===R.brackets){z({type:"text",value:C});continue}}if(R.brackets>0&&("]"!==C||"["===U.value||"[^"===U.value)){if(!1!==n.posix&&":"===C){const t=U.value.slice(1);if(t.includes("[")&&(U.posix=!0,t.includes(":"))){const t=U.value.lastIndexOf("["),e=U.value.slice(0,t),n=U.value.slice(t+2),r=pc[n];if(r){U.value=e+r,R.backtrack=!0,j(),i.output||1!==a.indexOf(U)||(i.output=d);continue}}}("["===C&&":"!==P()||"-"===C&&"]"===P())&&(C="\\".concat(C)),"]"!==C||"["!==U.value&&"[^"!==U.value||(C="\\".concat(C)),!0===n.posix&&"!"===C&&"["===U.value&&(C="^"),U.value+=C,H({value:C});continue}if(1===R.quotes&&'"'!==C){C=cc.escapeRegex(C),U.value+=C,H({value:C});continue}if('"'===C){R.quotes=1===R.quotes?0:1,!0===n.keepQuotes&&z({type:"text",value:C});continue}if("("===C){N("parens"),z({type:"paren",value:C});continue}if(")"===C){if(0===R.parens&&!0===n.strictBrackets)throw new SyntaxError(yc("opening","("));const t=k[k.length-1];if(t&&R.parens===t.parens+1){q(k.pop());continue}z({type:"paren",value:C,output:R.parens?")":"\\)"}),M("parens");continue}if("["===C){if(!0!==n.nobracket&&L().includes("]"))N("brackets");else{if(!0!==n.nobracket&&!0===n.strictBrackets)throw new SyntaxError(yc("closing","]"));C="\\".concat(C)}z({type:"bracket",value:C});continue}if("]"===C){if(!0===n.nobracket||U&&"bracket"===U.type&&1===U.value.length){z({type:"text",value:C,output:"\\".concat(C)});continue}if(0===R.brackets){if(!0===n.strictBrackets)throw new SyntaxError(yc("opening","["));z({type:"text",value:C,output:"\\".concat(C)});continue}M("brackets");const t=U.value.slice(1);if(!0===U.posix||"^"!==t[0]||t.includes("/")||(C="/".concat(C)),U.value+=C,H({value:C}),!1===n.literalBrackets||cc.hasRegexChars(t))continue;const e=cc.escapeRegex(U.value);if(R.output=R.output.slice(0,-U.value.length),!0===n.literalBrackets){R.output+=e,U.value=e;continue}U.value="(".concat(s).concat(e,"|").concat(U.value,")"),R.output+=U.value;continue}if("{"===C&&!0!==n.nobrace){N("braces");const t={type:"brace",value:C,output:"(",outputIndex:R.output.length,tokensIndex:R.tokens.length};O.push(t),z(t);continue}if("}"===C){const t=O[O.length-1];if(!0===n.nobrace||!t){z({type:"text",value:C,output:C});continue}let e=")";if(!0===t.dots){const t=a.slice(),r=[];for(let e=t.length-1;e>=0&&(a.pop(),"brace"!==t[e].type);e--)"dots"!==t[e].type&&r.unshift(t[e].value);e=mc(r,n),R.backtrack=!0}if(!0!==t.comma&&!0!==t.dots){const n=R.output.slice(0,t.outputIndex),r=R.tokens.slice(t.tokensIndex);t.value=t.output="\\{",C=e="\\}",R.output=n;for(const t of r)R.output+=t.output||t.value}z({type:"brace",value:C,output:e}),M("braces"),O.pop();continue}if("|"===C){k.length>0&&k[k.length-1].conditions++,z({type:"text",value:C});continue}if(","===C){let t=C;const e=O[O.length-1];e&&"braces"===T[T.length-1]&&(e.comma=!0,t="|"),z({type:"comma",value:C,output:t});continue}if("/"===C){if("dot"===U.type&&R.index===R.start+1){R.start=R.index+1,R.consumed="",R.output="",a.pop(),U=i;continue}z({type:"slash",value:C,output:f});continue}if("."===C){if(R.braces>0&&"dot"===U.type){"."===U.value&&(U.output=u);const t=O[O.length-1];U.type="dots",U.output+=C,U.value+=C,t.dots=!0;continue}if(R.braces+R.parens===0&&"bos"!==U.type&&"slash"!==U.type){z({type:"text",value:C,output:u});continue}z({type:"dot",value:C,output:u});continue}if("?"===C){if(!(U&&"("===U.value)&&!0!==n.noextglob&&"("===P()&&"?"!==P(2)){B("qmark",C);continue}if(U&&"paren"===U.type){const t=P();let e=C;("("===U.value&&!/[!=<:]/.test(t)||"<"===t&&!/<([!=]|\w+>)/.test(L()))&&(e="\\".concat(C)),z({type:"text",value:C,output:e});continue}if(!0!==n.dot&&("slash"===U.type||"bos"===U.type)){z({type:"qmark",value:C,output:b});continue}z({type:"qmark",value:C,output:v});continue}if("!"===C){if(!0!==n.noextglob&&"("===P()&&("?"!==P(2)||!/[!=<:]/.test(P(3)))){B("negate",C);continue}if(!0!==n.nonegate&&0===R.index){F();continue}}if("+"===C){if(!0!==n.noextglob&&"("===P()&&"?"!==P(2)){B("plus",C);continue}if(U&&"("===U.value||!1===n.regex){z({type:"plus",value:C,output:p});continue}if(U&&("bracket"===U.type||"paren"===U.type||"brace"===U.type)||R.parens>0){z({type:"plus",value:C});continue}z({type:"plus",value:p});continue}if("@"===C){if(!0!==n.noextglob&&"("===P()&&"?"!==P(2)){z({type:"at",extglob:!0,value:C,output:""});continue}z({type:"text",value:C});continue}if("*"!==C){"$"!==C&&"^"!==C||(C="\\".concat(C));const t=fc.exec(L());t&&(C+=t[0],R.index+=t[0].length),z({type:"text",value:C});continue}if(U&&("globstar"===U.type||!0===U.star)){U.type="star",U.star=!0,U.value+=C,U.output=A,R.backtrack=!0,R.globstar=!0,D(C);continue}let e=L();if(!0!==n.noextglob&&/^\([^?]/.test(e)){B("star",C);continue}if("star"===U.type){if(!0===n.noglobstar){D(C);continue}const r=U.prev,o=r.prev,i="slash"===r.type||"bos"===r.type,a=o&&("star"===o.type||"globstar"===o.type);if(!0===n.bash&&(!i||e[0]&&"/"!==e[0])){z({type:"star",value:C,output:""});continue}const s=R.braces>0&&("comma"===r.type||"brace"===r.type),l=k.length&&("pipe"===r.type||"paren"===r.type);if(!i&&"paren"!==r.type&&!s&&!l){z({type:"star",value:C,output:""});continue}for(;"/**"===e.slice(0,3);){const n=t[R.index+4];if(n&&"/"!==n)break;e=e.slice(3),D("/**",3)}if("bos"===r.type&&I()){U.type="globstar",U.value+=C,U.output=w(n),R.output=U.output,R.globstar=!0,D(C);continue}if("slash"===r.type&&"bos"!==r.prev.type&&!a&&I()){R.output=R.output.slice(0,-(r.output+U.output).length),r.output="(?:".concat(r.output),U.type="globstar",U.output=w(n)+(n.strictSlashes?")":"|$)"),U.value+=C,R.globstar=!0,R.output+=r.output+U.output,D(C);continue}if("slash"===r.type&&"bos"!==r.prev.type&&"/"===e[0]){const t=void 0!==e[1]?"|$":"";R.output=R.output.slice(0,-(r.output+U.output).length),r.output="(?:".concat(r.output),U.type="globstar",U.output="".concat(w(n)).concat(f,"|").concat(f).concat(t,")"),U.value+=C,R.output+=r.output+U.output,R.globstar=!0,D(C+j()),z({type:"slash",value:"/",output:""});continue}if("bos"===r.type&&"/"===e[0]){U.type="globstar",U.value+=C,U.output="(?:^|".concat(f,"|").concat(w(n)).concat(f,")"),R.output=U.output,R.globstar=!0,D(C+j()),z({type:"slash",value:"/",output:""});continue}R.output=R.output.slice(0,-U.output.length),U.type="globstar",U.output=w(n),U.value+=C,R.output+=U.output,R.globstar=!0,D(C);continue}const r={type:"star",value:C,output:A};!0!==n.bash?!U||"bracket"!==U.type&&"paren"!==U.type||!0!==n.regex?(R.index!==R.start&&"slash"!==U.type&&"dot"!==U.type||("dot"===U.type?(R.output+=y,U.output+=y):!0===n.dot?(R.output+=g,U.output+=g):(R.output+=E,U.output+=E),"*"!==P()&&(R.output+=d,U.output+=d)),z(r)):(r.output=C,z(r)):(r.output=".*?","bos"!==U.type&&"slash"!==U.type||(r.output=E+r.output),z(r))}for(;R.brackets>0;){if(!0===n.strictBrackets)throw new SyntaxError(yc("closing","]"));R.output=cc.escapeLast(R.output,"["),M("brackets")}for(;R.parens>0;){if(!0===n.strictBrackets)throw new SyntaxError(yc("closing",")"));R.output=cc.escapeLast(R.output,"("),M("parens")}for(;R.braces>0;){if(!0===n.strictBrackets)throw new SyntaxError(yc("closing","}"));R.output=cc.escapeLast(R.output,"{"),M("braces")}if(!0===n.strictSlashes||"star"!==U.type&&"bracket"!==U.type||z({type:"maybe_slash",value:"",output:"".concat(f,"?")}),!0===R.backtrack){R.output="";for(const t of R.tokens)R.output+=null!=t.output?t.output:t.value,t.suffix&&(R.output+=t.suffix)}return R};gc.fastpaths=(t,e)=>{const n={...e},r="number"==typeof n.maxLength?Math.min(uc,n.maxLength):uc,o=t.length;if(o>r)throw new SyntaxError("Input length: ".concat(o,", exceeds maximum allowed length: ").concat(r));t=hc[t]||t;const{DOT_LITERAL:i,SLASH_LITERAL:a,ONE_CHAR:s,DOTS_SLASH:l,NO_DOT:c,NO_DOTS:u,NO_DOTS_SLASH:p,STAR:f,START_ANCHOR:d}=lc.globChars(),h=n.dot?u:c,m=n.dot?p:c,y=n.capture?"":"?:";let g=!0===n.bash?".*?":f;n.capture&&(g="(".concat(g,")"));const v=t=>!0===t.noglobstar?g:"(".concat(y,"(?:(?!").concat(d).concat(t.dot?l:i,").)*?)"),b=t=>{switch(t){case"*":return"".concat(h).concat(s).concat(g);case".*":return"".concat(i).concat(s).concat(g);case"*.*":return"".concat(h).concat(g).concat(i).concat(s).concat(g);case"*/*":return"".concat(h).concat(g).concat(a).concat(s).concat(m).concat(g);case"**":return h+v(n);case"**/*":return"(?:".concat(h).concat(v(n)).concat(a,")?").concat(m).concat(s).concat(g);case"**/*.*":return"(?:".concat(h).concat(v(n)).concat(a,")?").concat(m).concat(g).concat(i).concat(s).concat(g);case"**/.*":return"(?:".concat(h).concat(v(n)).concat(a,")?").concat(i).concat(s).concat(g);default:{const e=/^(.*?)\.(\w+)$/.exec(t);if(!e)return;const n=b(e[1]);if(!n)return;return n+i+e[2]}}},x=cc.removePrefix(t,{negated:!1,prefix:""});let _=b(x);return _&&!0!==n.strictSlashes&&(_+="".concat(a,"?")),_};const vc=Ol,bc=ic,xc=gc,_c=Tl,wc=Ml,Ec=t=>t&&"object"==typeof t&&!Array.isArray(t),Sc=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(t)){const r=t.map((t=>Sc(t,e,n))),o=t=>{for(const e of r){const n=e(t);if(n)return n}return!1};return o}const r=Ec(t)&&t.tokens&&t.input;if(""===t||"string"!=typeof t&&!r)throw new TypeError("Expected pattern to be a non-empty string");const o=e||{},i=_c.isWindows(e),a=r?Sc.compileRe(t,e):Sc.makeRe(t,e,!1,!0),s=a.state;delete a.state;let l=()=>!1;if(o.ignore){const t={...e,ignore:null,onMatch:null,onResult:null};l=Sc(o.ignore,t,n)}const c=function(n){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{isMatch:c,match:u,output:p}=Sc.test(n,a,e,{glob:t,posix:i}),f={glob:t,state:s,regex:a,posix:i,input:n,output:p,match:u,isMatch:c};return"function"==typeof o.onResult&&o.onResult(f),!1===c?(f.isMatch=!1,!!r&&f):l(n)?("function"==typeof o.onIgnore&&o.onIgnore(f),f.isMatch=!1,!!r&&f):("function"==typeof o.onMatch&&o.onMatch(f),!r||f)};return n&&(c.state=s),c};Sc.test=function(t,e,n){let{glob:r,posix:o}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if("string"!=typeof t)throw new TypeError("Expected input to be a string");if(""===t)return{isMatch:!1,output:""};const i=n||{},a=i.format||(o?_c.toPosixSlashes:null);let s=t===r,l=s&&a?a(t):t;return!1===s&&(l=a?a(t):t,s=l===r),!1!==s&&!0!==i.capture||(s=!0===i.matchBase||!0===i.basename?Sc.matchBase(t,e,n,o):e.exec(l)),{isMatch:Boolean(s),match:s,output:l}},Sc.matchBase=function(t,e,n){arguments.length>3&&void 0!==arguments[3]||_c.isWindows(n);const r=e instanceof RegExp?e:Sc.makeRe(e,n);return r.test(vc.basename(t))},Sc.isMatch=(t,e,n)=>Sc(e,n)(t),Sc.parse=(t,e)=>Array.isArray(t)?t.map((t=>Sc.parse(t,e))):xc(t,{...e,fastpaths:!1}),Sc.scan=(t,e)=>bc(t,e),Sc.compileRe=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!0===n)return t.output;const o=e||{},i=o.contains?"":"^",a=o.contains?"":"$";let s="".concat(i,"(?:").concat(t.output,")").concat(a);t&&!0===t.negated&&(s="^(?!".concat(s,").*$"));const l=Sc.toRegex(s,e);return!0===r&&(l.state=t),l},Sc.makeRe=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!t||"string"!=typeof t)throw new TypeError("Expected a non-empty string");let o={negated:!1,fastpaths:!0};return!1===e.fastpaths||"."!==t[0]&&"*"!==t[0]||(o.output=xc.fastpaths(t,e)),o.output||(o=xc(t,e)),Sc.compileRe(o,e,n,r)},Sc.toRegex=(t,e)=>{try{const n=e||{};return new RegExp(t,n.flags||(n.nocase?"i":""))}catch(t){if(e&&!0===e.debug)throw t;return/$^/}},Sc.constants=wc,vl.exports=Sc;var Ac=e(vl.exports);class Rc{constructor(t){sa(this,"extensions",void 0),sa(this,"mimeTypes",void 0);const[e,n]=(t=>{const e=[],n=[];return t.split(",").map((t=>t.trim())).filter(Boolean).forEach((t=>{t.startsWith(".")?e.push("*".concat(t)):n.push(t)})),[e,n]})(t);this.extensions=e,this.mimeTypes=n}isAccepted(t){return 0===this.extensions.length&&0===this.mimeTypes.length||(this.isMimeTypeAccepted(gl.getType(t))||this.isExtensionAccepted(t))}isMimeTypeAccepted(t){return 0!==this.mimeTypes.length&&Ac.isMatch(t,this.mimeTypes)}isExtensionAccepted(t){return 0!==this.extensions.length&&Ac.isMatch(t,this.extensions)}}const kc=async t=>new Promise(((e,n)=>t.createReader().readEntries(e,n))),Oc=async t=>new Promise(((e,n)=>t.file(e,n))),Tc=async t=>{const e=[];for await(const n of t)if(n.isFile){const t=await Oc(n);e.push(t)}else if(n.isDirectory){const t=await kc(n);(await Tc(t)).forEach((t=>e.push(t)))}return e};class Cc{constructor(t){let{container:e,inputAccept:n,onUploadFiles:r,renderer:o}=t;sa(this,"acceptedFileTypes",void 0),sa(this,"container",void 0),sa(this,"onUploadFiles",void 0),sa(this,"renderer",void 0),sa(this,"onDrop",(t=>{const e=t;this.container.classList.remove("dff-dropping"),e.preventDefault(),e.stopPropagation();(async()=>{try{if(e.dataTransfer){const t=await(async t=>{if(t.items){const e=[...t.items].map((t=>t.webkitGetAsEntry()));return await Tc(e)}return[...t.files]})(e.dataTransfer),n=[],r=[];for(const e of t)this.acceptedFileTypes.isAccepted(e.name)?n.push(e):r.push(e);this.renderer.setErrorInvalidFiles(r),this.onUploadFiles(n)}}catch(t){console.error(t)}})()})),this.container=e,this.onUploadFiles=r,this.acceptedFileTypes=new Rc(n),this.renderer=o,e.addEventListener("dragenter",(()=>{e.classList.add("dff-dropping")})),e.addEventListener("dragleave",(()=>{e.classList.remove("dff-dropping")})),e.addEventListener("dragover",(t=>{e.classList.add("dff-dropping"),t.preventDefault()})),e.addEventListener("drop",this.onDrop)}}class Uc{constructor(t){let{name:e,status:n,type:r,uploadIndex:o}=t;sa(this,"name",void 0),sa(this,"status",void 0),sa(this,"type",void 0),sa(this,"uploadIndex",void 0),this.name=e,this.status=n,this.type=r,this.uploadIndex=o}async abort(){}async delete(){}}function Ic(t){var e=[];if(0===t.length)return"";if("string"!=typeof t[0])throw new TypeError("Url must be a string. Received "+t[0]);if(t[0].match(/^[^/:]+:\/*$/)&&t.length>1){var n=t.shift();t[0]=n+t[0]}t[0].match(/^file:\/\/\//)?t[0]=t[0].replace(/^([^/:]+):\/*/,"$1:///"):t[0]=t[0].replace(/^([^/:]+):\/*/,"$1://");for(var r=0;r<t.length;r++){var o=t[r];if("string"!=typeof o)throw new TypeError("Url must be a string. Received "+o);""!==o&&(r>0&&(o=o.replace(/^[\/]+/,"")),o=r<t.length-1?o.replace(/[\/]+$/,""):o.replace(/[\/]+$/,"/"),e.push(o))}var i=e.join("/"),a=(i=i.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return i=a.shift()+(a.length>0?"?":"")+a.join("&")}function Pc(){return Ic("object"==typeof arguments[0]?arguments[0]:[].slice.call(arguments))}const jc=(t,e)=>{const n=t.indexOf(e);-1!==n&&t.splice(n,1)};class Lc extends Uc{constructor(t){let{csrfToken:e,endpoint:n,file:r,s3UploadDir:o,uploadIndex:i}=t;super({name:r.name,status:"uploading",type:"s3",uploadIndex:i}),sa(this,"onError",void 0),sa(this,"onProgress",void 0),sa(this,"onSuccess",void 0),sa(this,"chunkState",void 0),sa(this,"chunks",void 0),sa(this,"createdPromise",void 0),sa(this,"csrfToken",void 0),sa(this,"endpoint",void 0),sa(this,"file",void 0),sa(this,"key",void 0),sa(this,"parts",void 0),sa(this,"s3UploadDir",void 0),sa(this,"uploadId",void 0),sa(this,"uploading",void 0),this.csrfToken=e,this.endpoint=n,this.file=r,this.s3UploadDir=o,this.key=null,this.uploadId=null,this.parts=[],this.createdPromise=Promise.reject(),this.chunks=[],this.chunkState=[],this.uploading=[],this.onError=void 0,this.onProgress=void 0,this.onSuccess=void 0,this.initChunks(),this.createdPromise.catch((()=>({})))}async abort(){this.uploading.slice().forEach((t=>{t.abort()})),this.uploading=[],await this.createdPromise,this.key&&this.uploadId&&await(t=>{let{csrfToken:e,key:n,uploadId:r,endpoint:o}=t;const i=encodeURIComponent(n),a=encodeURIComponent(r),s=new Headers({"X-CSRFToken":e}),l=Pc(o,a,"?key=".concat(i));return fetch(l,{method:"delete",headers:s}).then((t=>t.json()))})({csrfToken:this.csrfToken,endpoint:this.endpoint,key:this.key,uploadId:this.uploadId})}async delete(){return Promise.resolve()}getInitialFile(){return{id:this.uploadId||"",name:this.key||"",size:this.file.size,original_name:this.file.name,type:"s3"}}getSize(){return this.file.size}start(){this.createUpload()}initChunks(){const t=[],e=(n=this.file,Math.ceil(n.size/1e4));var n;const r=Math.max(5242880,Math.ceil(this.file.size/1e4)),o=Math.max(e,r);for(let e=0;e<this.file.size;e+=o){const n=Math.min(this.file.size,e+o);t.push(this.file.slice(e,n))}this.chunks=t,this.chunkState=t.map((()=>({uploaded:0,busy:!1,done:!1})))}createUpload(){return this.createdPromise=(t=>{let{csrfToken:e,endpoint:n,file:r,s3UploadDir:o}=t;const i=new Headers({accept:"application/json","content-type":"application/json","X-CSRFToken":e});return fetch(n,{method:"post",headers:i,body:JSON.stringify({filename:r.name,contentType:r.type,s3UploadDir:o})}).then((t=>t.json())).then((t=>t))})({csrfToken:this.csrfToken,endpoint:this.endpoint,file:this.file,s3UploadDir:this.s3UploadDir}),this.createdPromise.then((t=>{if(!("object"==typeof t&&t&&"string"==typeof t.uploadId&&"string"==typeof t.key))throw new TypeError("AwsS3/Multipart: Got incorrect result from `createMultipartUpload()`, expected an object `{ uploadId, key }`.");this.key=t.key,this.uploadId=t.uploadId,this.uploadParts()})).catch((t=>{this.handleError(t)}))}uploadParts(){const t=1-this.uploading.length;if(0===t)return;if(this.chunkState.every((t=>t.done)))return void this.completeUpload();const e=[];for(let n=0;n<this.chunkState.length;n++){const r=this.chunkState[n];if(!r.done&&!r.busy&&(e.push(n),e.length>=t))break}e.forEach((t=>{this.uploadPart(t)}))}uploadPart(t){return this.chunkState[t].busy=!0,this.key&&this.uploadId?(t=>{let{csrfToken:e,endpoint:n,key:r,number:o,uploadId:i}=t;const a=encodeURIComponent(r),s=new Headers({"X-CSRFToken":e}),l=Pc(n,i,"".concat(o),"?key=".concat(a));return fetch(l,{method:"get",headers:s}).then((t=>t.json())).then((t=>t))})({csrfToken:this.csrfToken,endpoint:this.endpoint,key:this.key,number:t+1,uploadId:this.uploadId}).then((t=>{if(!("object"==typeof t&&t&&"string"==typeof t.url))throw new TypeError("AwsS3/Multipart: Got incorrect result from `prepareUploadPart()`, expected an object `{ url }`.");return t})).then((e=>{let{url:n}=e;this.uploadPartBytes(t,n)}),(t=>{this.handleError(t)})):Promise.resolve()}onPartProgress(t,e){if(this.chunkState[t].uploaded=e,this.onProgress){const t=this.chunkState.reduce(((t,e)=>t+e.uploaded),0);this.onProgress(t,this.file.size)}}onPartComplete(t,e){this.chunkState[t].etag=e,this.chunkState[t].done=!0;const n={PartNumber:t+1,ETag:e};this.parts.push(n),this.uploadParts()}uploadPartBytes(t,e){const n=this.chunks[t],r=new XMLHttpRequest;r.open("PUT",e,!0),r.responseType="text",this.uploading.push(r),r.upload.addEventListener("progress",(e=>{e.lengthComputable&&this.onPartProgress(t,e.loaded)})),r.addEventListener("abort",(e=>{jc(this.uploading,e.target),this.chunkState[t].busy=!1})),r.addEventListener("load",(e=>{const r=e.target;if(jc(this.uploading,r),this.chunkState[t].busy=!1,r.status<200||r.status>=300)return void this.handleError(new Error("Non 2xx"));this.onPartProgress(t,n.size);const o=r.getResponseHeader("ETag");null!==o?this.onPartComplete(t,o):this.handleError(new Error("AwsS3/Multipart: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions."))})),r.addEventListener("error",(e=>{jc(this.uploading,e.target),this.chunkState[t].busy=!1;const n=new Error("Unknown error");this.handleError(n)})),r.send(n)}completeUpload(){return this.parts.sort(((t,e)=>t.PartNumber-e.PartNumber)),this.uploadId&&this.key?(t=>{let{csrfToken:e,key:n,uploadId:r,parts:o,endpoint:i}=t;const a=encodeURIComponent(n),s=encodeURIComponent(r),l=new Headers({"X-CSRFToken":e}),c=Pc(i,s,"complete","?key=".concat(a));return fetch(c,{method:"post",headers:l,body:JSON.stringify({parts:o})}).then((t=>t.json())).then((t=>t))})({csrfToken:this.csrfToken,endpoint:this.endpoint,key:this.key,uploadId:this.uploadId,parts:this.parts}).then((()=>{this.onSuccess&&this.onSuccess()}),(t=>{this.handleError(t)})):Promise.resolve()}handleError(t){if(!this.onError)throw t;this.onError(t)}}const Dc=async(t,e)=>new Promise(((n,r)=>{const o=new XMLHttpRequest;o.open("DELETE",t),o.onload=()=>{204===o.status?n():r()},o.setRequestHeader("Tus-Resumable","1.0.0"),o.setRequestHeader("X-CSRFToken",e),o.send(null)}));class Hc extends Uc{constructor(t){let{name:e,size:n,type:r,uploadIndex:o}=t;super({name:e,status:"done",type:r,uploadIndex:o}),sa(this,"size",void 0),this.size=n}async abort(){return Promise.resolve()}async delete(){return Promise.resolve()}getSize(){return this.size}}class Fc extends Hc{constructor(t,e){super({name:t.name,size:t.size,type:"placeholder",uploadIndex:e}),sa(this,"id",void 0),this.id=t.id}getInitialFile(){return{id:this.id,name:this.name,size:this.size,type:"placeholder"}}}class Nc extends Hc{constructor(t,e){super({name:t.original_name||t.name,size:t.size,type:"uploadedS3",uploadIndex:e}),sa(this,"id",void 0),sa(this,"key",void 0),this.id=t.id,this.key=t.name}getInitialFile(){return{id:this.id,name:this.key,original_name:this.name,size:this.size,type:"s3"}}}class Mc extends Hc{constructor(t,e){super({name:t.name,size:t.size,type:"existing",uploadIndex:e})}getInitialFile(){return{name:this.name,size:this.size,type:"existing"}}}class zc extends Hc{constructor(t){let{csrfToken:e,initialFile:n,uploadIndex:r,uploadUrl:o}=t;super({name:n.name,size:n.size,type:"uploadedTus",uploadIndex:r}),sa(this,"csrfToken",void 0),sa(this,"id",void 0),sa(this,"url",void 0),this.csrfToken=e,this.id=n.id,this.url="".concat(o).concat(n.id)}async delete(){await Dc(this.url,this.csrfToken)}getInitialFile(){return{id:this.id,name:this.name,size:this.size,type:"tus",url:""}}}const Bc="function"==typeof btoa,qc="function"==typeof Buffer,Gc=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder?new TextEncoder:void 0),$c=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),Kc=((t=>{let e={};t.forEach(((t,n)=>e[t]=n))})($c),String.fromCharCode.bind(String)),Xc=("function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),t=>t.replace(/=/g,"").replace(/[+\/]/g,(t=>"+"==t?"-":"_"))),Wc=t=>{let e,n,r,o,i="";const a=t.length%3;for(let a=0;a<t.length;){if((n=t.charCodeAt(a++))>255||(r=t.charCodeAt(a++))>255||(o=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=n<<16|r<<8|o,i+=$c[e>>18&63]+$c[e>>12&63]+$c[e>>6&63]+$c[63&e]}return a?i.slice(0,a-3)+"===".substring(a):i},Vc=Bc?t=>btoa(t):qc?t=>Buffer.from(t,"binary").toString("base64"):Wc,Yc=qc?t=>Buffer.from(t).toString("base64"):t=>{let e=[];for(let n=0,r=t.length;n<r;n+=4096)e.push(Kc.apply(null,t.subarray(n,n+4096)));return Vc(e.join(""))},Qc=t=>{if(t.length<2)return(e=t.charCodeAt(0))<128?t:e<2048?Kc(192|e>>>6)+Kc(128|63&e):Kc(224|e>>>12&15)+Kc(128|e>>>6&63)+Kc(128|63&e);var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return Kc(240|e>>>18&7)+Kc(128|e>>>12&63)+Kc(128|e>>>6&63)+Kc(128|63&e)},Zc=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Jc=t=>t.replace(Zc,Qc),tu=qc?t=>Buffer.from(t,"utf8").toString("base64"):Gc?t=>Yc(Gc.encode(t)):t=>Vc(Jc(t)),eu=(t,e=!1)=>e?Xc(tu(t)):tu(t),nu=eu;var ru={},ou=Object.prototype.hasOwnProperty;function iu(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}function au(t){try{return encodeURIComponent(t)}catch(t){return null}}ru.stringify=function(t,e){e=e||"";var n,r,o=[];for(r in"string"!=typeof e&&(e="?"),t)if(ou.call(t,r)){if((n=t[r])||null!=n&&!isNaN(n)||(n=""),r=au(r),n=au(n),null===r||null===n)continue;o.push(r+"="+n)}return o.length?e+o.join("&"):""},ru.parse=function(t){for(var e,n=/([^=?#&]+)=?([^&]*)/g,r={};e=n.exec(t);){var o=iu(e[1]),i=iu(e[2]);null===o||null===i||o in r||(r[o]=i)}return r};var su=function(t,e){if(e=e.split(":")[0],!(t=+t))return!1;switch(e){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t},lu=ru,cu=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,uu=/[\n\r\t]/g,pu=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,fu=/:\d+$/,du=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,hu=/^[a-zA-Z]:/;function mu(t){return(t||"").toString().replace(cu,"")}var yu=[["#","hash"],["?","query"],function(t,e){return bu(e.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],gu={hash:1,query:1};function vu(e){var n,r=("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{}).location||{},o={},i=typeof(e=e||r);if("blob:"===e.protocol)o=new _u(unescape(e.pathname),{});else if("string"===i)for(n in o=new _u(e,{}),gu)delete o[n];else if("object"===i){for(n in e)n in gu||(o[n]=e[n]);void 0===o.slashes&&(o.slashes=pu.test(e.href))}return o}function bu(t){return"file:"===t||"ftp:"===t||"http:"===t||"https:"===t||"ws:"===t||"wss:"===t}function xu(t,e){t=(t=mu(t)).replace(uu,""),e=e||{};var n,r=du.exec(t),o=r[1]?r[1].toLowerCase():"",i=!!r[2],a=!!r[3],s=0;return i?a?(n=r[2]+r[3]+r[4],s=r[2].length+r[3].length):(n=r[2]+r[4],s=r[2].length):a?(n=r[3]+r[4],s=r[3].length):n=r[4],"file:"===o?s>=2&&(n=n.slice(2)):bu(o)?n=r[4]:o?i&&(n=n.slice(2)):s>=2&&bu(e.protocol)&&(n=r[4]),{protocol:o,slashes:i||bu(o),slashesCount:s,rest:n}}function _u(t,e,n){if(t=(t=mu(t)).replace(uu,""),!(this instanceof _u))return new _u(t,e,n);var r,o,i,a,s,l,c=yu.slice(),u=typeof e,p=this,f=0;for("object"!==u&&"string"!==u&&(n=e,e=null),n&&"function"!=typeof n&&(n=lu.parse),r=!(o=xu(t||"",e=vu(e))).protocol&&!o.slashes,p.slashes=o.slashes||r&&e.slashes,p.protocol=o.protocol||e.protocol||"",t=o.rest,("file:"===o.protocol&&(2!==o.slashesCount||hu.test(t))||!o.slashes&&(o.protocol||o.slashesCount<2||!bu(p.protocol)))&&(c[3]=[/(.*)/,"pathname"]);f<c.length;f++)"function"!=typeof(a=c[f])?(i=a[0],l=a[1],i!=i?p[l]=t:"string"==typeof i?~(s="@"===i?t.lastIndexOf(i):t.indexOf(i))&&("number"==typeof a[2]?(p[l]=t.slice(0,s),t=t.slice(s+a[2])):(p[l]=t.slice(s),t=t.slice(0,s))):(s=i.exec(t))&&(p[l]=s[1],t=t.slice(0,s.index)),p[l]=p[l]||r&&a[3]&&e[l]||"",a[4]&&(p[l]=p[l].toLowerCase())):t=a(t,p);n&&(p.query=n(p.query)),r&&e.slashes&&"/"!==p.pathname.charAt(0)&&(""!==p.pathname||""!==e.pathname)&&(p.pathname=function(t,e){if(""===t)return e;for(var n=(e||"/").split("/").slice(0,-1).concat(t.split("/")),r=n.length,o=n[r-1],i=!1,a=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),a++):a&&(0===r&&(i=!0),n.splice(r,1),a--);return i&&n.unshift(""),"."!==o&&".."!==o||n.push(""),n.join("/")}(p.pathname,e.pathname)),"/"!==p.pathname.charAt(0)&&bu(p.protocol)&&(p.pathname="/"+p.pathname),su(p.port,p.protocol)||(p.host=p.hostname,p.port=""),p.username=p.password="",p.auth&&(~(s=p.auth.indexOf(":"))?(p.username=p.auth.slice(0,s),p.username=encodeURIComponent(decodeURIComponent(p.username)),p.password=p.auth.slice(s+1),p.password=encodeURIComponent(decodeURIComponent(p.password))):p.username=encodeURIComponent(decodeURIComponent(p.auth)),p.auth=p.password?p.username+":"+p.password:p.username),p.origin="file:"!==p.protocol&&bu(p.protocol)&&p.host?p.protocol+"//"+p.host:"null",p.href=p.toString()}_u.prototype={set:function(t,e,n){var r=this;switch(t){case"query":"string"==typeof e&&e.length&&(e=(n||lu.parse)(e)),r[t]=e;break;case"port":r[t]=e,su(e,r.protocol)?e&&(r.host=r.hostname+":"+e):(r.host=r.hostname,r[t]="");break;case"hostname":r[t]=e,r.port&&(e+=":"+r.port),r.host=e;break;case"host":r[t]=e,fu.test(e)?(e=e.split(":"),r.port=e.pop(),r.hostname=e.join(":")):(r.hostname=e,r.port="");break;case"protocol":r.protocol=e.toLowerCase(),r.slashes=!n;break;case"pathname":case"hash":if(e){var o="pathname"===t?"/":"#";r[t]=e.charAt(0)!==o?o+e:e}else r[t]=e;break;case"username":case"password":r[t]=encodeURIComponent(e);break;case"auth":var i=e.indexOf(":");~i?(r.username=e.slice(0,i),r.username=encodeURIComponent(decodeURIComponent(r.username)),r.password=e.slice(i+1),r.password=encodeURIComponent(decodeURIComponent(r.password))):r.username=encodeURIComponent(decodeURIComponent(e))}for(var a=0;a<yu.length;a++){var s=yu[a];s[4]&&(r[s[1]]=r[s[1]].toLowerCase())}return r.auth=r.password?r.username+":"+r.password:r.username,r.origin="file:"!==r.protocol&&bu(r.protocol)&&r.host?r.protocol+"//"+r.host:"null",r.href=r.toString(),r},toString:function(t){t&&"function"==typeof t||(t=lu.stringify);var e,n=this,r=n.host,o=n.protocol;o&&":"!==o.charAt(o.length-1)&&(o+=":");var i=o+(n.protocol&&n.slashes||bu(n.protocol)?"//":"");return n.username?(i+=n.username,n.password&&(i+=":"+n.password),i+="@"):n.password?(i+=":"+n.password,i+="@"):"file:"!==n.protocol&&bu(n.protocol)&&!r&&"/"!==n.pathname&&(i+="@"),(":"===r[r.length-1]||fu.test(n.hostname)&&!n.port)&&(r+=":"),i+=r+n.pathname,(e="object"==typeof n.query?t(n.query):n.query)&&(i+="?"!==e.charAt(0)?"?"+e:e),n.hash&&(i+=n.hash),i}},_u.extractProtocol=xu,_u.location=vu,_u.trimLeft=mu,_u.qs=lu;var wu=_u;function Eu(t){return Eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eu(t)}function Su(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Au(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ru(t,e){if(e&&("object"===Eu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ku(t){var e="function"==typeof Map?new Map:void 0;return ku=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return Ou(t,arguments,Uu(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Cu(r,t)},ku(t)}function Ou(t,e,n){return Ou=Tu()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&Cu(o,n.prototype),o},Ou.apply(null,arguments)}function Tu(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Cu(t,e){return Cu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Cu(t,e)}function Uu(t){return Uu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Uu(t)}var Iu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cu(t,e)}(o,t);var e,n,r=(e=o,n=Tu(),function(){var t,r=Uu(e);if(n){var o=Uu(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return Ru(this,t)});function o(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(Au(this,o),(e=r.call(this,t)).originalRequest=i,e.originalResponse=a,e.causingError=n,null!=n&&(t+=", caused by ".concat(n.toString())),null!=i){var s=i.getHeader("X-Request-ID")||"n/a",l=i.getMethod(),c=i.getURL(),u=a?a.getStatus():"n/a",p=a?a.getBody()||"":"n/a";t+=", originated from request (method: ".concat(l,", url: ").concat(c,", response code: ").concat(u,", response text: ").concat(p,", request id: ").concat(s,")")}return e.message=t,e}return function(t,e,n){return e&&Su(t.prototype,e),n&&Su(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(o)}(ku(Error));function Pu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){s=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return ju(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ju(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ju(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Lu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Du(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Lu(Object(n),!0).forEach((function(e){Hu(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Lu(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Hu(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Nu={endpoint:null,uploadUrl:null,metadata:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,_onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:null,chunkSize:1/0,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null},Mu=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"resume"in n&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=n,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=e,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}return function(t,e,n){e&&Fu(t.prototype,e),n&&Fu(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"findPreviousUploads",value:function(){var t=this;return this.options.fingerprint(this.file,this.options).then((function(e){return t._urlStorage.findUploadsByFingerprint(e)}))}},{key:"resumeFromPreviousUpload",value:function(t){this.url=t.uploadUrl||null,this._parallelUploadUrls=t.parallelUploadUrls||null,this._urlStorageKey=t.urlStorageKey}},{key:"start",value:function(){var t=this,e=this.file;if(e)if(this.options.endpoint||this.options.uploadUrl||this.url){var n=this.options.retryDelays;if(null==n||"[object Array]"===Object.prototype.toString.call(n)){if(this.options.parallelUploads>1)for(var r=0,o=["uploadUrl","uploadSize","uploadLengthDeferred"];r<o.length;r++){var i=o[r];if(this.options[i])return void this._emitError(new Error("tus: cannot use the ".concat(i," option when parallelUploads is enabled")))}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1)return void this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length)return void this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"))}this.options.fingerprint(e,this.options).then((function(n){return t._fingerprint=n,t._source?t._source:t.options.fileReader.openFile(e,t.options.chunkSize)})).then((function(e){if(t._source=e,t.options.uploadLengthDeferred)t._size=null;else if(null!=t.options.uploadSize){if(t._size=Number(t.options.uploadSize),Number.isNaN(t._size))return void t._emitError(new Error("tus: cannot convert `uploadSize` option into a number"))}else if(t._size=t._source.size,null==t._size)return void t._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));t.options.parallelUploads>1||null!=t._parallelUploadUrls?t._startParallelUpload():t._startSingleUpload()})).catch((function(e){t._emitError(e)}))}else this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"))}else this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));else this._emitError(new Error("tus: no file or stream to upload provided"))}},{key:"_startParallelUpload",value:function(){var e,n=this,r=this._size,o=0;this._parallelUploads=[];var i=null!=this._parallelUploadUrls?this._parallelUploadUrls.length:this.options.parallelUploads,a=null!==(e=this.options.parallelUploadBoundaries)&&void 0!==e?e:function(t,e){for(var n=Math.floor(t/e),r=[],o=0;o<e;o++)r.push({start:n*o,end:n*(o+1)});return r[e-1].end=t,r}(this._source.size,i);this._parallelUploadUrls&&a.forEach((function(t,e){t.uploadUrl=n._parallelUploadUrls[e]||null})),this._parallelUploadUrls=new Array(a.length);var s,l=a.map((function(e,i){var s=0;return n._source.slice(e.start,e.end).then((function(l){var c=l.value;return new Promise((function(l,u){var p=Du(Du({},n.options),{},{uploadUrl:e.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:{},headers:Du(Du({},n.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:l,onError:u,onProgress:function(t){o=o-s+t,s=t,n._emitProgress(o,r)},_onUploadUrlAvailable:function(){n._parallelUploadUrls[i]=f.url,n._parallelUploadUrls.filter((function(t){return Boolean(t)})).length===a.length&&n._saveUploadInUrlStorage()}}),f=new t(c,p);f.start(),n._parallelUploads.push(f)}))}))}));Promise.all(l).then((function(){(s=n._openRequest("POST",n.options.endpoint)).setHeader("Upload-Concat","final;".concat(n._parallelUploadUrls.join(" ")));var t=zu(n.options.metadata);return""!==t&&s.setHeader("Upload-Metadata",t),n._sendRequest(s,null)})).then((function(t){if(Bu(t.getStatus(),200)){var e=t.getHeader("Location");null!=e?(n.url=Ku(n.options.endpoint,e),"Created upload at ".concat(n.url),n._emitSuccess()):n._emitHttpError(s,t,"tus: invalid or missing Location header")}else n._emitHttpError(s,t,"tus: unexpected response while creating upload")})).catch((function(t){n._emitError(t)}))}},{key:"_startSingleUpload",value:function(){return this._aborted=!1,null!=this.url?("Resuming upload from previous URL: ".concat(this.url),void this._resumeUpload()):null!=this.options.uploadUrl?("Resuming upload from provided URL: ".concat(this.options.uploadUrl),this.url=this.options.uploadUrl,void this._resumeUpload()):void this._createUpload()}},{key:"abort",value:function(e){var n=this;return null!=this._parallelUploads&&this._parallelUploads.forEach((function(t){t.abort(e)})),null!==this._req&&this._req.abort(),this._aborted=!0,null!=this._retryTimeout&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),e&&null!=this.url?t.terminate(this.url,this.options).then((function(){return n._removeFromUrlStorage()})):Promise.resolve()}},{key:"_emitHttpError",value:function(t,e,n,r){this._emitError(new Iu(n,r,t,e))}},{key:"_emitError",value:function(t){var e=this;if(!this._aborted){if(null!=this.options.retryDelays)if(null!=this._offset&&this._offset>this._offsetBeforeRetry&&(this._retryAttempt=0),$u(t,this._retryAttempt,this.options)){var n=this.options.retryDelays[this._retryAttempt++];return this._offsetBeforeRetry=this._offset,void(this._retryTimeout=setTimeout((function(){e.start()}),n))}if("function"!=typeof this.options.onError)throw t;this.options.onError(t)}}},{key:"_emitSuccess",value:function(){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),"function"==typeof this.options.onSuccess&&this.options.onSuccess()}},{key:"_emitProgress",value:function(t,e){"function"==typeof this.options.onProgress&&this.options.onProgress(t,e)}},{key:"_emitChunkComplete",value:function(t,e,n){"function"==typeof this.options.onChunkComplete&&this.options.onChunkComplete(t,e,n)}},{key:"_createUpload",value:function(){var t=this;if(this.options.endpoint){var e=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?e.setHeader("Upload-Defer-Length",1):e.setHeader("Upload-Length",this._size);var n,r=zu(this.options.metadata);""!==r&&e.setHeader("Upload-Metadata",r),this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,n=this._addChunkToRequest(e)):n=this._sendRequest(e,null),n.then((function(n){if(Bu(n.getStatus(),200)){var r=n.getHeader("Location");if(null!=r){if(t.url=Ku(t.options.endpoint,r),"Created upload at ".concat(t.url),"function"==typeof t.options._onUploadUrlAvailable&&t.options._onUploadUrlAvailable(),0===t._size)return t._emitSuccess(),void t._source.close();t._saveUploadInUrlStorage().then((function(){t.options.uploadDataDuringCreation?t._handleUploadResponse(e,n):(t._offset=0,t._performUpload())}))}else t._emitHttpError(e,n,"tus: invalid or missing Location header")}else t._emitHttpError(e,n,"tus: unexpected response while creating upload")})).catch((function(n){t._emitHttpError(e,null,"tus: failed to create upload",n)}))}else this._emitError(new Error("tus: unable to create upload because no endpoint is provided"))}},{key:"_resumeUpload",value:function(){var t=this,e=this._openRequest("HEAD",this.url);this._sendRequest(e,null).then((function(n){var r=n.getStatus();if(!Bu(r,200))return 423===r?void t._emitHttpError(e,n,"tus: upload is currently locked; retry later"):(Bu(r,400)&&t._removeFromUrlStorage(),t.options.endpoint?(t.url=null,void t._createUpload()):void t._emitHttpError(e,n,"tus: unable to resume upload (new upload cannot be created without an endpoint)"));var o=parseInt(n.getHeader("Upload-Offset"),10);if(Number.isNaN(o))t._emitHttpError(e,n,"tus: invalid or missing offset value");else{var i=parseInt(n.getHeader("Upload-Length"),10);!Number.isNaN(i)||t.options.uploadLengthDeferred?("function"==typeof t.options._onUploadUrlAvailable&&t.options._onUploadUrlAvailable(),t._saveUploadInUrlStorage().then((function(){if(o===i)return t._emitProgress(i,i),void t._emitSuccess();t._offset=o,t._performUpload()}))):t._emitHttpError(e,n,"tus: invalid or missing length value")}})).catch((function(n){t._emitHttpError(e,null,"tus: failed to resume upload",n)}))}},{key:"_performUpload",value:function(){var t,e=this;this._aborted||(this.options.overridePatchMethod?(t=this._openRequest("POST",this.url)).setHeader("X-HTTP-Method-Override","PATCH"):t=this._openRequest("PATCH",this.url),t.setHeader("Upload-Offset",this._offset),this._addChunkToRequest(t).then((function(n){Bu(n.getStatus(),200)?e._handleUploadResponse(t,n):e._emitHttpError(t,n,"tus: unexpected response while uploading chunk")})).catch((function(n){e._aborted||e._emitHttpError(t,null,"tus: failed to upload chunk at offset ".concat(e._offset),n)})))}},{key:"_addChunkToRequest",value:function(t){var e=this,n=this._offset,r=this._offset+this.options.chunkSize;return t.setProgressHandler((function(t){e._emitProgress(n+t,e._size)})),t.setHeader("Content-Type","application/offset+octet-stream"),(r===1/0||r>this._size)&&!this.options.uploadLengthDeferred&&(r=this._size),this._source.slice(n,r).then((function(n){var r=n.value,o=n.done;return e.options.uploadLengthDeferred&&o&&(e._size=e._offset+(r&&r.size?r.size:0),t.setHeader("Upload-Length",e._size)),null===r?e._sendRequest(t):(e._emitProgress(e._offset,e._size),e._sendRequest(t,r))}))}},{key:"_handleUploadResponse",value:function(t,e){var n=parseInt(e.getHeader("Upload-Offset"),10);if(Number.isNaN(n))this._emitHttpError(t,e,"tus: invalid or missing offset value");else{if(this._emitProgress(n,this._size),this._emitChunkComplete(n-this._offset,n,this._size),this._offset=n,n===this._size)return this._emitSuccess(),void this._source.close();this._performUpload()}}},{key:"_openRequest",value:function(t,e){var n=qu(t,e,this.options);return this._req=n,n}},{key:"_removeFromUrlStorage",value:function(){var t=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch((function(e){t._emitError(e)})),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var t=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||null!==this._urlStorageKey)return Promise.resolve();var e={size:this._size,metadata:this.options.metadata,creationTime:(new Date).toString()};return this._parallelUploads?e.parallelUploadUrls=this._parallelUploadUrls:e.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,e).then((function(e){t._urlStorageKey=e}))}},{key:"_sendRequest",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Gu(t,e,this.options)}}],[{key:"terminate",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=qu("DELETE",e,n);return Gu(r,null,n).then((function(t){if(204!==t.getStatus())throw new Iu("tus: unexpected response while terminating upload",null,r,t)})).catch((function(o){if(o instanceof Iu||(o=new Iu("tus: failed to terminate upload",o,r,null)),!$u(o,0,n))throw o;var i=n.retryDelays[0],a=n.retryDelays.slice(1),s=Du(Du({},n),{},{retryDelays:a});return new Promise((function(t){return setTimeout(t,i)})).then((function(){return t.terminate(e,s)}))}))}}]),t}();function zu(t){return Object.entries(t).map((function(t){var e=Pu(t,2),n=e[0],r=e[1];return"".concat(n," ").concat(nu(String(r)))})).join(",")}function Bu(t,e){return t>=e&&t<e+100}function qu(t,e,n){var r=n.httpStack.createRequest(t,e);r.setHeader("Tus-Resumable","1.0.0");var o=n.headers||{};if(Object.entries(o).forEach((function(t){var e=Pu(t,2),n=e[0],o=e[1];r.setHeader(n,o)})),n.addRequestId){var i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}));r.setHeader("X-Request-ID",i)}return r}function Gu(t,e,n){return("function"==typeof n.onBeforeRequest?Promise.resolve(n.onBeforeRequest(t)):Promise.resolve()).then((function(){return t.send(e).then((function(e){return("function"==typeof n.onAfterResponse?Promise.resolve(n.onAfterResponse(t,e)):Promise.resolve()).then((function(){return e}))}))}))}function $u(t,e,n){if(null==n.retryDelays||e>=n.retryDelays.length||null==t.originalRequest)return!1;if(n&&"function"==typeof n.onShouldRetry)return n.onShouldRetry(t,e,n);var r,o=t.originalResponse?t.originalResponse.getStatus():0;return(!Bu(o,400)||409===o||423===o)&&(r=!0,"undefined"!=typeof window&&"navigator"in window&&!1===window.navigator.onLine&&(r=!1),r)}function Ku(t,e){return new wu(e,t).toString()}function Xu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Mu.defaultOptions=Nu;var Wu=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){e&&Xu(t.prototype,e),n&&Xu(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(t){return Promise.resolve([])}},{key:"removeUpload",value:function(t){return Promise.resolve()}},{key:"addUpload",value:function(t,e){return Promise.resolve(null)}}]),t}();function Vu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Yu=!1;try{Yu="localStorage"in window;var Qu="tusSupport";localStorage.setItem(Qu,localStorage.getItem(Qu))}catch(t){if(t.code!==t.SECURITY_ERR&&t.code!==t.QUOTA_EXCEEDED_ERR)throw t;Yu=!1}var Zu=Yu,Ju=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){e&&Vu(t.prototype,e),n&&Vu(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"findAllUploads",value:function(){var t=this._findEntries("tus::");return Promise.resolve(t)}},{key:"findUploadsByFingerprint",value:function(t){var e=this._findEntries("tus::".concat(t,"::"));return Promise.resolve(e)}},{key:"removeUpload",value:function(t){return localStorage.removeItem(t),Promise.resolve()}},{key:"addUpload",value:function(t,e){var n=Math.round(1e12*Math.random()),r="tus::".concat(t,"::").concat(n);return localStorage.setItem(r,JSON.stringify(e)),Promise.resolve(r)}},{key:"_findEntries",value:function(t){for(var e=[],n=0;n<localStorage.length;n++){var r=localStorage.key(n);if(0===r.indexOf(t))try{var o=JSON.parse(localStorage.getItem(r));o.urlStorageKey=r,e.push(o)}catch(t){}}return e}}]),t}();function tp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ep(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function np(t,e,n){return e&&ep(t.prototype,e),n&&ep(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var rp=function(){function t(){tp(this,t)}return np(t,[{key:"createRequest",value:function(t,e){return new op(t,e)}},{key:"getName",value:function(){return"XHRHttpStack"}}]),t}(),op=function(){function t(e,n){tp(this,t),this._xhr=new XMLHttpRequest,this._xhr.open(e,n,!0),this._method=e,this._url=n,this._headers={}}return np(t,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(t,e){this._xhr.setRequestHeader(t,e),this._headers[t]=e}},{key:"getHeader",value:function(t){return this._headers[t]}},{key:"setProgressHandler",value:function(t){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(e){e.lengthComputable&&t(e.loaded)})}},{key:"send",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Promise((function(n,r){t._xhr.onload=function(){n(new ip(t._xhr))},t._xhr.onerror=function(t){r(t)},t._xhr.send(e)}))}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),t}(),ip=function(){function t(e){tp(this,t),this._xhr=e}return np(t,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(t){return this._xhr.getResponseHeader(t)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),t}(),ap=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase()};var sp={exports:{}},lp=It("iterator"),cp=!1;try{var up=0,pp={next:function(){return{done:!!up++}},return:function(){cp=!0}};pp[lp]=function(){return this},Array.from(pp,(function(){throw 2}))}catch(t){}var fp,dp,hp,mp="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,yp=mp,gp=Ft,vp=r,bp=o,xp=s,_p=tt,wp=Ca,Ep=Jt,Sp=Vn,Ap=eo,Rp=Mt.f,kp=Kt,Op=$o,Tp=gi,Cp=It,Up=it,Ip=dr.enforce,Pp=dr.get,jp=vp.Int8Array,Lp=jp&&jp.prototype,Dp=vp.Uint8ClampedArray,Hp=Dp&&Dp.prototype,Fp=jp&&Op(jp),Np=Lp&&Op(Lp),Mp=Object.prototype,zp=vp.TypeError,Bp=Cp("toStringTag"),qp=Up("TYPED_ARRAY_TAG"),Gp="TypedArrayConstructor",$p=yp&&!!Tp&&"Opera"!==wp(vp.opera),Kp=!1,Xp={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Wp={BigInt64Array:8,BigUint64Array:8},Vp=function(t){var e=Op(t);if(xp(e)){var n=Pp(e);return n&&_p(n,Gp)?n.TypedArrayConstructor:Vp(e)}},Yp=function(t){if(!xp(t))return!1;var e=wp(t);return _p(Xp,e)||_p(Wp,e)};for(fp in Xp)(hp=(dp=vp[fp])&&dp.prototype)?Ip(hp).TypedArrayConstructor=dp:$p=!1;for(fp in Wp)(hp=(dp=vp[fp])&&dp.prototype)&&(Ip(hp).TypedArrayConstructor=dp);if((!$p||!bp(Fp)||Fp===Function.prototype)&&(Fp=function(){throw zp("Incorrect invocation")},$p))for(fp in Xp)vp[fp]&&Tp(vp[fp],Fp);if((!$p||!Np||Np===Mp)&&(Np=Fp.prototype,$p))for(fp in Xp)vp[fp]&&Tp(vp[fp].prototype,Np);if($p&&Op(Hp)!==Np&&Tp(Hp,Np),gp&&!_p(Np,Bp))for(fp in Kp=!0,Rp(Np,Bp,{get:function(){return xp(this)?this[qp]:void 0}}),Xp)vp[fp]&&Sp(vp[fp],qp,fp);var Qp={NATIVE_ARRAY_BUFFER_VIEWS:$p,TYPED_ARRAY_TAG:Kp&&qp,aTypedArray:function(t){if(Yp(t))return t;throw zp("Target is not a typed array")},aTypedArrayConstructor:function(t){if(bp(t)&&(!Tp||kp(Fp,t)))return t;throw zp(Ep(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,n,r){if(gp){if(n)for(var o in Xp){var i=vp[o];if(i&&_p(i.prototype,t))try{delete i.prototype[t]}catch(n){try{i.prototype[t]=e}catch(t){}}}Np[t]&&!n||Ap(Np,t,n?e:$p&&Lp[t]||e,r)}},exportTypedArrayStaticMethod:function(t,e,n){var r,o;if(gp){if(Tp){if(n)for(r in Xp)if((o=vp[r])&&_p(o,t))try{delete o[t]}catch(t){}if(Fp[t]&&!n)return;try{return Ap(Fp,t,n?e:$p&&Fp[t]||e)}catch(t){}}for(r in Xp)!(o=vp[r])||o[t]&&!n||Ap(o,t,e)}},getTypedArrayConstructor:Vp,isView:function(t){if(!xp(t))return!1;var e=wp(t);return"DataView"===e||_p(Xp,e)||_p(Wp,e)},isTypedArray:Yp,TypedArray:Fp,TypedArrayPrototype:Np},Zp=r,Jp=m,tf=function(t,e){if(!e&&!cp)return!1;var n=!1;try{var r={};r[lp]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(t){}return n},ef=Qp.NATIVE_ARRAY_BUFFER_VIEWS,nf=Zp.ArrayBuffer,rf=Zp.Int8Array,of=!ef||!Jp((function(){rf(1)}))||!Jp((function(){new rf(-1)}))||!tf((function(t){new rf,new rf(null),new rf(1.5),new rf(t)}),!0)||Jp((function(){return 1!==new rf(new nf(2),1,void 0).length})),af=eo,sf=Kt,lf=TypeError,cf=function(t,e){if(sf(e,t))return t;throw lf("Incorrect invocation")},uf=De,pf=qe,ff=RangeError,df=function(t){if(void 0===t)return 0;var e=uf(t),n=pf(e);if(e!==n)throw ff("Wrong length or index");return n},hf=Array,mf=Math.abs,yf=Math.pow,gf=Math.floor,vf=Math.log,bf=Math.LN2,xf={pack:function(t,e,n){var r,o,i,a=hf(n),s=8*n-e-1,l=(1<<s)-1,c=l>>1,u=23===e?yf(2,-24)-yf(2,-77):0,p=t<0||0===t&&1/t<0?1:0,f=0;for((t=mf(t))!=t||t===1/0?(o=t!=t?1:0,r=l):(r=gf(vf(t)/bf),t*(i=yf(2,-r))<1&&(r--,i*=2),(t+=r+c>=1?u/i:u*yf(2,1-c))*i>=2&&(r++,i/=2),r+c>=l?(o=0,r=l):r+c>=1?(o=(t*i-1)*yf(2,e),r+=c):(o=t*yf(2,c-1)*yf(2,e),r=0));e>=8;)a[f++]=255&o,o/=256,e-=8;for(r=r<<e|o,s+=e;s>0;)a[f++]=255&r,r/=256,s-=8;return a[--f]|=128*p,a},unpack:function(t,e){var n,r=t.length,o=8*r-e-1,i=(1<<o)-1,a=i>>1,s=o-7,l=r-1,c=t[l--],u=127&c;for(c>>=7;s>0;)u=256*u+t[l--],s-=8;for(n=u&(1<<-s)-1,u>>=-s,s+=e;s>0;)n=256*n+t[l--],s-=8;if(0===u)u=1-a;else{if(u===i)return n?NaN:c?-1/0:1/0;n+=yf(2,e),u-=a}return(c?-1:1)*n*yf(2,u-e)}},_f=Q,wf=Me,Ef=$e,Sf=function(t){for(var e=_f(this),n=Ef(e),r=arguments.length,o=wf(r>1?arguments[1]:void 0,n),i=r>2?arguments[2]:void 0,a=void 0===i?n:wf(i,n);a>o;)e[o++]=t;return e},Af=_e,Rf=Mt,kf=Kn,Of=Me,Tf=$e,Cf=function(t,e,n){var r=Af(e);r in t?Rf.f(t,r,kf(0,n)):t[r]=n},Uf=Array,If=Math.max,Pf=function(t,e,n){for(var r=Tf(t),o=Of(e,r),i=Of(void 0===n?r:n,r),a=Uf(If(i-o,0)),s=0;o<i;o++,s++)Cf(a,s,t[o]);return a.length=s,a},jf=r,Lf=w,Df=Ft,Hf=mp,Ff=jr,Nf=Vn,Mf=function(t,e,n){for(var r in e)af(t,r,e[r],n);return t},zf=m,Bf=cf,qf=De,Gf=qe,$f=df,Kf=xf,Xf=$o,Wf=gi,Vf=no.f,Yf=Mt.f,Qf=Sf,Zf=Pf,Jf=oi,td=Ff.PROPER,ed=Ff.CONFIGURABLE,nd=dr.get,rd=dr.set,od="ArrayBuffer",id="DataView",ad="Wrong index",sd=jf.ArrayBuffer,ld=sd,cd=ld&&ld.prototype,ud=jf.DataView,pd=ud&&ud.prototype,fd=Object.prototype,dd=jf.Array,hd=jf.RangeError,md=Lf(Qf),yd=Lf([].reverse),gd=Kf.pack,vd=Kf.unpack,bd=function(t){return[255&t]},xd=function(t){return[255&t,t>>8&255]},_d=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},wd=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},Ed=function(t){return gd(t,23,4)},Sd=function(t){return gd(t,52,8)},Ad=function(t,e){Yf(t.prototype,e,{get:function(){return nd(this)[e]}})},Rd=function(t,e,n,r){var o=$f(n),i=nd(t);if(o+e>i.byteLength)throw hd(ad);var a=nd(i.buffer).bytes,s=o+i.byteOffset,l=Zf(a,s,s+e);return r?l:yd(l)},kd=function(t,e,n,r,o,i){var a=$f(n),s=nd(t);if(a+e>s.byteLength)throw hd(ad);for(var l=nd(s.buffer).bytes,c=a+s.byteOffset,u=r(+o),p=0;p<e;p++)l[c+p]=u[i?p:e-p-1]};if(Hf){var Od=td&&sd.name!==od;if(zf((function(){sd(1)}))&&zf((function(){new sd(-1)}))&&!zf((function(){return new sd,new sd(1.5),new sd(NaN),1!=sd.length||Od&&!ed})))Od&&ed&&Nf(sd,"name",od);else{(ld=function(t){return Bf(this,cd),new sd($f(t))}).prototype=cd;for(var Td,Cd=Vf(sd),Ud=0;Cd.length>Ud;)(Td=Cd[Ud++])in ld||Nf(ld,Td,sd[Td]);cd.constructor=ld}Wf&&Xf(pd)!==fd&&Wf(pd,fd);var Id=new ud(new ld(2)),Pd=Lf(pd.setInt8);Id.setInt8(0,2147483648),Id.setInt8(1,2147483649),!Id.getInt8(0)&&Id.getInt8(1)||Mf(pd,{setInt8:function(t,e){Pd(this,t,e<<24>>24)},setUint8:function(t,e){Pd(this,t,e<<24>>24)}},{unsafe:!0})}else cd=(ld=function(t){Bf(this,cd);var e=$f(t);rd(this,{bytes:md(dd(e),0),byteLength:e}),Df||(this.byteLength=e)}).prototype,pd=(ud=function(t,e,n){Bf(this,pd),Bf(t,cd);var r=nd(t).byteLength,o=qf(e);if(o<0||o>r)throw hd("Wrong offset");if(o+(n=void 0===n?r-o:Gf(n))>r)throw hd("Wrong length");rd(this,{buffer:t,byteLength:n,byteOffset:o}),Df||(this.buffer=t,this.byteLength=n,this.byteOffset=o)}).prototype,Df&&(Ad(ld,"byteLength"),Ad(ud,"buffer"),Ad(ud,"byteLength"),Ad(ud,"byteOffset")),Mf(pd,{getInt8:function(t){return Rd(this,1,t)[0]<<24>>24},getUint8:function(t){return Rd(this,1,t)[0]},getInt16:function(t){var e=Rd(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=Rd(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return wd(Rd(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return wd(Rd(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return vd(Rd(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return vd(Rd(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){kd(this,1,t,bd,e)},setUint8:function(t,e){kd(this,1,t,bd,e)},setInt16:function(t,e){kd(this,2,t,xd,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){kd(this,2,t,xd,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){kd(this,4,t,_d,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){kd(this,4,t,_d,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){kd(this,4,t,Ed,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){kd(this,8,t,Sd,e,arguments.length>2?arguments[2]:void 0)}});Jf(ld,od),Jf(ud,id);var jd={ArrayBuffer:ld,DataView:ud},Ld=s,Dd=Math.floor,Hd=Number.isInteger||function(t){return!Ld(t)&&isFinite(t)&&Dd(t)===t},Fd=De,Nd=RangeError,Md=function(t){var e=Fd(t);if(e<0)throw Nd("The argument can't be less than 0");return e},zd=RangeError,Bd=function(t,e){var n=Md(t);if(n%e)throw zd("Wrong offset");return n},qd=re,Gd=y,$d=w(w.bind),Kd=function(t,e){return qd(t),void 0===e?t:Gd?$d(t,e):function(){return t.apply(e,arguments)}},Xd=w,Wd=m,Vd=o,Yd=Ca,Qd=Fr,Zd=function(){},Jd=[],th=ct("Reflect","construct"),eh=/^\s*(?:class|function)\b/,nh=Xd(eh.exec),rh=!eh.exec(Zd),oh=function(t){if(!Vd(t))return!1;try{return th(Zd,Jd,t),!0}catch(t){return!1}},ih=function(t){if(!Vd(t))return!1;switch(Yd(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return rh||!!nh(eh,Qd(t))}catch(t){return!0}};ih.sham=!0;var ah=!th||Wd((function(){var t;return oh(oh.call)||!oh(Object)||!oh((function(){t=!0}))||t}))?ih:oh,sh=ah,lh=Jt,ch=TypeError,uh=Ca,ph=ae,fh=I,dh=Bn,hh=It("iterator"),mh=function(t){if(!fh(t))return ph(t,hh)||ph(t,"@@iterator")||dh[uh(t)]},yh=$t,gh=re,vh=Dt,bh=Jt,xh=mh,_h=TypeError,wh=Bn,Eh=It("iterator"),Sh=Array.prototype,Ah=Kd,Rh=$t,kh=function(t){if(sh(t))return t;throw ch(lh(t)+" is not a constructor")},Oh=Q,Th=$e,Ch=function(t,e){var n=arguments.length<2?xh(t):e;if(gh(n))return vh(yh(n,t));throw _h(bh(t)+" is not iterable")},Uh=mh,Ih=function(t){return void 0!==t&&(wh.Array===t||Sh[Eh]===t)},Ph=Qp.aTypedArrayConstructor,jh=R,Lh=Array.isArray||function(t){return"Array"==jh(t)},Dh=ah,Hh=s,Fh=It("species"),Nh=Array,Mh=function(t){var e;return Lh(t)&&(e=t.constructor,(Dh(e)&&(e===Nh||Lh(e.prototype))||Hh(e)&&null===(e=e[Fh]))&&(e=void 0)),void 0===e?Nh:e},zh=Kd,Bh=U,qh=Q,Gh=$e,$h=function(t,e){return new(Mh(t))(0===e?0:e)},Kh=w([].push),Xh=function(t){var e=1==t,n=2==t,r=3==t,o=4==t,i=6==t,a=7==t,s=5==t||i;return function(l,c,u,p){for(var f,d,h=qh(l),m=Bh(h),y=zh(c,u),g=Gh(m),v=0,b=p||$h,x=e?b(l,g):n||a?b(l,0):void 0;g>v;v++)if((s||v in m)&&(d=y(f=m[v],v,h),t))if(e)x[v]=d;else if(d)switch(t){case 3:return!0;case 5:return f;case 6:return v;case 2:Kh(x,f)}else switch(t){case 4:return!1;case 7:Kh(x,f)}return i?-1:r||o?o:x}},Wh={forEach:Xh(0),map:Xh(1),filter:Xh(2),some:Xh(3),every:Xh(4),find:Xh(5),findIndex:Xh(6),filterReject:Xh(7)},Vh=ct,Yh=Mt,Qh=Ft,Zh=It("species"),Jh=o,tm=s,em=gi,nm=Do,rm=r,om=$t,im=Ft,am=of,sm=Qp,lm=jd,cm=cf,um=Kn,pm=Vn,fm=Hd,dm=qe,hm=df,mm=Bd,ym=_e,gm=tt,vm=Ca,bm=s,xm=Qt,_m=In,wm=Kt,Em=gi,Sm=no.f,Am=function(t){var e,n,r,o,i,a,s=kh(this),l=Oh(t),c=arguments.length,u=c>1?arguments[1]:void 0,p=void 0!==u,f=Uh(l);if(f&&!Ih(f))for(a=(i=Ch(l,f)).next,l=[];!(o=Rh(a,i)).done;)l.push(o.value);for(p&&c>2&&(u=Ah(u,arguments[2])),n=Th(l),r=new(Ph(s))(n),e=0;n>e;e++)r[e]=p?u(l[e],e):l[e];return r},Rm=Wh.forEach,km=function(t){var e=Vh(t),n=Yh.f;Qh&&e&&!e[Zh]&&n(e,Zh,{configurable:!0,get:function(){return this}})},Om=Mt,Tm=hr,Cm=function(t,e,n){var r,o;return em&&Jh(r=e.constructor)&&r!==n&&tm(o=r.prototype)&&o!==n.prototype&&em(t,o),t},Um=dr.get,Im=dr.set,Pm=dr.enforce,jm=Om.f,Lm=Tm.f,Dm=Math.round,Hm=rm.RangeError,Fm=lm.ArrayBuffer,Nm=Fm.prototype,Mm=lm.DataView,zm=sm.NATIVE_ARRAY_BUFFER_VIEWS,Bm=sm.TYPED_ARRAY_TAG,qm=sm.TypedArray,Gm=sm.TypedArrayPrototype,$m=sm.aTypedArrayConstructor,Km=sm.isTypedArray,Xm="BYTES_PER_ELEMENT",Wm="Wrong length",Vm=function(t,e){$m(t);for(var n=0,r=e.length,o=new t(r);r>n;)o[n]=e[n++];return o},Ym=function(t,e){jm(t,e,{get:function(){return Um(this)[e]}})},Qm=function(t){var e;return wm(Nm,t)||"ArrayBuffer"==(e=vm(t))||"SharedArrayBuffer"==e},Zm=function(t,e){return Km(t)&&!xm(e)&&e in t&&fm(+e)&&e>=0},Jm=function(t,e){return e=ym(e),Zm(t,e)?um(2,t[e]):Lm(t,e)},ty=function(t,e,n){return e=ym(e),!(Zm(t,e)&&bm(n)&&gm(n,"value"))||gm(n,"get")||gm(n,"set")||n.configurable||gm(n,"writable")&&!n.writable||gm(n,"enumerable")&&!n.enumerable?jm(t,e,n):(t[e]=n.value,t)};im?(zm||(Tm.f=Jm,Om.f=ty,Ym(Gm,"buffer"),Ym(Gm,"byteOffset"),Ym(Gm,"byteLength"),Ym(Gm,"length")),nm({target:"Object",stat:!0,forced:!zm},{getOwnPropertyDescriptor:Jm,defineProperty:ty}),sp.exports=function(t,e,n){var r=t.match(/\d+$/)[0]/8,o=t+(n?"Clamped":"")+"Array",i="get"+t,a="set"+t,s=rm[o],l=s,c=l&&l.prototype,u={},p=function(t,e){jm(t,e,{get:function(){return function(t,e){var n=Um(t);return n.view[i](e*r+n.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,o){var i=Um(t);n&&(o=(o=Dm(o))<0?0:o>255?255:255&o),i.view[a](e*r+i.byteOffset,o,!0)}(this,e,t)},enumerable:!0})};zm?am&&(l=e((function(t,e,n,o){return cm(t,c),Cm(bm(e)?Qm(e)?void 0!==o?new s(e,mm(n,r),o):void 0!==n?new s(e,mm(n,r)):new s(e):Km(e)?Vm(l,e):om(Am,l,e):new s(hm(e)),t,l)})),Em&&Em(l,qm),Rm(Sm(s),(function(t){t in l||pm(l,t,s[t])})),l.prototype=c):(l=e((function(t,e,n,o){cm(t,c);var i,a,s,u=0,f=0;if(bm(e)){if(!Qm(e))return Km(e)?Vm(l,e):om(Am,l,e);i=e,f=mm(n,r);var d=e.byteLength;if(void 0===o){if(d%r)throw Hm(Wm);if((a=d-f)<0)throw Hm(Wm)}else if((a=dm(o)*r)+f>d)throw Hm(Wm);s=a/r}else s=hm(e),i=new Fm(a=s*r);for(Im(t,{buffer:i,byteOffset:f,byteLength:a,length:s,view:new Mm(i)});u<s;)p(t,u++)})),Em&&Em(l,qm),c=l.prototype=_m(Gm)),c.constructor!==l&&pm(c,"constructor",l),Pm(c).TypedArrayConstructor=l,Bm&&pm(c,Bm,o);var f=l!=s;u[o]=l,nm({global:!0,constructor:!0,forced:f,sham:!zm},u),Xm in l||pm(l,Xm,r),Xm in c||pm(c,Xm,r),km(o)}):sp.exports=function(){},(0,sp.exports)("Uint8",(function(t){return function(e,n,r){return t(this,e,n,r)}}));var ey=ve,ny=TypeError,ry=Sf,oy=function(t){var e=ey(t,"number");if("number"==typeof e)throw ny("Can't convert number to bigint");return BigInt(e)},iy=Ca,ay=$t,sy=m,ly=Qp.aTypedArray,cy=Qp.exportTypedArrayMethod,uy=w("".slice);cy("fill",(function(t){var e=arguments.length;ly(this);var n="Big"===uy(iy(this),0,3)?oy(t):+t;return ay(ry,this,n,e>1?arguments[1]:void 0,e>2?arguments[2]:void 0)}),sy((function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),1!==t})));var py=r,fy=$t,dy=Qp,hy=$e,my=Bd,yy=Q,gy=m,vy=py.RangeError,by=py.Int8Array,xy=by&&by.prototype,_y=xy&&xy.set,wy=dy.aTypedArray,Ey=dy.exportTypedArrayMethod,Sy=!gy((function(){var t=new Uint8ClampedArray(2);return fy(_y,t,{length:1,0:3},1),3!==t[1]})),Ay=Sy&&dy.NATIVE_ARRAY_BUFFER_VIEWS&&gy((function(){var t=new by(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));Ey("set",(function(t){wy(this);var e=my(arguments.length>1?arguments[1]:void 0,1),n=yy(t);if(Sy)return fy(_y,this,n,e);var r=this.length,o=hy(n),i=0;if(o+e>r)throw vy("Wrong length");for(;i<o;)this[e+i]=n[i++]}),!Sy||Ay);var Ry=Pf,ky=Math.floor,Oy=function(t,e){var n=t.length,r=ky(n/2);return n<8?Ty(t,e):Cy(t,Oy(Ry(t,0,r),e),Oy(Ry(t,r),e),e)},Ty=function(t,e){for(var n,r,o=t.length,i=1;i<o;){for(r=i,n=t[i];r&&e(t[r-1],n)>0;)t[r]=t[--r];r!==i++&&(t[r]=n)}return t},Cy=function(t,e,n,r){for(var o=e.length,i=n.length,a=0,s=0;a<o||s<i;)t[a+s]=a<o&&s<i?r(e[a],n[s])<=0?e[a++]:n[s++]:a<o?e[a++]:n[s++];return t},Uy=Oy,Iy=ut.match(/firefox\/(\d+)/i),Py=!!Iy&&+Iy[1],jy=/MSIE|Trident/.test(ut),Ly=ut.match(/AppleWebKit\/(\d+)\./),Dy=!!Ly&&+Ly[1],Hy=w,Fy=m,Ny=re,My=Uy,zy=Py,By=jy,qy=gt,Gy=Dy,$y=Qp.aTypedArray,Ky=Qp.exportTypedArrayMethod,Xy=r.Uint16Array,Wy=Xy&&Hy(Xy.prototype.sort),Vy=!(!Wy||Fy((function(){Wy(new Xy(2),null)}))&&Fy((function(){Wy(new Xy(2),{})}))),Yy=!!Wy&&!Fy((function(){if(qy)return qy<74;if(zy)return zy<67;if(By)return!0;if(Gy)return Gy<602;var t,e,n=new Xy(516),r=Array(516);for(t=0;t<516;t++)e=t%4,n[t]=515-t,r[t]=t-2*e+3;for(Wy(n,(function(t,e){return(t/4|0)-(e/4|0)})),t=0;t<516;t++)if(n[t]!==r[t])return!0}));function Qy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Ky("sort",(function(t){return void 0!==t&&Ny(t),Yy?Wy(this,t):My($y(this),function(t){return function(e,n){return void 0!==t?+t(e,n)||0:n!=n?-1:e!=e?1:0===e&&0===n?1/e>0&&1/n<0?1:-1:e>n}}(t))}),!Yy||Vy);var Zy=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._file=e,this.size=e.size}return function(t,e,n){e&&Qy(t.prototype,e),n&&Qy(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"slice",value:function(t,e){if("undefined"!=typeof window&&(void 0!==window.PhoneGap||void 0!==window.Cordova||void 0!==window.cordova))return n=this._file.slice(t,e),new Promise((function(t,e){var r=new FileReader;r.onload=function(){var e=new Uint8Array(r.result);t({value:e})},r.onerror=function(t){e(t)},r.readAsArrayBuffer(n)}));var n,r=this._file.slice(t,e);return Promise.resolve({value:r})}},{key:"close",value:function(){}}]),t}();function Jy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tg(t){return void 0===t?0:void 0!==t.size?t.size:t.length}var eg=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._buffer=void 0,this._bufferOffset=0,this._reader=e,this._done=!1}return function(t,e,n){e&&Jy(t.prototype,e),n&&Jy(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"slice",value:function(t,e){return t<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(t,e)}},{key:"_readUntilEnoughDataOrDone",value:function(t,e){var n=this,r=e<=this._bufferOffset+tg(this._buffer);if(this._done||r){var o=this._getDataFromBuffer(t,e),i=null==o&&this._done;return Promise.resolve({value:o,done:i})}return this._reader.read().then((function(r){var o=r.value;return r.done?n._done=!0:void 0===n._buffer?n._buffer=o:n._buffer=function(t,e){if(t.concat)return t.concat(e);if(t instanceof Blob)return new Blob([t,e],{type:t.type});if(t.set){var n=new t.constructor(t.length+e.length);return n.set(t),n.set(e,t.length),n}throw new Error("Unknown data type")}(n._buffer,o),n._readUntilEnoughDataOrDone(t,e)}))}},{key:"_getDataFromBuffer",value:function(t,e){t>this._bufferOffset&&(this._buffer=this._buffer.slice(t-this._bufferOffset),this._bufferOffset=t);var n=0===tg(this._buffer);return this._done&&n?null:this._buffer.slice(0,e-t)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}]),t}();function ng(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var rg=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){e&&ng(t.prototype,e),n&&ng(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"openFile",value:function(t,e){return ap()&&t&&void 0!==t.uri?(n=t.uri,new Promise((function(t,e){var r=new XMLHttpRequest;r.responseType="blob",r.onload=function(){var e=r.response;t(e)},r.onerror=function(t){e(t)},r.open("GET",n),r.send()}))).then((function(t){return new Zy(t)})).catch((function(t){throw new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(t))})):"function"==typeof t.slice&&void 0!==t.size?Promise.resolve(new Zy(t)):"function"==typeof t.read?(e=Number(e),Number.isFinite(e)?Promise.resolve(new eg(t,e)):Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option"))):Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment"));var n}}]),t}();function og(t){return og="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},og(t)}function ig(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ag(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function sg(t,e){return sg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},sg(t,e)}function lg(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ug(t);if(e){var o=ug(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return cg(this,n)}}function cg(t,e){if(e&&("object"===og(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ug(t){return ug=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ug(t)}function pg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function fg(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pg(Object(n),!0).forEach((function(e){dg(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pg(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function dg(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var hg=fg(fg({},Mu.defaultOptions),{},{httpStack:new rp,fileReader:new rg,urlStorage:Zu?new Ju:new Wu,fingerprint:function(t,e){return ap()?Promise.resolve(function(t,e){var n=t.exif?function(t){var e=0;if(0===t.length)return e;for(var n=0;n<t.length;n++){e=(e<<5)-e+t.charCodeAt(n),e&=e}return e}(JSON.stringify(t.exif)):"noexif";return["tus-rn",t.name||"noname",t.size||"nosize",n,e.endpoint].join("/")}(t,e)):Promise.resolve(["tus-br",t.name,t.type,t.size,t.lastModified,e.endpoint].join("-"))}}),mg=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sg(t,e)}(n,t);var e=lg(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ig(this,n),r=fg(fg({},hg),r),e.call(this,t,r)}return function(t,e,n){e&&ag(t.prototype,e),n&&ag(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(n,null,[{key:"terminate",value:function(t,e,n){return e=fg(fg({},hg),e),Mu.terminate(t,e,n)}}]),n}(Mu);class yg extends Uc{constructor(t){let{chunkSize:e,csrfToken:n,fieldName:r,file:o,formId:i,retryDelays:a,uploadIndex:s,uploadUrl:l}=t;super({name:o.name,status:"uploading",type:"tus",uploadIndex:s}),sa(this,"onError",void 0),sa(this,"onProgress",void 0),sa(this,"onSuccess",void 0),sa(this,"upload",void 0),sa(this,"csrfToken",void 0),sa(this,"handleError",(t=>{if(!this.onError)throw t;this.onError(t)})),sa(this,"handleProgress",((t,e)=>{this.onProgress&&this.onProgress(t,e)})),sa(this,"handleSucces",(()=>{this.onSuccess&&this.onSuccess()})),sa(this,"addCsrTokenToRequest",(t=>{t.setHeader("X-CSRFToken",this.csrfToken)})),this.csrfToken=n,this.upload=new mg(o,{chunkSize:e,endpoint:l,metadata:{fieldName:r,filename:o.name,formId:i},onBeforeRequest:this.addCsrTokenToRequest,onError:this.handleError,onProgress:this.handleProgress,onSuccess:this.handleSucces,retryDelays:a||[0,1e3,3e3,5e3]}),this.onError=void 0,this.onProgress=void 0,this.onSuccess=void 0}async abort(){await this.upload.abort(!0)}async delete(){if(!this.upload.url)return Promise.resolve();await Dc(this.upload.url,this.csrfToken)}getSize(){return this.upload.file.size}start(){this.upload.start()}getInitialFile(){return{id:this.name,name:this.name,size:this.getSize(),type:"tus",url:""}}}class gg{constructor(t){let{callbacks:e,chunkSize:n,csrfToken:r,eventEmitter:o,fieldName:i,form:a,formId:s,initial:l,input:c,multiple:u,parent:p,prefix:f,retryDelays:d,s3UploadDir:h,skipRequired:m,supportDropArea:y,translations:g,uploadUrl:v}=t;sa(this,"acceptedFileTypes",void 0),sa(this,"callbacks",void 0),sa(this,"chunkSize",void 0),sa(this,"csrfToken",void 0),sa(this,"eventEmitter",void 0),sa(this,"fieldName",void 0),sa(this,"form",void 0),sa(this,"formId",void 0),sa(this,"multiple",void 0),sa(this,"nextUploadIndex",void 0),sa(this,"prefix",void 0),sa(this,"renderer",void 0),sa(this,"retryDelays",void 0),sa(this,"s3UploadDir",void 0),sa(this,"supportDropArea",void 0),sa(this,"uploads",void 0),sa(this,"uploadUrl",void 0),sa(this,"uploadFiles",(async t=>{if(0!==t.length){if(!this.multiple){for(const t of this.uploads)this.renderer.deleteFile(t.uploadIndex);this.uploads=[]}for await(const e of t)await this.uploadFile(e);this.checkDropHint()}})),sa(this,"onChange",(t=>{const e=t.target.files||[],n=[],r=[];for(const t of e)this.acceptedFileTypes.isAccepted(t.name)?n.push(t):r.push(t);r&&this.handleInvalidFiles([...r]),n&&this.uploadFiles([...n]),this.renderer.clearInput()})),sa(this,"handleInvalidFiles",(t=>{this.renderer.setErrorInvalidFiles(t)})),sa(this,"onClick",(t=>{const e=t.target,n=()=>{const t=e.getAttribute("data-index");if(!t)return;const n=parseInt(t,10);return this.getUploadByIndex(n)};if(e.classList.contains("dff-delete")&&!e.classList.contains("dff-disabled")){const e=n();e&&this.removeExistingUpload(e),t.preventDefault()}else if(e.classList.contains("dff-cancel")){const e=n();e&&this.handleCancel(e),t.preventDefault()}})),sa(this,"handleProgress",((t,e,n)=>{const r=(e/n*100).toFixed(2);this.renderer.updateProgress(t.uploadIndex,r);const{onProgress:o}=this.callbacks;o&&t instanceof yg&&o(e,n,t)})),sa(this,"handleError",((t,e)=>{this.renderer.setError(t.uploadIndex),t.status="error";const{onError:n}=this.callbacks;n&&t instanceof yg&&n(e,t)})),sa(this,"handleSuccess",(t=>{const{renderer:e}=this;this.updatePlaceholderInput(),e.clearInput(),e.setSuccess(t.uploadIndex,t.getSize()),t.status="done";const{onSuccess:n}=this.callbacks,r=document.getElementsByClassName("dff-file-id-".concat(t.uploadIndex))[0];this.emitEvent("uploadComplete",r,t),n&&"tus"===t.type&&n(t)})),this.callbacks=e,this.chunkSize=n,this.csrfToken=r,this.eventEmitter=o,this.fieldName=i,this.form=a,this.formId=s,this.multiple=u,this.prefix=f,this.retryDelays=d,this.s3UploadDir=h,this.supportDropArea=y,this.uploadUrl=v,this.acceptedFileTypes=new Rc(c.accept),this.uploads=[],this.nextUploadIndex=0,this.renderer=new ma({parent:p,input:c,skipRequired:m,translations:g});const b=this.renderer.container;y&&this.initDropArea(b,c.accept),l&&this.addInitialFiles(l),this.checkDropHint(),c.addEventListener("change",this.onChange),b.addEventListener("click",this.onClick)}addInitialFiles(t){if(0===t.length)return;const{multiple:e,renderer:n}=this,r=t=>{const{size:e}=t,r="s3"===t.type&&t.original_name?t.original_name:t.name,o=n.addUploadedFile(r,this.nextUploadIndex,e),i=(t=>{let{csrfToken:e,initialFile:n,uploadIndex:r,uploadUrl:o}=t;switch(n.type){case"existing":return new Mc(n,r);case"placeholder":return new Fc(n,r);case"s3":return new Nc(n,r);case"tus":return new zc({csrfToken:e,initialFile:n,uploadUrl:o,uploadIndex:r})}})({csrfToken:this.csrfToken,initialFile:t,uploadIndex:this.nextUploadIndex,uploadUrl:this.uploadUrl});this.uploads.push(i),this.emitEvent("addUpload",o,i)};e?t.forEach((t=>{r(t),this.nextUploadIndex+=1})):r(t[0])}async uploadFile(t){const{fieldName:e,formId:n,renderer:r,uploadUrl:o}=this,i=t.name,a=this.findUploadByName(i),s=a?a.uploadIndex:this.nextUploadIndex;a||(this.nextUploadIndex+=1),a&&await this.removeExistingUpload(a);const l=(()=>{const{csrfToken:r,s3UploadDir:i}=this;return null!=i?new Lc({csrfToken:r,endpoint:o,file:t,s3UploadDir:i,uploadIndex:s}):new yg({chunkSize:this.chunkSize,csrfToken:this.csrfToken,fieldName:e,file:t,formId:n,retryDelays:this.retryDelays,uploadIndex:s,uploadUrl:o})})();l.onError=t=>this.handleError(l,t),l.onProgress=(t,e)=>this.handleProgress(l,t,e),l.onSuccess=()=>this.handleSuccess(l),l.start(),this.uploads.push(l);const c=r.addNewUpload(i,s);this.emitEvent("addUpload",c,l)}getUploadByIndex(t){return this.uploads.find((e=>e.uploadIndex===t))}findUploadByName(t){return this.uploads.find((e=>e.name===t))}async removeExistingUpload(t){const e=this.renderer.findFileDiv(t.uploadIndex);if(e&&this.emitEvent("removeUpload",e,t),"uploading"===t.status)this.renderer.disableCancel(t.uploadIndex),await t.abort();else if("done"===t.status){this.renderer.disableDelete(t.uploadIndex);try{await t.delete()}catch{return void this.renderer.setDeleteFailed(t.uploadIndex)}}this.removeUploadFromList(t),this.updatePlaceholderInput()}removeUploadFromList(t){this.renderer.deleteFile(t.uploadIndex);const e=this.uploads.indexOf(t);e>=0&&this.uploads.splice(e,1),this.checkDropHint();const{onDelete:n}=this.callbacks;n&&n(t)}async handleCancel(t){this.renderer.disableCancel(t.uploadIndex),await t.abort(),this.removeUploadFromList(t)}initDropArea(t,e){new Cc({container:t,inputAccept:e,onUploadFiles:this.uploadFiles,renderer:this.renderer})}checkDropHint(){if(!this.supportDropArea)return;0===this.uploads.filter((t=>t)).length?this.renderer.renderDropHint():this.renderer.removeDropHint()}updatePlaceholderInput(){const t=ua(this.form,pa(this.fieldName,this.prefix),this.prefix);if(!t)return;const e=this.uploads.map((t=>t.getInitialFile()));t.value=JSON.stringify(e)}getMetaDataField(){return ua(this.form,(t=this.fieldName,e=this.prefix,"".concat(ca(t,e),"-metadata")),this.prefix);var t,e}emitEvent(t,e,n){this.eventEmitter&&this.eventEmitter.emit(t,{element:e,fieldName:this.fieldName,fileName:n.name,metaDataField:this.getMetaDataField(),upload:n})}}const vg=function(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=t=>!n||!n.prefix||t.startsWith("".concat(n.prefix,"-")),o=()=>n&&n.prefix?n.prefix:null,i=e=>fa(t,e,o()),a=t=>{const e=i(pa(t,o()));return e?JSON.parse(e):[]},s=i("upload_url"),l=i("form_id"),c=i("s3_upload_dir"),u=n.skipRequired||!1,p=o(),f=null===(e=ua(t,"csrfmiddlewaretoken",null))||void 0===e?void 0:e.value;if(!f)throw Error("Csrf token not found");l&&s&&t.querySelectorAll(".dff-uploader").forEach((e=>{const o=e.querySelector(".dff-container");if(!o)return;const i=o.querySelector("input[type=file]");if(!i||!r(i.name))return;const d=i.name,{multiple:h}=i,m=a(d),y=o.getAttribute("data-translations"),g=y?JSON.parse(y):{},v=!(!1===n.supportDropArea);new gg({callbacks:n.callbacks||{},chunkSize:n.chunkSize||2621440,csrfToken:f,eventEmitter:n.eventEmitter,fieldName:d,form:t,formId:l,s3UploadDir:c||null,initial:m,input:i,multiple:h,parent:o,prefix:p,retryDelays:n.retryDelays||null,skipRequired:u,supportDropArea:v,translations:g,uploadUrl:s})}))};window.autoInitFileForms=()=>{const t=window.initUploadFields,e=(t=>Array.from(new Set(t).values()))(Array.from(document.querySelectorAll(".dff-uploader")).map(aa));e.forEach(t)},window.initFormSet=(t,e)=>{let n;n="string"==typeof e?{prefix:e}:e;const r=n.prefix||"form",o=fa(t,"TOTAL_FORMS",r);if(!o)return;const i=parseInt(o,10);for(let e=0;e<i;e+=1){const o=la("".concat(e),null);vg(t,{...n,prefix:"".concat(r,"-").concat(o)})}},window.initUploadFields=vg}();
//# sourceMappingURL=file_form.js.map
