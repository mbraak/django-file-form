!function(){var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var n=function(t){return t&&t.Math==Math&&t},r=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||function(){return this}()||Function("return this")(),o=function(t){return"function"==typeof t},i=o,a=function(t){return"object"==typeof t?null!==t:i(t)},s=a,l=r.document,c=s(l)&&s(l.createElement),u=function(t){return c?l.createElement(t):{}},p=u("span").classList,f=p&&p.constructor&&p.constructor.prototype,d=f===Object.prototype?void 0:f,h=function(t){try{return!!t()}catch(t){return!0}},m=!h((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),y=m,g=Function.prototype,v=g.bind,b=g.call,x=y&&v.bind(b,b),_=y?function(t){return t&&x(t)}:function(t){return t&&function(){return b.apply(t,arguments)}},w=_,E=w({}.toString),S=w("".slice),A=function(t){return S(E(t),8,-1)},R=h,k=A,O=Object,T=_("".split),C=R((function(){return!O("z").propertyIsEnumerable(0)}))?function(t){return"String"==k(t)?T(t,""):O(t)}:O,U=TypeError,P=function(t){if(null==t)throw U("Can't call method on "+t);return t},I=C,j=P,L=function(t){return I(j(t))},D={exports:{}},H=r,F=Object.defineProperty,N=function(t,e){try{F(H,t,{value:e,configurable:!0,writable:!0})}catch(n){H[t]=e}return e},M=N,z="__core-js_shared__",B=r[z]||M(z,{}),q=B;(D.exports=function(t,e){return q[t]||(q[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.23.3",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.3/LICENSE",source:"https://github.com/zloirock/core-js"});var G,$,K=P,X=Object,W=function(t){return X(K(t))},V=W,Y=_({}.hasOwnProperty),Q=Object.hasOwn||function(t,e){return Y(V(t),e)},Z=_,J=0,tt=Math.random(),et=Z(1..toString),nt=function(t){return"Symbol("+(void 0===t?"":t)+")_"+et(++J+tt,36)},rt=r,ot=o,it=function(t){return ot(t)?t:void 0},at=function(t,e){return arguments.length<2?it(rt[t]):rt[t]&&rt[t][e]},st=at("navigator","userAgent")||"",lt=r,ct=st,ut=lt.process,pt=lt.Deno,ft=ut&&ut.versions||pt&&pt.version,dt=ft&&ft.v8;dt&&($=(G=dt.split("."))[0]>0&&G[0]<4?1:+(G[0]+G[1])),!$&&ct&&(!(G=ct.match(/Edge\/(\d+)/))||G[1]>=74)&&(G=ct.match(/Chrome\/(\d+)/))&&($=+G[1]);var ht=$,mt=ht,yt=h,gt=!!Object.getOwnPropertySymbols&&!yt((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&mt&&mt<41})),vt=gt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,bt=r,xt=D.exports,_t=Q,wt=nt,Et=gt,St=vt,At=xt("wks"),Rt=bt.Symbol,kt=Rt&&Rt.for,Ot=St?Rt:Rt&&Rt.withoutSetter||wt,Tt=function(t){if(!_t(At,t)||!Et&&"string"!=typeof At[t]){var e="Symbol."+t;Et&&_t(Rt,t)?At[t]=Rt[t]:At[t]=St&&kt?kt(e):Ot(e)}return At[t]},Ct=a,Ut=String,Pt=TypeError,It=function(t){if(Ct(t))return t;throw Pt(Ut(t)+" is not an object")},jt={},Lt=!h((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),Dt=Lt&&h((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Ht={},Ft=u,Nt=!Lt&&!h((function(){return 7!=Object.defineProperty(Ft("div"),"a",{get:function(){return 7}}).a})),Mt=m,zt=Function.prototype.call,Bt=Mt?zt.bind(zt):function(){return zt.apply(zt,arguments)},qt=_({}.isPrototypeOf),Gt=at,$t=o,Kt=qt,Xt=Object,Wt=vt?function(t){return"symbol"==typeof t}:function(t){var e=Gt("Symbol");return $t(e)&&Kt(e.prototype,Xt(t))},Vt=String,Yt=function(t){try{return Vt(t)}catch(t){return"Object"}},Qt=o,Zt=Yt,Jt=TypeError,te=function(t){if(Qt(t))return t;throw Jt(Zt(t)+" is not a function")},ee=te,ne=function(t,e){var n=t[e];return null==n?void 0:ee(n)},re=Bt,oe=o,ie=a,ae=TypeError,se=Bt,le=a,ce=Wt,ue=ne,pe=function(t,e){var n,r;if("string"===e&&oe(n=t.toString)&&!ie(r=re(n,t)))return r;if(oe(n=t.valueOf)&&!ie(r=re(n,t)))return r;if("string"!==e&&oe(n=t.toString)&&!ie(r=re(n,t)))return r;throw ae("Can't convert object to primitive value")},fe=TypeError,de=Tt("toPrimitive"),he=function(t,e){if(!le(t)||ce(t))return t;var n,r=ue(t,de);if(r){if(void 0===e&&(e="default"),n=se(r,t,e),!le(n)||ce(n))return n;throw fe("Can't convert object to primitive value")}return void 0===e&&(e="number"),pe(t,e)},me=he,ye=Wt,ge=function(t){var e=me(t,"string");return ye(e)?e:e+""},ve=Lt,be=Nt,xe=Dt,_e=It,we=ge,Ee=TypeError,Se=Object.defineProperty,Ae=Object.getOwnPropertyDescriptor,Re="enumerable",ke="configurable",Oe="writable";Ht.f=ve?xe?function(t,e,n){if(_e(t),e=we(e),_e(n),"function"==typeof t&&"prototype"===e&&"value"in n&&Oe in n&&!n.writable){var r=Ae(t,e);r&&r.writable&&(t[e]=n.value,n={configurable:ke in n?n.configurable:r.configurable,enumerable:Re in n?n.enumerable:r.enumerable,writable:!1})}return Se(t,e,n)}:Se:function(t,e,n){if(_e(t),e=we(e),_e(n),be)try{return Se(t,e,n)}catch(t){}if("get"in n||"set"in n)throw Ee("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var Te=Math.ceil,Ce=Math.floor,Ue=Math.trunc||function(t){var e=+t;return(e>0?Ce:Te)(e)},Pe=function(t){var e=+t;return e!=e||0===e?0:Ue(e)},Ie=Pe,je=Math.max,Le=Math.min,De=function(t,e){var n=Ie(t);return n<0?je(n+e,0):Le(n,e)},He=Pe,Fe=Math.min,Ne=function(t){return t>0?Fe(He(t),9007199254740991):0},Me=Ne,ze=function(t){return Me(t.length)},Be=L,qe=De,Ge=ze,$e=function(t){return function(e,n,r){var o,i=Be(e),a=Ge(i),s=qe(r,a);if(t&&n!=n){for(;a>s;)if((o=i[s++])!=o)return!0}else for(;a>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},Ke={includes:$e(!0),indexOf:$e(!1)},Xe={},We=Q,Ve=L,Ye=Ke.indexOf,Qe=Xe,Ze=_([].push),Je=function(t,e){var n,r=Ve(t),o=0,i=[];for(n in r)!We(Qe,n)&&We(r,n)&&Ze(i,n);for(;e.length>o;)We(r,n=e[o++])&&(~Ye(i,n)||Ze(i,n));return i},tn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],en=Je,nn=tn,rn=Object.keys||function(t){return en(t,nn)},on=Lt,an=Dt,sn=Ht,ln=It,cn=L,un=rn;jt.f=on&&!an?Object.defineProperties:function(t,e){ln(t);for(var n,r=cn(e),o=un(e),i=o.length,a=0;i>a;)sn.f(t,n=o[a++],r[n]);return t};var pn,fn=at("document","documentElement"),dn=D.exports,hn=nt,mn=dn("keys"),yn=function(t){return mn[t]||(mn[t]=hn(t))},gn=It,vn=jt,bn=tn,xn=Xe,_n=fn,wn=u,En=yn("IE_PROTO"),Sn=function(){},An=function(t){return"<script>"+t+"</"+"script>"},Rn=function(t){t.write(An("")),t.close();var e=t.parentWindow.Object;return t=null,e},kn=function(){try{pn=new ActiveXObject("htmlfile")}catch(t){}var t,e;kn="undefined"!=typeof document?document.domain&&pn?Rn(pn):((e=wn("iframe")).style.display="none",_n.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(An("document.F=Object")),t.close(),t.F):Rn(pn);for(var n=bn.length;n--;)delete kn.prototype[bn[n]];return kn()};xn[En]=!0;var On=Object.create||function(t,e){var n;return null!==t?(Sn.prototype=gn(t),n=new Sn,Sn.prototype=null,n[En]=t):n=kn(),void 0===e?n:vn.f(n,e)},Tn=Tt,Cn=On,Un=Ht.f,Pn=Tn("unscopables"),In=Array.prototype;null==In[Pn]&&Un(In,Pn,{configurable:!0,value:Cn(null)});var jn=function(t){In[Pn][t]=!0},Ln={},Dn=o,Hn=B,Fn=_(Function.toString);Dn(Hn.inspectSource)||(Hn.inspectSource=function(t){return Fn(t)});var Nn,Mn,zn,Bn=Hn.inspectSource,qn=o,Gn=Bn,$n=r.WeakMap,Kn=qn($n)&&/native code/.test(Gn($n)),Xn=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},Wn=Ht,Vn=Xn,Yn=Lt?function(t,e,n){return Wn.f(t,e,Vn(1,n))}:function(t,e,n){return t[e]=n,t},Qn=Kn,Zn=r,Jn=_,tr=a,er=Yn,nr=Q,rr=B,or=yn,ir=Xe,ar="Object already initialized",sr=Zn.TypeError,lr=Zn.WeakMap;if(Qn||rr.state){var cr=rr.state||(rr.state=new lr),ur=Jn(cr.get),pr=Jn(cr.has),fr=Jn(cr.set);Nn=function(t,e){if(pr(cr,t))throw new sr(ar);return e.facade=t,fr(cr,t,e),e},Mn=function(t){return ur(cr,t)||{}},zn=function(t){return pr(cr,t)}}else{var dr=or("state");ir[dr]=!0,Nn=function(t,e){if(nr(t,dr))throw new sr(ar);return e.facade=t,er(t,dr,e),e},Mn=function(t){return nr(t,dr)?t[dr]:{}},zn=function(t){return nr(t,dr)}}var hr={set:Nn,get:Mn,has:zn,enforce:function(t){return zn(t)?Mn(t):Nn(t,{})},getterFor:function(t){return function(e){var n;if(!tr(e)||(n=Mn(e)).type!==t)throw sr("Incompatible receiver, "+t+" required");return n}}},mr={},yr={},gr={}.propertyIsEnumerable,vr=Object.getOwnPropertyDescriptor,br=vr&&!gr.call({1:2},1);yr.f=br?function(t){var e=vr(this,t);return!!e&&e.enumerable}:gr;var xr=Lt,_r=Bt,wr=yr,Er=Xn,Sr=L,Ar=ge,Rr=Q,kr=Nt,Or=Object.getOwnPropertyDescriptor;mr.f=xr?Or:function(t,e){if(t=Sr(t),e=Ar(e),kr)try{return Or(t,e)}catch(t){}if(Rr(t,e))return Er(!_r(wr.f,t,e),t[e])};var Tr={exports:{}},Cr=Lt,Ur=Q,Pr=Function.prototype,Ir=Cr&&Object.getOwnPropertyDescriptor,jr=Ur(Pr,"name"),Lr={EXISTS:jr,PROPER:jr&&"something"===function(){}.name,CONFIGURABLE:jr&&(!Cr||Cr&&Ir(Pr,"name").configurable)},Dr=h,Hr=o,Fr=Q,Nr=Lt,Mr=Lr.CONFIGURABLE,zr=Bn,Br=hr.enforce,qr=hr.get,Gr=Object.defineProperty,$r=Nr&&!Dr((function(){return 8!==Gr((function(){}),"length",{value:8}).length})),Kr=String(String).split("String"),Xr=Tr.exports=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Fr(t,"name")||Mr&&t.name!==e)&&(Nr?Gr(t,"name",{value:e,configurable:!0}):t.name=e),$r&&n&&Fr(n,"arity")&&t.length!==n.arity&&Gr(t,"length",{value:n.arity});try{n&&Fr(n,"constructor")&&n.constructor?Nr&&Gr(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=Br(t);return Fr(r,"source")||(r.source=Kr.join("string"==typeof e?e:"")),t};Function.prototype.toString=Xr((function(){return Hr(this)&&qr(this).source||zr(this)}),"toString");var Wr=o,Vr=Ht,Yr=Tr.exports,Qr=N,Zr=function(t,e,n,r){r||(r={});var o=r.enumerable,i=void 0!==r.name?r.name:e;if(Wr(n)&&Yr(n,i,r),r.global)o?t[e]=n:Qr(e,n);else{try{r.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=n:Vr.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},Jr={},to=Je,eo=tn.concat("length","prototype");Jr.f=Object.getOwnPropertyNames||function(t){return to(t,eo)};var no={};no.f=Object.getOwnPropertySymbols;var ro,oo,io,ao=at,so=Jr,lo=no,co=It,uo=_([].concat),po=ao("Reflect","ownKeys")||function(t){var e=so.f(co(t)),n=lo.f;return n?uo(e,n(t)):e},fo=Q,ho=po,mo=mr,yo=Ht,go=h,vo=o,bo=/#|\.prototype\./,xo=function(t,e){var n=wo[_o(t)];return n==So||n!=Eo&&(vo(e)?go(e):!!e)},_o=xo.normalize=function(t){return String(t).replace(bo,".").toLowerCase()},wo=xo.data={},Eo=xo.NATIVE="N",So=xo.POLYFILL="P",Ao=xo,Ro=r,ko=mr.f,Oo=Yn,To=Zr,Co=N,Uo=function(t,e,n){for(var r=ho(e),o=yo.f,i=mo.f,a=0;a<r.length;a++){var s=r[a];fo(t,s)||n&&fo(n,s)||o(t,s,i(e,s))}},Po=Ao,Io=function(t,e){var n,r,o,i,a,s=t.target,l=t.global,c=t.stat;if(n=l?Ro:c?Ro[s]||Co(s,{}):(Ro[s]||{}).prototype)for(r in e){if(i=e[r],o=t.dontCallGetSet?(a=ko(n,r))&&a.value:n[r],!Po(l?r:s+(c?".":"#")+r,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Uo(i,o)}(t.sham||o&&o.sham)&&Oo(i,"sham",!0),To(n,r,i,t)}},jo=!h((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),Lo=Q,Do=o,Ho=W,Fo=jo,No=yn("IE_PROTO"),Mo=Object,zo=Mo.prototype,Bo=Fo?Mo.getPrototypeOf:function(t){var e=Ho(t);if(Lo(e,No))return e[No];var n=e.constructor;return Do(n)&&e instanceof n?n.prototype:e instanceof Mo?zo:null},qo=h,Go=o,$o=Bo,Ko=Zr,Xo=Tt("iterator"),Wo=!1;[].keys&&("next"in(io=[].keys())?(oo=$o($o(io)))!==Object.prototype&&(ro=oo):Wo=!0);var Vo=null==ro||qo((function(){var t={};return ro[Xo].call(t)!==t}));Vo&&(ro={}),Go(ro[Xo])||Ko(ro,Xo,(function(){return this}));var Yo={IteratorPrototype:ro,BUGGY_SAFARI_ITERATORS:Wo},Qo=Ht.f,Zo=Q,Jo=Tt("toStringTag"),ti=function(t,e,n){t&&!n&&(t=t.prototype),t&&!Zo(t,Jo)&&Qo(t,Jo,{configurable:!0,value:e})},ei=Yo.IteratorPrototype,ni=On,ri=Xn,oi=ti,ii=Ln,ai=function(){return this},si=o,li=String,ci=TypeError,ui=_,pi=It,fi=function(t){if("object"==typeof t||si(t))return t;throw ci("Can't set "+li(t)+" as a prototype")},di=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=ui(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return pi(n),fi(r),e?t(n,r):n.__proto__=r,n}}():void 0),hi=Io,mi=Bt,yi=o,gi=function(t,e,n,r){var o=e+" Iterator";return t.prototype=ni(ei,{next:ri(+!r,n)}),oi(t,o,!1),ii[o]=ai,t},vi=Bo,bi=di,xi=ti,_i=Yn,wi=Zr,Ei=Ln,Si=Lr.PROPER,Ai=Lr.CONFIGURABLE,Ri=Yo.IteratorPrototype,ki=Yo.BUGGY_SAFARI_ITERATORS,Oi=Tt("iterator"),Ti="keys",Ci="values",Ui="entries",Pi=function(){return this},Ii=L,ji=jn,Li=Ln,Di=hr,Hi=Ht.f,Fi=function(t,e,n,r,o,i,a){gi(n,e,r);var s,l,c,u=function(t){if(t===o&&m)return m;if(!ki&&t in d)return d[t];switch(t){case Ti:case Ci:case Ui:return function(){return new n(this,t)}}return function(){return new n(this)}},p=e+" Iterator",f=!1,d=t.prototype,h=d[Oi]||d["@@iterator"]||o&&d[o],m=!ki&&h||u(o),y="Array"==e&&d.entries||h;if(y&&(s=vi(y.call(new t)))!==Object.prototype&&s.next&&(vi(s)!==Ri&&(bi?bi(s,Ri):yi(s[Oi])||wi(s,Oi,Pi)),xi(s,p,!0)),Si&&o==Ci&&h&&h.name!==Ci&&(Ai?_i(d,"name",Ci):(f=!0,m=function(){return mi(h,this)})),o)if(l={values:u(Ci),keys:i?m:u(Ti),entries:u(Ui)},a)for(c in l)(ki||f||!(c in d))&&wi(d,c,l[c]);else hi({target:e,proto:!0,forced:ki||f},l);return d[Oi]!==m&&wi(d,Oi,m,{name:o}),Ei[e]=m,l},Ni=Lt,Mi="Array Iterator",zi=Di.set,Bi=Di.getterFor(Mi),qi=Fi(Array,"Array",(function(t,e){zi(this,{type:Mi,target:Ii(t),index:0,kind:e})}),(function(){var t=Bi(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values"),Gi=Li.Arguments=Li.Array;if(ji("keys"),ji("values"),ji("entries"),Ni&&"values"!==Gi.name)try{Hi(Gi,"name",{value:"values"})}catch(t){}var $i=r,Ki={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Xi=d,Wi=qi,Vi=Yn,Yi=Tt,Qi=Yi("iterator"),Zi=Yi("toStringTag"),Ji=Wi.values,ta=function(t,e){if(t){if(t[Qi]!==Ji)try{Vi(t,Qi,Ji)}catch(e){t[Qi]=Ji}if(t[Zi]||Vi(t,Zi,e),Ki[e])for(var n in Wi)if(t[n]!==Wi[n])try{Vi(t,n,Wi[n])}catch(e){t[n]=Wi[n]}}};for(var ea in Ki)ta($i[ea]&&$i[ea].prototype,ea);ta(Xi,"DOMTokenList");const na=t=>{const e=t.parentElement;return e?"FORM"===e.tagName?e:na(e):null};function ra(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const oa=(t,e)=>e?"".concat(e,"-").concat(t):t,ia=(t,e)=>e?t.slice(e.length+1):t,aa=(t,e,n)=>{const r=oa(e,n),o=t.querySelector('[name="'.concat(r,'"]'));return o||null},sa=(t,e)=>"".concat(ia(t,e),"-uploads"),la=(t,e,n)=>{var r;return null===(r=aa(t,e,n))||void 0===r?void 0:r.value};
/*!
	 * escape-html
	 * Copyright(c) 2012-2013 TJ Holowaychuk
	 * Copyright(c) 2015 Andreas Lubbe
	 * Copyright(c) 2015 Tiancheng "Timothy" Gu
	 * MIT Licensed
	 */
var ca=/["'&<>]/,ua=function(t){var e,n=""+t,r=ca.exec(n);if(!r)return n;var o="",i=0,a=0;for(i=r.index;i<n.length;i++){switch(n.charCodeAt(i)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#39;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}a!==i&&(o+=n.substring(a,i)),a=i+1,o+=e}return a!==i?o+n.substring(a,i):o};class pa{constructor(t){let{parent:e,input:n,skipRequired:r,translations:o}=t;ra(this,"container",void 0),ra(this,"input",void 0),ra(this,"translations",void 0),ra(this,"createFilesContainer",(t=>{const e=document.createElement("div");return e.className="dff-files",t.appendChild(e),e})),this.container=this.createFilesContainer(e),this.input=n,this.translations=o,r&&(this.input.required=!1)}addNewUpload(t,e){const n=this.addFile(t,e),r=document.createElement("span");r.className="dff-progress";const o=document.createElement("span");o.className="dff-progress-inner",r.appendChild(o),n.appendChild(r);const i=document.createElement("a");return i.className="dff-cancel",i.innerHTML=this.translations.Cancel,i.setAttribute("data-index","".concat(e)),i.href="#",n.appendChild(i),n}addUploadedFile(t,e,n){const r=this.addFile(t,e);return this.setSuccess(e,n),r}clearInput(){const{input:t}=this;t.value=""}deleteFile(t){const e=this.findFileDiv(t);e&&e.remove()}disableCancel(t){const e=this.findCancelSpan(t);e&&e.classList.add("dff-disabled")}disableDelete(t){const e=this.findDeleteLink(t);e&&e.classList.add("dff-disabled")}findFileDiv(t){return this.container.querySelector(".dff-file-id-".concat(t))}removeDropHint(){const t=this.container.querySelector(".dff-drop-hint");t&&t.remove()}renderDropHint(){if(this.container.querySelector(".dff-drop-hint"))return;const t=document.createElement("div");t.className="dff-drop-hint",t.innerHTML=this.translations["Drop your files here"],this.container.appendChild(t)}setDeleteFailed(t){this.setErrorMessage(t,this.translations["Delete failed"]),this.enableDelete(t)}setError(t){this.setErrorMessage(t,this.translations["Upload failed"]);const e=this.findFileDiv(t);e&&e.classList.add("dff-upload-fail"),this.removeProgress(t),this.removeCancel(t)}setSuccess(t,e){const{translations:n}=this,r=this.findFileDiv(t);if(r){if(r.classList.add("dff-upload-success"),null!=e){const t=document.createElement("span");t.innerHTML=((t,e)=>{if(0===t)return"0 Bytes";const n=e<=0?0:e||2,r=Math.floor(Math.log(t)/Math.log(1024)),o=parseFloat((t/1024**r).toFixed(n)),i=["Bytes","KB","MB","GB"][r];return"".concat(o," ").concat(i)})(e,2),t.className="dff-filesize",r.appendChild(t)}const o=document.createElement("a");o.innerHTML=n.Delete,o.className="dff-delete",o.setAttribute("data-index","".concat(t)),o.href="#",r.appendChild(o)}this.removeProgress(t),this.removeCancel(t)}updateProgress(t,e){const n=this.container.querySelector(".dff-file-id-".concat(t));if(n){const t=n.querySelector(".dff-progress-inner");t&&(t.style.width="".concat(e,"%"))}}addFile(t,e){const n=document.createElement("div");n.className="dff-file dff-file-id-".concat(e);const r=document.createElement("span");return r.innerHTML=ua(t),n.appendChild(r),this.container.appendChild(n),this.input.required=!1,n}removeProgress(t){const e=this.findFileDiv(t);if(e){const t=e.querySelector(".dff-progress");t&&t.remove()}}removeCancel(t){const e=this.findCancelSpan(t);e&&e.remove()}findCancelSpan(t){const e=this.findFileDiv(t);return e?e.querySelector(".dff-cancel"):null}enableDelete(t){const e=this.findDeleteLink(t);e&&e.classList.remove("dff-disabled")}findDeleteLink(t){const e=this.findFileDiv(t);return e?e.querySelector(".dff-delete"):e}setErrorMessage(t,e){const n=this.findFileDiv(t);if(!n)return;const r=n.querySelector(".dff-error");r&&r.remove();const o=document.createElement("span");o.classList.add("dff-error"),o.innerHTML=e,n.appendChild(o)}}var fa=m,da=Function.prototype,ha=da.apply,ma=da.call,ya="object"==typeof Reflect&&Reflect.apply||(fa?ma.bind(ha):function(){return ma.apply(ha,arguments)}),ga={};ga[Tt("toStringTag")]="z";var va,ba,xa="[object z]"===String(ga),_a=o,wa=A,Ea=Tt("toStringTag"),Sa=Object,Aa="Arguments"==wa(function(){return arguments}()),Ra=xa?wa:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Sa(t),Ea))?n:Aa?wa(e):"Object"==(r=wa(e))&&_a(e.callee)?"Arguments":r},ka=Ra,Oa=String,Ta=function(t){if("Symbol"===ka(t))throw TypeError("Cannot convert a Symbol value to a string");return Oa(t)},Ca=It,Ua=function(){var t=Ca(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},Pa=h,Ia=r.RegExp,ja=Pa((function(){var t=Ia("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),La=ja||Pa((function(){return!Ia("a","y").sticky})),Da={BROKEN_CARET:ja||Pa((function(){var t=Ia("^r","gy");return t.lastIndex=2,null!=t.exec("str")})),MISSED_STICKY:La,UNSUPPORTED_Y:ja},Ha=h,Fa=r.RegExp,Na=Ha((function(){var t=Fa(".","s");return!(t.dotAll&&t.exec("\n")&&"s"===t.flags)})),Ma=h,za=r.RegExp,Ba=Ma((function(){var t=za("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})),qa=Bt,Ga=_,$a=Ta,Ka=Ua,Xa=Da,Wa=D.exports,Va=On,Ya=hr.get,Qa=Na,Za=Ba,Ja=Wa("native-string-replace",String.prototype.replace),ts=RegExp.prototype.exec,es=ts,ns=Ga("".charAt),rs=Ga("".indexOf),os=Ga("".replace),is=Ga("".slice),as=(ba=/b*/g,qa(ts,va=/a/,"a"),qa(ts,ba,"a"),0!==va.lastIndex||0!==ba.lastIndex),ss=Xa.BROKEN_CARET,ls=void 0!==/()??/.exec("")[1];(as||ls||ss||Qa||Za)&&(es=function(t){var e,n,r,o,i,a,s,l=this,c=Ya(l),u=$a(t),p=c.raw;if(p)return p.lastIndex=l.lastIndex,e=qa(es,p,u),l.lastIndex=p.lastIndex,e;var f=c.groups,d=ss&&l.sticky,h=qa(Ka,l),m=l.source,y=0,g=u;if(d&&(h=os(h,"y",""),-1===rs(h,"g")&&(h+="g"),g=is(u,l.lastIndex),l.lastIndex>0&&(!l.multiline||l.multiline&&"\n"!==ns(u,l.lastIndex-1))&&(m="(?: "+m+")",g=" "+g,y++),n=new RegExp("^(?:"+m+")",h)),ls&&(n=new RegExp("^"+m+"$(?!\\s)",h)),as&&(r=l.lastIndex),o=qa(ts,d?n:l,g),d?o?(o.input=is(o.input,y),o[0]=is(o[0],y),o.index=l.lastIndex,l.lastIndex+=o[0].length):l.lastIndex=0:as&&o&&(l.lastIndex=l.global?o.index+o[0].length:r),ls&&o&&o.length>1&&qa(Ja,o[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o&&f)for(o.groups=a=Va(null),i=0;i<f.length;i++)a[(s=f[i])[0]]=o[s[1]];return o});var cs=es;Io({target:"RegExp",proto:!0,forced:/./.exec!==cs},{exec:cs});var us=_,ps=Zr,fs=cs,ds=h,hs=Tt,ms=Yn,ys=hs("species"),gs=RegExp.prototype,vs=_,bs=Pe,xs=Ta,_s=P,ws=vs("".charAt),Es=vs("".charCodeAt),Ss=vs("".slice),As=function(t){return function(e,n){var r,o,i=xs(_s(e)),a=bs(n),s=i.length;return a<0||a>=s?t?"":void 0:(r=Es(i,a))<55296||r>56319||a+1===s||(o=Es(i,a+1))<56320||o>57343?t?ws(i,a):r:t?Ss(i,a,a+2):o-56320+(r-55296<<10)+65536}},Rs={codeAt:As(!1),charAt:As(!0)}.charAt,ks=_,Os=W,Ts=Math.floor,Cs=ks("".charAt),Us=ks("".replace),Ps=ks("".slice),Is=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,js=/\$([$&'`]|\d{1,2})/g,Ls=Bt,Ds=It,Hs=o,Fs=A,Ns=cs,Ms=TypeError,zs=ya,Bs=Bt,qs=_,Gs=function(t,e,n,r){var o=hs(t),i=!ds((function(){var e={};return e[o]=function(){return 7},7!=""[t](e)})),a=i&&!ds((function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[ys]=function(){return n},n.flags="",n[o]=/./[o]),n.exec=function(){return e=!0,null},n[o](""),!e}));if(!i||!a||n){var s=us(/./[o]),l=e(o,""[t],(function(t,e,n,r,o){var a=us(t),l=e.exec;return l===fs||l===gs.exec?i&&!o?{done:!0,value:s(e,n,r)}:{done:!0,value:a(n,e,r)}:{done:!1}}));ps(String.prototype,t,l[0]),ps(gs,o,l[1])}r&&ms(gs[o],"sham",!0)},$s=h,Ks=It,Xs=o,Ws=Pe,Vs=Ne,Ys=Ta,Qs=P,Zs=function(t,e,n){return e+(n?Rs(t,e).length:1)},Js=ne,tl=function(t,e,n,r,o,i){var a=n+t.length,s=r.length,l=js;return void 0!==o&&(o=Os(o),l=Is),Us(i,l,(function(i,l){var c;switch(Cs(l,0)){case"$":return"$";case"&":return t;case"`":return Ps(e,0,n);case"'":return Ps(e,a);case"<":c=o[Ps(l,1,-1)];break;default:var u=+l;if(0===u)return i;if(u>s){var p=Ts(u/10);return 0===p?i:p<=s?void 0===r[p-1]?Cs(l,1):r[p-1]+Cs(l,1):i}c=r[u-1]}return void 0===c?"":c}))},el=function(t,e){var n=t.exec;if(Hs(n)){var r=Ls(n,t,e);return null!==r&&Ds(r),r}if("RegExp"===Fs(t))return Ls(Ns,t,e);throw Ms("RegExp#exec called on incompatible receiver")},nl=Tt("replace"),rl=Math.max,ol=Math.min,il=qs([].concat),al=qs([].push),sl=qs("".indexOf),ll=qs("".slice),cl="$0"==="a".replace(/./,"$0"),ul=!!/./[nl]&&""===/./[nl]("a","$0");function pl(){this._types=Object.create(null),this._extensions=Object.create(null);for(let t=0;t<arguments.length;t++)this.define(arguments[t]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}Gs("replace",(function(t,e,n){var r=ul?"$":"$0";return[function(t,n){var r=Qs(this),o=null==t?void 0:Js(t,nl);return o?Bs(o,t,r,n):Bs(e,Ys(r),t,n)},function(t,o){var i=Ks(this),a=Ys(t);if("string"==typeof o&&-1===sl(o,r)&&-1===sl(o,"$<")){var s=n(e,i,a,o);if(s.done)return s.value}var l=Xs(o);l||(o=Ys(o));var c=i.global;if(c){var u=i.unicode;i.lastIndex=0}for(var p=[];;){var f=el(i,a);if(null===f)break;if(al(p,f),!c)break;""===Ys(f[0])&&(i.lastIndex=Zs(a,Vs(i.lastIndex),u))}for(var d,h="",m=0,y=0;y<p.length;y++){for(var g=Ys((f=p[y])[0]),v=rl(ol(Ws(f.index),a.length),0),b=[],x=1;x<f.length;x++)al(b,void 0===(d=f[x])?d:String(d));var _=f.groups;if(l){var w=il([g],b,v,a);void 0!==_&&al(w,_);var E=Ys(zs(o,void 0,w))}else E=tl(g,a,v,b,_,o);v>=m&&(h+=ll(a,m,v)+E,m=v+g.length)}return h+ll(a,m)}]}),!!$s((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}))||!cl||ul),pl.prototype.define=function(t,e){for(let n in t){let r=t[n].map((function(t){return t.toLowerCase()}));n=n.toLowerCase();for(let t=0;t<r.length;t++){const o=r[t];if("*"!==o[0]){if(!e&&o in this._types)throw new Error('Attempt to change mapping for "'+o+'" extension from "'+this._types[o]+'" to "'+n+'". Pass `force=true` to allow this, otherwise remove "'+o+'" from the list of extensions for "'+n+'".');this._types[o]=n}}if(e||!this._extensions[n]){const t=r[0];this._extensions[n]="*"!==t[0]?t:t.substr(1)}}},pl.prototype.getType=function(t){let e=(t=String(t)).replace(/^.*[/\\]/,"").toLowerCase(),n=e.replace(/^.*\./,"").toLowerCase(),r=e.length<t.length;return(n.length<e.length-1||!r)&&this._types[n]||null},pl.prototype.getExtension=function(t){return(t=/^\s*([^;\s]*)/.test(t)&&RegExp.$1)&&this._extensions[t.toLowerCase()]||null};var fl=new pl({"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}),dl={exports:{}},hl=Tr.exports,ml=Ht,yl=Lt,gl=function(t,e,n){return n.get&&hl(n.get,e,{getter:!0}),n.set&&hl(n.set,e,{setter:!0}),ml.f(t,e,n)},vl=Ua,bl=h,xl=r.RegExp,_l=xl.prototype,wl=yl&&bl((function(){var t=!0;try{xl(".","d")}catch(e){t=!1}var e={},n="",r=t?"dgimsy":"gimsy",o=function(t,r){Object.defineProperty(e,t,{get:function(){return n+=r,!0}})},i={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var a in t&&(i.hasIndices="d"),i)o(a,i[a]);return Object.getOwnPropertyDescriptor(_l,"flags").get.call(e)!==r||n!==r}));wl&&gl(_l,"flags",{configurable:!0,get:vl});var El={basename:t=>{var e,n=0,r=-1,o=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!o){n=e+1;break}}else-1===r&&(o=!1,r=e+1);return-1===r?"":t.slice(n,r)}},Sl={};const Al="\\\\/",Rl="[^".concat(Al,"]"),kl="\\.",Ol="\\/",Tl="[^/]",Cl="(?:".concat(Ol,"|$)"),Ul="(?:^|".concat(Ol,")"),Pl="".concat(kl,"{1,2}").concat(Cl),Il={DOT_LITERAL:kl,PLUS_LITERAL:"\\+",QMARK_LITERAL:"\\?",SLASH_LITERAL:Ol,ONE_CHAR:"(?=.)",QMARK:Tl,END_ANCHOR:Cl,DOTS_SLASH:Pl,NO_DOT:"(?!".concat(kl,")"),NO_DOTS:"(?!".concat(Ul).concat(Pl,")"),NO_DOT_SLASH:"(?!".concat(kl,"{0,1}").concat(Cl,")"),NO_DOTS_SLASH:"(?!".concat(Pl,")"),QMARK_NO_DOT:"[^.".concat(Ol,"]"),STAR:"".concat(Tl,"*?"),START_ANCHOR:Ul},jl={...Il,SLASH_LITERAL:"[".concat(Al,"]"),QMARK:Rl,STAR:"".concat(Rl,"*?"),DOTS_SLASH:"".concat(kl,"{1,2}(?:[").concat(Al,"]|$)"),NO_DOT:"(?!".concat(kl,")"),NO_DOTS:"(?!(?:^|[".concat(Al,"])").concat(kl,"{1,2}(?:[").concat(Al,"]|$))"),NO_DOT_SLASH:"(?!".concat(kl,"{0,1}(?:[").concat(Al,"]|$))"),NO_DOTS_SLASH:"(?!".concat(kl,"{1,2}(?:[").concat(Al,"]|$))"),QMARK_NO_DOT:"[^.".concat(Al,"]"),START_ANCHOR:"(?:^|[".concat(Al,"])"),END_ANCHOR:"(?:[".concat(Al,"]|$)")};var Ll={MAX_LENGTH:65536,POSIX_REGEX_SOURCE:{alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"},REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:"/",extglobChars:t=>({"!":{type:"negate",open:"(?:(?!(?:",close:"))".concat(t.STAR,")")},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}),globChars(){return!0===(arguments.length>0&&void 0!==arguments[0]&&arguments[0])?jl:Il}};!function(t){const{REGEX_BACKSLASH:e,REGEX_REMOVE_BACKSLASH:n,REGEX_SPECIAL_CHARS:r,REGEX_SPECIAL_CHARS_GLOBAL:o}=Ll;t.isObject=t=>null!==t&&"object"==typeof t&&!Array.isArray(t),t.hasRegexChars=t=>r.test(t),t.isRegexChar=e=>1===e.length&&t.hasRegexChars(e),t.escapeRegex=t=>t.replace(o,"\\$1"),t.toPosixSlashes=t=>t.replace(e,"/"),t.removeBackslashes=t=>t.replace(n,(t=>"\\"===t?"":t)),t.isWindows=t=>!(!t||"boolean"!=typeof t.windows)&&t.windows,t.escapeLast=(e,n,r)=>{const o=e.lastIndexOf(n,r);return-1===o?e:"\\"===e[o-1]?t.escapeLast(e,n,o-1):"".concat(e.slice(0,o),"\\").concat(e.slice(o))},t.removePrefix=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t;return n.startsWith("./")&&(n=n.slice(2),e.prefix="./"),n},t.wrapOutput=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=n.contains?"":"^",o=n.contains?"":"$";let i="".concat(r,"(?:").concat(t,")").concat(o);return!0===e.negated&&(i="(?:^(?!".concat(i,").*$)")),i}}(Sl);const Dl=Sl,{CHAR_ASTERISK:Hl,CHAR_AT:Fl,CHAR_BACKWARD_SLASH:Nl,CHAR_COMMA:Ml,CHAR_DOT:zl,CHAR_EXCLAMATION_MARK:Bl,CHAR_FORWARD_SLASH:ql,CHAR_LEFT_CURLY_BRACE:Gl,CHAR_LEFT_PARENTHESES:$l,CHAR_LEFT_SQUARE_BRACKET:Kl,CHAR_PLUS:Xl,CHAR_QUESTION_MARK:Wl,CHAR_RIGHT_CURLY_BRACE:Vl,CHAR_RIGHT_PARENTHESES:Yl,CHAR_RIGHT_SQUARE_BRACKET:Ql}=Ll,Zl=t=>t===ql||t===Nl,Jl=t=>{!0!==t.isPrefix&&(t.depth=t.isGlobstar?1/0:1)};var tc=(t,e)=>{const n=e||{},r=t.length-1,o=!0===n.parts||!0===n.scanToEnd,i=[],a=[],s=[];let l,c,u=t,p=-1,f=0,d=0,h=!1,m=!1,y=!1,g=!1,v=!1,b=!1,x=!1,_=!1,w=!1,E=!1,S=0,A={value:"",depth:0,isGlob:!1};const R=()=>p>=r,k=()=>(l=c,u.charCodeAt(++p));for(;p<r;){let t;if(c=k(),c!==Nl){if(!0===b||c===Gl){for(S++;!0!==R()&&(c=k());)if(c!==Nl)if(c!==Gl){if(!0!==b&&c===zl&&(c=k())===zl){if(h=A.isBrace=!0,y=A.isGlob=!0,E=!0,!0===o)continue;break}if(!0!==b&&c===Ml){if(h=A.isBrace=!0,y=A.isGlob=!0,E=!0,!0===o)continue;break}if(c===Vl&&(S--,0===S)){b=!1,h=A.isBrace=!0,E=!0;break}}else S++;else x=A.backslashes=!0,k();if(!0===o)continue;break}if(c!==ql){if(!0!==n.noext){if(!0===(c===Xl||c===Fl||c===Hl||c===Wl||c===Bl)&&u.charCodeAt(p+1)===$l){if(y=A.isGlob=!0,g=A.isExtglob=!0,E=!0,c===Bl&&p===f&&(w=!0),!0===o){for(;!0!==R()&&(c=k());)if(c!==Nl){if(c===Yl){y=A.isGlob=!0,E=!0;break}}else x=A.backslashes=!0,c=k();continue}break}}if(c===Hl){if(l===Hl&&(v=A.isGlobstar=!0),y=A.isGlob=!0,E=!0,!0===o)continue;break}if(c===Wl){if(y=A.isGlob=!0,E=!0,!0===o)continue;break}if(c===Kl){for(;!0!==R()&&(t=k());)if(t!==Nl){if(t===Ql){m=A.isBracket=!0,y=A.isGlob=!0,E=!0;break}}else x=A.backslashes=!0,k();if(!0===o)continue;break}if(!0===n.nonegate||c!==Bl||p!==f){if(!0!==n.noparen&&c===$l){if(y=A.isGlob=!0,!0===o){for(;!0!==R()&&(c=k());)if(c!==$l){if(c===Yl){E=!0;break}}else x=A.backslashes=!0,c=k();continue}break}if(!0===y){if(E=!0,!0===o)continue;break}}else _=A.negated=!0,f++}else{if(i.push(p),a.push(A),A={value:"",depth:0,isGlob:!1},!0===E)continue;if(l===zl&&p===f+1){f+=2;continue}d=p+1}}else x=A.backslashes=!0,c=k(),c===Gl&&(b=!0)}!0===n.noext&&(g=!1,y=!1);let O=u,T="",C="";f>0&&(T=u.slice(0,f),u=u.slice(f),d-=f),O&&!0===y&&d>0?(O=u.slice(0,d),C=u.slice(d)):!0===y?(O="",C=u):O=u,O&&""!==O&&"/"!==O&&O!==u&&Zl(O.charCodeAt(O.length-1))&&(O=O.slice(0,-1)),!0===n.unescape&&(C&&(C=Dl.removeBackslashes(C)),O&&!0===x&&(O=Dl.removeBackslashes(O)));const U={prefix:T,input:t,start:f,base:O,glob:C,isBrace:h,isBracket:m,isGlob:y,isExtglob:g,isGlobstar:v,negated:_,negatedExtglob:w};if(!0===n.tokens&&(U.maxDepth=0,Zl(c)||a.push(A),U.tokens=a),!0===n.parts||!0===n.tokens){let e;for(let r=0;r<i.length;r++){const o=e?e+1:f,l=i[r],c=t.slice(o,l);n.tokens&&(0===r&&0!==f?(a[r].isPrefix=!0,a[r].value=T):a[r].value=c,Jl(a[r]),U.maxDepth+=a[r].depth),0===r&&""===c||s.push(c),e=l}if(e&&e+1<t.length){const r=t.slice(e+1);s.push(r),n.tokens&&(a[a.length-1].value=r,Jl(a[a.length-1]),U.maxDepth+=a[a.length-1].depth)}U.slashes=i,U.parts=s}return U},ec=Ke.includes,nc=jn;Io({target:"Array",proto:!0,forced:h((function(){return!Array(1).includes()}))},{includes:function(t){return ec(this,t,arguments.length>1?arguments[1]:void 0)}}),nc("includes");const rc=Ll,oc=Sl,{MAX_LENGTH:ic,POSIX_REGEX_SOURCE:ac,REGEX_NON_SPECIAL_CHARS:sc,REGEX_SPECIAL_CHARS_BACKREF:lc,REPLACEMENTS:cc}=rc,uc=(t,e)=>{if("function"==typeof e.expandRange)return e.expandRange(...t,e);t.sort();const n="[".concat(t.join("-"),"]");try{new RegExp(n)}catch(e){return t.map((t=>oc.escapeRegex(t))).join("..")}return n},pc=(t,e)=>"Missing ".concat(t,': "').concat(e,'" - use "\\\\').concat(e,'" to match literal characters'),fc=(t,e)=>{if("string"!=typeof t)throw new TypeError("Expected a string");t=cc[t]||t;const n={...e},r="number"==typeof n.maxLength?Math.min(ic,n.maxLength):ic;let o=t.length;if(o>r)throw new SyntaxError("Input length: ".concat(o,", exceeds maximum allowed length: ").concat(r));const i={type:"bos",value:"",output:n.prepend||""},a=[i],s=n.capture?"":"?:",l=rc.globChars(),c=rc.extglobChars(l),{DOT_LITERAL:u,PLUS_LITERAL:p,SLASH_LITERAL:f,ONE_CHAR:d,DOTS_SLASH:h,NO_DOT:m,NO_DOT_SLASH:y,NO_DOTS_SLASH:g,QMARK:v,QMARK_NO_DOT:b,STAR:x,START_ANCHOR:_}=l,w=t=>"(".concat(s,"(?:(?!").concat(_).concat(t.dot?h:u,").)*?)"),E=n.dot?"":m,S=n.dot?v:b;let A=!0===n.bash?w(n):x;n.capture&&(A="(".concat(A,")")),"boolean"==typeof n.noext&&(n.noextglob=n.noext);const R={input:t,index:-1,start:0,dot:!0===n.dot,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};t=oc.removePrefix(t,R),o=t.length;const k=[],O=[],T=[];let C,U=i;const P=()=>R.index===o-1,I=R.peek=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return t[R.index+e]},j=R.advance=()=>t[++R.index]||"",L=()=>t.slice(R.index+1),D=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;R.consumed+=t,R.index+=e},H=t=>{R.output+=null!=t.output?t.output:t.value,D(t.value)},F=()=>{let t=1;for(;"!"===I()&&("("!==I(2)||"?"===I(3));)j(),R.start++,t++;return t%2!=0&&(R.negated=!0,R.start++,!0)},N=t=>{R[t]++,T.push(t)},M=t=>{R[t]--,T.pop()},z=t=>{if("globstar"===U.type){const e=R.braces>0&&("comma"===t.type||"brace"===t.type),n=!0===t.extglob||k.length&&("pipe"===t.type||"paren"===t.type);"slash"===t.type||"paren"===t.type||e||n||(R.output=R.output.slice(0,-U.output.length),U.type="star",U.value="*",U.output=A,R.output+=U.output)}if(k.length&&"paren"!==t.type&&(k[k.length-1].inner+=t.value),(t.value||t.output)&&H(t),U&&"text"===U.type&&"text"===t.type)return U.value+=t.value,void(U.output=(U.output||"")+t.value);t.prev=U,a.push(t),U=t},B=(t,e)=>{const r={...c[e],conditions:1,inner:""};r.prev=U,r.parens=R.parens,r.output=R.output;const o=(n.capture?"(":"")+r.open;N("parens"),z({type:t,value:e,output:R.output?"":d}),z({type:"paren",extglob:!0,value:j(),output:o}),k.push(r)},q=t=>{let r,o=t.close+(n.capture?")":"");if("negate"===t.type){let i=A;if(t.inner&&t.inner.length>1&&t.inner.includes("/")&&(i=w(n)),(i!==A||P()||/^\)+$/.test(L()))&&(o=t.close=")$))".concat(i)),t.inner.includes("*")&&(r=L())&&/^\.[^\\/.]+$/.test(r)){const n=fc(r,{...e,fastpaths:!1}).output;o=t.close=")".concat(n,")").concat(i,")")}"bos"===t.prev.type&&(R.negatedExtglob=!0)}z({type:"paren",extglob:!0,value:C,output:o}),M("parens")};if(!1!==n.fastpaths&&!/(^[*!]|[/()[\]{}"])/.test(t)){let r=!1,o=t.replace(lc,((t,e,n,o,i,a)=>"\\"===o?(r=!0,t):"?"===o?e?e+o+(i?v.repeat(i.length):""):0===a?S+(i?v.repeat(i.length):""):v.repeat(n.length):"."===o?u.repeat(n.length):"*"===o?e?e+o+(i?A:""):A:e?t:"\\".concat(t)));return!0===r&&(o=!0===n.unescape?o.replace(/\\/g,""):o.replace(/\\+/g,(t=>t.length%2==0?"\\\\":t?"\\":""))),o===t&&!0===n.contains?(R.output=t,R):(R.output=oc.wrapOutput(o,R,e),R)}for(;!P();){if(C=j(),"\0"===C)continue;if("\\"===C){const t=I();if("/"===t&&!0!==n.bash)continue;if("."===t||";"===t)continue;if(!t){C+="\\",z({type:"text",value:C});continue}const e=/^\\+/.exec(L());let r=0;if(e&&e[0].length>2&&(r=e[0].length,R.index+=r,r%2!=0&&(C+="\\")),!0===n.unescape?C=j():C+=j(),0===R.brackets){z({type:"text",value:C});continue}}if(R.brackets>0&&("]"!==C||"["===U.value||"[^"===U.value)){if(!1!==n.posix&&":"===C){const t=U.value.slice(1);if(t.includes("[")&&(U.posix=!0,t.includes(":"))){const t=U.value.lastIndexOf("["),e=U.value.slice(0,t),n=U.value.slice(t+2),r=ac[n];if(r){U.value=e+r,R.backtrack=!0,j(),i.output||1!==a.indexOf(U)||(i.output=d);continue}}}("["===C&&":"!==I()||"-"===C&&"]"===I())&&(C="\\".concat(C)),"]"!==C||"["!==U.value&&"[^"!==U.value||(C="\\".concat(C)),!0===n.posix&&"!"===C&&"["===U.value&&(C="^"),U.value+=C,H({value:C});continue}if(1===R.quotes&&'"'!==C){C=oc.escapeRegex(C),U.value+=C,H({value:C});continue}if('"'===C){R.quotes=1===R.quotes?0:1,!0===n.keepQuotes&&z({type:"text",value:C});continue}if("("===C){N("parens"),z({type:"paren",value:C});continue}if(")"===C){if(0===R.parens&&!0===n.strictBrackets)throw new SyntaxError(pc("opening","("));const t=k[k.length-1];if(t&&R.parens===t.parens+1){q(k.pop());continue}z({type:"paren",value:C,output:R.parens?")":"\\)"}),M("parens");continue}if("["===C){if(!0!==n.nobracket&&L().includes("]"))N("brackets");else{if(!0!==n.nobracket&&!0===n.strictBrackets)throw new SyntaxError(pc("closing","]"));C="\\".concat(C)}z({type:"bracket",value:C});continue}if("]"===C){if(!0===n.nobracket||U&&"bracket"===U.type&&1===U.value.length){z({type:"text",value:C,output:"\\".concat(C)});continue}if(0===R.brackets){if(!0===n.strictBrackets)throw new SyntaxError(pc("opening","["));z({type:"text",value:C,output:"\\".concat(C)});continue}M("brackets");const t=U.value.slice(1);if(!0===U.posix||"^"!==t[0]||t.includes("/")||(C="/".concat(C)),U.value+=C,H({value:C}),!1===n.literalBrackets||oc.hasRegexChars(t))continue;const e=oc.escapeRegex(U.value);if(R.output=R.output.slice(0,-U.value.length),!0===n.literalBrackets){R.output+=e,U.value=e;continue}U.value="(".concat(s).concat(e,"|").concat(U.value,")"),R.output+=U.value;continue}if("{"===C&&!0!==n.nobrace){N("braces");const t={type:"brace",value:C,output:"(",outputIndex:R.output.length,tokensIndex:R.tokens.length};O.push(t),z(t);continue}if("}"===C){const t=O[O.length-1];if(!0===n.nobrace||!t){z({type:"text",value:C,output:C});continue}let e=")";if(!0===t.dots){const t=a.slice(),r=[];for(let e=t.length-1;e>=0&&(a.pop(),"brace"!==t[e].type);e--)"dots"!==t[e].type&&r.unshift(t[e].value);e=uc(r,n),R.backtrack=!0}if(!0!==t.comma&&!0!==t.dots){const n=R.output.slice(0,t.outputIndex),r=R.tokens.slice(t.tokensIndex);t.value=t.output="\\{",C=e="\\}",R.output=n;for(const t of r)R.output+=t.output||t.value}z({type:"brace",value:C,output:e}),M("braces"),O.pop();continue}if("|"===C){k.length>0&&k[k.length-1].conditions++,z({type:"text",value:C});continue}if(","===C){let t=C;const e=O[O.length-1];e&&"braces"===T[T.length-1]&&(e.comma=!0,t="|"),z({type:"comma",value:C,output:t});continue}if("/"===C){if("dot"===U.type&&R.index===R.start+1){R.start=R.index+1,R.consumed="",R.output="",a.pop(),U=i;continue}z({type:"slash",value:C,output:f});continue}if("."===C){if(R.braces>0&&"dot"===U.type){"."===U.value&&(U.output=u);const t=O[O.length-1];U.type="dots",U.output+=C,U.value+=C,t.dots=!0;continue}if(R.braces+R.parens===0&&"bos"!==U.type&&"slash"!==U.type){z({type:"text",value:C,output:u});continue}z({type:"dot",value:C,output:u});continue}if("?"===C){if(!(U&&"("===U.value)&&!0!==n.noextglob&&"("===I()&&"?"!==I(2)){B("qmark",C);continue}if(U&&"paren"===U.type){const t=I();let e=C;("("===U.value&&!/[!=<:]/.test(t)||"<"===t&&!/<([!=]|\w+>)/.test(L()))&&(e="\\".concat(C)),z({type:"text",value:C,output:e});continue}if(!0!==n.dot&&("slash"===U.type||"bos"===U.type)){z({type:"qmark",value:C,output:b});continue}z({type:"qmark",value:C,output:v});continue}if("!"===C){if(!0!==n.noextglob&&"("===I()&&("?"!==I(2)||!/[!=<:]/.test(I(3)))){B("negate",C);continue}if(!0!==n.nonegate&&0===R.index){F();continue}}if("+"===C){if(!0!==n.noextglob&&"("===I()&&"?"!==I(2)){B("plus",C);continue}if(U&&"("===U.value||!1===n.regex){z({type:"plus",value:C,output:p});continue}if(U&&("bracket"===U.type||"paren"===U.type||"brace"===U.type)||R.parens>0){z({type:"plus",value:C});continue}z({type:"plus",value:p});continue}if("@"===C){if(!0!==n.noextglob&&"("===I()&&"?"!==I(2)){z({type:"at",extglob:!0,value:C,output:""});continue}z({type:"text",value:C});continue}if("*"!==C){"$"!==C&&"^"!==C||(C="\\".concat(C));const t=sc.exec(L());t&&(C+=t[0],R.index+=t[0].length),z({type:"text",value:C});continue}if(U&&("globstar"===U.type||!0===U.star)){U.type="star",U.star=!0,U.value+=C,U.output=A,R.backtrack=!0,R.globstar=!0,D(C);continue}let e=L();if(!0!==n.noextglob&&/^\([^?]/.test(e)){B("star",C);continue}if("star"===U.type){if(!0===n.noglobstar){D(C);continue}const r=U.prev,o=r.prev,i="slash"===r.type||"bos"===r.type,a=o&&("star"===o.type||"globstar"===o.type);if(!0===n.bash&&(!i||e[0]&&"/"!==e[0])){z({type:"star",value:C,output:""});continue}const s=R.braces>0&&("comma"===r.type||"brace"===r.type),l=k.length&&("pipe"===r.type||"paren"===r.type);if(!i&&"paren"!==r.type&&!s&&!l){z({type:"star",value:C,output:""});continue}for(;"/**"===e.slice(0,3);){const n=t[R.index+4];if(n&&"/"!==n)break;e=e.slice(3),D("/**",3)}if("bos"===r.type&&P()){U.type="globstar",U.value+=C,U.output=w(n),R.output=U.output,R.globstar=!0,D(C);continue}if("slash"===r.type&&"bos"!==r.prev.type&&!a&&P()){R.output=R.output.slice(0,-(r.output+U.output).length),r.output="(?:".concat(r.output),U.type="globstar",U.output=w(n)+(n.strictSlashes?")":"|$)"),U.value+=C,R.globstar=!0,R.output+=r.output+U.output,D(C);continue}if("slash"===r.type&&"bos"!==r.prev.type&&"/"===e[0]){const t=void 0!==e[1]?"|$":"";R.output=R.output.slice(0,-(r.output+U.output).length),r.output="(?:".concat(r.output),U.type="globstar",U.output="".concat(w(n)).concat(f,"|").concat(f).concat(t,")"),U.value+=C,R.output+=r.output+U.output,R.globstar=!0,D(C+j()),z({type:"slash",value:"/",output:""});continue}if("bos"===r.type&&"/"===e[0]){U.type="globstar",U.value+=C,U.output="(?:^|".concat(f,"|").concat(w(n)).concat(f,")"),R.output=U.output,R.globstar=!0,D(C+j()),z({type:"slash",value:"/",output:""});continue}R.output=R.output.slice(0,-U.output.length),U.type="globstar",U.output=w(n),U.value+=C,R.output+=U.output,R.globstar=!0,D(C);continue}const r={type:"star",value:C,output:A};!0!==n.bash?!U||"bracket"!==U.type&&"paren"!==U.type||!0!==n.regex?(R.index!==R.start&&"slash"!==U.type&&"dot"!==U.type||("dot"===U.type?(R.output+=y,U.output+=y):!0===n.dot?(R.output+=g,U.output+=g):(R.output+=E,U.output+=E),"*"!==I()&&(R.output+=d,U.output+=d)),z(r)):(r.output=C,z(r)):(r.output=".*?","bos"!==U.type&&"slash"!==U.type||(r.output=E+r.output),z(r))}for(;R.brackets>0;){if(!0===n.strictBrackets)throw new SyntaxError(pc("closing","]"));R.output=oc.escapeLast(R.output,"["),M("brackets")}for(;R.parens>0;){if(!0===n.strictBrackets)throw new SyntaxError(pc("closing",")"));R.output=oc.escapeLast(R.output,"("),M("parens")}for(;R.braces>0;){if(!0===n.strictBrackets)throw new SyntaxError(pc("closing","}"));R.output=oc.escapeLast(R.output,"{"),M("braces")}if(!0===n.strictSlashes||"star"!==U.type&&"bracket"!==U.type||z({type:"maybe_slash",value:"",output:"".concat(f,"?")}),!0===R.backtrack){R.output="";for(const t of R.tokens)R.output+=null!=t.output?t.output:t.value,t.suffix&&(R.output+=t.suffix)}return R};fc.fastpaths=(t,e)=>{const n={...e},r="number"==typeof n.maxLength?Math.min(ic,n.maxLength):ic,o=t.length;if(o>r)throw new SyntaxError("Input length: ".concat(o,", exceeds maximum allowed length: ").concat(r));t=cc[t]||t;const{DOT_LITERAL:i,SLASH_LITERAL:a,ONE_CHAR:s,DOTS_SLASH:l,NO_DOT:c,NO_DOTS:u,NO_DOTS_SLASH:p,STAR:f,START_ANCHOR:d}=rc.globChars(),h=n.dot?u:c,m=n.dot?p:c,y=n.capture?"":"?:";let g=!0===n.bash?".*?":f;n.capture&&(g="(".concat(g,")"));const v=t=>!0===t.noglobstar?g:"(".concat(y,"(?:(?!").concat(d).concat(t.dot?l:i,").)*?)"),b=t=>{switch(t){case"*":return"".concat(h).concat(s).concat(g);case".*":return"".concat(i).concat(s).concat(g);case"*.*":return"".concat(h).concat(g).concat(i).concat(s).concat(g);case"*/*":return"".concat(h).concat(g).concat(a).concat(s).concat(m).concat(g);case"**":return h+v(n);case"**/*":return"(?:".concat(h).concat(v(n)).concat(a,")?").concat(m).concat(s).concat(g);case"**/*.*":return"(?:".concat(h).concat(v(n)).concat(a,")?").concat(m).concat(g).concat(i).concat(s).concat(g);case"**/.*":return"(?:".concat(h).concat(v(n)).concat(a,")?").concat(i).concat(s).concat(g);default:{const e=/^(.*?)\.(\w+)$/.exec(t);if(!e)return;const n=b(e[1]);if(!n)return;return n+i+e[2]}}},x=oc.removePrefix(t,{negated:!1,prefix:""});let _=b(x);return _&&!0!==n.strictSlashes&&(_+="".concat(a,"?")),_};const dc=El,hc=tc,mc=fc,yc=Sl,gc=Ll,vc=t=>t&&"object"==typeof t&&!Array.isArray(t),bc=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(t)){const r=t.map((t=>bc(t,e,n))),o=t=>{for(const e of r){const n=e(t);if(n)return n}return!1};return o}const r=vc(t)&&t.tokens&&t.input;if(""===t||"string"!=typeof t&&!r)throw new TypeError("Expected pattern to be a non-empty string");const o=e||{},i=yc.isWindows(e),a=r?bc.compileRe(t,e):bc.makeRe(t,e,!1,!0),s=a.state;delete a.state;let l=()=>!1;if(o.ignore){const t={...e,ignore:null,onMatch:null,onResult:null};l=bc(o.ignore,t,n)}const c=function(n){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{isMatch:c,match:u,output:p}=bc.test(n,a,e,{glob:t,posix:i}),f={glob:t,state:s,regex:a,posix:i,input:n,output:p,match:u,isMatch:c};return"function"==typeof o.onResult&&o.onResult(f),!1===c?(f.isMatch=!1,!!r&&f):l(n)?("function"==typeof o.onIgnore&&o.onIgnore(f),f.isMatch=!1,!!r&&f):("function"==typeof o.onMatch&&o.onMatch(f),!r||f)};return n&&(c.state=s),c};bc.test=function(t,e,n){let{glob:r,posix:o}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if("string"!=typeof t)throw new TypeError("Expected input to be a string");if(""===t)return{isMatch:!1,output:""};const i=n||{},a=i.format||(o?yc.toPosixSlashes:null);let s=t===r,l=s&&a?a(t):t;return!1===s&&(l=a?a(t):t,s=l===r),!1!==s&&!0!==i.capture||(s=!0===i.matchBase||!0===i.basename?bc.matchBase(t,e,n,o):e.exec(l)),{isMatch:Boolean(s),match:s,output:l}},bc.matchBase=function(t,e,n){arguments.length>3&&void 0!==arguments[3]||yc.isWindows(n);const r=e instanceof RegExp?e:bc.makeRe(e,n);return r.test(dc.basename(t))},bc.isMatch=(t,e,n)=>bc(e,n)(t),bc.parse=(t,e)=>Array.isArray(t)?t.map((t=>bc.parse(t,e))):mc(t,{...e,fastpaths:!1}),bc.scan=(t,e)=>hc(t,e),bc.compileRe=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!0===n)return t.output;const o=e||{},i=o.contains?"":"^",a=o.contains?"":"$";let s="".concat(i,"(?:").concat(t.output,")").concat(a);t&&!0===t.negated&&(s="^(?!".concat(s,").*$"));const l=bc.toRegex(s,e);return!0===r&&(l.state=t),l},bc.makeRe=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!t||"string"!=typeof t)throw new TypeError("Expected a non-empty string");let o={negated:!1,fastpaths:!0};return!1===e.fastpaths||"."!==t[0]&&"*"!==t[0]||(o.output=mc.fastpaths(t,e)),o.output||(o=mc(t,e)),bc.compileRe(o,e,n,r)},bc.toRegex=(t,e)=>{try{const n=e||{};return new RegExp(t,n.flags||(n.nocase?"i":""))}catch(t){if(e&&!0===e.debug)throw t;return/$^/}},bc.constants=gc,dl.exports=bc;var xc=e(dl.exports);class _c{constructor(t){ra(this,"extensions",void 0),ra(this,"mimeTypes",void 0);const[e,n]=(t=>{const e=[],n=[];return t.split(",").map((t=>t.trim())).filter(Boolean).forEach((t=>{t.startsWith(".")?e.push("*".concat(t)):n.push(t)})),[e,n]})(t);this.extensions=e,this.mimeTypes=n}isAccepted(t){return 0===this.extensions.length&&0===this.mimeTypes.length||(this.isMimeTypeAccepted(fl.getType(t))||this.isExtensionAccepted(t))}isMimeTypeAccepted(t){return 0!==this.mimeTypes.length&&xc.isMatch(t,this.mimeTypes)}isExtensionAccepted(t){return 0!==this.extensions.length&&xc.isMatch(t,this.extensions)}}const wc=async t=>new Promise(((e,n)=>t.createReader().readEntries(e,n))),Ec=async t=>new Promise(((e,n)=>t.file(e,n))),Sc=async t=>{const e=[];for await(const n of t)if(n.isFile){const t=await Ec(n);e.push(t)}else if(n.isDirectory){const t=await wc(n);(await Sc(t)).forEach((t=>e.push(t)))}return e};class Ac{constructor(t){let{container:e,inputAccept:n,onUploadFiles:r}=t;ra(this,"acceptedFileTypes",void 0),ra(this,"container",void 0),ra(this,"onUploadFiles",void 0),ra(this,"onDrop",(t=>{const e=t;this.container.classList.remove("dff-dropping"),e.preventDefault(),e.stopPropagation();(async()=>{try{if(e.dataTransfer){const t=(await(async t=>{if(t.items){const e=[...t.items].map((t=>t.webkitGetAsEntry()));return await Sc(e)}return[...t.files]})(e.dataTransfer)).filter((t=>this.acceptedFileTypes.isAccepted(t.name)));this.onUploadFiles(t)}}catch(t){console.error(t)}})()})),this.container=e,this.onUploadFiles=r,this.acceptedFileTypes=new _c(n),e.addEventListener("dragenter",(()=>{e.classList.add("dff-dropping")})),e.addEventListener("dragleave",(()=>{e.classList.remove("dff-dropping")})),e.addEventListener("dragover",(t=>{e.classList.add("dff-dropping"),t.preventDefault()})),e.addEventListener("drop",this.onDrop)}}class Rc{constructor(t){let{name:e,status:n,type:r,uploadIndex:o}=t;ra(this,"name",void 0),ra(this,"status",void 0),ra(this,"type",void 0),ra(this,"uploadIndex",void 0),this.name=e,this.status=n,this.type=r,this.uploadIndex=o}async abort(){}async delete(){}}function kc(t){var e=[];if(0===t.length)return"";if("string"!=typeof t[0])throw new TypeError("Url must be a string. Received "+t[0]);if(t[0].match(/^[^/:]+:\/*$/)&&t.length>1){var n=t.shift();t[0]=n+t[0]}t[0].match(/^file:\/\/\//)?t[0]=t[0].replace(/^([^/:]+):\/*/,"$1:///"):t[0]=t[0].replace(/^([^/:]+):\/*/,"$1://");for(var r=0;r<t.length;r++){var o=t[r];if("string"!=typeof o)throw new TypeError("Url must be a string. Received "+o);""!==o&&(r>0&&(o=o.replace(/^[\/]+/,"")),o=r<t.length-1?o.replace(/[\/]+$/,""):o.replace(/[\/]+$/,"/"),e.push(o))}var i=e.join("/"),a=(i=i.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return i=a.shift()+(a.length>0?"?":"")+a.join("&")}function Oc(){return kc("object"==typeof arguments[0]?arguments[0]:[].slice.call(arguments))}const Tc=(t,e)=>{const n=t.indexOf(e);-1!==n&&t.splice(n,1)};class Cc extends Rc{constructor(t){let{csrfToken:e,endpoint:n,file:r,s3UploadDir:o,uploadIndex:i}=t;super({name:r.name,status:"uploading",type:"s3",uploadIndex:i}),ra(this,"onError",void 0),ra(this,"onProgress",void 0),ra(this,"onSuccess",void 0),ra(this,"chunkState",void 0),ra(this,"chunks",void 0),ra(this,"createdPromise",void 0),ra(this,"csrfToken",void 0),ra(this,"endpoint",void 0),ra(this,"file",void 0),ra(this,"key",void 0),ra(this,"parts",void 0),ra(this,"s3UploadDir",void 0),ra(this,"uploadId",void 0),ra(this,"uploading",void 0),this.csrfToken=e,this.endpoint=n,this.file=r,this.s3UploadDir=o,this.key=null,this.uploadId=null,this.parts=[],this.createdPromise=Promise.reject(),this.chunks=[],this.chunkState=[],this.uploading=[],this.onError=void 0,this.onProgress=void 0,this.onSuccess=void 0,this.initChunks(),this.createdPromise.catch((()=>({})))}async abort(){this.uploading.slice().forEach((t=>{t.abort()})),this.uploading=[],await this.createdPromise,this.key&&this.uploadId&&await(t=>{let{csrfToken:e,key:n,uploadId:r,endpoint:o}=t;const i=encodeURIComponent(n),a=encodeURIComponent(r),s=new Headers({"X-CSRFToken":e}),l=Oc(o,a,"?key=".concat(i));return fetch(l,{method:"delete",headers:s}).then((t=>t.json()))})({csrfToken:this.csrfToken,endpoint:this.endpoint,key:this.key,uploadId:this.uploadId})}async delete(){return Promise.resolve()}getInitialFile(){return{id:this.uploadId||"",name:this.key||"",size:this.file.size,original_name:this.file.name,type:"s3"}}getSize(){return this.file.size}start(){this.createUpload()}initChunks(){const t=[],e=(n=this.file,Math.ceil(n.size/1e4));var n;const r=Math.max(5242880,Math.ceil(this.file.size/1e4)),o=Math.max(e,r);for(let e=0;e<this.file.size;e+=o){const n=Math.min(this.file.size,e+o);t.push(this.file.slice(e,n))}this.chunks=t,this.chunkState=t.map((()=>({uploaded:0,busy:!1,done:!1})))}createUpload(){return this.createdPromise=(t=>{let{csrfToken:e,endpoint:n,file:r,s3UploadDir:o}=t;const i=new Headers({accept:"application/json","content-type":"application/json","X-CSRFToken":e});return fetch(n,{method:"post",headers:i,body:JSON.stringify({filename:r.name,contentType:r.type,s3UploadDir:o})}).then((t=>t.json())).then((t=>t))})({csrfToken:this.csrfToken,endpoint:this.endpoint,file:this.file,s3UploadDir:this.s3UploadDir}),this.createdPromise.then((t=>{if(!("object"==typeof t&&t&&"string"==typeof t.uploadId&&"string"==typeof t.key))throw new TypeError("AwsS3/Multipart: Got incorrect result from `createMultipartUpload()`, expected an object `{ uploadId, key }`.");this.key=t.key,this.uploadId=t.uploadId,this.uploadParts()})).catch((t=>{this.handleError(t)}))}uploadParts(){const t=1-this.uploading.length;if(0===t)return;if(this.chunkState.every((t=>t.done)))return void this.completeUpload();const e=[];for(let n=0;n<this.chunkState.length;n++){const r=this.chunkState[n];if(!r.done&&!r.busy&&(e.push(n),e.length>=t))break}e.forEach((t=>{this.uploadPart(t)}))}uploadPart(t){return this.chunkState[t].busy=!0,this.key&&this.uploadId?(t=>{let{csrfToken:e,endpoint:n,key:r,number:o,uploadId:i}=t;const a=encodeURIComponent(r),s=new Headers({"X-CSRFToken":e}),l=Oc(n,i,"".concat(o),"?key=".concat(a));return fetch(l,{method:"get",headers:s}).then((t=>t.json())).then((t=>t))})({csrfToken:this.csrfToken,endpoint:this.endpoint,key:this.key,number:t+1,uploadId:this.uploadId}).then((t=>{if(!("object"==typeof t&&t&&"string"==typeof t.url))throw new TypeError("AwsS3/Multipart: Got incorrect result from `prepareUploadPart()`, expected an object `{ url }`.");return t})).then((e=>{let{url:n}=e;this.uploadPartBytes(t,n)}),(t=>{this.handleError(t)})):Promise.resolve()}onPartProgress(t,e){if(this.chunkState[t].uploaded=e,this.onProgress){const t=this.chunkState.reduce(((t,e)=>t+e.uploaded),0);this.onProgress(t,this.file.size)}}onPartComplete(t,e){this.chunkState[t].etag=e,this.chunkState[t].done=!0;const n={PartNumber:t+1,ETag:e};this.parts.push(n),this.uploadParts()}uploadPartBytes(t,e){const n=this.chunks[t],r=new XMLHttpRequest;r.open("PUT",e,!0),r.responseType="text",this.uploading.push(r),r.upload.addEventListener("progress",(e=>{e.lengthComputable&&this.onPartProgress(t,e.loaded)})),r.addEventListener("abort",(e=>{Tc(this.uploading,e.target),this.chunkState[t].busy=!1})),r.addEventListener("load",(e=>{const r=e.target;if(Tc(this.uploading,r),this.chunkState[t].busy=!1,r.status<200||r.status>=300)return void this.handleError(new Error("Non 2xx"));this.onPartProgress(t,n.size);const o=r.getResponseHeader("ETag");null!==o?this.onPartComplete(t,o):this.handleError(new Error("AwsS3/Multipart: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions."))})),r.addEventListener("error",(e=>{Tc(this.uploading,e.target),this.chunkState[t].busy=!1;const n=new Error("Unknown error");this.handleError(n)})),r.send(n)}completeUpload(){return this.parts.sort(((t,e)=>t.PartNumber-e.PartNumber)),this.uploadId&&this.key?(t=>{let{csrfToken:e,key:n,uploadId:r,parts:o,endpoint:i}=t;const a=encodeURIComponent(n),s=encodeURIComponent(r),l=new Headers({"X-CSRFToken":e}),c=Oc(i,s,"complete","?key=".concat(a));return fetch(c,{method:"post",headers:l,body:JSON.stringify({parts:o})}).then((t=>t.json())).then((t=>t))})({csrfToken:this.csrfToken,endpoint:this.endpoint,key:this.key,uploadId:this.uploadId,parts:this.parts}).then((()=>{this.onSuccess&&this.onSuccess()}),(t=>{this.handleError(t)})):Promise.resolve()}handleError(t){if(!this.onError)throw t;this.onError(t)}}const Uc=async(t,e)=>new Promise(((n,r)=>{const o=new XMLHttpRequest;o.open("DELETE",t),o.onload=()=>{204===o.status?n():r()},o.setRequestHeader("Tus-Resumable","1.0.0"),o.setRequestHeader("X-CSRFToken",e),o.send(null)}));class Pc extends Rc{constructor(t){let{name:e,size:n,type:r,uploadIndex:o}=t;super({name:e,status:"done",type:r,uploadIndex:o}),ra(this,"size",void 0),this.size=n}async abort(){return Promise.resolve()}async delete(){return Promise.resolve()}getSize(){return this.size}}class Ic extends Pc{constructor(t,e){super({name:t.name,size:t.size,type:"placeholder",uploadIndex:e}),ra(this,"id",void 0),this.id=t.id}getInitialFile(){return{id:this.id,name:this.name,size:this.size,type:"placeholder"}}}class jc extends Pc{constructor(t,e){super({name:t.original_name||t.name,size:t.size,type:"uploadedS3",uploadIndex:e}),ra(this,"id",void 0),ra(this,"key",void 0),this.id=t.id,this.key=t.name}getInitialFile(){return{id:this.id,name:this.key,original_name:this.name,size:this.size,type:"s3"}}}class Lc extends Pc{constructor(t,e){super({name:t.name,size:t.size,type:"existing",uploadIndex:e})}getInitialFile(){return{name:this.name,size:this.size,type:"existing"}}}class Dc extends Pc{constructor(t){let{csrfToken:e,initialFile:n,uploadIndex:r,uploadUrl:o}=t;super({name:n.name,size:n.size,type:"uploadedTus",uploadIndex:r}),ra(this,"csrfToken",void 0),ra(this,"id",void 0),ra(this,"url",void 0),this.csrfToken=e,this.id=n.id,this.url="".concat(o).concat(n.id)}async delete(){await Uc(this.url,this.csrfToken)}getInitialFile(){return{id:this.id,name:this.name,size:this.size,type:"tus",url:""}}}const Hc="function"==typeof btoa,Fc="function"==typeof Buffer,Nc=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder?new TextEncoder:void 0),Mc=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),zc=((t=>{let e={};t.forEach(((t,n)=>e[t]=n))})(Mc),String.fromCharCode.bind(String)),Bc=("function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),t=>t.replace(/=/g,"").replace(/[+\/]/g,(t=>"+"==t?"-":"_"))),qc=t=>{let e,n,r,o,i="";const a=t.length%3;for(let a=0;a<t.length;){if((n=t.charCodeAt(a++))>255||(r=t.charCodeAt(a++))>255||(o=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=n<<16|r<<8|o,i+=Mc[e>>18&63]+Mc[e>>12&63]+Mc[e>>6&63]+Mc[63&e]}return a?i.slice(0,a-3)+"===".substring(a):i},Gc=Hc?t=>btoa(t):Fc?t=>Buffer.from(t,"binary").toString("base64"):qc,$c=Fc?t=>Buffer.from(t).toString("base64"):t=>{let e=[];for(let n=0,r=t.length;n<r;n+=4096)e.push(zc.apply(null,t.subarray(n,n+4096)));return Gc(e.join(""))},Kc=t=>{if(t.length<2)return(e=t.charCodeAt(0))<128?t:e<2048?zc(192|e>>>6)+zc(128|63&e):zc(224|e>>>12&15)+zc(128|e>>>6&63)+zc(128|63&e);var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return zc(240|e>>>18&7)+zc(128|e>>>12&63)+zc(128|e>>>6&63)+zc(128|63&e)},Xc=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Wc=t=>t.replace(Xc,Kc),Vc=Fc?t=>Buffer.from(t,"utf8").toString("base64"):Nc?t=>$c(Nc.encode(t)):t=>Gc(Wc(t)),Yc=(t,e=!1)=>e?Bc(Vc(t)):Vc(t),Qc=Yc;var Zc={},Jc=Object.prototype.hasOwnProperty;function tu(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}function eu(t){try{return encodeURIComponent(t)}catch(t){return null}}Zc.stringify=function(t,e){e=e||"";var n,r,o=[];for(r in"string"!=typeof e&&(e="?"),t)if(Jc.call(t,r)){if((n=t[r])||null!=n&&!isNaN(n)||(n=""),r=eu(r),n=eu(n),null===r||null===n)continue;o.push(r+"="+n)}return o.length?e+o.join("&"):""},Zc.parse=function(t){for(var e,n=/([^=?#&]+)=?([^&]*)/g,r={};e=n.exec(t);){var o=tu(e[1]),i=tu(e[2]);null===o||null===i||o in r||(r[o]=i)}return r};var nu=function(t,e){if(e=e.split(":")[0],!(t=+t))return!1;switch(e){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t},ru=Zc,ou=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,iu=/[\n\r\t]/g,au=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,su=/:\d+$/,lu=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,cu=/^[a-zA-Z]:/;function uu(t){return(t||"").toString().replace(ou,"")}var pu=[["#","hash"],["?","query"],function(t,e){return hu(e.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],fu={hash:1,query:1};function du(e){var n,r=("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{}).location||{},o={},i=typeof(e=e||r);if("blob:"===e.protocol)o=new yu(unescape(e.pathname),{});else if("string"===i)for(n in o=new yu(e,{}),fu)delete o[n];else if("object"===i){for(n in e)n in fu||(o[n]=e[n]);void 0===o.slashes&&(o.slashes=au.test(e.href))}return o}function hu(t){return"file:"===t||"ftp:"===t||"http:"===t||"https:"===t||"ws:"===t||"wss:"===t}function mu(t,e){t=(t=uu(t)).replace(iu,""),e=e||{};var n,r=lu.exec(t),o=r[1]?r[1].toLowerCase():"",i=!!r[2],a=!!r[3],s=0;return i?a?(n=r[2]+r[3]+r[4],s=r[2].length+r[3].length):(n=r[2]+r[4],s=r[2].length):a?(n=r[3]+r[4],s=r[3].length):n=r[4],"file:"===o?s>=2&&(n=n.slice(2)):hu(o)?n=r[4]:o?i&&(n=n.slice(2)):s>=2&&hu(e.protocol)&&(n=r[4]),{protocol:o,slashes:i||hu(o),slashesCount:s,rest:n}}function yu(t,e,n){if(t=(t=uu(t)).replace(iu,""),!(this instanceof yu))return new yu(t,e,n);var r,o,i,a,s,l,c=pu.slice(),u=typeof e,p=this,f=0;for("object"!==u&&"string"!==u&&(n=e,e=null),n&&"function"!=typeof n&&(n=ru.parse),r=!(o=mu(t||"",e=du(e))).protocol&&!o.slashes,p.slashes=o.slashes||r&&e.slashes,p.protocol=o.protocol||e.protocol||"",t=o.rest,("file:"===o.protocol&&(2!==o.slashesCount||cu.test(t))||!o.slashes&&(o.protocol||o.slashesCount<2||!hu(p.protocol)))&&(c[3]=[/(.*)/,"pathname"]);f<c.length;f++)"function"!=typeof(a=c[f])?(i=a[0],l=a[1],i!=i?p[l]=t:"string"==typeof i?~(s="@"===i?t.lastIndexOf(i):t.indexOf(i))&&("number"==typeof a[2]?(p[l]=t.slice(0,s),t=t.slice(s+a[2])):(p[l]=t.slice(s),t=t.slice(0,s))):(s=i.exec(t))&&(p[l]=s[1],t=t.slice(0,s.index)),p[l]=p[l]||r&&a[3]&&e[l]||"",a[4]&&(p[l]=p[l].toLowerCase())):t=a(t,p);n&&(p.query=n(p.query)),r&&e.slashes&&"/"!==p.pathname.charAt(0)&&(""!==p.pathname||""!==e.pathname)&&(p.pathname=function(t,e){if(""===t)return e;for(var n=(e||"/").split("/").slice(0,-1).concat(t.split("/")),r=n.length,o=n[r-1],i=!1,a=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),a++):a&&(0===r&&(i=!0),n.splice(r,1),a--);return i&&n.unshift(""),"."!==o&&".."!==o||n.push(""),n.join("/")}(p.pathname,e.pathname)),"/"!==p.pathname.charAt(0)&&hu(p.protocol)&&(p.pathname="/"+p.pathname),nu(p.port,p.protocol)||(p.host=p.hostname,p.port=""),p.username=p.password="",p.auth&&(~(s=p.auth.indexOf(":"))?(p.username=p.auth.slice(0,s),p.username=encodeURIComponent(decodeURIComponent(p.username)),p.password=p.auth.slice(s+1),p.password=encodeURIComponent(decodeURIComponent(p.password))):p.username=encodeURIComponent(decodeURIComponent(p.auth)),p.auth=p.password?p.username+":"+p.password:p.username),p.origin="file:"!==p.protocol&&hu(p.protocol)&&p.host?p.protocol+"//"+p.host:"null",p.href=p.toString()}yu.prototype={set:function(t,e,n){var r=this;switch(t){case"query":"string"==typeof e&&e.length&&(e=(n||ru.parse)(e)),r[t]=e;break;case"port":r[t]=e,nu(e,r.protocol)?e&&(r.host=r.hostname+":"+e):(r.host=r.hostname,r[t]="");break;case"hostname":r[t]=e,r.port&&(e+=":"+r.port),r.host=e;break;case"host":r[t]=e,su.test(e)?(e=e.split(":"),r.port=e.pop(),r.hostname=e.join(":")):(r.hostname=e,r.port="");break;case"protocol":r.protocol=e.toLowerCase(),r.slashes=!n;break;case"pathname":case"hash":if(e){var o="pathname"===t?"/":"#";r[t]=e.charAt(0)!==o?o+e:e}else r[t]=e;break;case"username":case"password":r[t]=encodeURIComponent(e);break;case"auth":var i=e.indexOf(":");~i?(r.username=e.slice(0,i),r.username=encodeURIComponent(decodeURIComponent(r.username)),r.password=e.slice(i+1),r.password=encodeURIComponent(decodeURIComponent(r.password))):r.username=encodeURIComponent(decodeURIComponent(e))}for(var a=0;a<pu.length;a++){var s=pu[a];s[4]&&(r[s[1]]=r[s[1]].toLowerCase())}return r.auth=r.password?r.username+":"+r.password:r.username,r.origin="file:"!==r.protocol&&hu(r.protocol)&&r.host?r.protocol+"//"+r.host:"null",r.href=r.toString(),r},toString:function(t){t&&"function"==typeof t||(t=ru.stringify);var e,n=this,r=n.host,o=n.protocol;o&&":"!==o.charAt(o.length-1)&&(o+=":");var i=o+(n.protocol&&n.slashes||hu(n.protocol)?"//":"");return n.username?(i+=n.username,n.password&&(i+=":"+n.password),i+="@"):n.password?(i+=":"+n.password,i+="@"):"file:"!==n.protocol&&hu(n.protocol)&&!r&&"/"!==n.pathname&&(i+="@"),(":"===r[r.length-1]||su.test(n.hostname)&&!n.port)&&(r+=":"),i+=r+n.pathname,(e="object"==typeof n.query?t(n.query):n.query)&&(i+="?"!==e.charAt(0)?"?"+e:e),n.hash&&(i+=n.hash),i}},yu.extractProtocol=mu,yu.location=du,yu.trimLeft=uu,yu.qs=ru;var gu=yu;function vu(t){return vu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vu(t)}function bu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _u(t,e){if(e&&("object"===vu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function wu(t){var e="function"==typeof Map?new Map:void 0;return wu=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return Eu(t,arguments,Ru(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Au(r,t)},wu(t)}function Eu(t,e,n){return Eu=Su()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&Au(o,n.prototype),o},Eu.apply(null,arguments)}function Su(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Au(t,e){return Au=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Au(t,e)}function Ru(t){return Ru=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ru(t)}var ku=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Au(t,e)}(o,t);var e,n,r=(e=o,n=Su(),function(){var t,r=Ru(e);if(n){var o=Ru(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return _u(this,t)});function o(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(xu(this,o),(e=r.call(this,t)).originalRequest=i,e.originalResponse=a,e.causingError=n,null!=n&&(t+=", caused by ".concat(n.toString())),null!=i){var s=i.getHeader("X-Request-ID")||"n/a",l=i.getMethod(),c=i.getURL(),u=a?a.getStatus():"n/a",p=a?a.getBody()||"":"n/a";t+=", originated from request (method: ".concat(l,", url: ").concat(c,", response code: ").concat(u,", response text: ").concat(p,", request id: ").concat(s,")")}return e.message=t,e}return function(t,e,n){return e&&bu(t.prototype,e),n&&bu(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(o)}(wu(Error));function Ou(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Tu(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ou(Object(n),!0).forEach((function(e){Cu(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ou(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Cu(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Pu={endpoint:null,uploadUrl:null,metadata:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,_onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:null,chunkSize:1/0,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null},Iu=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"resume"in n&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=n,this.options.chunkSize=+this.options.chunkSize,this._urlStorage=this.options.urlStorage,this.file=e,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}return function(t,e,n){e&&Uu(t.prototype,e),n&&Uu(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"findPreviousUploads",value:function(){var t=this;return this.options.fingerprint(this.file,this.options).then((function(e){return t._urlStorage.findUploadsByFingerprint(e)}))}},{key:"resumeFromPreviousUpload",value:function(t){this.url=t.uploadUrl||null,this._parallelUploadUrls=t.parallelUploadUrls||null,this._urlStorageKey=t.urlStorageKey}},{key:"start",value:function(){var t=this,e=this.file;if(e)if(this.options.endpoint||this.options.uploadUrl){var n=this.options.retryDelays;null==n||"[object Array]"===Object.prototype.toString.call(n)?(this.options.parallelUploads>1&&["uploadUrl","uploadSize","uploadLengthDeferred"].forEach((function(e){t.options[e]&&t._emitError(new Error("tus: cannot use the ".concat(e," option when parallelUploads is enabled")))})),this.options.fingerprint(e,this.options).then((function(n){return t._fingerprint=n,t._source?t._source:t.options.fileReader.openFile(e,t.options.chunkSize)})).then((function(e){t._source=e,t.options.parallelUploads>1||null!=t._parallelUploadUrls?t._startParallelUpload():t._startSingleUpload()})).catch((function(e){t._emitError(e)}))):this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"))}else this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));else this._emitError(new Error("tus: no file or stream to upload provided"))}},{key:"_startParallelUpload",value:function(){var e=this,n=this._size=this._source.size,r=0;this._parallelUploads=[];var o=null!=this._parallelUploadUrls?this._parallelUploadUrls.length:this.options.parallelUploads,i=function(t,e,n){for(var r=Math.floor(t/e),o=[],i=0;i<e;i++)o.push({start:r*i,end:r*(i+1)});o[e-1].end=t,n&&o.forEach((function(t,e){t.uploadUrl=n[e]||null}));return o}(this._source.size,o,this._parallelUploadUrls);this._parallelUploadUrls=new Array(i.length);var a,s=i.map((function(o,a){var s=0;return e._source.slice(o.start,o.end).then((function(l){var c=l.value;return new Promise((function(l,u){var p=Tu(Tu({},e.options),{},{uploadUrl:o.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,metadata:{},headers:Tu(Tu({},e.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:l,onError:u,onProgress:function(t){r=r-s+t,s=t,e._emitProgress(r,n)},_onUploadUrlAvailable:function(){e._parallelUploadUrls[a]=f.url,e._parallelUploadUrls.filter((function(t){return!!t})).length===i.length&&e._saveUploadInUrlStorage()}}),f=new t(c,p);f.start(),e._parallelUploads.push(f)}))}))}));Promise.all(s).then((function(){(a=e._openRequest("POST",e.options.endpoint)).setHeader("Upload-Concat","final;".concat(e._parallelUploadUrls.join(" ")));var t=ju(e.options.metadata);return""!==t&&a.setHeader("Upload-Metadata",t),e._sendRequest(a,null)})).then((function(t){if(Lu(t.getStatus(),200)){var n=t.getHeader("Location");null!=n?(e.url=Nu(e.options.endpoint,n),"Created upload at ".concat(e.url),e._emitSuccess()):e._emitHttpError(a,t,"tus: invalid or missing Location header")}else e._emitHttpError(a,t,"tus: unexpected response while creating upload")})).catch((function(t){e._emitError(t)}))}},{key:"_startSingleUpload",value:function(){if(this.options.uploadLengthDeferred)this._size=null;else if(null!=this.options.uploadSize){if(this._size=+this.options.uploadSize,isNaN(this._size))return void this._emitError(new Error("tus: cannot convert `uploadSize` option into a number"))}else if(this._size=this._source.size,null==this._size)return void this._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));return this._aborted=!1,null!=this.url?("Resuming upload from previous URL: ".concat(this.url),void this._resumeUpload()):null!=this.options.uploadUrl?("Resuming upload from provided URL: ".concat(this.options.uploadUrl),this.url=this.options.uploadUrl,void this._resumeUpload()):void this._createUpload()}},{key:"abort",value:function(e){var n=this;if(arguments.length>1&&"function"==typeof arguments[1])throw new Error("tus: the abort function does not accept a callback since v2 anymore; please use the returned Promise instead");return null!=this._parallelUploads&&this._parallelUploads.forEach((function(t){t.abort(e)})),null!==this._req&&(this._req.abort(),this._source.close()),this._aborted=!0,null!=this._retryTimeout&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),e&&null!=this.url?t.terminate(this.url,this.options).then((function(){return n._removeFromUrlStorage()})):Promise.resolve()}},{key:"_emitHttpError",value:function(t,e,n,r){this._emitError(new ku(n,r,t,e))}},{key:"_emitError",value:function(t){var e=this;if(!this._aborted){if(null!=this.options.retryDelays)if(null!=this._offset&&this._offset>this._offsetBeforeRetry&&(this._retryAttempt=0),Fu(t,this._retryAttempt,this.options)){var n=this.options.retryDelays[this._retryAttempt++];return this._offsetBeforeRetry=this._offset,void(this._retryTimeout=setTimeout((function(){e.start()}),n))}if("function"!=typeof this.options.onError)throw t;this.options.onError(t)}}},{key:"_emitSuccess",value:function(){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),"function"==typeof this.options.onSuccess&&this.options.onSuccess()}},{key:"_emitProgress",value:function(t,e){"function"==typeof this.options.onProgress&&this.options.onProgress(t,e)}},{key:"_emitChunkComplete",value:function(t,e,n){"function"==typeof this.options.onChunkComplete&&this.options.onChunkComplete(t,e,n)}},{key:"_createUpload",value:function(){var t=this;if(this.options.endpoint){var e=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?e.setHeader("Upload-Defer-Length",1):e.setHeader("Upload-Length",this._size);var n,r=ju(this.options.metadata);""!==r&&e.setHeader("Upload-Metadata",r),this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,n=this._addChunkToRequest(e)):n=this._sendRequest(e,null),n.then((function(n){if(Lu(n.getStatus(),200)){var r=n.getHeader("Location");if(null!=r){if(t.url=Nu(t.options.endpoint,r),"Created upload at ".concat(t.url),"function"==typeof t.options._onUploadUrlAvailable&&t.options._onUploadUrlAvailable(),0===t._size)return t._emitSuccess(),void t._source.close();t._saveUploadInUrlStorage(),t.options.uploadDataDuringCreation?t._handleUploadResponse(e,n):(t._offset=0,t._performUpload())}else t._emitHttpError(e,n,"tus: invalid or missing Location header")}else t._emitHttpError(e,n,"tus: unexpected response while creating upload")})).catch((function(n){t._emitHttpError(e,null,"tus: failed to create upload",n)}))}else this._emitError(new Error("tus: unable to create upload because no endpoint is provided"))}},{key:"_resumeUpload",value:function(){var t=this,e=this._openRequest("HEAD",this.url);this._sendRequest(e,null).then((function(n){var r=n.getStatus();if(!Lu(r,200))return Lu(r,400)&&t._removeFromUrlStorage(),423===r?void t._emitHttpError(e,n,"tus: upload is currently locked; retry later"):t.options.endpoint?(t.url=null,void t._createUpload()):void t._emitHttpError(e,n,"tus: unable to resume upload (new upload cannot be created without an endpoint)");var o=parseInt(n.getHeader("Upload-Offset"),10);if(isNaN(o))t._emitHttpError(e,n,"tus: invalid or missing offset value");else{var i=parseInt(n.getHeader("Upload-Length"),10);if(!isNaN(i)||t.options.uploadLengthDeferred){if("function"==typeof t.options._onUploadUrlAvailable&&t.options._onUploadUrlAvailable(),o===i)return t._emitProgress(i,i),void t._emitSuccess();t._offset=o,t._performUpload()}else t._emitHttpError(e,n,"tus: invalid or missing length value")}})).catch((function(n){t._emitHttpError(e,null,"tus: failed to resume upload",n)}))}},{key:"_performUpload",value:function(){var t,e=this;this._aborted||(this.options.overridePatchMethod?(t=this._openRequest("POST",this.url)).setHeader("X-HTTP-Method-Override","PATCH"):t=this._openRequest("PATCH",this.url),t.setHeader("Upload-Offset",this._offset),this._addChunkToRequest(t).then((function(n){Lu(n.getStatus(),200)?e._handleUploadResponse(t,n):e._emitHttpError(t,n,"tus: unexpected response while uploading chunk")})).catch((function(n){e._aborted||e._emitHttpError(t,null,"tus: failed to upload chunk at offset ".concat(e._offset),n)})))}},{key:"_addChunkToRequest",value:function(t){var e=this,n=this._offset,r=this._offset+this.options.chunkSize;return t.setProgressHandler((function(t){e._emitProgress(n+t,e._size)})),t.setHeader("Content-Type","application/offset+octet-stream"),(r===1/0||r>this._size)&&!this.options.uploadLengthDeferred&&(r=this._size),this._source.slice(n,r).then((function(n){var r=n.value,o=n.done;return e.options.uploadLengthDeferred&&o&&(e._size=e._offset+(r&&r.size?r.size:0),t.setHeader("Upload-Length",e._size)),null===r?e._sendRequest(t):(e._emitProgress(e._offset,e._size),e._sendRequest(t,r))}))}},{key:"_handleUploadResponse",value:function(t,e){var n=parseInt(e.getHeader("Upload-Offset"),10);if(isNaN(n))this._emitHttpError(t,e,"tus: invalid or missing offset value");else{if(this._emitProgress(n,this._size),this._emitChunkComplete(n-this._offset,n,this._size),this._offset=n,n==this._size)return this._emitSuccess(),void this._source.close();this._performUpload()}}},{key:"_openRequest",value:function(t,e){var n=Du(t,e,this.options);return this._req=n,n}},{key:"_removeFromUrlStorage",value:function(){var t=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch((function(e){t._emitError(e)})),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var t=this;if(this.options.storeFingerprintForResuming&&this._fingerprint){var e={size:this._size,metadata:this.options.metadata,creationTime:(new Date).toString()};this._parallelUploads?e.parallelUploadUrls=this._parallelUploadUrls:e.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,e).then((function(e){return t._urlStorageKey=e})).catch((function(e){t._emitError(e)}))}}},{key:"_sendRequest",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Hu(t,e,this.options)}}],[{key:"terminate",value:function(e,n){if(arguments.length>1&&"function"==typeof arguments[arguments.length-1])throw new Error("tus: the terminate function does not accept a callback since v2 anymore; please use the returned Promise instead");void 0===n&&(n={});var r=Du("DELETE",e,n);return Hu(r,null,n).then((function(t){if(204!==t.getStatus())throw new ku("tus: unexpected response while terminating upload",null,r,t)})).catch((function(o){if(o instanceof ku||(o=new ku("tus: failed to terminate upload",o,r,null)),!Fu(o,0,n))throw o;var i=n.retryDelays[0],a=n.retryDelays.slice(1),s=Tu(Tu({},n),{},{retryDelays:a});return new Promise((function(t){return setTimeout(t,i)})).then((function(){return t.terminate(e,s)}))}))}}]),t}();function ju(t){var e=[];for(var n in t)e.push("".concat(n," ").concat(Qc(String(t[n]))));return e.join(",")}function Lu(t,e){return t>=e&&t<e+100}function Du(t,e,n){var r=n.httpStack.createRequest(t,e);r.setHeader("Tus-Resumable","1.0.0");var o=n.headers||{};for(var i in o)r.setHeader(i,o[i]);if(n.addRequestId){var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}));r.setHeader("X-Request-ID",a)}return r}function Hu(t,e,n){return("function"==typeof n.onBeforeRequest?Promise.resolve(n.onBeforeRequest(t)):Promise.resolve()).then((function(){return t.send(e).then((function(e){return("function"==typeof n.onAfterResponse?Promise.resolve(n.onAfterResponse(t,e)):Promise.resolve()).then((function(){return e}))}))}))}function Fu(t,e,n){if(null==n.retryDelays||e>=n.retryDelays.length||null==t.originalRequest)return!1;if(n&&"function"==typeof n.onShouldRetry)return n.onShouldRetry(t,e,n);var r,o=t.originalResponse?t.originalResponse.getStatus():0;return(!Lu(o,400)||409===o||423===o)&&(r=!0,"undefined"!=typeof window&&"navigator"in window&&!1===window.navigator.onLine&&(r=!1),r)}function Nu(t,e){return new gu(e,t).toString()}function Mu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Iu.defaultOptions=Pu;var zu=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){e&&Mu(t.prototype,e),n&&Mu(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(t){return Promise.resolve([])}},{key:"removeUpload",value:function(t){return Promise.resolve()}},{key:"addUpload",value:function(t,e){return Promise.resolve(null)}}]),t}();function Bu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var qu=!1;try{qu="localStorage"in window;var Gu="tusSupport";localStorage.setItem(Gu,localStorage.getItem(Gu))}catch(t){if(t.code!==t.SECURITY_ERR&&t.code!==t.QUOTA_EXCEEDED_ERR)throw t;qu=!1}var $u=qu,Ku=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){e&&Bu(t.prototype,e),n&&Bu(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"findAllUploads",value:function(){var t=this._findEntries("tus::");return Promise.resolve(t)}},{key:"findUploadsByFingerprint",value:function(t){var e=this._findEntries("tus::".concat(t,"::"));return Promise.resolve(e)}},{key:"removeUpload",value:function(t){return localStorage.removeItem(t),Promise.resolve()}},{key:"addUpload",value:function(t,e){var n=Math.round(1e12*Math.random()),r="tus::".concat(t,"::").concat(n);return localStorage.setItem(r,JSON.stringify(e)),Promise.resolve(r)}},{key:"_findEntries",value:function(t){for(var e=[],n=0;n<localStorage.length;n++){var r=localStorage.key(n);if(0===r.indexOf(t))try{var o=JSON.parse(localStorage.getItem(r));o.urlStorageKey=r,e.push(o)}catch(t){}}return e}}]),t}();function Xu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Vu(t,e,n){return e&&Wu(t.prototype,e),n&&Wu(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var Yu=function(){function t(){Xu(this,t)}return Vu(t,[{key:"createRequest",value:function(t,e){return new Qu(t,e)}},{key:"getName",value:function(){return"XHRHttpStack"}}]),t}(),Qu=function(){function t(e,n){Xu(this,t),this._xhr=new XMLHttpRequest,this._xhr.open(e,n,!0),this._method=e,this._url=n,this._headers={}}return Vu(t,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(t,e){this._xhr.setRequestHeader(t,e),this._headers[t]=e}},{key:"getHeader",value:function(t){return this._headers[t]}},{key:"setProgressHandler",value:function(t){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(e){e.lengthComputable&&t(e.loaded)})}},{key:"send",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Promise((function(n,r){t._xhr.onload=function(){n(new Zu(t._xhr))},t._xhr.onerror=function(t){r(t)},t._xhr.send(e)}))}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),t}(),Zu=function(){function t(e){Xu(this,t),this._xhr=e}return Vu(t,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(t){return this._xhr.getResponseHeader(t)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),t}(),Ju=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase()};var tp={exports:{}},ep=Tt("iterator"),np=!1;try{var rp=0,op={next:function(){return{done:!!rp++}},return:function(){np=!0}};op[ep]=function(){return this},Array.from(op,(function(){throw 2}))}catch(t){}var ip,ap,sp,lp="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,cp=lp,up=Lt,pp=r,fp=o,dp=a,hp=Q,mp=Ra,yp=Yt,gp=Yn,vp=Zr,bp=Ht.f,xp=qt,_p=Bo,wp=di,Ep=Tt,Sp=nt,Ap=hr.enforce,Rp=hr.get,kp=pp.Int8Array,Op=kp&&kp.prototype,Tp=pp.Uint8ClampedArray,Cp=Tp&&Tp.prototype,Up=kp&&_p(kp),Pp=Op&&_p(Op),Ip=Object.prototype,jp=pp.TypeError,Lp=Ep("toStringTag"),Dp=Sp("TYPED_ARRAY_TAG"),Hp="TypedArrayConstructor",Fp=cp&&!!wp&&"Opera"!==mp(pp.opera),Np=!1,Mp={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},zp={BigInt64Array:8,BigUint64Array:8},Bp=function(t){var e=_p(t);if(dp(e)){var n=Rp(e);return n&&hp(n,Hp)?n.TypedArrayConstructor:Bp(e)}},qp=function(t){if(!dp(t))return!1;var e=mp(t);return hp(Mp,e)||hp(zp,e)};for(ip in Mp)(sp=(ap=pp[ip])&&ap.prototype)?Ap(sp).TypedArrayConstructor=ap:Fp=!1;for(ip in zp)(sp=(ap=pp[ip])&&ap.prototype)&&(Ap(sp).TypedArrayConstructor=ap);if((!Fp||!fp(Up)||Up===Function.prototype)&&(Up=function(){throw jp("Incorrect invocation")},Fp))for(ip in Mp)pp[ip]&&wp(pp[ip],Up);if((!Fp||!Pp||Pp===Ip)&&(Pp=Up.prototype,Fp))for(ip in Mp)pp[ip]&&wp(pp[ip].prototype,Pp);if(Fp&&_p(Cp)!==Pp&&wp(Cp,Pp),up&&!hp(Pp,Lp))for(ip in Np=!0,bp(Pp,Lp,{get:function(){return dp(this)?this[Dp]:void 0}}),Mp)pp[ip]&&gp(pp[ip],Dp,ip);var Gp={NATIVE_ARRAY_BUFFER_VIEWS:Fp,TYPED_ARRAY_TAG:Np&&Dp,aTypedArray:function(t){if(qp(t))return t;throw jp("Target is not a typed array")},aTypedArrayConstructor:function(t){if(fp(t)&&(!wp||xp(Up,t)))return t;throw jp(yp(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,n,r){if(up){if(n)for(var o in Mp){var i=pp[o];if(i&&hp(i.prototype,t))try{delete i.prototype[t]}catch(n){try{i.prototype[t]=e}catch(t){}}}Pp[t]&&!n||vp(Pp,t,n?e:Fp&&Op[t]||e,r)}},exportTypedArrayStaticMethod:function(t,e,n){var r,o;if(up){if(wp){if(n)for(r in Mp)if((o=pp[r])&&hp(o,t))try{delete o[t]}catch(t){}if(Up[t]&&!n)return;try{return vp(Up,t,n?e:Fp&&Up[t]||e)}catch(t){}}for(r in Mp)!(o=pp[r])||o[t]&&!n||vp(o,t,e)}},getTypedArrayConstructor:Bp,isView:function(t){if(!dp(t))return!1;var e=mp(t);return"DataView"===e||hp(Mp,e)||hp(zp,e)},isTypedArray:qp,TypedArray:Up,TypedArrayPrototype:Pp},$p=r,Kp=h,Xp=function(t,e){if(!e&&!np)return!1;var n=!1;try{var r={};r[ep]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(t){}return n},Wp=Gp.NATIVE_ARRAY_BUFFER_VIEWS,Vp=$p.ArrayBuffer,Yp=$p.Int8Array,Qp=!Wp||!Kp((function(){Yp(1)}))||!Kp((function(){new Yp(-1)}))||!Xp((function(t){new Yp,new Yp(null),new Yp(1.5),new Yp(t)}),!0)||Kp((function(){return 1!==new Yp(new Vp(2),1,void 0).length})),Zp=Zr,Jp=qt,tf=TypeError,ef=function(t,e){if(Jp(e,t))return t;throw tf("Incorrect invocation")},nf=Pe,rf=Ne,of=RangeError,af=function(t){if(void 0===t)return 0;var e=nf(t),n=rf(e);if(e!==n)throw of("Wrong length or index");return n},sf=Array,lf=Math.abs,cf=Math.pow,uf=Math.floor,pf=Math.log,ff=Math.LN2,df={pack:function(t,e,n){var r,o,i,a=sf(n),s=8*n-e-1,l=(1<<s)-1,c=l>>1,u=23===e?cf(2,-24)-cf(2,-77):0,p=t<0||0===t&&1/t<0?1:0,f=0;for((t=lf(t))!=t||t===1/0?(o=t!=t?1:0,r=l):(r=uf(pf(t)/ff),t*(i=cf(2,-r))<1&&(r--,i*=2),(t+=r+c>=1?u/i:u*cf(2,1-c))*i>=2&&(r++,i/=2),r+c>=l?(o=0,r=l):r+c>=1?(o=(t*i-1)*cf(2,e),r+=c):(o=t*cf(2,c-1)*cf(2,e),r=0));e>=8;)a[f++]=255&o,o/=256,e-=8;for(r=r<<e|o,s+=e;s>0;)a[f++]=255&r,r/=256,s-=8;return a[--f]|=128*p,a},unpack:function(t,e){var n,r=t.length,o=8*r-e-1,i=(1<<o)-1,a=i>>1,s=o-7,l=r-1,c=t[l--],u=127&c;for(c>>=7;s>0;)u=256*u+t[l--],s-=8;for(n=u&(1<<-s)-1,u>>=-s,s+=e;s>0;)n=256*n+t[l--],s-=8;if(0===u)u=1-a;else{if(u===i)return n?NaN:c?-1/0:1/0;n+=cf(2,e),u-=a}return(c?-1:1)*n*cf(2,u-e)}},hf=W,mf=De,yf=ze,gf=function(t){for(var e=hf(this),n=yf(e),r=arguments.length,o=mf(r>1?arguments[1]:void 0,n),i=r>2?arguments[2]:void 0,a=void 0===i?n:mf(i,n);a>o;)e[o++]=t;return e},vf=ge,bf=Ht,xf=Xn,_f=De,wf=ze,Ef=function(t,e,n){var r=vf(e);r in t?bf.f(t,r,xf(0,n)):t[r]=n},Sf=Array,Af=Math.max,Rf=function(t,e,n){for(var r=wf(t),o=_f(e,r),i=_f(void 0===n?r:n,r),a=Sf(Af(i-o,0)),s=0;o<i;o++,s++)Ef(a,s,t[o]);return a.length=s,a},kf=r,Of=_,Tf=Lt,Cf=lp,Uf=Lr,Pf=Yn,If=function(t,e,n){for(var r in e)Zp(t,r,e[r],n);return t},jf=h,Lf=ef,Df=Pe,Hf=Ne,Ff=af,Nf=df,Mf=Bo,zf=di,Bf=Jr.f,qf=Ht.f,Gf=gf,$f=Rf,Kf=ti,Xf=Uf.PROPER,Wf=Uf.CONFIGURABLE,Vf=hr.get,Yf=hr.set,Qf="ArrayBuffer",Zf="DataView",Jf="Wrong index",td=kf.ArrayBuffer,ed=td,nd=ed&&ed.prototype,rd=kf.DataView,od=rd&&rd.prototype,id=Object.prototype,ad=kf.Array,sd=kf.RangeError,ld=Of(Gf),cd=Of([].reverse),ud=Nf.pack,pd=Nf.unpack,fd=function(t){return[255&t]},dd=function(t){return[255&t,t>>8&255]},hd=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},md=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},yd=function(t){return ud(t,23,4)},gd=function(t){return ud(t,52,8)},vd=function(t,e){qf(t.prototype,e,{get:function(){return Vf(this)[e]}})},bd=function(t,e,n,r){var o=Ff(n),i=Vf(t);if(o+e>i.byteLength)throw sd(Jf);var a=Vf(i.buffer).bytes,s=o+i.byteOffset,l=$f(a,s,s+e);return r?l:cd(l)},xd=function(t,e,n,r,o,i){var a=Ff(n),s=Vf(t);if(a+e>s.byteLength)throw sd(Jf);for(var l=Vf(s.buffer).bytes,c=a+s.byteOffset,u=r(+o),p=0;p<e;p++)l[c+p]=u[i?p:e-p-1]};if(Cf){var _d=Xf&&td.name!==Qf;if(jf((function(){td(1)}))&&jf((function(){new td(-1)}))&&!jf((function(){return new td,new td(1.5),new td(NaN),_d&&!Wf})))_d&&Wf&&Pf(td,"name",Qf);else{(ed=function(t){return Lf(this,nd),new td(Ff(t))}).prototype=nd;for(var wd,Ed=Bf(td),Sd=0;Ed.length>Sd;)(wd=Ed[Sd++])in ed||Pf(ed,wd,td[wd]);nd.constructor=ed}zf&&Mf(od)!==id&&zf(od,id);var Ad=new rd(new ed(2)),Rd=Of(od.setInt8);Ad.setInt8(0,2147483648),Ad.setInt8(1,2147483649),!Ad.getInt8(0)&&Ad.getInt8(1)||If(od,{setInt8:function(t,e){Rd(this,t,e<<24>>24)},setUint8:function(t,e){Rd(this,t,e<<24>>24)}},{unsafe:!0})}else nd=(ed=function(t){Lf(this,nd);var e=Ff(t);Yf(this,{bytes:ld(ad(e),0),byteLength:e}),Tf||(this.byteLength=e)}).prototype,od=(rd=function(t,e,n){Lf(this,od),Lf(t,nd);var r=Vf(t).byteLength,o=Df(e);if(o<0||o>r)throw sd("Wrong offset");if(o+(n=void 0===n?r-o:Hf(n))>r)throw sd("Wrong length");Yf(this,{buffer:t,byteLength:n,byteOffset:o}),Tf||(this.buffer=t,this.byteLength=n,this.byteOffset=o)}).prototype,Tf&&(vd(ed,"byteLength"),vd(rd,"buffer"),vd(rd,"byteLength"),vd(rd,"byteOffset")),If(od,{getInt8:function(t){return bd(this,1,t)[0]<<24>>24},getUint8:function(t){return bd(this,1,t)[0]},getInt16:function(t){var e=bd(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=bd(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return md(bd(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return md(bd(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return pd(bd(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return pd(bd(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){xd(this,1,t,fd,e)},setUint8:function(t,e){xd(this,1,t,fd,e)},setInt16:function(t,e){xd(this,2,t,dd,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){xd(this,2,t,dd,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){xd(this,4,t,hd,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){xd(this,4,t,hd,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){xd(this,4,t,yd,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){xd(this,8,t,gd,e,arguments.length>2?arguments[2]:void 0)}});Kf(ed,Qf),Kf(rd,Zf);var kd={ArrayBuffer:ed,DataView:rd},Od=a,Td=Math.floor,Cd=Number.isInteger||function(t){return!Od(t)&&isFinite(t)&&Td(t)===t},Ud=Pe,Pd=RangeError,Id=function(t){var e=Ud(t);if(e<0)throw Pd("The argument can't be less than 0");return e},jd=RangeError,Ld=function(t,e){var n=Id(t);if(n%e)throw jd("Wrong offset");return n},Dd=te,Hd=m,Fd=_(_.bind),Nd=function(t,e){return Dd(t),void 0===e?t:Hd?Fd(t,e):function(){return t.apply(e,arguments)}},Md=_,zd=h,Bd=o,qd=Ra,Gd=Bn,$d=function(){},Kd=[],Xd=at("Reflect","construct"),Wd=/^\s*(?:class|function)\b/,Vd=Md(Wd.exec),Yd=!Wd.exec($d),Qd=function(t){if(!Bd(t))return!1;try{return Xd($d,Kd,t),!0}catch(t){return!1}},Zd=function(t){if(!Bd(t))return!1;switch(qd(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Yd||!!Vd(Wd,Gd(t))}catch(t){return!0}};Zd.sham=!0;var Jd=!Xd||zd((function(){var t;return Qd(Qd.call)||!Qd(Object)||!Qd((function(){t=!0}))||t}))?Zd:Qd,th=Jd,eh=Yt,nh=TypeError,rh=Ra,oh=ne,ih=Ln,ah=Tt("iterator"),sh=function(t){if(null!=t)return oh(t,ah)||oh(t,"@@iterator")||ih[rh(t)]},lh=Bt,ch=te,uh=It,ph=Yt,fh=sh,dh=TypeError,hh=Ln,mh=Tt("iterator"),yh=Array.prototype,gh=Nd,vh=Bt,bh=function(t){if(th(t))return t;throw nh(eh(t)+" is not a constructor")},xh=W,_h=ze,wh=function(t,e){var n=arguments.length<2?fh(t):e;if(ch(n))return uh(lh(n,t));throw dh(ph(t)+" is not iterable")},Eh=sh,Sh=function(t){return void 0!==t&&(hh.Array===t||yh[mh]===t)},Ah=Gp.aTypedArrayConstructor,Rh=A,kh=Array.isArray||function(t){return"Array"==Rh(t)},Oh=Jd,Th=a,Ch=Tt("species"),Uh=Array,Ph=function(t){var e;return kh(t)&&(e=t.constructor,(Oh(e)&&(e===Uh||kh(e.prototype))||Th(e)&&null===(e=e[Ch]))&&(e=void 0)),void 0===e?Uh:e},Ih=Nd,jh=C,Lh=W,Dh=ze,Hh=function(t,e){return new(Ph(t))(0===e?0:e)},Fh=_([].push),Nh=function(t){var e=1==t,n=2==t,r=3==t,o=4==t,i=6==t,a=7==t,s=5==t||i;return function(l,c,u,p){for(var f,d,h=Lh(l),m=jh(h),y=Ih(c,u),g=Dh(m),v=0,b=p||Hh,x=e?b(l,g):n||a?b(l,0):void 0;g>v;v++)if((s||v in m)&&(d=y(f=m[v],v,h),t))if(e)x[v]=d;else if(d)switch(t){case 3:return!0;case 5:return f;case 6:return v;case 2:Fh(x,f)}else switch(t){case 4:return!1;case 7:Fh(x,f)}return i?-1:r||o?o:x}},Mh={forEach:Nh(0),map:Nh(1),filter:Nh(2),some:Nh(3),every:Nh(4),find:Nh(5),findIndex:Nh(6),filterReject:Nh(7)},zh=at,Bh=Ht,qh=Lt,Gh=Tt("species"),$h=o,Kh=a,Xh=di,Wh=Io,Vh=r,Yh=Bt,Qh=Lt,Zh=Qp,Jh=Gp,tm=kd,em=ef,nm=Xn,rm=Yn,om=Cd,im=Ne,am=af,sm=Ld,lm=ge,cm=Q,um=Ra,pm=a,fm=Wt,dm=On,hm=qt,mm=di,ym=Jr.f,gm=function(t){var e,n,r,o,i,a,s=bh(this),l=xh(t),c=arguments.length,u=c>1?arguments[1]:void 0,p=void 0!==u,f=Eh(l);if(f&&!Sh(f))for(a=(i=wh(l,f)).next,l=[];!(o=vh(a,i)).done;)l.push(o.value);for(p&&c>2&&(u=gh(u,arguments[2])),n=_h(l),r=new(Ah(s))(n),e=0;n>e;e++)r[e]=p?u(l[e],e):l[e];return r},vm=Mh.forEach,bm=function(t){var e=zh(t),n=Bh.f;qh&&e&&!e[Gh]&&n(e,Gh,{configurable:!0,get:function(){return this}})},xm=Ht,_m=mr,wm=function(t,e,n){var r,o;return Xh&&$h(r=e.constructor)&&r!==n&&Kh(o=r.prototype)&&o!==n.prototype&&Xh(t,o),t},Em=hr.get,Sm=hr.set,Am=hr.enforce,Rm=xm.f,km=_m.f,Om=Math.round,Tm=Vh.RangeError,Cm=tm.ArrayBuffer,Um=Cm.prototype,Pm=tm.DataView,Im=Jh.NATIVE_ARRAY_BUFFER_VIEWS,jm=Jh.TYPED_ARRAY_TAG,Lm=Jh.TypedArray,Dm=Jh.TypedArrayPrototype,Hm=Jh.aTypedArrayConstructor,Fm=Jh.isTypedArray,Nm="BYTES_PER_ELEMENT",Mm="Wrong length",zm=function(t,e){Hm(t);for(var n=0,r=e.length,o=new t(r);r>n;)o[n]=e[n++];return o},Bm=function(t,e){Rm(t,e,{get:function(){return Em(this)[e]}})},qm=function(t){var e;return hm(Um,t)||"ArrayBuffer"==(e=um(t))||"SharedArrayBuffer"==e},Gm=function(t,e){return Fm(t)&&!fm(e)&&e in t&&om(+e)&&e>=0},$m=function(t,e){return e=lm(e),Gm(t,e)?nm(2,t[e]):km(t,e)},Km=function(t,e,n){return e=lm(e),!(Gm(t,e)&&pm(n)&&cm(n,"value"))||cm(n,"get")||cm(n,"set")||n.configurable||cm(n,"writable")&&!n.writable||cm(n,"enumerable")&&!n.enumerable?Rm(t,e,n):(t[e]=n.value,t)};Qh?(Im||(_m.f=$m,xm.f=Km,Bm(Dm,"buffer"),Bm(Dm,"byteOffset"),Bm(Dm,"byteLength"),Bm(Dm,"length")),Wh({target:"Object",stat:!0,forced:!Im},{getOwnPropertyDescriptor:$m,defineProperty:Km}),tp.exports=function(t,e,n){var r=t.match(/\d+$/)[0]/8,o=t+(n?"Clamped":"")+"Array",i="get"+t,a="set"+t,s=Vh[o],l=s,c=l&&l.prototype,u={},p=function(t,e){Rm(t,e,{get:function(){return function(t,e){var n=Em(t);return n.view[i](e*r+n.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,o){var i=Em(t);n&&(o=(o=Om(o))<0?0:o>255?255:255&o),i.view[a](e*r+i.byteOffset,o,!0)}(this,e,t)},enumerable:!0})};Im?Zh&&(l=e((function(t,e,n,o){return em(t,c),wm(pm(e)?qm(e)?void 0!==o?new s(e,sm(n,r),o):void 0!==n?new s(e,sm(n,r)):new s(e):Fm(e)?zm(l,e):Yh(gm,l,e):new s(am(e)),t,l)})),mm&&mm(l,Lm),vm(ym(s),(function(t){t in l||rm(l,t,s[t])})),l.prototype=c):(l=e((function(t,e,n,o){em(t,c);var i,a,s,u=0,f=0;if(pm(e)){if(!qm(e))return Fm(e)?zm(l,e):Yh(gm,l,e);i=e,f=sm(n,r);var d=e.byteLength;if(void 0===o){if(d%r)throw Tm(Mm);if((a=d-f)<0)throw Tm(Mm)}else if((a=im(o)*r)+f>d)throw Tm(Mm);s=a/r}else s=am(e),i=new Cm(a=s*r);for(Sm(t,{buffer:i,byteOffset:f,byteLength:a,length:s,view:new Pm(i)});u<s;)p(t,u++)})),mm&&mm(l,Lm),c=l.prototype=dm(Dm)),c.constructor!==l&&rm(c,"constructor",l),Am(c).TypedArrayConstructor=l,jm&&rm(c,jm,o);var f=l!=s;u[o]=l,Wh({global:!0,constructor:!0,forced:f,sham:!Im},u),Nm in l||rm(l,Nm,r),Nm in c||rm(c,Nm,r),bm(o)}):tp.exports=function(){},(0,tp.exports)("Uint8",(function(t){return function(e,n,r){return t(this,e,n,r)}}));var Xm=he,Wm=TypeError,Vm=gf,Ym=function(t){var e=Xm(t,"number");if("number"==typeof e)throw Wm("Can't convert number to bigint");return BigInt(e)},Qm=Ra,Zm=Bt,Jm=h,ty=Gp.aTypedArray,ey=Gp.exportTypedArrayMethod,ny=_("".slice);ey("fill",(function(t){var e=arguments.length;ty(this);var n="Big"===ny(Qm(this),0,3)?Ym(t):+t;return Zm(Vm,this,n,e>1?arguments[1]:void 0,e>2?arguments[2]:void 0)}),Jm((function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),1!==t})));var ry=r,oy=Bt,iy=Gp,ay=ze,sy=Ld,ly=W,cy=h,uy=ry.RangeError,py=ry.Int8Array,fy=py&&py.prototype,dy=fy&&fy.set,hy=iy.aTypedArray,my=iy.exportTypedArrayMethod,yy=!cy((function(){var t=new Uint8ClampedArray(2);return oy(dy,t,{length:1,0:3},1),3!==t[1]})),gy=yy&&iy.NATIVE_ARRAY_BUFFER_VIEWS&&cy((function(){var t=new py(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));my("set",(function(t){hy(this);var e=sy(arguments.length>1?arguments[1]:void 0,1),n=ly(t);if(yy)return oy(dy,this,n,e);var r=this.length,o=ay(n),i=0;if(o+e>r)throw uy("Wrong length");for(;i<o;)this[e+i]=n[i++]}),!yy||gy);var vy=Rf,by=Math.floor,xy=function(t,e){var n=t.length,r=by(n/2);return n<8?_y(t,e):wy(t,xy(vy(t,0,r),e),xy(vy(t,r),e),e)},_y=function(t,e){for(var n,r,o=t.length,i=1;i<o;){for(r=i,n=t[i];r&&e(t[r-1],n)>0;)t[r]=t[--r];r!==i++&&(t[r]=n)}return t},wy=function(t,e,n,r){for(var o=e.length,i=n.length,a=0,s=0;a<o||s<i;)t[a+s]=a<o&&s<i?r(e[a],n[s])<=0?e[a++]:n[s++]:a<o?e[a++]:n[s++];return t},Ey=xy,Sy=st.match(/firefox\/(\d+)/i),Ay=!!Sy&&+Sy[1],Ry=/MSIE|Trident/.test(st),ky=st.match(/AppleWebKit\/(\d+)\./),Oy=!!ky&&+ky[1],Ty=_,Cy=h,Uy=te,Py=Ey,Iy=Ay,jy=Ry,Ly=ht,Dy=Oy,Hy=Gp.aTypedArray,Fy=Gp.exportTypedArrayMethod,Ny=r.Uint16Array,My=Ny&&Ty(Ny.prototype.sort),zy=!(!My||Cy((function(){My(new Ny(2),null)}))&&Cy((function(){My(new Ny(2),{})}))),By=!!My&&!Cy((function(){if(Ly)return Ly<74;if(Iy)return Iy<67;if(jy)return!0;if(Dy)return Dy<602;var t,e,n=new Ny(516),r=Array(516);for(t=0;t<516;t++)e=t%4,n[t]=515-t,r[t]=t-2*e+3;for(My(n,(function(t,e){return(t/4|0)-(e/4|0)})),t=0;t<516;t++)if(n[t]!==r[t])return!0}));function qy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Fy("sort",(function(t){return void 0!==t&&Uy(t),By?My(this,t):Py(Hy(this),function(t){return function(e,n){return void 0!==t?+t(e,n)||0:n!=n?-1:e!=e?1:0===e&&0===n?1/e>0&&1/n<0?1:-1:e>n}}(t))}),!By||zy);var Gy=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._file=e,this.size=e.size}return function(t,e,n){e&&qy(t.prototype,e),n&&qy(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"slice",value:function(t,e){if("undefined"!=typeof window&&(void 0!==window.PhoneGap||void 0!==window.Cordova||void 0!==window.cordova))return n=this._file.slice(t,e),new Promise((function(t,e){var r=new FileReader;r.onload=function(){var e=new Uint8Array(r.result);t({value:e})},r.onerror=function(t){e(t)},r.readAsArrayBuffer(n)}));var n,r=this._file.slice(t,e);return Promise.resolve({value:r})}},{key:"close",value:function(){}}]),t}();function $y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ky(t){return void 0===t?0:void 0!==t.size?t.size:t.length}var Xy=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._buffer=void 0,this._bufferOffset=0,this._reader=e,this._done=!1}return function(t,e,n){e&&$y(t.prototype,e),n&&$y(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"slice",value:function(t,e){return t<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(t,e)}},{key:"_readUntilEnoughDataOrDone",value:function(t,e){var n=this,r=e<=this._bufferOffset+Ky(this._buffer);if(this._done||r){var o=this._getDataFromBuffer(t,e),i=null==o&&this._done;return Promise.resolve({value:o,done:i})}return this._reader.read().then((function(r){var o=r.value;return r.done?n._done=!0:void 0===n._buffer?n._buffer=o:n._buffer=function(t,e){if(t.concat)return t.concat(e);if(t instanceof Blob)return new Blob([t,e],{type:t.type});if(t.set){var n=new t.constructor(t.length+e.length);return n.set(t),n.set(e,t.length),n}throw new Error("Unknown data type")}(n._buffer,o),n._readUntilEnoughDataOrDone(t,e)}))}},{key:"_getDataFromBuffer",value:function(t,e){t>this._bufferOffset&&(this._buffer=this._buffer.slice(t-this._bufferOffset),this._bufferOffset=t);var n=0===Ky(this._buffer);return this._done&&n?null:this._buffer.slice(0,e-t)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}]),t}();function Wy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Vy=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){e&&Wy(t.prototype,e),n&&Wy(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"openFile",value:function(t,e){return Ju()&&t&&void 0!==t.uri?(n=t.uri,new Promise((function(t,e){var r=new XMLHttpRequest;r.responseType="blob",r.onload=function(){var e=r.response;t(e)},r.onerror=function(t){e(t)},r.open("GET",n),r.send()}))).then((function(t){return new Gy(t)})).catch((function(t){throw new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(t))})):"function"==typeof t.slice&&void 0!==t.size?Promise.resolve(new Gy(t)):"function"==typeof t.read?(e=+e,isFinite(e)?Promise.resolve(new Xy(t,e)):Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option"))):Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment"));var n}}]),t}();function Yy(t){return Yy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yy(t)}function Qy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Jy(t,e){return Jy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Jy(t,e)}function tg(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ng(t);if(e){var o=ng(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return eg(this,n)}}function eg(t,e){if(e&&("object"===Yy(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ng(t){return ng=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ng(t)}function rg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function og(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rg(Object(n),!0).forEach((function(e){ig(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rg(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ig(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ag=og(og({},Iu.defaultOptions),{},{httpStack:new Yu,fileReader:new Vy,urlStorage:$u?new Ku:new zu,fingerprint:function(t,e){return Ju()?Promise.resolve(function(t,e){var n=t.exif?function(t){var e=0;if(0===t.length)return e;for(var n=0;n<t.length;n++){e=(e<<5)-e+t.charCodeAt(n),e&=e}return e}(JSON.stringify(t.exif)):"noexif";return["tus-rn",t.name||"noname",t.size||"nosize",n,e.endpoint].join("/")}(t,e)):Promise.resolve(["tus-br",t.name,t.type,t.size,t.lastModified,e.endpoint].join("-"))}}),sg=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jy(t,e)}(n,t);var e=tg(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Qy(this,n),r=og(og({},ag),r),e.call(this,t,r)}return function(t,e,n){e&&Zy(t.prototype,e),n&&Zy(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(n,null,[{key:"terminate",value:function(t,e,n){return e=og(og({},ag),e),Iu.terminate(t,e,n)}}]),n}(Iu);class lg extends Rc{constructor(t){let{chunkSize:e,csrfToken:n,fieldName:r,file:o,formId:i,retryDelays:a,uploadIndex:s,uploadUrl:l}=t;super({name:o.name,status:"uploading",type:"tus",uploadIndex:s}),ra(this,"onError",void 0),ra(this,"onProgress",void 0),ra(this,"onSuccess",void 0),ra(this,"upload",void 0),ra(this,"csrfToken",void 0),ra(this,"handleError",(t=>{if(!this.onError)throw t;this.onError(t)})),ra(this,"handleProgress",((t,e)=>{this.onProgress&&this.onProgress(t,e)})),ra(this,"handleSucces",(()=>{this.onSuccess&&this.onSuccess()})),ra(this,"addCsrTokenToRequest",(t=>{t.setHeader("X-CSRFToken",this.csrfToken)})),this.csrfToken=n,this.upload=new sg(o,{chunkSize:e,endpoint:l,metadata:{fieldName:r,filename:o.name,formId:i},onBeforeRequest:this.addCsrTokenToRequest,onError:this.handleError,onProgress:this.handleProgress,onSuccess:this.handleSucces,retryDelays:a||[0,1e3,3e3,5e3]}),this.onError=void 0,this.onProgress=void 0,this.onSuccess=void 0}async abort(){await this.upload.abort(!0)}async delete(){if(!this.upload.url)return Promise.resolve();await Uc(this.upload.url,this.csrfToken)}getSize(){return this.upload.file.size}start(){this.upload.start()}getInitialFile(){return{id:this.name,name:this.name,size:this.getSize(),type:"tus",url:""}}}class cg{constructor(t){let{callbacks:e,chunkSize:n,csrfToken:r,eventEmitter:o,fieldName:i,form:a,formId:s,initial:l,input:c,multiple:u,parent:p,prefix:f,retryDelays:d,s3UploadDir:h,skipRequired:m,supportDropArea:y,translations:g,uploadUrl:v}=t;ra(this,"callbacks",void 0),ra(this,"chunkSize",void 0),ra(this,"csrfToken",void 0),ra(this,"eventEmitter",void 0),ra(this,"fieldName",void 0),ra(this,"form",void 0),ra(this,"formId",void 0),ra(this,"multiple",void 0),ra(this,"nextUploadIndex",void 0),ra(this,"prefix",void 0),ra(this,"renderer",void 0),ra(this,"retryDelays",void 0),ra(this,"s3UploadDir",void 0),ra(this,"supportDropArea",void 0),ra(this,"uploads",void 0),ra(this,"uploadUrl",void 0),ra(this,"uploadFiles",(async t=>{if(0!==t.length){this.multiple||0===this.uploads.length||(this.renderer.deleteFile(0),this.uploads=[]);for await(const e of t)await this.uploadFile(e);this.checkDropHint()}})),ra(this,"onChange",(t=>{const e=t.target.files;e&&this.uploadFiles([...e])})),ra(this,"onClick",(t=>{const e=t.target,n=()=>{const t=e.getAttribute("data-index");if(!t)return;const n=parseInt(t,10);return this.getUploadByIndex(n)};if(e.classList.contains("dff-delete")&&!e.classList.contains("dff-disabled")){const e=n();e&&this.removeExistingUpload(e),t.preventDefault()}else if(e.classList.contains("dff-cancel")){const e=n();e&&this.handleCancel(e),t.preventDefault()}})),ra(this,"handleProgress",((t,e,n)=>{const r=(e/n*100).toFixed(2);this.renderer.updateProgress(t.uploadIndex,r);const{onProgress:o}=this.callbacks;o&&t instanceof lg&&o(e,n,t)})),ra(this,"handleError",((t,e)=>{this.renderer.setError(t.uploadIndex),t.status="error";const{onError:n}=this.callbacks;n&&t instanceof lg&&n(e,t)})),ra(this,"handleSuccess",(t=>{const{renderer:e}=this;this.updatePlaceholderInput(),e.clearInput(),e.setSuccess(t.uploadIndex,t.getSize()),t.status="done";const{onSuccess:n}=this.callbacks,r=document.getElementsByClassName("dff-file-id-".concat(t.uploadIndex))[0];this.emitEvent("uploadComplete",r,t),n&&"tus"===t.type&&n(t)})),this.callbacks=e,this.chunkSize=n,this.csrfToken=r,this.eventEmitter=o,this.fieldName=i,this.form=a,this.formId=s,this.multiple=u,this.prefix=f,this.retryDelays=d,this.s3UploadDir=h,this.supportDropArea=y,this.uploadUrl=v,this.uploads=[],this.nextUploadIndex=0,this.renderer=new pa({parent:p,input:c,skipRequired:m,translations:g});const b=this.renderer.container;y&&this.initDropArea(b,c.accept),l&&this.addInitialFiles(l),this.checkDropHint(),c.addEventListener("change",this.onChange),b.addEventListener("click",this.onClick)}addInitialFiles(t){if(0===t.length)return;const{multiple:e,renderer:n}=this,r=t=>{const{size:e}=t,r="s3"===t.type&&t.original_name?t.original_name:t.name,o=n.addUploadedFile(r,this.nextUploadIndex,e),i=(t=>{let{csrfToken:e,initialFile:n,uploadIndex:r,uploadUrl:o}=t;switch(n.type){case"existing":return new Lc(n,r);case"placeholder":return new Ic(n,r);case"s3":return new jc(n,r);case"tus":return new Dc({csrfToken:e,initialFile:n,uploadUrl:o,uploadIndex:r})}})({csrfToken:this.csrfToken,initialFile:t,uploadIndex:this.nextUploadIndex,uploadUrl:this.uploadUrl});this.uploads.push(i),this.emitEvent("addUpload",o,i)};e?t.forEach((t=>{r(t),this.nextUploadIndex+=1})):r(t[0])}async uploadFile(t){const{fieldName:e,formId:n,renderer:r,uploadUrl:o}=this,i=t.name,a=this.findUploadByName(i),s=a?a.uploadIndex:this.nextUploadIndex;a||(this.nextUploadIndex+=1),a&&await this.removeExistingUpload(a);const l=(()=>{const{csrfToken:r,s3UploadDir:i}=this;return null!=i?new Cc({csrfToken:r,endpoint:o,file:t,s3UploadDir:i,uploadIndex:s}):new lg({chunkSize:this.chunkSize,csrfToken:this.csrfToken,fieldName:e,file:t,formId:n,retryDelays:this.retryDelays,uploadIndex:s,uploadUrl:o})})();l.onError=t=>this.handleError(l,t),l.onProgress=(t,e)=>this.handleProgress(l,t,e),l.onSuccess=()=>this.handleSuccess(l),l.start(),this.uploads.push(l);const c=r.addNewUpload(i,s);this.emitEvent("addUpload",c,l)}getUploadByIndex(t){return this.uploads.find((e=>e.uploadIndex===t))}findUploadByName(t){return this.uploads.find((e=>e.name===t))}async removeExistingUpload(t){const e=this.renderer.findFileDiv(t.uploadIndex);if(e&&this.emitEvent("removeUpload",e,t),"uploading"===t.status)this.renderer.disableCancel(t.uploadIndex),await t.abort();else if("done"===t.status){this.renderer.disableDelete(t.uploadIndex);try{await t.delete()}catch{return void this.renderer.setDeleteFailed(t.uploadIndex)}}this.removeUploadFromList(t),this.updatePlaceholderInput()}removeUploadFromList(t){this.renderer.deleteFile(t.uploadIndex);const e=this.uploads.indexOf(t);e>=0&&this.uploads.splice(e,1),this.checkDropHint();const{onDelete:n}=this.callbacks;n&&n(t)}async handleCancel(t){this.renderer.disableCancel(t.uploadIndex),await t.abort(),this.removeUploadFromList(t)}initDropArea(t,e){new Ac({container:t,inputAccept:e,onUploadFiles:this.uploadFiles})}checkDropHint(){if(!this.supportDropArea)return;0===this.uploads.filter((t=>t)).length?this.renderer.renderDropHint():this.renderer.removeDropHint()}updatePlaceholderInput(){const t=aa(this.form,sa(this.fieldName,this.prefix),this.prefix);if(!t)return;const e=this.uploads.map((t=>t.getInitialFile()));t.value=JSON.stringify(e)}getMetaDataField(){return aa(this.form,(t=this.fieldName,e=this.prefix,"".concat(ia(t,e),"-metadata")),this.prefix);var t,e}emitEvent(t,e,n){this.eventEmitter&&this.eventEmitter.emit(t,{element:e,fieldName:this.fieldName,fileName:n.name,metaDataField:this.getMetaDataField(),upload:n})}}const ug=function(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=t=>!n||!n.prefix||t.startsWith("".concat(n.prefix,"-")),o=()=>n&&n.prefix?n.prefix:null,i=e=>la(t,e,o()),a=t=>{const e=i(sa(t,o()));return e?JSON.parse(e):[]},s=i("upload_url"),l=i("form_id"),c=i("s3_upload_dir"),u=n.skipRequired||!1,p=o(),f=null===(e=aa(t,"csrfmiddlewaretoken",null))||void 0===e?void 0:e.value;if(!f)throw Error("Csrf token not found");l&&s&&t.querySelectorAll(".dff-uploader").forEach((e=>{const o=e.querySelector(".dff-container");if(!o)return;const i=o.querySelector("input[type=file]");if(!i||!r(i.name))return;const d=i.name,{multiple:h}=i,m=a(d),y=o.getAttribute("data-translations"),g=y?JSON.parse(y):{},v=!(!1===n.supportDropArea);new cg({callbacks:n.callbacks||{},chunkSize:n.chunkSize||2621440,csrfToken:f,eventEmitter:n.eventEmitter,fieldName:d,form:t,formId:l,s3UploadDir:c||null,initial:m,input:i,multiple:h,parent:o,prefix:p,retryDelays:n.retryDelays||null,skipRequired:u,supportDropArea:v,translations:g,uploadUrl:s})}))};window.autoInitFileForms=()=>{const t=window.initUploadFields,e=(t=>Array.from(new Set(t).values()))(Array.from(document.querySelectorAll(".dff-uploader")).map(na));e.forEach(t)},window.initFormSet=(t,e)=>{let n;n="string"==typeof e?{prefix:e}:e;const r=n.prefix||"form",o=la(t,"TOTAL_FORMS",r);if(!o)return;const i=parseInt(o,10);for(let e=0;e<i;e+=1){const o=oa("".concat(e),null);ug(t,{...n,prefix:"".concat(r,"-").concat(o)})}},window.initUploadFields=ug}();
//# sourceMappingURL=file_form.js.map
