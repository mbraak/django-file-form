!function(){const t=e=>{const n=e.parentElement;return n?"FORM"===n.tagName?n:t(n):null};function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,n||"default");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"===e(n)?n:String(n)}function r(t,e,r){return(e=n(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const o=(t,e)=>e?`${e}-${t}`:t,i=(t,e)=>e?t.slice(e.length+1):t,a=(t,e,n)=>{const r=o(e,n),i=t.querySelector(`[name="${r}"]`);return i||null},s=(t,e)=>`${i(t,e)}-uploads`,l=(t,e,n)=>a(t,e,n)?.value;var u="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function c(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}
/*!
   * escape-html
   * Copyright(c) 2012-2013 TJ Holowaychuk
   * Copyright(c) 2015 Andreas Lubbe
   * Copyright(c) 2015 Tiancheng "Timothy" Gu
   * MIT Licensed
   */var p=/["'&<>]/,f=function(t){var e,n=""+t,r=p.exec(n);if(!r)return n;var o="",i=0,a=0;for(i=r.index;i<n.length;i++){switch(n.charCodeAt(i)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#39;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}a!==i&&(o+=n.substring(a,i)),a=i+1,o+=e}return a!==i?o+n.substring(a,i):o};var d=c(f);class h{constructor(t){let{parent:e,input:n,skipRequired:o,translations:i}=t;r(this,"container",void 0),r(this,"input",void 0),r(this,"translations",void 0),r(this,"errors",void 0),r(this,"createErrorContainer",(t=>{const e=document.createElement("div");return e.className="dff-invalid-files",t.appendChild(e),e})),r(this,"createFilesContainer",(t=>{const e=document.createElement("div");return e.className="dff-files",t.appendChild(e),e})),this.container=this.createFilesContainer(e),this.errors=this.createErrorContainer(e),this.input=n,this.translations=i,o&&(this.input.required=!1)}addNewUpload(t,e){const n=this.addFile(t,e),r=document.createElement("span");r.className="dff-progress";const o=document.createElement("span");o.className="dff-progress-inner",r.appendChild(o),n.appendChild(r);const i=document.createElement("a");return i.className="dff-cancel",i.innerHTML=this.translations.Cancel||"",i.setAttribute("data-index",`${e}`),i.href="#",n.appendChild(i),n}addUploadedFile(t,e,n){const r=this.addFile(t,e);return this.setSuccess(e,n),r}clearInput(){const{input:t}=this;t.value=""}deleteFile(t){const e=this.findFileDiv(t);e&&e.remove()}disableCancel(t){const e=this.findCancelSpan(t);e&&e.classList.add("dff-disabled")}disableDelete(t){const e=this.findDeleteLink(t);e&&e.classList.add("dff-disabled")}findFileDiv(t){return this.container.querySelector(`.dff-file-id-${t}`)}removeDropHint(){const t=this.container.querySelector(".dff-drop-hint");t&&t.remove()}renderDropHint(){if(this.container.querySelector(".dff-drop-hint"))return;const t=document.createElement("div");t.className="dff-drop-hint",t.innerHTML=this.translations["Drop your files here"]||"",this.container.appendChild(t)}setDeleteFailed(t){this.setErrorMessage(t,this.translations["Delete failed"]||""),this.enableDelete(t)}setError(t){this.setErrorMessage(t,this.translations["Upload failed"]||"");const e=this.findFileDiv(t);e&&e.classList.add("dff-upload-fail"),this.removeProgress(t),this.removeCancel(t)}setErrorInvalidFiles(t){const e=document.createElement("ul");for(const n of t){const t=document.createElement("li");t.innerText=`${n.name}: ${this.translations["Invalid file type"]}`,t.className="dff-error",e.appendChild(t)}this.errors.replaceChildren(e),this.clearInput()}setSuccess(t,e){const{translations:n}=this,r=this.findFileDiv(t);if(r){if(r.classList.add("dff-upload-success"),null!=e){const t=document.createElement("span");t.innerHTML=((t,e)=>{if(0===t)return"0 Bytes";const n=e<=0?0:e||2,r=Math.floor(Math.log(t)/Math.log(1024));return`${parseFloat((t/1024**r).toFixed(n))} ${["Bytes","KB","MB","GB"][r]}`})(e,2),t.className="dff-filesize",r.appendChild(t)}const o=document.createElement("a");o.innerHTML=n.Delete||"",o.className="dff-delete",o.setAttribute("data-index",`${t}`),o.href="#",r.appendChild(o)}this.removeProgress(t),this.removeCancel(t)}updateProgress(t,e){const n=this.container.querySelector(`.dff-file-id-${t}`);if(n){const t=n.querySelector(".dff-progress-inner");t&&(t.style.width=`${e}%`)}}addFile(t,e){const n=document.createElement("div");n.className=`dff-file dff-file-id-${e}`;const r=document.createElement("span");return r.innerHTML=d(t),r.className="dff-filename",r.setAttribute("data-index",`${e}`),n.appendChild(r),this.container.appendChild(n),this.input.required=!1,n}removeProgress(t){const e=this.findFileDiv(t);if(e){const t=e.querySelector(".dff-progress");t&&t.remove()}}removeCancel(t){const e=this.findCancelSpan(t);e&&e.remove()}findCancelSpan(t){const e=this.findFileDiv(t);return e?e.querySelector(".dff-cancel"):null}enableDelete(t){const e=this.findDeleteLink(t);e&&e.classList.remove("dff-disabled")}findDeleteLink(t){const e=this.findFileDiv(t);return e?e.querySelector(".dff-delete"):e}setErrorMessage(t,e){const n=this.findFileDiv(t);if(!n)return;const r=n.querySelector(".dff-error");r&&r.remove();const o=document.createElement("span");o.classList.add("dff-error"),o.innerHTML=e,n.appendChild(o)}}function m(){this._types=Object.create(null),this._extensions=Object.create(null);for(let t=0;t<arguments.length;t++)this.define(arguments[t]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}m.prototype.define=function(t,e){for(let n in t){let r=t[n].map((function(t){return t.toLowerCase()}));n=n.toLowerCase();for(let t=0;t<r.length;t++){const o=r[t];if("*"!==o[0]){if(!e&&o in this._types)throw new Error('Attempt to change mapping for "'+o+'" extension from "'+this._types[o]+'" to "'+n+'". Pass `force=true` to allow this, otherwise remove "'+o+'" from the list of extensions for "'+n+'".');this._types[o]=n}}if(e||!this._extensions[n]){const t=r[0];this._extensions[n]="*"!==t[0]?t:t.substr(1)}}},m.prototype.getType=function(t){let e=(t=String(t)).replace(/^.*[/\\]/,"").toLowerCase(),n=e.replace(/^.*\./,"").toLowerCase(),r=e.length<t.length;return(n.length<e.length-1||!r)&&this._types[n]||null},m.prototype.getExtension=function(t){return(t=/^\s*([^;\s]*)/.test(t)&&RegExp.$1)&&this._extensions[t.toLowerCase()]||null};var y=c(new m({"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]})),v=function(t){return t&&t.Math===Math&&t},g=v("object"==typeof globalThis&&globalThis)||v("object"==typeof window&&window)||v("object"==typeof self&&self)||v("object"==typeof u&&u)||function(){return this}()||u||Function("return this")(),b=function(t){try{return!!t()}catch(t){return!0}},x=!b((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),_={exports:{}},w=!b((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),S=w,E=Function.prototype,k=E.call,R=S&&E.bind.bind(k,k),A=S?R:function(t){return function(){return k.apply(t,arguments)}},C="object"==typeof document&&document.all,O={all:C,IS_HTMLDDA:void 0===C&&void 0!==C},T=O.all,j=O.IS_HTMLDDA?function(t){return"function"==typeof t||t===T}:function(t){return"function"==typeof t},P=function(t){return null==t},U=P,L=TypeError,I=function(t){if(U(t))throw new L("Can't call method on "+t);return t},H=Object,D=function(t){return H(I(t))},$=A({}.hasOwnProperty),N=Object.hasOwn||function(t,e){return $(D(t),e)},F=x,z=N,q=Function.prototype,M=F&&Object.getOwnPropertyDescriptor,B=z(q,"name"),G={EXISTS:B,PROPER:B&&"something"===function(){}.name,CONFIGURABLE:B&&(!F||F&&M(q,"name").configurable)},K=g,X=Object.defineProperty,Q=function(t,e){try{X(K,t,{value:e,configurable:!0,writable:!0})}catch(n){K[t]=e}return e},W="__core-js_shared__",Y=g[W]||Q(W,{}),Z=j,J=Y,V=A(Function.toString);Z(J.inspectSource)||(J.inspectSource=function(t){return V(t)});var tt,et,nt=J.inspectSource,rt=j,ot=g.WeakMap,it=rt(ot)&&/native code/.test(String(ot)),at=j,st=O.all,lt=O.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:at(t)||t===st}:function(t){return"object"==typeof t?null!==t:at(t)},ut={},ct=lt,pt=g.document,ft=ct(pt)&&ct(pt.createElement),dt=function(t){return ft?pt.createElement(t):{}},ht=!x&&!b((function(){return 7!==Object.defineProperty(dt("div"),"a",{get:function(){return 7}}).a})),mt=x&&b((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),yt=lt,vt=String,gt=TypeError,bt=function(t){if(yt(t))return t;throw new gt(vt(t)+" is not an object")},xt=w,_t=Function.prototype.call,wt=xt?_t.bind(_t):function(){return _t.apply(_t,arguments)},St=g,Et=j,kt=A({}.isPrototypeOf),Rt=g,At="undefined"!=typeof navigator&&String(navigator.userAgent)||"",Ct=Rt.process,Ot=Rt.Deno,Tt=Ct&&Ct.versions||Ot&&Ot.version,jt=Tt&&Tt.v8;jt&&(et=(tt=jt.split("."))[0]>0&&tt[0]<4?1:+(tt[0]+tt[1])),!et&&At&&(!(tt=At.match(/Edge\/(\d+)/))||tt[1]>=74)&&(tt=At.match(/Chrome\/(\d+)/))&&(et=+tt[1]);var Pt=et,Ut=b,Lt=g.String,It=!!Object.getOwnPropertySymbols&&!Ut((function(){var t=Symbol("symbol detection");return!Lt(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Pt&&Pt<41})),Ht=It&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Dt=function(t,e){return arguments.length<2?(n=St[t],Et(n)?n:void 0):St[t]&&St[t][e];var n},$t=j,Nt=kt,Ft=Object,zt=Ht?function(t){return"symbol"==typeof t}:function(t){var e=Dt("Symbol");return $t(e)&&Nt(e.prototype,Ft(t))},qt=String,Mt=j,Bt=function(t){try{return qt(t)}catch(t){return"Object"}},Gt=TypeError,Kt=function(t){if(Mt(t))return t;throw new Gt(Bt(t)+" is not a function")},Xt=P,Qt=wt,Wt=j,Yt=lt,Zt=TypeError,Jt={exports:{}},Vt=Y;(Jt.exports=function(t,e){return Vt[t]||(Vt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.33.0",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"});var te=Jt.exports,ee=A,ne=0,re=Math.random(),oe=ee(1..toString),ie=function(t){return"Symbol("+(void 0===t?"":t)+")_"+oe(++ne+re,36)},ae=te,se=N,le=ie,ue=It,ce=Ht,pe=g.Symbol,fe=ae("wks"),de=ce?pe.for||pe:pe&&pe.withoutSetter||le,he=wt,me=lt,ye=zt,ve=function(t,e){var n=t[e];return Xt(n)?void 0:Kt(n)},ge=function(t,e){var n,r;if("string"===e&&Wt(n=t.toString)&&!Yt(r=Qt(n,t)))return r;if(Wt(n=t.valueOf)&&!Yt(r=Qt(n,t)))return r;if("string"!==e&&Wt(n=t.toString)&&!Yt(r=Qt(n,t)))return r;throw new Zt("Can't convert object to primitive value")},be=TypeError,xe=function(t){return se(fe,t)||(fe[t]=ue&&se(pe,t)?pe[t]:de("Symbol."+t)),fe[t]}("toPrimitive"),_e=function(t,e){if(!me(t)||ye(t))return t;var n,r=ve(t,xe);if(r){if(void 0===e&&(e="default"),n=he(r,t,e),!me(n)||ye(n))return n;throw new be("Can't convert object to primitive value")}return void 0===e&&(e="number"),ge(t,e)},we=zt,Se=x,Ee=ht,ke=mt,Re=bt,Ae=function(t){var e=_e(t,"string");return we(e)?e:e+""},Ce=TypeError,Oe=Object.defineProperty,Te=Object.getOwnPropertyDescriptor,je="enumerable",Pe="configurable",Ue="writable";ut.f=Se?ke?function(t,e,n){if(Re(t),e=Ae(e),Re(n),"function"==typeof t&&"prototype"===e&&"value"in n&&Ue in n&&!n[Ue]){var r=Te(t,e);r&&r[Ue]&&(t[e]=n.value,n={configurable:Pe in n?n[Pe]:r[Pe],enumerable:je in n?n[je]:r[je],writable:!1})}return Oe(t,e,n)}:Oe:function(t,e,n){if(Re(t),e=Ae(e),Re(n),Ee)try{return Oe(t,e,n)}catch(t){}if("get"in n||"set"in n)throw new Ce("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var Le,Ie,He,De=ut,$e=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},Ne=x?function(t,e,n){return De.f(t,e,$e(1,n))}:function(t,e,n){return t[e]=n,t},Fe=ie,ze=te("keys"),qe=it,Me=g,Be=lt,Ge=Ne,Ke=N,Xe=Y,Qe=function(t){return ze[t]||(ze[t]=Fe(t))},We={},Ye="Object already initialized",Ze=Me.TypeError,Je=Me.WeakMap;if(qe||Xe.state){var Ve=Xe.state||(Xe.state=new Je);Ve.get=Ve.get,Ve.has=Ve.has,Ve.set=Ve.set,Le=function(t,e){if(Ve.has(t))throw new Ze(Ye);return e.facade=t,Ve.set(t,e),e},Ie=function(t){return Ve.get(t)||{}},He=function(t){return Ve.has(t)}}else{var tn=Qe("state");We[tn]=!0,Le=function(t,e){if(Ke(t,tn))throw new Ze(Ye);return e.facade=t,Ge(t,tn,e),e},Ie=function(t){return Ke(t,tn)?t[tn]:{}},He=function(t){return Ke(t,tn)}}var en={set:Le,get:Ie,has:He,enforce:function(t){return He(t)?Ie(t):Le(t,{})},getterFor:function(t){return function(e){var n;if(!Be(e)||(n=Ie(e)).type!==t)throw new Ze("Incompatible receiver, "+t+" required");return n}}},nn=A,rn=b,on=j,an=N,sn=x,ln=G.CONFIGURABLE,un=nt,cn=en.enforce,pn=en.get,fn=String,dn=Object.defineProperty,hn=nn("".slice),mn=nn("".replace),yn=nn([].join),vn=sn&&!rn((function(){return 8!==dn((function(){}),"length",{value:8}).length})),gn=String(String).split("String"),bn=_.exports=function(t,e,n){"Symbol("===hn(fn(e),0,7)&&(e="["+mn(fn(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!an(t,"name")||ln&&t.name!==e)&&(sn?dn(t,"name",{value:e,configurable:!0}):t.name=e),vn&&n&&an(n,"arity")&&t.length!==n.arity&&dn(t,"length",{value:n.arity});try{n&&an(n,"constructor")&&n.constructor?sn&&dn(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=cn(t);return an(r,"source")||(r.source=yn(gn,"string"==typeof e?e:"")),t};Function.prototype.toString=bn((function(){return on(this)&&pn(this).source||un(this)}),"toString");var xn=_.exports,_n=ut,wn=bt,Sn=x,En=function(t,e,n){return n.get&&xn(n.get,e,{getter:!0}),n.set&&xn(n.set,e,{setter:!0}),_n.f(t,e,n)},kn=function(){var t=wn(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},Rn=b,An=g.RegExp,Cn=An.prototype,On=Sn&&Rn((function(){var t=!0;try{An(".","d")}catch(e){t=!1}var e={},n="",r=t?"dgimsy":"gimsy",o=function(t,r){Object.defineProperty(e,t,{get:function(){return n+=r,!0}})},i={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var a in t&&(i.hasIndices="d"),i)o(a,i[a]);return Object.getOwnPropertyDescriptor(Cn,"flags").get.call(e)!==r||n!==r}));On&&En(Cn,"flags",{configurable:!0,get:kn});var Tn={basename:t=>{var e,n=0,r=-1,o=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!o){n=e+1;break}}else-1===r&&(o=!1,r=e+1);return-1===r?"":t.slice(n,r)}},jn={};const Pn="\\\\/",Un=`[^${Pn}]`,Ln="\\.",In="\\/",Hn="[^/]",Dn=`(?:${In}|$)`,$n=`(?:^|${In})`,Nn=`${Ln}{1,2}${Dn}`,Fn={DOT_LITERAL:Ln,PLUS_LITERAL:"\\+",QMARK_LITERAL:"\\?",SLASH_LITERAL:In,ONE_CHAR:"(?=.)",QMARK:Hn,END_ANCHOR:Dn,DOTS_SLASH:Nn,NO_DOT:`(?!${Ln})`,NO_DOTS:`(?!${$n}${Nn})`,NO_DOT_SLASH:`(?!${Ln}{0,1}${Dn})`,NO_DOTS_SLASH:`(?!${Nn})`,QMARK_NO_DOT:`[^.${In}]`,STAR:`${Hn}*?`,START_ANCHOR:$n},zn={...Fn,SLASH_LITERAL:`[${Pn}]`,QMARK:Un,STAR:`${Un}*?`,DOTS_SLASH:`${Ln}{1,2}(?:[${Pn}]|$)`,NO_DOT:`(?!${Ln})`,NO_DOTS:`(?!(?:^|[${Pn}])${Ln}{1,2}(?:[${Pn}]|$))`,NO_DOT_SLASH:`(?!${Ln}{0,1}(?:[${Pn}]|$))`,NO_DOTS_SLASH:`(?!${Ln}{1,2}(?:[${Pn}]|$))`,QMARK_NO_DOT:`[^.${Pn}]`,START_ANCHOR:`(?:^|[${Pn}])`,END_ANCHOR:`(?:[${Pn}]|$)`};var qn={MAX_LENGTH:65536,POSIX_REGEX_SOURCE:{alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"},REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:"/",extglobChars:t=>({"!":{type:"negate",open:"(?:(?!(?:",close:`))${t.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}),globChars(){return!0===(arguments.length>0&&void 0!==arguments[0]&&arguments[0])?zn:Fn}};!function(t){const{REGEX_BACKSLASH:e,REGEX_REMOVE_BACKSLASH:n,REGEX_SPECIAL_CHARS:r,REGEX_SPECIAL_CHARS_GLOBAL:o}=qn;t.isObject=t=>null!==t&&"object"==typeof t&&!Array.isArray(t),t.hasRegexChars=t=>r.test(t),t.isRegexChar=e=>1===e.length&&t.hasRegexChars(e),t.escapeRegex=t=>t.replace(o,"\\$1"),t.toPosixSlashes=t=>t.replace(e,"/"),t.removeBackslashes=t=>t.replace(n,(t=>"\\"===t?"":t)),t.isWindows=t=>!(!t||"boolean"!=typeof t.windows)&&t.windows,t.escapeLast=(e,n,r)=>{const o=e.lastIndexOf(n,r);return-1===o?e:"\\"===e[o-1]?t.escapeLast(e,n,o-1):`${e.slice(0,o)}\\${e.slice(o)}`},t.removePrefix=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t;return n.startsWith("./")&&(n=n.slice(2),e.prefix="./"),n},t.wrapOutput=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};let r=`${n.contains?"":"^"}(?:${t})${n.contains?"":"$"}`;return!0===e.negated&&(r=`(?:^(?!${r}).*$)`),r}}(jn);const Mn=jn,{CHAR_ASTERISK:Bn,CHAR_AT:Gn,CHAR_BACKWARD_SLASH:Kn,CHAR_COMMA:Xn,CHAR_DOT:Qn,CHAR_EXCLAMATION_MARK:Wn,CHAR_FORWARD_SLASH:Yn,CHAR_LEFT_CURLY_BRACE:Zn,CHAR_LEFT_PARENTHESES:Jn,CHAR_LEFT_SQUARE_BRACKET:Vn,CHAR_PLUS:tr,CHAR_QUESTION_MARK:er,CHAR_RIGHT_CURLY_BRACE:nr,CHAR_RIGHT_PARENTHESES:rr,CHAR_RIGHT_SQUARE_BRACKET:or}=qn,ir=t=>t===Yn||t===Kn,ar=t=>{!0!==t.isPrefix&&(t.depth=t.isGlobstar?1/0:1)};var sr=(t,e)=>{const n=e||{},r=t.length-1,o=!0===n.parts||!0===n.scanToEnd,i=[],a=[],s=[];let l,u,c=t,p=-1,f=0,d=0,h=!1,m=!1,y=!1,v=!1,g=!1,b=!1,x=!1,_=!1,w=!1,S=!1,E=0,k={value:"",depth:0,isGlob:!1};const R=()=>p>=r,A=()=>(l=u,c.charCodeAt(++p));for(;p<r;){let t;if(u=A(),u!==Kn){if(!0===b||u===Zn){for(E++;!0!==R()&&(u=A());)if(u!==Kn)if(u!==Zn){if(!0!==b&&u===Qn&&(u=A())===Qn){if(h=k.isBrace=!0,y=k.isGlob=!0,S=!0,!0===o)continue;break}if(!0!==b&&u===Xn){if(h=k.isBrace=!0,y=k.isGlob=!0,S=!0,!0===o)continue;break}if(u===nr&&(E--,0===E)){b=!1,h=k.isBrace=!0,S=!0;break}}else E++;else x=k.backslashes=!0,A();if(!0===o)continue;break}if(u!==Yn){if(!0!==n.noext){if(!0===(u===tr||u===Gn||u===Bn||u===er||u===Wn)&&c.charCodeAt(p+1)===Jn){if(y=k.isGlob=!0,v=k.isExtglob=!0,S=!0,u===Wn&&p===f&&(w=!0),!0===o){for(;!0!==R()&&(u=A());)if(u!==Kn){if(u===rr){y=k.isGlob=!0,S=!0;break}}else x=k.backslashes=!0,u=A();continue}break}}if(u===Bn){if(l===Bn&&(g=k.isGlobstar=!0),y=k.isGlob=!0,S=!0,!0===o)continue;break}if(u===er){if(y=k.isGlob=!0,S=!0,!0===o)continue;break}if(u===Vn){for(;!0!==R()&&(t=A());)if(t!==Kn){if(t===or){m=k.isBracket=!0,y=k.isGlob=!0,S=!0;break}}else x=k.backslashes=!0,A();if(!0===o)continue;break}if(!0===n.nonegate||u!==Wn||p!==f){if(!0!==n.noparen&&u===Jn){if(y=k.isGlob=!0,!0===o){for(;!0!==R()&&(u=A());)if(u!==Jn){if(u===rr){S=!0;break}}else x=k.backslashes=!0,u=A();continue}break}if(!0===y){if(S=!0,!0===o)continue;break}}else _=k.negated=!0,f++}else{if(i.push(p),a.push(k),k={value:"",depth:0,isGlob:!1},!0===S)continue;if(l===Qn&&p===f+1){f+=2;continue}d=p+1}}else x=k.backslashes=!0,u=A(),u===Zn&&(b=!0)}!0===n.noext&&(v=!1,y=!1);let C=c,O="",T="";f>0&&(O=c.slice(0,f),c=c.slice(f),d-=f),C&&!0===y&&d>0?(C=c.slice(0,d),T=c.slice(d)):!0===y?(C="",T=c):C=c,C&&""!==C&&"/"!==C&&C!==c&&ir(C.charCodeAt(C.length-1))&&(C=C.slice(0,-1)),!0===n.unescape&&(T&&(T=Mn.removeBackslashes(T)),C&&!0===x&&(C=Mn.removeBackslashes(C)));const j={prefix:O,input:t,start:f,base:C,glob:T,isBrace:h,isBracket:m,isGlob:y,isExtglob:v,isGlobstar:g,negated:_,negatedExtglob:w};if(!0===n.tokens&&(j.maxDepth=0,ir(u)||a.push(k),j.tokens=a),!0===n.parts||!0===n.tokens){let e;for(let r=0;r<i.length;r++){const o=e?e+1:f,l=i[r],u=t.slice(o,l);n.tokens&&(0===r&&0!==f?(a[r].isPrefix=!0,a[r].value=O):a[r].value=u,ar(a[r]),j.maxDepth+=a[r].depth),0===r&&""===u||s.push(u),e=l}if(e&&e+1<t.length){const r=t.slice(e+1);s.push(r),n.tokens&&(a[a.length-1].value=r,ar(a[a.length-1]),j.maxDepth+=a[a.length-1].depth)}j.slashes=i,j.parts=s}return j};const lr=qn,ur=jn,{MAX_LENGTH:cr,POSIX_REGEX_SOURCE:pr,REGEX_NON_SPECIAL_CHARS:fr,REGEX_SPECIAL_CHARS_BACKREF:dr,REPLACEMENTS:hr}=lr,mr=(t,e)=>{if("function"==typeof e.expandRange)return e.expandRange(...t,e);t.sort();const n=`[${t.join("-")}]`;try{new RegExp(n)}catch(e){return t.map((t=>ur.escapeRegex(t))).join("..")}return n},yr=(t,e)=>`Missing ${t}: "${e}" - use "\\\\${e}" to match literal characters`,vr=(t,e)=>{if("string"!=typeof t)throw new TypeError("Expected a string");t=hr[t]||t;const n={...e},r="number"==typeof n.maxLength?Math.min(cr,n.maxLength):cr;let o=t.length;if(o>r)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${r}`);const i={type:"bos",value:"",output:n.prepend||""},a=[i],s=n.capture?"":"?:",l=lr.globChars(),u=lr.extglobChars(l),{DOT_LITERAL:c,PLUS_LITERAL:p,SLASH_LITERAL:f,ONE_CHAR:d,DOTS_SLASH:h,NO_DOT:m,NO_DOT_SLASH:y,NO_DOTS_SLASH:v,QMARK:g,QMARK_NO_DOT:b,STAR:x,START_ANCHOR:_}=l,w=t=>`(${s}(?:(?!${_}${t.dot?h:c}).)*?)`,S=n.dot?"":m,E=n.dot?g:b;let k=!0===n.bash?w(n):x;n.capture&&(k=`(${k})`),"boolean"==typeof n.noext&&(n.noextglob=n.noext);const R={input:t,index:-1,start:0,dot:!0===n.dot,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};t=ur.removePrefix(t,R),o=t.length;const A=[],C=[],O=[];let T,j=i;const P=()=>R.index===o-1,U=R.peek=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return t[R.index+e]},L=R.advance=()=>t[++R.index]||"",I=()=>t.slice(R.index+1),H=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;R.consumed+=t,R.index+=e},D=t=>{R.output+=null!=t.output?t.output:t.value,H(t.value)},$=()=>{let t=1;for(;"!"===U()&&("("!==U(2)||"?"===U(3));)L(),R.start++,t++;return t%2!=0&&(R.negated=!0,R.start++,!0)},N=t=>{R[t]++,O.push(t)},F=t=>{R[t]--,O.pop()},z=t=>{if("globstar"===j.type){const e=R.braces>0&&("comma"===t.type||"brace"===t.type),n=!0===t.extglob||A.length&&("pipe"===t.type||"paren"===t.type);"slash"===t.type||"paren"===t.type||e||n||(R.output=R.output.slice(0,-j.output.length),j.type="star",j.value="*",j.output=k,R.output+=j.output)}if(A.length&&"paren"!==t.type&&(A[A.length-1].inner+=t.value),(t.value||t.output)&&D(t),j&&"text"===j.type&&"text"===t.type)return j.value+=t.value,void(j.output=(j.output||"")+t.value);t.prev=j,a.push(t),j=t},q=(t,e)=>{const r={...u[e],conditions:1,inner:""};r.prev=j,r.parens=R.parens,r.output=R.output;const o=(n.capture?"(":"")+r.open;N("parens"),z({type:t,value:e,output:R.output?"":d}),z({type:"paren",extglob:!0,value:L(),output:o}),A.push(r)},M=t=>{let r,o=t.close+(n.capture?")":"");if("negate"===t.type){let i=k;if(t.inner&&t.inner.length>1&&t.inner.includes("/")&&(i=w(n)),(i!==k||P()||/^\)+$/.test(I()))&&(o=t.close=`)$))${i}`),t.inner.includes("*")&&(r=I())&&/^\.[^\\/.]+$/.test(r)){const n=vr(r,{...e,fastpaths:!1}).output;o=t.close=`)${n})${i})`}"bos"===t.prev.type&&(R.negatedExtglob=!0)}z({type:"paren",extglob:!0,value:T,output:o}),F("parens")};if(!1!==n.fastpaths&&!/(^[*!]|[/()[\]{}"])/.test(t)){let r=!1,o=t.replace(dr,((t,e,n,o,i,a)=>"\\"===o?(r=!0,t):"?"===o?e?e+o+(i?g.repeat(i.length):""):0===a?E+(i?g.repeat(i.length):""):g.repeat(n.length):"."===o?c.repeat(n.length):"*"===o?e?e+o+(i?k:""):k:e?t:`\\${t}`));return!0===r&&(o=!0===n.unescape?o.replace(/\\/g,""):o.replace(/\\+/g,(t=>t.length%2==0?"\\\\":t?"\\":""))),o===t&&!0===n.contains?(R.output=t,R):(R.output=ur.wrapOutput(o,R,e),R)}for(;!P();){if(T=L(),"\0"===T)continue;if("\\"===T){const t=U();if("/"===t&&!0!==n.bash)continue;if("."===t||";"===t)continue;if(!t){T+="\\",z({type:"text",value:T});continue}const e=/^\\+/.exec(I());let r=0;if(e&&e[0].length>2&&(r=e[0].length,R.index+=r,r%2!=0&&(T+="\\")),!0===n.unescape?T=L():T+=L(),0===R.brackets){z({type:"text",value:T});continue}}if(R.brackets>0&&("]"!==T||"["===j.value||"[^"===j.value)){if(!1!==n.posix&&":"===T){const t=j.value.slice(1);if(t.includes("[")&&(j.posix=!0,t.includes(":"))){const t=j.value.lastIndexOf("["),e=j.value.slice(0,t),n=j.value.slice(t+2),r=pr[n];if(r){j.value=e+r,R.backtrack=!0,L(),i.output||1!==a.indexOf(j)||(i.output=d);continue}}}("["===T&&":"!==U()||"-"===T&&"]"===U())&&(T=`\\${T}`),"]"!==T||"["!==j.value&&"[^"!==j.value||(T=`\\${T}`),!0===n.posix&&"!"===T&&"["===j.value&&(T="^"),j.value+=T,D({value:T});continue}if(1===R.quotes&&'"'!==T){T=ur.escapeRegex(T),j.value+=T,D({value:T});continue}if('"'===T){R.quotes=1===R.quotes?0:1,!0===n.keepQuotes&&z({type:"text",value:T});continue}if("("===T){N("parens"),z({type:"paren",value:T});continue}if(")"===T){if(0===R.parens&&!0===n.strictBrackets)throw new SyntaxError(yr("opening","("));const t=A[A.length-1];if(t&&R.parens===t.parens+1){M(A.pop());continue}z({type:"paren",value:T,output:R.parens?")":"\\)"}),F("parens");continue}if("["===T){if(!0!==n.nobracket&&I().includes("]"))N("brackets");else{if(!0!==n.nobracket&&!0===n.strictBrackets)throw new SyntaxError(yr("closing","]"));T=`\\${T}`}z({type:"bracket",value:T});continue}if("]"===T){if(!0===n.nobracket||j&&"bracket"===j.type&&1===j.value.length){z({type:"text",value:T,output:`\\${T}`});continue}if(0===R.brackets){if(!0===n.strictBrackets)throw new SyntaxError(yr("opening","["));z({type:"text",value:T,output:`\\${T}`});continue}F("brackets");const t=j.value.slice(1);if(!0===j.posix||"^"!==t[0]||t.includes("/")||(T=`/${T}`),j.value+=T,D({value:T}),!1===n.literalBrackets||ur.hasRegexChars(t))continue;const e=ur.escapeRegex(j.value);if(R.output=R.output.slice(0,-j.value.length),!0===n.literalBrackets){R.output+=e,j.value=e;continue}j.value=`(${s}${e}|${j.value})`,R.output+=j.value;continue}if("{"===T&&!0!==n.nobrace){N("braces");const t={type:"brace",value:T,output:"(",outputIndex:R.output.length,tokensIndex:R.tokens.length};C.push(t),z(t);continue}if("}"===T){const t=C[C.length-1];if(!0===n.nobrace||!t){z({type:"text",value:T,output:T});continue}let e=")";if(!0===t.dots){const t=a.slice(),r=[];for(let e=t.length-1;e>=0&&(a.pop(),"brace"!==t[e].type);e--)"dots"!==t[e].type&&r.unshift(t[e].value);e=mr(r,n),R.backtrack=!0}if(!0!==t.comma&&!0!==t.dots){const n=R.output.slice(0,t.outputIndex),r=R.tokens.slice(t.tokensIndex);t.value=t.output="\\{",T=e="\\}",R.output=n;for(const t of r)R.output+=t.output||t.value}z({type:"brace",value:T,output:e}),F("braces"),C.pop();continue}if("|"===T){A.length>0&&A[A.length-1].conditions++,z({type:"text",value:T});continue}if(","===T){let t=T;const e=C[C.length-1];e&&"braces"===O[O.length-1]&&(e.comma=!0,t="|"),z({type:"comma",value:T,output:t});continue}if("/"===T){if("dot"===j.type&&R.index===R.start+1){R.start=R.index+1,R.consumed="",R.output="",a.pop(),j=i;continue}z({type:"slash",value:T,output:f});continue}if("."===T){if(R.braces>0&&"dot"===j.type){"."===j.value&&(j.output=c);const t=C[C.length-1];j.type="dots",j.output+=T,j.value+=T,t.dots=!0;continue}if(R.braces+R.parens===0&&"bos"!==j.type&&"slash"!==j.type){z({type:"text",value:T,output:c});continue}z({type:"dot",value:T,output:c});continue}if("?"===T){if(!(j&&"("===j.value)&&!0!==n.noextglob&&"("===U()&&"?"!==U(2)){q("qmark",T);continue}if(j&&"paren"===j.type){const t=U();let e=T;("("===j.value&&!/[!=<:]/.test(t)||"<"===t&&!/<([!=]|\w+>)/.test(I()))&&(e=`\\${T}`),z({type:"text",value:T,output:e});continue}if(!0!==n.dot&&("slash"===j.type||"bos"===j.type)){z({type:"qmark",value:T,output:b});continue}z({type:"qmark",value:T,output:g});continue}if("!"===T){if(!0!==n.noextglob&&"("===U()&&("?"!==U(2)||!/[!=<:]/.test(U(3)))){q("negate",T);continue}if(!0!==n.nonegate&&0===R.index){$();continue}}if("+"===T){if(!0!==n.noextglob&&"("===U()&&"?"!==U(2)){q("plus",T);continue}if(j&&"("===j.value||!1===n.regex){z({type:"plus",value:T,output:p});continue}if(j&&("bracket"===j.type||"paren"===j.type||"brace"===j.type)||R.parens>0){z({type:"plus",value:T});continue}z({type:"plus",value:p});continue}if("@"===T){if(!0!==n.noextglob&&"("===U()&&"?"!==U(2)){z({type:"at",extglob:!0,value:T,output:""});continue}z({type:"text",value:T});continue}if("*"!==T){"$"!==T&&"^"!==T||(T=`\\${T}`);const t=fr.exec(I());t&&(T+=t[0],R.index+=t[0].length),z({type:"text",value:T});continue}if(j&&("globstar"===j.type||!0===j.star)){j.type="star",j.star=!0,j.value+=T,j.output=k,R.backtrack=!0,R.globstar=!0,H(T);continue}let e=I();if(!0!==n.noextglob&&/^\([^?]/.test(e)){q("star",T);continue}if("star"===j.type){if(!0===n.noglobstar){H(T);continue}const r=j.prev,o=r.prev,i="slash"===r.type||"bos"===r.type,a=o&&("star"===o.type||"globstar"===o.type);if(!0===n.bash&&(!i||e[0]&&"/"!==e[0])){z({type:"star",value:T,output:""});continue}const s=R.braces>0&&("comma"===r.type||"brace"===r.type),l=A.length&&("pipe"===r.type||"paren"===r.type);if(!i&&"paren"!==r.type&&!s&&!l){z({type:"star",value:T,output:""});continue}for(;"/**"===e.slice(0,3);){const n=t[R.index+4];if(n&&"/"!==n)break;e=e.slice(3),H("/**",3)}if("bos"===r.type&&P()){j.type="globstar",j.value+=T,j.output=w(n),R.output=j.output,R.globstar=!0,H(T);continue}if("slash"===r.type&&"bos"!==r.prev.type&&!a&&P()){R.output=R.output.slice(0,-(r.output+j.output).length),r.output=`(?:${r.output}`,j.type="globstar",j.output=w(n)+(n.strictSlashes?")":"|$)"),j.value+=T,R.globstar=!0,R.output+=r.output+j.output,H(T);continue}if("slash"===r.type&&"bos"!==r.prev.type&&"/"===e[0]){const t=void 0!==e[1]?"|$":"";R.output=R.output.slice(0,-(r.output+j.output).length),r.output=`(?:${r.output}`,j.type="globstar",j.output=`${w(n)}${f}|${f}${t})`,j.value+=T,R.output+=r.output+j.output,R.globstar=!0,H(T+L()),z({type:"slash",value:"/",output:""});continue}if("bos"===r.type&&"/"===e[0]){j.type="globstar",j.value+=T,j.output=`(?:^|${f}|${w(n)}${f})`,R.output=j.output,R.globstar=!0,H(T+L()),z({type:"slash",value:"/",output:""});continue}R.output=R.output.slice(0,-j.output.length),j.type="globstar",j.output=w(n),j.value+=T,R.output+=j.output,R.globstar=!0,H(T);continue}const r={type:"star",value:T,output:k};!0!==n.bash?!j||"bracket"!==j.type&&"paren"!==j.type||!0!==n.regex?(R.index!==R.start&&"slash"!==j.type&&"dot"!==j.type||("dot"===j.type?(R.output+=y,j.output+=y):!0===n.dot?(R.output+=v,j.output+=v):(R.output+=S,j.output+=S),"*"!==U()&&(R.output+=d,j.output+=d)),z(r)):(r.output=T,z(r)):(r.output=".*?","bos"!==j.type&&"slash"!==j.type||(r.output=S+r.output),z(r))}for(;R.brackets>0;){if(!0===n.strictBrackets)throw new SyntaxError(yr("closing","]"));R.output=ur.escapeLast(R.output,"["),F("brackets")}for(;R.parens>0;){if(!0===n.strictBrackets)throw new SyntaxError(yr("closing",")"));R.output=ur.escapeLast(R.output,"("),F("parens")}for(;R.braces>0;){if(!0===n.strictBrackets)throw new SyntaxError(yr("closing","}"));R.output=ur.escapeLast(R.output,"{"),F("braces")}if(!0===n.strictSlashes||"star"!==j.type&&"bracket"!==j.type||z({type:"maybe_slash",value:"",output:`${f}?`}),!0===R.backtrack){R.output="";for(const t of R.tokens)R.output+=null!=t.output?t.output:t.value,t.suffix&&(R.output+=t.suffix)}return R};vr.fastpaths=(t,e)=>{const n={...e},r="number"==typeof n.maxLength?Math.min(cr,n.maxLength):cr,o=t.length;if(o>r)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${r}`);t=hr[t]||t;const{DOT_LITERAL:i,SLASH_LITERAL:a,ONE_CHAR:s,DOTS_SLASH:l,NO_DOT:u,NO_DOTS:c,NO_DOTS_SLASH:p,STAR:f,START_ANCHOR:d}=lr.globChars(),h=n.dot?c:u,m=n.dot?p:u,y=n.capture?"":"?:";let v=!0===n.bash?".*?":f;n.capture&&(v=`(${v})`);const g=t=>!0===t.noglobstar?v:`(${y}(?:(?!${d}${t.dot?l:i}).)*?)`,b=t=>{switch(t){case"*":return`${h}${s}${v}`;case".*":return`${i}${s}${v}`;case"*.*":return`${h}${v}${i}${s}${v}`;case"*/*":return`${h}${v}${a}${s}${m}${v}`;case"**":return h+g(n);case"**/*":return`(?:${h}${g(n)}${a})?${m}${s}${v}`;case"**/*.*":return`(?:${h}${g(n)}${a})?${m}${v}${i}${s}${v}`;case"**/.*":return`(?:${h}${g(n)}${a})?${i}${s}${v}`;default:{const e=/^(.*?)\.(\w+)$/.exec(t);if(!e)return;const n=b(e[1]);if(!n)return;return n+i+e[2]}}},x=ur.removePrefix(t,{negated:!1,prefix:""});let _=b(x);return _&&!0!==n.strictSlashes&&(_+=`${a}?`),_};const gr=Tn,br=sr,xr=vr,_r=jn,wr=qn,Sr=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(t)){const r=t.map((t=>Sr(t,e,n))),o=t=>{for(const e of r){const n=e(t);if(n)return n}return!1};return o}const r=(o=t)&&"object"==typeof o&&!Array.isArray(o)&&t.tokens&&t.input;var o;if(""===t||"string"!=typeof t&&!r)throw new TypeError("Expected pattern to be a non-empty string");const i=e||{},a=_r.isWindows(e),s=r?Sr.compileRe(t,e):Sr.makeRe(t,e,!1,!0),l=s.state;delete s.state;let u=()=>!1;if(i.ignore){const t={...e,ignore:null,onMatch:null,onResult:null};u=Sr(i.ignore,t,n)}const c=function(n){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{isMatch:o,match:c,output:p}=Sr.test(n,s,e,{glob:t,posix:a}),f={glob:t,state:l,regex:s,posix:a,input:n,output:p,match:c,isMatch:o};return"function"==typeof i.onResult&&i.onResult(f),!1===o?(f.isMatch=!1,!!r&&f):u(n)?("function"==typeof i.onIgnore&&i.onIgnore(f),f.isMatch=!1,!!r&&f):("function"==typeof i.onMatch&&i.onMatch(f),!r||f)};return n&&(c.state=l),c};Sr.test=function(t,e,n){let{glob:r,posix:o}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if("string"!=typeof t)throw new TypeError("Expected input to be a string");if(""===t)return{isMatch:!1,output:""};const i=n||{},a=i.format||(o?_r.toPosixSlashes:null);let s=t===r,l=s&&a?a(t):t;return!1===s&&(l=a?a(t):t,s=l===r),!1!==s&&!0!==i.capture||(s=!0===i.matchBase||!0===i.basename?Sr.matchBase(t,e,n,o):e.exec(l)),{isMatch:Boolean(s),match:s,output:l}},Sr.matchBase=function(t,e,n){arguments.length>3&&void 0!==arguments[3]||_r.isWindows(n);return(e instanceof RegExp?e:Sr.makeRe(e,n)).test(gr.basename(t))},Sr.isMatch=(t,e,n)=>Sr(e,n)(t),Sr.parse=(t,e)=>Array.isArray(t)?t.map((t=>Sr.parse(t,e))):xr(t,{...e,fastpaths:!1}),Sr.scan=(t,e)=>br(t,e),Sr.compileRe=function(t,e){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!0===(arguments.length>2&&void 0!==arguments[2]&&arguments[2]))return t.output;const r=e||{},o=r.contains?"":"^",i=r.contains?"":"$";let a=`${o}(?:${t.output})${i}`;t&&!0===t.negated&&(a=`^(?!${a}).*$`);const s=Sr.toRegex(a,e);return!0===n&&(s.state=t),s},Sr.makeRe=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!t||"string"!=typeof t)throw new TypeError("Expected a non-empty string");let o={negated:!1,fastpaths:!0};return!1===e.fastpaths||"."!==t[0]&&"*"!==t[0]||(o.output=xr.fastpaths(t,e)),o.output||(o=xr(t,e)),Sr.compileRe(o,e,n,r)},Sr.toRegex=(t,e)=>{try{const n=e||{};return new RegExp(t,n.flags||(n.nocase?"i":""))}catch(t){if(e&&!0===e.debug)throw t;return/$^/}},Sr.constants=wr;var Er=c(Sr);class kr{constructor(t){r(this,"extensions",void 0),r(this,"mimeTypes",void 0);const[e,n]=(t=>{const e=[],n=[];return t.split(",").map((t=>t.trim())).filter(Boolean).forEach((t=>{t.startsWith(".")?e.push(`*${t}`):n.push(t)})),[e,n]})(t);this.extensions=e,this.mimeTypes=n}isAccepted(t){return 0===this.extensions.length&&0===this.mimeTypes.length||(this.isMimeTypeAccepted(y.getType(t))||this.isExtensionAccepted(t))}isMimeTypeAccepted(t){return!(!t||0===this.mimeTypes.length)&&Er.isMatch(t,this.mimeTypes)}isExtensionAccepted(t){return 0!==this.extensions.length&&Er.isMatch(t,this.extensions)}}const Rr=async t=>new Promise(((e,n)=>t.createReader().readEntries(e,n))),Ar=async t=>new Promise(((e,n)=>t.file(e,n))),Cr=async t=>{const e=[];for await(const n of t)if(n.isFile){const t=await Ar(n);e.push(t)}else if(n.isDirectory){const t=await Rr(n);(await Cr(t)).forEach((t=>e.push(t)))}return e};class Or{constructor(t){let{container:e,inputAccept:n,onUploadFiles:o,renderer:i}=t;r(this,"acceptedFileTypes",void 0),r(this,"container",void 0),r(this,"onUploadFiles",void 0),r(this,"renderer",void 0),r(this,"onDrop",(t=>{const e=t;this.container.classList.remove("dff-dropping"),e.preventDefault(),e.stopPropagation();(async()=>{try{if(e.dataTransfer){const t=await(async t=>{if(t.items){const e=[...t.items].map((t=>t.webkitGetAsEntry()));return await Cr(e)}return[...t.files]})(e.dataTransfer),n=[],r=[];for(const e of t)this.acceptedFileTypes.isAccepted(e.name)?n.push(e):r.push(e);this.renderer.setErrorInvalidFiles(r),this.onUploadFiles(n)}}catch(t){console.error(t)}})()})),this.container=e,this.onUploadFiles=o,this.acceptedFileTypes=new kr(n),this.renderer=i,e.addEventListener("dragenter",(()=>{e.classList.add("dff-dropping")})),e.addEventListener("dragleave",(()=>{e.classList.remove("dff-dropping")})),e.addEventListener("dragover",(t=>{e.classList.add("dff-dropping"),t.preventDefault()})),e.addEventListener("drop",this.onDrop)}}let Tr=class{constructor(t){let{name:e,status:n,type:o,uploadIndex:i}=t;r(this,"name",void 0),r(this,"status",void 0),r(this,"type",void 0),r(this,"uploadIndex",void 0),this.name=e,this.status=n,this.type=o,this.uploadIndex=i}async abort(){}async delete(){}};function jr(){return function(t){var e=[];if(0===t.length)return"";if("string"!=typeof t[0])throw new TypeError("Url must be a string. Received "+t[0]);if(t[0].match(/^[^/:]+:\/*$/)&&t.length>1){var n=t.shift();t[0]=n+t[0]}t[0].match(/^file:\/\/\//)?t[0]=t[0].replace(/^([^/:]+):\/*/,"$1:///"):t[0]=t[0].replace(/^([^/:]+):\/*/,"$1://");for(var r=0;r<t.length;r++){var o=t[r];if("string"!=typeof o)throw new TypeError("Url must be a string. Received "+o);""!==o&&(r>0&&(o=o.replace(/^[\/]+/,"")),o=r<t.length-1?o.replace(/[\/]+$/,""):o.replace(/[\/]+$/,"/"),e.push(o))}var i=e.join("/"),a=(i=i.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return a.shift()+(a.length>0?"?":"")+a.join("&")}("object"==typeof arguments[0]?arguments[0]:[].slice.call(arguments))}const Pr=(t,e)=>{const n=t.indexOf(e);-1!==n&&t.splice(n,1)};class Ur extends Tr{constructor(t){let{csrfToken:e,endpoint:n,file:o,s3UploadDir:i,uploadIndex:a}=t;super({name:o.name,status:"uploading",type:"s3",uploadIndex:a}),r(this,"onError",void 0),r(this,"onProgress",void 0),r(this,"onSuccess",void 0),r(this,"chunkState",void 0),r(this,"chunks",void 0),r(this,"createdPromise",void 0),r(this,"csrfToken",void 0),r(this,"endpoint",void 0),r(this,"file",void 0),r(this,"key",void 0),r(this,"parts",void 0),r(this,"s3UploadDir",void 0),r(this,"uploadId",void 0),r(this,"uploading",void 0),this.csrfToken=e,this.endpoint=n,this.file=o,this.s3UploadDir=i,this.key=null,this.uploadId=null,this.parts=[],this.createdPromise=Promise.reject(),this.chunks=[],this.chunkState=[],this.uploading=[],this.onError=void 0,this.onProgress=void 0,this.onSuccess=void 0,this.initChunks(),this.createdPromise.catch((()=>({})))}async abort(){this.uploading.slice().forEach((t=>{t.abort()})),this.uploading=[],await this.createdPromise,this.key&&this.uploadId&&await(t=>{let{csrfToken:e,key:n,uploadId:r,endpoint:o}=t;const i=encodeURIComponent(n),a=encodeURIComponent(r),s=new Headers({"X-CSRFToken":e}),l=jr(o,a,`?key=${i}`);return fetch(l,{method:"delete",headers:s}).then((t=>t.json()))})({csrfToken:this.csrfToken,endpoint:this.endpoint,key:this.key,uploadId:this.uploadId})}async delete(){return Promise.resolve()}getId(){return this.uploadId||void 0}getInitialFile(){return{id:this.uploadId||"",name:this.key||"",size:this.file.size,original_name:this.file.name,type:"s3"}}getSize(){return this.file.size}start(){this.createUpload()}initChunks(){const t=[],e=(n=this.file,Math.ceil(n.size/1e4));var n;const r=Math.max(5242880,Math.ceil(this.file.size/1e4)),o=Math.max(e,r);for(let e=0;e<this.file.size;e+=o){const n=Math.min(this.file.size,e+o);t.push(this.file.slice(e,n))}this.chunks=t,this.chunkState=t.map((()=>({uploaded:0,busy:!1,done:!1})))}createUpload(){return this.createdPromise=(t=>{let{csrfToken:e,endpoint:n,file:r,s3UploadDir:o}=t;const i=new Headers({accept:"application/json","content-type":"application/json","X-CSRFToken":e});return fetch(n,{method:"post",headers:i,body:JSON.stringify({filename:r.name,contentType:r.type,s3UploadDir:o})}).then((t=>t.json())).then((t=>t))})({csrfToken:this.csrfToken,endpoint:this.endpoint,file:this.file,s3UploadDir:this.s3UploadDir}),this.createdPromise.then((t=>{if(!("object"==typeof t&&t&&"string"==typeof t.uploadId&&"string"==typeof t.key))throw new TypeError("AwsS3/Multipart: Got incorrect result from `createMultipartUpload()`, expected an object `{ uploadId, key }`.");this.key=t.key,this.uploadId=t.uploadId,this.uploadParts()})).catch((t=>{this.handleError(t)}))}uploadParts(){const t=1-this.uploading.length;if(0===t)return;if(this.chunkState.every((t=>t.done)))return void this.completeUpload();const e=[];for(let n=0;n<this.chunkState.length;n++){const r=this.chunkState[n];if(r&&!r.done&&!r.busy&&(e.push(n),e.length>=t))break}e.forEach((t=>{this.uploadPart(t)}))}uploadPart(t){const e=this.chunkState[t];return e&&(e.busy=!0),this.key&&this.uploadId?(t=>{let{csrfToken:e,endpoint:n,key:r,number:o,uploadId:i}=t;const a=encodeURIComponent(r),s=new Headers({"X-CSRFToken":e}),l=jr(n,i,`${o}`,`?key=${a}`);return fetch(l,{method:"get",headers:s}).then((t=>t.json())).then((t=>t))})({csrfToken:this.csrfToken,endpoint:this.endpoint,key:this.key,number:t+1,uploadId:this.uploadId}).then((t=>{if(!("object"==typeof t&&t&&"string"==typeof t.url))throw new TypeError("AwsS3/Multipart: Got incorrect result from `prepareUploadPart()`, expected an object `{ url }`.");return t})).then((e=>{let{url:n}=e;this.uploadPartBytes(t,n)}),(t=>{this.handleError(t)})):Promise.resolve()}onPartProgress(t,e){const n=this.chunkState[t];if(n&&(n.uploaded=e),this.onProgress){const t=this.chunkState.reduce(((t,e)=>t+e.uploaded),0);this.onProgress(t,this.file.size)}}onPartComplete(t,e){const n=this.chunkState[t];n&&(n.etag=e,n.done=!0);const r={PartNumber:t+1,ETag:e};this.parts.push(r),this.uploadParts()}uploadPartBytes(t,e){const n=this.chunks[t],r=new XMLHttpRequest;r.open("PUT",e,!0),r.responseType="text",this.uploading.push(r),r.upload.addEventListener("progress",(e=>{e.lengthComputable&&this.onPartProgress(t,e.loaded)})),r.addEventListener("abort",(e=>{Pr(this.uploading,e.target);const n=this.chunkState[t];n&&(n.busy=!1)})),r.addEventListener("load",(e=>{const r=e.target;Pr(this.uploading,r);const o=this.chunkState[t];if(o&&(o.busy=!1),r.status<200||r.status>=300)return void this.handleError(new Error("Non 2xx"));this.onPartProgress(t,n?.size||0);const i=r.getResponseHeader("ETag");null!==i?this.onPartComplete(t,i):this.handleError(new Error("AwsS3/Multipart: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions."))})),r.addEventListener("error",(e=>{Pr(this.uploading,e.target);const n=this.chunkState[t];n&&(n.busy=!1);const r=new Error("Unknown error");this.handleError(r)})),r.send(n)}completeUpload(){return this.parts.sort(((t,e)=>t.PartNumber-e.PartNumber)),this.uploadId&&this.key?(t=>{let{csrfToken:e,key:n,uploadId:r,parts:o,endpoint:i}=t;const a=encodeURIComponent(n),s=encodeURIComponent(r),l=new Headers({"X-CSRFToken":e}),u=jr(i,s,"complete",`?key=${a}`);return fetch(u,{method:"post",headers:l,body:JSON.stringify({parts:o})}).then((t=>t.json())).then((t=>t))})({csrfToken:this.csrfToken,endpoint:this.endpoint,key:this.key,uploadId:this.uploadId,parts:this.parts}).then((()=>{this.onSuccess&&this.onSuccess()}),(t=>{this.handleError(t)})):Promise.resolve()}handleError(t){if(!this.onError)throw t;this.onError(t)}}const Lr=async(t,e)=>new Promise(((n,r)=>{const o=new XMLHttpRequest;o.open("DELETE",t),o.onload=()=>{204===o.status?n():r()},o.setRequestHeader("Tus-Resumable","1.0.0"),o.setRequestHeader("X-CSRFToken",e),o.send(null)}));class Ir extends Tr{constructor(t){let{name:e,size:n,type:o,uploadIndex:i}=t;super({name:e,status:"done",type:o,uploadIndex:i}),r(this,"size",void 0),this.size=n}async abort(){return Promise.resolve()}async delete(){return Promise.resolve()}getSize(){return this.size}}class Hr extends Ir{constructor(t,e){super({name:t.name,size:t.size,type:"placeholder",uploadIndex:e}),r(this,"id",void 0),this.id=t.id}getId(){}getInitialFile(){return{id:this.id,name:this.name,size:this.size,type:"placeholder"}}}class Dr extends Ir{constructor(t,e){super({name:t.original_name||t.name,size:t.size,type:"uploadedS3",uploadIndex:e}),r(this,"id",void 0),r(this,"key",void 0),this.id=t.id,this.key=t.name}getId(){return this.id}getInitialFile(){return{id:this.id,name:this.key,original_name:this.name,size:this.size,type:"s3"}}}class $r extends Ir{constructor(t,e){super({name:t.name,size:t.size,type:"existing",uploadIndex:e})}getId(){}getInitialFile(){return{name:this.name,size:this.size,type:"existing"}}}class Nr extends Ir{constructor(t){let{csrfToken:e,initialFile:n,uploadIndex:o,uploadUrl:i}=t;super({name:n.name,size:n.size,type:"uploadedTus",uploadIndex:o}),r(this,"csrfToken",void 0),r(this,"id",void 0),r(this,"url",void 0),this.csrfToken=e,this.id=n.id,this.url=`${i}${n.id}`}async delete(){await Lr(this.url,this.csrfToken)}getId(){return this.id}getInitialFile(){return{id:this.id,name:this.name,size:this.size,type:"tus",url:""}}}const Fr="function"==typeof btoa,zr="function"==typeof Buffer,qr=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder?new TextEncoder:void 0),Mr=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),Br=((t=>{let e={};t.forEach(((t,n)=>e[t]=n))})(Mr),String.fromCharCode.bind(String)),Gr=("function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),t=>t.replace(/=/g,"").replace(/[+\/]/g,(t=>"+"==t?"-":"_"))),Kr=t=>{let e,n,r,o,i="";const a=t.length%3;for(let a=0;a<t.length;){if((n=t.charCodeAt(a++))>255||(r=t.charCodeAt(a++))>255||(o=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=n<<16|r<<8|o,i+=Mr[e>>18&63]+Mr[e>>12&63]+Mr[e>>6&63]+Mr[63&e]}return a?i.slice(0,a-3)+"===".substring(a):i},Xr=Fr?t=>btoa(t):zr?t=>Buffer.from(t,"binary").toString("base64"):Kr,Qr=zr?t=>Buffer.from(t).toString("base64"):t=>{let e=[];for(let n=0,r=t.length;n<r;n+=4096)e.push(Br.apply(null,t.subarray(n,n+4096)));return Xr(e.join(""))},Wr=t=>{if(t.length<2)return(e=t.charCodeAt(0))<128?t:e<2048?Br(192|e>>>6)+Br(128|63&e):Br(224|e>>>12&15)+Br(128|e>>>6&63)+Br(128|63&e);var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return Br(240|e>>>18&7)+Br(128|e>>>12&63)+Br(128|e>>>6&63)+Br(128|63&e)},Yr=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Zr=t=>t.replace(Yr,Wr),Jr=zr?t=>Buffer.from(t,"utf8").toString("base64"):qr?t=>Qr(qr.encode(t)):t=>Xr(Zr(t)),Vr=(t,e=!1)=>e?Gr(Jr(t)):Jr(t),to=Vr;var eo={},no=Object.prototype.hasOwnProperty;function ro(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}function oo(t){try{return encodeURIComponent(t)}catch(t){return null}}eo.stringify=function(t,e){e=e||"";var n,r,o=[];for(r in"string"!=typeof e&&(e="?"),t)if(no.call(t,r)){if((n=t[r])||null!=n&&!isNaN(n)||(n=""),r=oo(r),n=oo(n),null===r||null===n)continue;o.push(r+"="+n)}return o.length?e+o.join("&"):""},eo.parse=function(t){for(var e,n=/([^=?#&]+)=?([^&]*)/g,r={};e=n.exec(t);){var o=ro(e[1]),i=ro(e[2]);null===o||null===i||o in r||(r[o]=i)}return r};var io=function(t,e){if(e=e.split(":")[0],!(t=+t))return!1;switch(e){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t},ao=eo,so=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,lo=/[\n\r\t]/g,uo=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,co=/:\d+$/,po=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,fo=/^[a-zA-Z]:/;function ho(t){return(t||"").toString().replace(so,"")}var mo=[["#","hash"],["?","query"],function(t,e){return go(e.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],yo={hash:1,query:1};function vo(t){var e,n=("undefined"!=typeof window?window:void 0!==u?u:"undefined"!=typeof self?self:{}).location||{},r={},o=typeof(t=t||n);if("blob:"===t.protocol)r=new xo(unescape(t.pathname),{});else if("string"===o)for(e in r=new xo(t,{}),yo)delete r[e];else if("object"===o){for(e in t)e in yo||(r[e]=t[e]);void 0===r.slashes&&(r.slashes=uo.test(t.href))}return r}function go(t){return"file:"===t||"ftp:"===t||"http:"===t||"https:"===t||"ws:"===t||"wss:"===t}function bo(t,e){t=(t=ho(t)).replace(lo,""),e=e||{};var n,r=po.exec(t),o=r[1]?r[1].toLowerCase():"",i=!!r[2],a=!!r[3],s=0;return i?a?(n=r[2]+r[3]+r[4],s=r[2].length+r[3].length):(n=r[2]+r[4],s=r[2].length):a?(n=r[3]+r[4],s=r[3].length):n=r[4],"file:"===o?s>=2&&(n=n.slice(2)):go(o)?n=r[4]:o?i&&(n=n.slice(2)):s>=2&&go(e.protocol)&&(n=r[4]),{protocol:o,slashes:i||go(o),slashesCount:s,rest:n}}function xo(t,e,n){if(t=(t=ho(t)).replace(lo,""),!(this instanceof xo))return new xo(t,e,n);var r,o,i,a,s,l,u=mo.slice(),c=typeof e,p=this,f=0;for("object"!==c&&"string"!==c&&(n=e,e=null),n&&"function"!=typeof n&&(n=ao.parse),r=!(o=bo(t||"",e=vo(e))).protocol&&!o.slashes,p.slashes=o.slashes||r&&e.slashes,p.protocol=o.protocol||e.protocol||"",t=o.rest,("file:"===o.protocol&&(2!==o.slashesCount||fo.test(t))||!o.slashes&&(o.protocol||o.slashesCount<2||!go(p.protocol)))&&(u[3]=[/(.*)/,"pathname"]);f<u.length;f++)"function"!=typeof(a=u[f])?(i=a[0],l=a[1],i!=i?p[l]=t:"string"==typeof i?~(s="@"===i?t.lastIndexOf(i):t.indexOf(i))&&("number"==typeof a[2]?(p[l]=t.slice(0,s),t=t.slice(s+a[2])):(p[l]=t.slice(s),t=t.slice(0,s))):(s=i.exec(t))&&(p[l]=s[1],t=t.slice(0,s.index)),p[l]=p[l]||r&&a[3]&&e[l]||"",a[4]&&(p[l]=p[l].toLowerCase())):t=a(t,p);n&&(p.query=n(p.query)),r&&e.slashes&&"/"!==p.pathname.charAt(0)&&(""!==p.pathname||""!==e.pathname)&&(p.pathname=function(t,e){if(""===t)return e;for(var n=(e||"/").split("/").slice(0,-1).concat(t.split("/")),r=n.length,o=n[r-1],i=!1,a=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),a++):a&&(0===r&&(i=!0),n.splice(r,1),a--);return i&&n.unshift(""),"."!==o&&".."!==o||n.push(""),n.join("/")}(p.pathname,e.pathname)),"/"!==p.pathname.charAt(0)&&go(p.protocol)&&(p.pathname="/"+p.pathname),io(p.port,p.protocol)||(p.host=p.hostname,p.port=""),p.username=p.password="",p.auth&&(~(s=p.auth.indexOf(":"))?(p.username=p.auth.slice(0,s),p.username=encodeURIComponent(decodeURIComponent(p.username)),p.password=p.auth.slice(s+1),p.password=encodeURIComponent(decodeURIComponent(p.password))):p.username=encodeURIComponent(decodeURIComponent(p.auth)),p.auth=p.password?p.username+":"+p.password:p.username),p.origin="file:"!==p.protocol&&go(p.protocol)&&p.host?p.protocol+"//"+p.host:"null",p.href=p.toString()}xo.prototype={set:function(t,e,n){var r=this;switch(t){case"query":"string"==typeof e&&e.length&&(e=(n||ao.parse)(e)),r[t]=e;break;case"port":r[t]=e,io(e,r.protocol)?e&&(r.host=r.hostname+":"+e):(r.host=r.hostname,r[t]="");break;case"hostname":r[t]=e,r.port&&(e+=":"+r.port),r.host=e;break;case"host":r[t]=e,co.test(e)?(e=e.split(":"),r.port=e.pop(),r.hostname=e.join(":")):(r.hostname=e,r.port="");break;case"protocol":r.protocol=e.toLowerCase(),r.slashes=!n;break;case"pathname":case"hash":if(e){var o="pathname"===t?"/":"#";r[t]=e.charAt(0)!==o?o+e:e}else r[t]=e;break;case"username":case"password":r[t]=encodeURIComponent(e);break;case"auth":var i=e.indexOf(":");~i?(r.username=e.slice(0,i),r.username=encodeURIComponent(decodeURIComponent(r.username)),r.password=e.slice(i+1),r.password=encodeURIComponent(decodeURIComponent(r.password))):r.username=encodeURIComponent(decodeURIComponent(e))}for(var a=0;a<mo.length;a++){var s=mo[a];s[4]&&(r[s[1]]=r[s[1]].toLowerCase())}return r.auth=r.password?r.username+":"+r.password:r.username,r.origin="file:"!==r.protocol&&go(r.protocol)&&r.host?r.protocol+"//"+r.host:"null",r.href=r.toString(),r},toString:function(t){t&&"function"==typeof t||(t=ao.stringify);var e,n=this,r=n.host,o=n.protocol;o&&":"!==o.charAt(o.length-1)&&(o+=":");var i=o+(n.protocol&&n.slashes||go(n.protocol)?"//":"");return n.username?(i+=n.username,n.password&&(i+=":"+n.password),i+="@"):n.password?(i+=":"+n.password,i+="@"):"file:"!==n.protocol&&go(n.protocol)&&!r&&"/"!==n.pathname&&(i+="@"),(":"===r[r.length-1]||co.test(n.hostname)&&!n.port)&&(r+=":"),i+=r+n.pathname,(e="object"==typeof n.query?t(n.query):n.query)&&(i+="?"!==e.charAt(0)?"?"+e:e),n.hash&&(i+=n.hash),i}},xo.extractProtocol=bo,xo.location=vo,xo.trimLeft=ho,xo.qs=ao;var _o=c(xo);function wo(t){return wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wo(t)}function So(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Eo(r.key),r)}}function Eo(t){var e=function(t,e){if("object"!==wo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==wo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===wo(e)?e:String(e)}function ko(t){var e=Co();return function(){var n,r=To(t);if(e){var o=To(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===wo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Ro(t){var e="function"==typeof Map?new Map:void 0;return Ro=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return Ao(t,arguments,To(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Oo(r,t)},Ro(t)}function Ao(t,e,n){return Ao=Co()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&Oo(o,n.prototype),o},Ao.apply(null,arguments)}function Co(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Oo(t,e){return Oo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Oo(t,e)}function To(t){return To=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},To(t)}var jo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Oo(t,e)}(i,t);var e,n,r,o=ko(i);function i(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,t)).originalRequest=r,e.originalResponse=a,e.causingError=n,null!=n&&(t+=", caused by ".concat(n.toString())),null!=r){var s=r.getHeader("X-Request-ID")||"n/a",l=r.getMethod(),u=r.getURL(),c=a?a.getStatus():"n/a",p=a?a.getBody()||"":"n/a";t+=", originated from request (method: ".concat(l,", url: ").concat(u,", response code: ").concat(c,", response text: ").concat(p,", request id: ").concat(s,")")}return e.message=t,e}return e=i,n&&So(e.prototype,n),r&&So(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Ro(Error));function Po(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
Po=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function u(t,e,n,o){var i=e&&e.prototype instanceof f?e:f,a=Object.create(i.prototype),s=new k(o||[]);return r(a,"_invoke",{value:_(t,n,s)}),a}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var p={};function f(){}function d(){}function h(){}var m={};l(m,i,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(R([])));v&&v!==e&&n.call(v,i)&&(m=v);var g=h.prototype=f.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function o(r,i,a,s){var l=c(t[r],t,i);if("throw"!==l.type){var u=l.arg,p=u.value;return p&&"object"==Ho(p)&&n.call(p,"__await")?e.resolve(p.__await).then((function(t){o("next",t,a,s)}),(function(t){o("throw",t,a,s)})):e.resolve(p).then((function(t){u.value=t,a(u)}),(function(t){return o("throw",t,a,s)}))}s(l.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function _(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return A()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=c(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===p)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var o=c(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function R(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:A}}function A(){return{value:void 0,done:!0}}return d.prototype=h,r(g,"constructor",{value:h,configurable:!0}),r(h,"constructor",{value:d,configurable:!0}),d.displayName=l(h,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,l(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(x.prototype),l(x.prototype,a,(function(){return this})),t.AsyncIterator=x,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new x(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),l(g,s,"Generator"),l(g,i,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=R,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;E(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:R(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},t}function Uo(t,e,n,r,o,i,a){try{var s=t[i](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,o)}function Lo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);l=!0);}catch(t){u=!0,o=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Io(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Io(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Io(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ho(t){return Ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ho(t)}function Do(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Do(Object(n),!0).forEach((function(e){No(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Do(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function No(t,e,n){return(e=zo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zo(r.key),r)}}function zo(t){var e=function(t,e){if("object"!==Ho(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Ho(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Ho(e)?e:String(e)}var qo={endpoint:null,uploadUrl:null,metadata:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:null,chunkSize:1/0,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null},Mo=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"resume"in n&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=n,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=e,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}var e,n,r;return e=t,n=[{key:"findPreviousUploads",value:function(){var t=this;return this.options.fingerprint(this.file,this.options).then((function(e){return t._urlStorage.findUploadsByFingerprint(e)}))}},{key:"resumeFromPreviousUpload",value:function(t){this.url=t.uploadUrl||null,this._parallelUploadUrls=t.parallelUploadUrls||null,this._urlStorageKey=t.urlStorageKey}},{key:"start",value:function(){var t=this,e=this.file;if(e)if(this.options.endpoint||this.options.uploadUrl||this.url){var n=this.options.retryDelays;if(null==n||"[object Array]"===Object.prototype.toString.call(n)){if(this.options.parallelUploads>1)for(var r=0,o=["uploadUrl","uploadSize","uploadLengthDeferred"];r<o.length;r++){var i=o[r];if(this.options[i])return void this._emitError(new Error("tus: cannot use the ".concat(i," option when parallelUploads is enabled")))}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1)return void this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length)return void this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"))}this.options.fingerprint(e,this.options).then((function(n){return t._fingerprint=n,t._source?t._source:t.options.fileReader.openFile(e,t.options.chunkSize)})).then((function(e){if(t._source=e,t.options.uploadLengthDeferred)t._size=null;else if(null!=t.options.uploadSize){if(t._size=Number(t.options.uploadSize),Number.isNaN(t._size))return void t._emitError(new Error("tus: cannot convert `uploadSize` option into a number"))}else if(t._size=t._source.size,null==t._size)return void t._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));t.options.parallelUploads>1||null!=t._parallelUploadUrls?t._startParallelUpload():t._startSingleUpload()})).catch((function(e){t._emitError(e)}))}else this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"))}else this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));else this._emitError(new Error("tus: no file or stream to upload provided"))}},{key:"_startParallelUpload",value:function(){var e,n=this,r=this._size,o=0;this._parallelUploads=[];var i=null!=this._parallelUploadUrls?this._parallelUploadUrls.length:this.options.parallelUploads,a=null!==(e=this.options.parallelUploadBoundaries)&&void 0!==e?e:function(t,e){for(var n=Math.floor(t/e),r=[],o=0;o<e;o++)r.push({start:n*o,end:n*(o+1)});return r[e-1].end=t,r}(this._source.size,i);this._parallelUploadUrls&&a.forEach((function(t,e){t.uploadUrl=n._parallelUploadUrls[e]||null})),this._parallelUploadUrls=new Array(a.length);var s,l=a.map((function(e,i){var s=0;return n._source.slice(e.start,e.end).then((function(l){var u=l.value;return new Promise((function(l,c){var p=$o($o({},n.options),{},{uploadUrl:e.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:{},headers:$o($o({},n.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:l,onError:c,onProgress:function(t){o=o-s+t,s=t,n._emitProgress(o,r)},onUploadUrlAvailable:function(){n._parallelUploadUrls[i]=f.url,n._parallelUploadUrls.filter((function(t){return Boolean(t)})).length===a.length&&n._saveUploadInUrlStorage()}}),f=new t(u,p);f.start(),n._parallelUploads.push(f)}))}))}));Promise.all(l).then((function(){(s=n._openRequest("POST",n.options.endpoint)).setHeader("Upload-Concat","final;".concat(n._parallelUploadUrls.join(" ")));var t=Bo(n.options.metadata);return""!==t&&s.setHeader("Upload-Metadata",t),n._sendRequest(s,null)})).then((function(t){if(Go(t.getStatus(),200)){var e=t.getHeader("Location");null!=e?(n.url=Yo(n.options.endpoint,e),"Created upload at ".concat(n.url),n._emitSuccess()):n._emitHttpError(s,t,"tus: invalid or missing Location header")}else n._emitHttpError(s,t,"tus: unexpected response while creating upload")})).catch((function(t){n._emitError(t)}))}},{key:"_startSingleUpload",value:function(){return this._aborted=!1,null!=this.url?("Resuming upload from previous URL: ".concat(this.url),void this._resumeUpload()):null!=this.options.uploadUrl?("Resuming upload from provided URL: ".concat(this.options.uploadUrl),this.url=this.options.uploadUrl,void this._resumeUpload()):void this._createUpload()}},{key:"abort",value:function(e){var n=this;return null!=this._parallelUploads&&this._parallelUploads.forEach((function(t){t.abort(e)})),null!==this._req&&this._req.abort(),this._aborted=!0,null!=this._retryTimeout&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),e&&null!=this.url?t.terminate(this.url,this.options).then((function(){return n._removeFromUrlStorage()})):Promise.resolve()}},{key:"_emitHttpError",value:function(t,e,n,r){this._emitError(new jo(n,r,t,e))}},{key:"_emitError",value:function(t){var e=this;if(!this._aborted){if(null!=this.options.retryDelays&&(null!=this._offset&&this._offset>this._offsetBeforeRetry&&(this._retryAttempt=0),Wo(t,this._retryAttempt,this.options))){var n=this.options.retryDelays[this._retryAttempt++];return this._offsetBeforeRetry=this._offset,void(this._retryTimeout=setTimeout((function(){e.start()}),n))}if("function"!=typeof this.options.onError)throw t;this.options.onError(t)}}},{key:"_emitSuccess",value:function(){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),"function"==typeof this.options.onSuccess&&this.options.onSuccess()}},{key:"_emitProgress",value:function(t,e){"function"==typeof this.options.onProgress&&this.options.onProgress(t,e)}},{key:"_emitChunkComplete",value:function(t,e,n){"function"==typeof this.options.onChunkComplete&&this.options.onChunkComplete(t,e,n)}},{key:"_createUpload",value:function(){var t=this;if(this.options.endpoint){var e=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?e.setHeader("Upload-Defer-Length",1):e.setHeader("Upload-Length",this._size);var n,r=Bo(this.options.metadata);""!==r&&e.setHeader("Upload-Metadata",r),this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,n=this._addChunkToRequest(e)):n=this._sendRequest(e,null),n.then((function(n){if(Go(n.getStatus(),200)){var r=n.getHeader("Location");if(null!=r){if(t.url=Yo(t.options.endpoint,r),"Created upload at ".concat(t.url),"function"==typeof t.options.onUploadUrlAvailable&&t.options.onUploadUrlAvailable(),0===t._size)return t._emitSuccess(),void t._source.close();t._saveUploadInUrlStorage().then((function(){t.options.uploadDataDuringCreation?t._handleUploadResponse(e,n):(t._offset=0,t._performUpload())}))}else t._emitHttpError(e,n,"tus: invalid or missing Location header")}else t._emitHttpError(e,n,"tus: unexpected response while creating upload")})).catch((function(n){t._emitHttpError(e,null,"tus: failed to create upload",n)}))}else this._emitError(new Error("tus: unable to create upload because no endpoint is provided"))}},{key:"_resumeUpload",value:function(){var t=this,e=this._openRequest("HEAD",this.url);this._sendRequest(e,null).then((function(n){var r=n.getStatus();if(!Go(r,200))return 423===r?void t._emitHttpError(e,n,"tus: upload is currently locked; retry later"):(Go(r,400)&&t._removeFromUrlStorage(),t.options.endpoint?(t.url=null,void t._createUpload()):void t._emitHttpError(e,n,"tus: unable to resume upload (new upload cannot be created without an endpoint)"));var o=parseInt(n.getHeader("Upload-Offset"),10);if(Number.isNaN(o))t._emitHttpError(e,n,"tus: invalid or missing offset value");else{var i=parseInt(n.getHeader("Upload-Length"),10);!Number.isNaN(i)||t.options.uploadLengthDeferred?("function"==typeof t.options.onUploadUrlAvailable&&t.options.onUploadUrlAvailable(),t._saveUploadInUrlStorage().then((function(){if(o===i)return t._emitProgress(i,i),void t._emitSuccess();t._offset=o,t._performUpload()}))):t._emitHttpError(e,n,"tus: invalid or missing length value")}})).catch((function(n){t._emitHttpError(e,null,"tus: failed to resume upload",n)}))}},{key:"_performUpload",value:function(){var t,e=this;this._aborted||(this.options.overridePatchMethod?(t=this._openRequest("POST",this.url)).setHeader("X-HTTP-Method-Override","PATCH"):t=this._openRequest("PATCH",this.url),t.setHeader("Upload-Offset",this._offset),this._addChunkToRequest(t).then((function(n){Go(n.getStatus(),200)?e._handleUploadResponse(t,n):e._emitHttpError(t,n,"tus: unexpected response while uploading chunk")})).catch((function(n){e._aborted||e._emitHttpError(t,null,"tus: failed to upload chunk at offset ".concat(e._offset),n)})))}},{key:"_addChunkToRequest",value:function(t){var e=this,n=this._offset,r=this._offset+this.options.chunkSize;return t.setProgressHandler((function(t){e._emitProgress(n+t,e._size)})),t.setHeader("Content-Type","application/offset+octet-stream"),(r===1/0||r>this._size)&&!this.options.uploadLengthDeferred&&(r=this._size),this._source.slice(n,r).then((function(n){var r=n.value,o=n.done,i=r&&r.size?r.size:0;e.options.uploadLengthDeferred&&o&&(e._size=e._offset+i,t.setHeader("Upload-Length",e._size));var a=e._offset+i;return!e.options.uploadLengthDeferred&&o&&a!==e._size?Promise.reject(new Error("upload was configured with a size of ".concat(e._size," bytes, but the source is done after ").concat(a," bytes"))):null===r?e._sendRequest(t):(e._emitProgress(e._offset,e._size),e._sendRequest(t,r))}))}},{key:"_handleUploadResponse",value:function(t,e){var n=parseInt(e.getHeader("Upload-Offset"),10);if(Number.isNaN(n))this._emitHttpError(t,e,"tus: invalid or missing offset value");else{if(this._emitProgress(n,this._size),this._emitChunkComplete(n-this._offset,n,this._size),this._offset=n,n===this._size)return this._emitSuccess(),void this._source.close();this._performUpload()}}},{key:"_openRequest",value:function(t,e){var n=Ko(t,e,this.options);return this._req=n,n}},{key:"_removeFromUrlStorage",value:function(){var t=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch((function(e){t._emitError(e)})),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var t=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||null!==this._urlStorageKey)return Promise.resolve();var e={size:this._size,metadata:this.options.metadata,creationTime:(new Date).toString()};return this._parallelUploads?e.parallelUploadUrls=this._parallelUploadUrls:e.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,e).then((function(e){t._urlStorageKey=e}))}},{key:"_sendRequest",value:function(t){return Xo(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,this.options)}}],r=[{key:"terminate",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Ko("DELETE",e,n);return Xo(r,null,n).then((function(t){if(204!==t.getStatus())throw new jo("tus: unexpected response while terminating upload",null,r,t)})).catch((function(o){if(o instanceof jo||(o=new jo("tus: failed to terminate upload",o,r,null)),!Wo(o,0,n))throw o;var i=n.retryDelays[0],a=n.retryDelays.slice(1),s=$o($o({},n),{},{retryDelays:a});return new Promise((function(t){return setTimeout(t,i)})).then((function(){return t.terminate(e,s)}))}))}}],n&&Fo(e.prototype,n),r&&Fo(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Bo(t){return Object.entries(t).map((function(t){var e=Lo(t,2),n=e[0],r=e[1];return"".concat(n," ").concat(to(String(r)))})).join(",")}function Go(t,e){return t>=e&&t<e+100}function Ko(t,e,n){var r=n.httpStack.createRequest(t,e);r.setHeader("Tus-Resumable","1.0.0");var o=n.headers||{};if(Object.entries(o).forEach((function(t){var e=Lo(t,2),n=e[0],o=e[1];r.setHeader(n,o)})),n.addRequestId){var i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}));r.setHeader("X-Request-ID",i)}return r}function Xo(t,e,n){return Qo.apply(this,arguments)}function Qo(){var t;return t=Po().mark((function t(e,n,r){var o;return Po().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("function"!=typeof r.onBeforeRequest){t.next=3;break}return t.next=3,r.onBeforeRequest(e);case 3:return t.next=5,e.send(n);case 5:if(o=t.sent,"function"!=typeof r.onAfterResponse){t.next=9;break}return t.next=9,r.onAfterResponse(e,o);case 9:return t.abrupt("return",o);case 10:case"end":return t.stop()}}),t)})),Qo=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Uo(i,r,o,a,s,"next",t)}function s(t){Uo(i,r,o,a,s,"throw",t)}a(void 0)}))},Qo.apply(this,arguments)}function Wo(t,e,n){if(null==n.retryDelays||e>=n.retryDelays.length||null==t.originalRequest)return!1;if(n&&"function"==typeof n.onShouldRetry)return n.onShouldRetry(t,e,n);var r,o=t.originalResponse?t.originalResponse.getStatus():0;return(!Go(o,400)||409===o||423===o)&&(r=!0,"undefined"!=typeof window&&"navigator"in window&&!1===window.navigator.onLine&&(r=!1),r)}function Yo(t,e){return new _o(e,t).toString()}function Zo(t){return Zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zo(t)}function Jo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Vo(r.key),r)}}function Vo(t){var e=function(t,e){if("object"!==Zo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Zo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Zo(e)?e:String(e)}Mo.defaultOptions=qo;var ti=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(t){return Promise.resolve([])}},{key:"removeUpload",value:function(t){return Promise.resolve()}},{key:"addUpload",value:function(t,e){return Promise.resolve(null)}}])&&Jo(e.prototype,n),r&&Jo(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ei(t){return ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ei(t)}function ni(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ri(r.key),r)}}function ri(t){var e=function(t,e){if("object"!==ei(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ei(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===ei(e)?e:String(e)}var oi=!1;try{oi="localStorage"in window;var ii="tusSupport",ai=localStorage.getItem(ii);localStorage.setItem(ii,ai),null===ai&&localStorage.removeItem(ii)}catch(t){if(t.code!==t.SECURITY_ERR&&t.code!==t.QUOTA_EXCEEDED_ERR)throw t;oi=!1}var si=oi,li=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,n=[{key:"findAllUploads",value:function(){var t=this._findEntries("tus::");return Promise.resolve(t)}},{key:"findUploadsByFingerprint",value:function(t){var e=this._findEntries("tus::".concat(t,"::"));return Promise.resolve(e)}},{key:"removeUpload",value:function(t){return localStorage.removeItem(t),Promise.resolve()}},{key:"addUpload",value:function(t,e){var n=Math.round(1e12*Math.random()),r="tus::".concat(t,"::").concat(n);return localStorage.setItem(r,JSON.stringify(e)),Promise.resolve(r)}},{key:"_findEntries",value:function(t){for(var e=[],n=0;n<localStorage.length;n++){var r=localStorage.key(n);if(0===r.indexOf(t))try{var o=JSON.parse(localStorage.getItem(r));o.urlStorageKey=r,e.push(o)}catch(t){}}return e}}],n&&ni(e.prototype,n),r&&ni(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ui(t){return ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ui(t)}function ci(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,di(r.key),r)}}function fi(t,e,n){return e&&pi(t.prototype,e),n&&pi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function di(t){var e=function(t,e){if("object"!==ui(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ui(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===ui(e)?e:String(e)}var hi=function(){function t(){ci(this,t)}return fi(t,[{key:"createRequest",value:function(t,e){return new mi(t,e)}},{key:"getName",value:function(){return"XHRHttpStack"}}]),t}(),mi=function(){function t(e,n){ci(this,t),this._xhr=new XMLHttpRequest,this._xhr.open(e,n,!0),this._method=e,this._url=n,this._headers={}}return fi(t,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(t,e){this._xhr.setRequestHeader(t,e),this._headers[t]=e}},{key:"getHeader",value:function(t){return this._headers[t]}},{key:"setProgressHandler",value:function(t){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(e){e.lengthComputable&&t(e.loaded)})}},{key:"send",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Promise((function(n,r){t._xhr.onload=function(){n(new yi(t._xhr))},t._xhr.onerror=function(t){r(t)},t._xhr.send(e)}))}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),t}(),yi=function(){function t(e){ci(this,t),this._xhr=e}return fi(t,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(t){return this._xhr.getResponseHeader(t)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),t}(),vi=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase()};function gi(t){return new Promise((function(e,n){var r=new XMLHttpRequest;r.responseType="blob",r.onload=function(){var t=r.response;e(t)},r.onerror=function(t){n(t)},r.open("GET",t),r.send()}))}function bi(t){return bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bi(t)}function xi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_i(r.key),r)}}function _i(t){var e=function(t,e){if("object"!==bi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==bi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===bi(e)?e:String(e)}var wi=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._file=e,this.size=e.size}var e,n,r;return e=t,n=[{key:"slice",value:function(t,e){if("undefined"!=typeof window&&(void 0!==window.PhoneGap||void 0!==window.Cordova||void 0!==window.cordova))return n=this._file.slice(t,e),new Promise((function(t,e){var r=new FileReader;r.onload=function(){var e=new Uint8Array(r.result);t({value:e})},r.onerror=function(t){e(t)},r.readAsArrayBuffer(n)}));var n,r=this._file.slice(t,e),o=e>=this.size;return Promise.resolve({value:r,done:o})}},{key:"close",value:function(){}}],n&&xi(e.prototype,n),r&&xi(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Si(t){return Si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Si(t)}function Ei(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ki(r.key),r)}}function ki(t){var e=function(t,e){if("object"!==Si(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Si(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Si(e)?e:String(e)}function Ri(t){return void 0===t?0:void 0!==t.size?t.size:t.length}var Ai=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._buffer=void 0,this._bufferOffset=0,this._reader=e,this._done=!1}var e,n,r;return e=t,(n=[{key:"slice",value:function(t,e){return t<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(t,e)}},{key:"_readUntilEnoughDataOrDone",value:function(t,e){var n=this,r=e<=this._bufferOffset+Ri(this._buffer);if(this._done||r){var o=this._getDataFromBuffer(t,e),i=null==o&&this._done;return Promise.resolve({value:o,done:i})}return this._reader.read().then((function(r){var o=r.value;return r.done?n._done=!0:void 0===n._buffer?n._buffer=o:n._buffer=function(t,e){if(t.concat)return t.concat(e);if(t instanceof Blob)return new Blob([t,e],{type:t.type});if(t.set){var n=new t.constructor(t.length+e.length);return n.set(t),n.set(e,t.length),n}throw new Error("Unknown data type")}(n._buffer,o),n._readUntilEnoughDataOrDone(t,e)}))}},{key:"_getDataFromBuffer",value:function(t,e){t>this._bufferOffset&&(this._buffer=this._buffer.slice(t-this._bufferOffset),this._bufferOffset=t);var n=0===Ri(this._buffer);return this._done&&n?null:this._buffer.slice(0,e-t)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}])&&Ei(e.prototype,n),r&&Ei(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ci(t){return Ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ci(t)}function Oi(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
Oi=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function u(t,e,n,o){var i=e&&e.prototype instanceof f?e:f,a=Object.create(i.prototype),s=new k(o||[]);return r(a,"_invoke",{value:_(t,n,s)}),a}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var p={};function f(){}function d(){}function h(){}var m={};l(m,i,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(R([])));v&&v!==e&&n.call(v,i)&&(m=v);var g=h.prototype=f.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function o(r,i,a,s){var l=c(t[r],t,i);if("throw"!==l.type){var u=l.arg,p=u.value;return p&&"object"==Ci(p)&&n.call(p,"__await")?e.resolve(p.__await).then((function(t){o("next",t,a,s)}),(function(t){o("throw",t,a,s)})):e.resolve(p).then((function(t){u.value=t,a(u)}),(function(t){return o("throw",t,a,s)}))}s(l.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function _(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return A()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=c(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===p)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var o=c(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function R(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:A}}function A(){return{value:void 0,done:!0}}return d.prototype=h,r(g,"constructor",{value:h,configurable:!0}),r(h,"constructor",{value:d,configurable:!0}),d.displayName=l(h,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,l(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(x.prototype),l(x.prototype,a,(function(){return this})),t.AsyncIterator=x,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new x(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),l(g,s,"Generator"),l(g,i,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=R,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;E(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:R(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},t}function Ti(t,e,n,r,o,i,a){try{var s=t[i](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,o)}function ji(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Pi(r.key),r)}}function Pi(t){var e=function(t,e){if("object"!==Ci(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Ci(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Ci(e)?e:String(e)}var Ui=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r,o,i;return e=t,n=[{key:"openFile",value:(o=Oi().mark((function t(e,n){var r;return Oi().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!vi()||!e||void 0===e.uri){t.next=11;break}return t.prev=1,t.next=4,gi(e.uri);case 4:return r=t.sent,t.abrupt("return",new wi(r));case 8:throw t.prev=8,t.t0=t.catch(1),new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(t.t0));case 11:if("function"!=typeof e.slice||void 0===e.size){t.next=13;break}return t.abrupt("return",Promise.resolve(new wi(e)));case 13:if("function"!=typeof e.read){t.next=18;break}if(n=Number(n),Number.isFinite(n)){t.next=17;break}return t.abrupt("return",Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option")));case 17:return t.abrupt("return",Promise.resolve(new Ai(e,n)));case 18:return t.abrupt("return",Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment")));case 19:case"end":return t.stop()}}),t,null,[[1,8]])})),i=function(){var t=this,e=arguments;return new Promise((function(n,r){var i=o.apply(t,e);function a(t){Ti(i,n,r,a,s,"next",t)}function s(t){Ti(i,n,r,a,s,"throw",t)}a(void 0)}))},function(t,e){return i.apply(this,arguments)})}],n&&ji(e.prototype,n),r&&ji(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Li(t){return Li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Li(t)}function Ii(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,qi(r.key),r)}}function Hi(t,e){return Hi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Hi(t,e)}function Di(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=$i(t);if(e){var o=$i(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Li(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function $i(t){return $i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$i(t)}function Ni(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Fi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ni(Object(n),!0).forEach((function(e){zi(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ni(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function zi(t,e,n){return(e=qi(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qi(t){var e=function(t,e){if("object"!==Li(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Li(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Li(e)?e:String(e)}var Mi=Fi(Fi({},Mo.defaultOptions),{},{httpStack:new hi,fileReader:new Ui,urlStorage:si?new li:new ti,fingerprint:function(t,e){return vi()?Promise.resolve(function(t,e){var n=t.exif?function(t){var e=0;if(0===t.length)return e;for(var n=0;n<t.length;n++){e=(e<<5)-e+t.charCodeAt(n),e&=e}return e}(JSON.stringify(t.exif)):"noexif";return["tus-rn",t.name||"noname",t.size||"nosize",n,e.endpoint].join("/")}(t,e)):Promise.resolve(["tus-br",t.name,t.type,t.size,t.lastModified,e.endpoint].join("-"))}}),Bi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hi(t,e)}(i,t);var e,n,r,o=Di(i);function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),e=Fi(Fi({},Mi),e),o.call(this,t,e)}return e=i,r=[{key:"terminate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=Fi(Fi({},Mi),e),Mo.terminate(t,e)}}],(n=null)&&Ii(e.prototype,n),r&&Ii(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Mo);class Gi extends Tr{constructor(t){let{chunkSize:e,csrfToken:n,fieldName:o,file:i,formId:a,retryDelays:s,uploadIndex:l,uploadUrl:u}=t;super({name:i.name,status:"uploading",type:"tus",uploadIndex:l}),r(this,"onError",void 0),r(this,"onProgress",void 0),r(this,"onSuccess",void 0),r(this,"id",void 0),r(this,"upload",void 0),r(this,"csrfToken",void 0),r(this,"handleError",(t=>{if(!this.onError)throw t;this.onError(t)})),r(this,"handleProgress",((t,e)=>{this.onProgress&&this.onProgress(t,e)})),r(this,"handleSucces",(()=>{this.onSuccess&&this.onSuccess()})),r(this,"addCsrTokenToRequest",(t=>{t.setHeader("X-CSRFToken",this.csrfToken)})),r(this,"handleAfterReponse",((t,e)=>{const n=e.getHeader("ResourceId");n&&(this.id=n)})),this.csrfToken=n,this.upload=new Bi(i,{chunkSize:e,endpoint:u,metadata:{fieldName:o,filename:i.name,formId:a},onAfterResponse:this.handleAfterReponse,onBeforeRequest:this.addCsrTokenToRequest,onError:this.handleError,onProgress:this.handleProgress,onSuccess:this.handleSucces,retryDelays:s||[0,1e3,3e3,5e3]}),this.onError=void 0,this.onProgress=void 0,this.onSuccess=void 0}async abort(){await this.upload.abort(!0)}async delete(){if(!this.upload.url)return Promise.resolve();await Lr(this.upload.url,this.csrfToken)}getId(){return this.id}getSize(){return this.upload.file.size}start(){this.upload.start()}getInitialFile(){return{id:this.id,name:this.name,size:this.getSize(),type:"tus",url:""}}}class Ki{constructor(t){let{callbacks:e,chunkSize:n,csrfToken:o,eventEmitter:i,fieldName:a,form:s,formId:l,initial:u,input:c,multiple:p,parent:f,prefix:d,retryDelays:m,s3UploadDir:y,skipRequired:v,supportDropArea:g,translations:b,uploadUrl:x}=t;r(this,"acceptedFileTypes",void 0),r(this,"callbacks",void 0),r(this,"chunkSize",void 0),r(this,"csrfToken",void 0),r(this,"eventEmitter",void 0),r(this,"fieldName",void 0),r(this,"form",void 0),r(this,"formId",void 0),r(this,"multiple",void 0),r(this,"nextUploadIndex",void 0),r(this,"prefix",void 0),r(this,"renderer",void 0),r(this,"retryDelays",void 0),r(this,"s3UploadDir",void 0),r(this,"supportDropArea",void 0),r(this,"uploads",void 0),r(this,"uploadUrl",void 0),r(this,"uploadFiles",(async t=>{if(0!==t.length){if(this.multiple)for await(const e of t)await this.uploadFile(e);else{for(const t of this.uploads)this.renderer.deleteFile(t.uploadIndex);this.uploads=[];const e=t[0];e&&await this.uploadFile(e)}this.checkDropHint()}})),r(this,"onChange",(t=>{const e=t.target.files||[],n=[],r=[];for(const t of e)this.acceptedFileTypes.isAccepted(t.name)?n.push(t):r.push(t);r&&this.handleInvalidFiles([...r]),n&&this.uploadFiles([...n]),this.renderer.clearInput()})),r(this,"handleInvalidFiles",(t=>{this.renderer.setErrorInvalidFiles(t)})),r(this,"handleClick",(t=>{const e=t.target,n=()=>{const t=e.getAttribute("data-index");if(!t)return;const n=parseInt(t,10);return this.getUploadByIndex(n)};if(e.classList.contains("dff-delete")&&!e.classList.contains("dff-disabled")){t.preventDefault();const e=n();e&&this.removeExistingUpload(e)}else if(e.classList.contains("dff-cancel")){t.preventDefault();const e=n();e&&this.handleCancel(e)}else if(e.classList.contains("dff-filename")){t.preventDefault();const e=n();"done"===e?.status&&this.callbacks.onClick&&this.callbacks.onClick({fileName:e.name,fieldName:this.fieldName,id:e.getId(),type:e.type})}})),r(this,"handleProgress",((t,e,n)=>{const r=(e/n*100).toFixed(2);this.renderer.updateProgress(t.uploadIndex,r);const{onProgress:o}=this.callbacks;o&&t instanceof Gi&&o(e,n,t)})),r(this,"handleError",((t,e)=>{this.renderer.setError(t.uploadIndex),t.status="error";const{onError:n}=this.callbacks;n&&t instanceof Gi&&n(e,t)})),r(this,"handleSuccess",(t=>{const{renderer:e}=this;this.updatePlaceholderInput(),e.clearInput(),e.setSuccess(t.uploadIndex,t.getSize()),t.status="done";const{onSuccess:n}=this.callbacks,r=this.renderer.findFileDiv(t.uploadIndex);this.emitEvent("uploadComplete",r,t),n&&"tus"===t.type&&n(t)})),this.callbacks=e,this.chunkSize=n,this.csrfToken=o,this.eventEmitter=i,this.fieldName=a,this.form=s,this.formId=l,this.multiple=p,this.prefix=d,this.retryDelays=m,this.s3UploadDir=y,this.supportDropArea=g&&!c.disabled,this.uploadUrl=x,this.acceptedFileTypes=new kr(c.accept),this.uploads=[],this.nextUploadIndex=0,this.renderer=new h({parent:f,input:c,skipRequired:v,translations:b});const _=this.renderer.container;g&&this.initDropArea(_,c.accept),u&&this.addInitialFiles(u),this.checkDropHint(),c.addEventListener("change",this.onChange),_.addEventListener("click",this.handleClick)}addInitialFiles(t){if(0===t.length)return;const{multiple:e,renderer:n}=this,r=t=>{const{size:e}=t,r="s3"===t.type&&t.original_name?t.original_name:t.name,o=n.addUploadedFile(r,this.nextUploadIndex,e),i=(t=>{let{csrfToken:e,initialFile:n,uploadIndex:r,uploadUrl:o}=t;switch(n.type){case"existing":return new $r(n,r);case"placeholder":return new Hr(n,r);case"s3":return new Dr(n,r);case"tus":return new Nr({csrfToken:e,initialFile:n,uploadUrl:o,uploadIndex:r})}})({csrfToken:this.csrfToken,initialFile:t,uploadIndex:this.nextUploadIndex,uploadUrl:this.uploadUrl});this.uploads.push(i),this.emitEvent("addUpload",o,i)};if(e)t.forEach((t=>{r(t),this.nextUploadIndex+=1}));else{const e=t[0];e&&r(e)}}async uploadFile(t){const{fieldName:e,formId:n,renderer:r,uploadUrl:o}=this,i=t.name,a=this.findUploadByName(i),s=a?a.uploadIndex:this.nextUploadIndex;a||(this.nextUploadIndex+=1),a&&await this.removeExistingUpload(a);const l=(()=>{const{csrfToken:r,s3UploadDir:i}=this;return null!=i?new Ur({csrfToken:r,endpoint:o,file:t,s3UploadDir:i,uploadIndex:s}):new Gi({chunkSize:this.chunkSize,csrfToken:this.csrfToken,fieldName:e,file:t,formId:n,retryDelays:this.retryDelays,uploadIndex:s,uploadUrl:o})})();l.onError=t=>this.handleError(l,t),l.onProgress=(t,e)=>this.handleProgress(l,t,e),l.onSuccess=()=>this.handleSuccess(l),l.start(),this.uploads.push(l);const u=r.addNewUpload(i,s);this.emitEvent("addUpload",u,l)}getUploadByIndex(t){return this.uploads.find((e=>e.uploadIndex===t))}findUploadByName(t){return this.uploads.find((e=>e.name===t))}async removeExistingUpload(t){const e=this.renderer.findFileDiv(t.uploadIndex);if(e&&this.emitEvent("removeUpload",e,t),"uploading"===t.status)this.renderer.disableCancel(t.uploadIndex),await t.abort();else if("done"===t.status){this.renderer.disableDelete(t.uploadIndex);try{await t.delete()}catch{return void this.renderer.setDeleteFailed(t.uploadIndex)}}this.removeUploadFromList(t),this.updatePlaceholderInput()}removeUploadFromList(t){this.renderer.deleteFile(t.uploadIndex);const e=this.uploads.indexOf(t);e>=0&&this.uploads.splice(e,1),this.checkDropHint();const{onDelete:n}=this.callbacks;n&&n(t)}async handleCancel(t){this.renderer.disableCancel(t.uploadIndex),await t.abort(),this.removeUploadFromList(t)}initDropArea(t,e){new Or({container:t,inputAccept:e,onUploadFiles:this.uploadFiles,renderer:this.renderer})}checkDropHint(){if(!this.supportDropArea)return;0===this.uploads.filter((t=>t)).length?this.renderer.renderDropHint():this.renderer.removeDropHint()}updatePlaceholderInput(){const t=a(this.form,s(this.fieldName,this.prefix),this.prefix);if(!t)return;const e=this.uploads.map((t=>t.getInitialFile()));t.value=JSON.stringify(e)}getMetaDataField(){return a(this.form,(t=this.fieldName,e=this.prefix,`${i(t,e)}-metadata`),this.prefix);var t,e}emitEvent(t,e,n){this.eventEmitter&&this.eventEmitter.emit(t,{element:e,fieldName:this.fieldName,fileName:n.name,metaDataField:this.getMetaDataField(),upload:n})}}const Xi=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=()=>e&&e.prefix?e.prefix:null,r=e=>l(t,e,n()),o=r("upload_url"),i=r("form_id"),u=r("s3_upload_dir"),c=e.skipRequired||!1,p=n(),f=a(t,"csrfmiddlewaretoken",null)?.value;if(!f)throw Error("Csrf token not found");i&&o&&t.querySelectorAll(".dff-uploader").forEach((a=>{const l=a.querySelector(".dff-container");if(!l)return;const d=l.querySelector("input[type=file]");if(!d||!(t=>!e||!e.prefix||t.startsWith(`${e.prefix}-`))(d.name))return;const h=d.name,{multiple:m}=d,y=(t=>{const e=r(s(t,n()));return e?JSON.parse(e):[]})(h),v=l.getAttribute("data-translations"),g=v?JSON.parse(v):{},b=!(!1===e.supportDropArea);new Ki({callbacks:e.callbacks||{},chunkSize:e.chunkSize||2621440,csrfToken:f,eventEmitter:e.eventEmitter,fieldName:h,form:t,formId:i,s3UploadDir:u||null,initial:y,input:d,multiple:m,parent:l,prefix:p,retryDelays:e.retryDelays||null,skipRequired:c,supportDropArea:b,translations:g,uploadUrl:o})}))};window.autoInitFileForms=()=>{const e=window.initUploadFields;var n;(n=Array.from(document.querySelectorAll(".dff-uploader")).map(t),Array.from(new Set(n).values())).forEach(e)},window.initFormSet=(t,e)=>{let n;n="string"==typeof e?{prefix:e}:e;const r=n.prefix||"form",i=l(t,"TOTAL_FORMS",r);if(!i)return;const a=parseInt(i,10);for(let e=0;e<a;e+=1){const i=o(`${e}`,null);Xi(t,{...n,prefix:`${r}-${i}`})}},window.initUploadFields=Xi}();
//# sourceMappingURL=file_form.min.js.map
