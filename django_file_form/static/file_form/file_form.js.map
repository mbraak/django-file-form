{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///./node_modules/@babel/runtime/regenerator/index.js","webpack:///./src/util.ts","webpack:///./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack:///./node_modules/@babel/runtime/helpers/asyncToGenerator.js","webpack:///./node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/@babel/runtime/helpers/createClass.js","webpack:///./node_modules/@babel/runtime/helpers/arrayLikeToArray.js","webpack:///./node_modules/namespace-emitter/index.js","webpack:///./node_modules/cuid/lib/pad.js","webpack:///./node_modules/@uppy/utils/lib/getFileNameAndExtension.js","webpack:///./node_modules/@uppy/companion-client/lib/RequestClient.js","webpack:///./node_modules/js-base64/base64.js","webpack:///./node_modules/url-parse/index.js","webpack:///./node_modules/escape-html/index.js","webpack:///./node_modules/@babel/runtime/helpers/asyncIterator.js","webpack:///./node_modules/tus-js-client/lib.esm/error.js","webpack:///./node_modules/tus-js-client/lib.esm/logger.js","webpack:///./node_modules/tus-js-client/lib.esm/upload.js","webpack:///./node_modules/tus-js-client/lib.esm/uuid.js","webpack:///./node_modules/tus-js-client/lib.esm/noopUrlStorage.js","webpack:///./node_modules/tus-js-client/lib.esm/browser/urlStorage.js","webpack:///./node_modules/tus-js-client/lib.esm/browser/httpStack.js","webpack:///./node_modules/tus-js-client/lib.esm/browser/isReactNative.js","webpack:///./node_modules/tus-js-client/lib.esm/browser/isCordova.js","webpack:///./node_modules/tus-js-client/lib.esm/browser/fileReader.js","webpack:///./node_modules/tus-js-client/lib.esm/browser/readAsByteArray.js","webpack:///./node_modules/tus-js-client/lib.esm/browser/uriToBlob.js","webpack:///./node_modules/tus-js-client/lib.esm/browser/index.js","webpack:///./node_modules/tus-js-client/lib.esm/browser/fingerprint.js","webpack:///./src/render_upload_file.ts","webpack:///./src/drop_area.ts","webpack:///./src/upload_file.ts","webpack:///./src/file_form.ts","webpack:///./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack:///./node_modules/@babel/runtime/helpers/iterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack:///./node_modules/requires-port/index.js","webpack:///./node_modules/querystringify/index.js","webpack:///./node_modules/regenerator-runtime/runtime.js","webpack:///./node_modules/@uppy/core/lib/index.js","webpack:///./node_modules/@uppy/utils/lib/Translator.js","webpack:///./node_modules/@uppy/utils/lib/hasProperty.js","webpack:///./node_modules/cuid/index.js","webpack:///./node_modules/cuid/lib/fingerprint.browser.js","webpack:///./node_modules/cuid/lib/getRandomValue.browser.js","webpack:///./node_modules/lodash.throttle/index.js","webpack:///./node_modules/@transloadit/prettier-bytes/prettierBytes.js","webpack:///./node_modules/mime-match/index.js","webpack:///./node_modules/wildcard/index.js","webpack:///./node_modules/@uppy/store-default/lib/index.js","webpack:///./node_modules/@uppy/utils/lib/getFileType.js","webpack:///./node_modules/@uppy/utils/lib/mimeTypes.js","webpack:///./node_modules/@uppy/utils/lib/generateFileID.js","webpack:///./node_modules/@uppy/core/lib/supportsUploadProgress.js","webpack:///./node_modules/@uppy/core/lib/loggers.js","webpack:///./node_modules/@uppy/utils/lib/getTimeStamp.js","webpack:///./node_modules/@uppy/core/lib/Plugin.js","webpack:///./node_modules/preact/dist/preact.esm.js","webpack:///./node_modules/@uppy/utils/lib/findDOMElement.js","webpack:///./node_modules/@uppy/utils/lib/isDOMElement.js","webpack:///./node_modules/@uppy/companion-client/lib/index.js","webpack:///./node_modules/@uppy/companion-client/lib/AuthError.js","webpack:///./node_modules/@uppy/utils/lib/fetchWithNetworkError.js","webpack:///./node_modules/@uppy/utils/lib/NetworkError.js","webpack:///./node_modules/@uppy/companion-client/lib/Provider.js","webpack:///./node_modules/@uppy/companion-client/lib/tokenStorage.js","webpack:///./node_modules/@uppy/companion-client/lib/Socket.js","webpack:///./src/MultipartUploader.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","obj","configurable","writable","formatBytes","bytes","decimals","dm","Math","floor","log","parseFloat","toFixed","size","getInputNameWithPrefix","fieldName","prefix","findInput","form","inputNameWithPrefix","input","querySelector","console","error","getPlaceholderFieldName","slice","length","getInputNameWithoutPrefix","getInputValueForFormAndPrefix","instance","Constructor","TypeError","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","done","Promise","then","fn","self","this","args","arguments","apply","err","undefined","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","arr","g","Function","e","window","_defineProperties","target","props","descriptor","protoProps","staticProps","len","arr2","Array","emitter","_fns","emit","event","arg1","arg2","arg3","arg4","arg5","arg6","toEmit","out","idx","indexOf","substring","keys","concat","getListeners","fns","emitAll","on","push","once","one","off","keep","num","substr","fullFileName","lastDot","lastIndexOf","extension","_class","_temp","_extends","assign","source","AuthError","fetchWithNetworkError","RequestClient","uppy","opts","onReceiveResponse","allowedHeaders","preflightDone","_proto","headers","userHeaders","companionHeaders","serverHeaders","defaultHeaders","_getPostResponseFunc","skip","_this","response","_extends2","companion","getState","host","companionUrl","has","setState","_getUrl","url","test","hostname","_json","res","status","errMsg","statusText","json","errData","message","requestId","Error","catch","preflight","path","_this2","fetch","method","split","map","headerName","trim","toLowerCase","preflightAndHeaders","_this3","all","_ref","forEach","header","skipPostResponse","_this4","credentials","isAuthError","post","data","_this5","body","JSON","stringify","delete","_this6","replace","Accept","VERSION","global","factory","fromUint8Array","_Base64","Base64","b64chars","b64tab","bin","charAt","fromCharCode","String","cb_utob","cc","charCodeAt","re_utob","utob","u","cb_encode","ccc","padlen","ord","join","btoa","b","match","RangeError","_encode","mkUriSafe","b64","m0","encode","urisafe","Uint8Array","a","a0","a1","a2","toUint8Array","re_btou","cb_btou","cccc","offset","btou","cb_decode","chars","_atob","atob","_fromURI","decode","_decode","from","noConflict","fromBase64","toBase64","encodeURI","noEnum","v","extendString","required","qs","slashes","protocolre","left","RegExp","trimLeft","str","toString","rules","address","NaN","ignore","hash","query","lolcation","loc","location","finaldestination","type","protocol","Url","unescape","pathname","href","extractProtocol","exec","rest","parser","relative","extracted","parse","instruction","index","instructions","base","last","unshift","up","splice","port","username","password","auth","origin","set","part","pop","char","ins","result","matchHtmlRegExp","string","escape","html","lastIndex","iterable","asyncIterator","iterator","_typeof","constructor","_classCallCheck","_possibleConstructorReturn","ReferenceError","_assertThisInitialized","_wrapNativeSuper","Class","_cache","Map","Wrapper","_construct","_getPrototypeOf","_setPrototypeOf","Parent","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","setPrototypeOf","__proto__","getPrototypeOf","_Error","subClass","superClass","_inherits","DetailedError","Derived","_super","Super","NewTarget","causingErr","req","originalRequest","originalResponse","causingError","getHeader","getMethod","getURL","getStatus","getBody","isEnabled","msg","ownKeys","enumerableOnly","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","_objectSpread","_defineProperty","getOwnPropertyDescriptors","defineProperties","defaultOptions","endpoint","uploadUrl","metadata","fingerprint","uploadSize","onProgress","onChunkComplete","onSuccess","onError","_onUploadUrlAvailable","overridePatchMethod","addRequestId","onBeforeRequest","onAfterResponse","chunkSize","Infinity","retryDelays","parallelUploads","storeFingerprintForResuming","removeFingerprintOnSuccess","uploadLengthDeferred","uploadDataDuringCreation","urlStorage","fileReader","httpStack","BaseUpload","file","options","_urlStorage","_req","_fingerprint","_urlStorageKey","_offset","_aborted","_size","_source","_retryAttempt","_retryTimeout","_offsetBeforeRetry","_parallelUploads","_parallelUploadUrls","cb","openRequest","promise","send","shouldRetry","delay","remainingDelays","newOptions","setTimeout","terminate","findUploadsByFingerprint","previousUpload","parallelUploadUrls","urlStorageKey","optionName","_emitError","openFile","_startParallelUpload","_startSingleUpload","totalSize","totalProgress","partCount","parts","previousUrls","partSize","start","end","splitSizeIntoParts","uploads","lastPartProgress","newPartProgress","_emitProgress","upload","_saveUploadInUrlStorage","_openRequest","setHeader","encodeMetadata","_sendRequest","inStatusCategory","resolveUrl","_emitSuccess","_emitHttpError","isNaN","_resumeUpload","_createUpload","shouldTerminate","abort","close","clearTimeout","_removeFromUrlStorage","bytesSent","bytesTotal","bytesAccepted","_addChunkToRequest","_handleUploadResponse","_performUpload","_this7","parseInt","_this8","_this9","setProgressHandler","_ref2","_emitChunkComplete","_this10","removeUpload","_this11","storedUpload","creationTime","addUpload","_this12","encoded","category","createRequest","random","retryAttempt","online","isServerError","navigator","onLine","link","NoopUrlStorage","hasStorage","localStorage","setItem","getItem","code","SECURITY_ERR","QUOTA_EXCEEDED_ERR","canStoreURLs","WebStorageUrlStorage","results","_findEntries","removeItem","id","round","_key","XHRHttpStack","Request","_xhr","XMLHttpRequest","open","_method","_url","_headers","setRequestHeader","progressHandler","onprogress","lengthComputable","loaded","onload","Response","onerror","xhr","getResponseHeader","responseText","product","PhoneGap","Cordova","cordova","FileSource","_file","chunk","reader","FileReader","readAsArrayBuffer","StreamSource","_chunkSize","_buffer","_bufferOffset","_reader","_done","_readUntilEnoughDataOrDone","hasEnoughData","_getDataFromBuffer","read","Blob","hasAllDataBeenRead","cancel","blobOrArray","uri","responseType","blob","isFinite","exifHash","exif","_char","hashCode","reactNativeFingerprint","lastModified","_BaseUpload","Upload","_window","RenderUploadFile","parent","skipRequired","translations","div","document","createElement","className","appendChild","container","createFilesContainer","filename","uploadIndex","filesize","addFile","setSuccess","progressSpan","innerSpan","cancelLink","innerHTML","Cancel","setAttribute","nameSpan","findFileDiv","remove","span","classList","add","el","removeProgress","removeCancel","fileSizeInfo","deleteLink","Delete","cancelSpan","percentage","innerProgressSpan","style","width","dropHint","getEntriesFromDirectory","directoryEntry","createReader","readEntries","getFileFromFileEntry","fileEntry","getFilesFromFileSystemEntries","entries","entry","isFile","isDirectory","entriesFromDirectory","getFilesFromDataTransfer","dataTransfer","items","item","webkitGetAsEntry","files","DropArea","onUploadFiles","dragEvent","preventDefault","stopPropagation","uploadFiles","addEventListener","onDrop","require","Plugin","Uploader","Socket","Provider","UploadFile","callbacks","formId","initial","multiple","supportDropArea","renderer","deleteFile","createMultipartUpload","listParts","prepareUploadPart","completeMultipartUpload","abortMultipartUpload","getChunkSize","addNewUpload","checkDropHint","getUploadIndex","dataIndex","getAttribute","contains","handleDelete","handleCancel","bytesUploaded","updateProgress","setError","uploadedSize","clearInput","filesContainer","initDropArea","addInitialFiles","onChange","onClick","csrftoken","getElementsByName","accept","contentType","uploadId","encodeURIComponent","uploadIdEnc","number","initialFiles","addInitialFile","addUploadedFile","placeholder","deleteFromServer","deletePlaceholder","onDelete","deleteUpload","setDeleteFailed","updatePlaceholderInput","renderDropHint","removeDropHint","placeholdersInfo","initUploadFields","matchesPrefix","startsWith","getPrefix","getInputValue","getInitialFiles","element","filesData","dataset","getPlaceholders","querySelectorAll","uploaderDiv","dataTranslations","initFormSet","optionsParam","totalFormsValue","formCount","subFormPrefix","arrayLikeToArray","isArray","iter","minLen","decodeURIComponent","pairs","runtime","Op","hasOwn","$Symbol","iteratorSymbol","asyncIteratorSymbol","toStringTagSymbol","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","context","Context","_invoke","state","doneResult","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","makeInvokeMethod","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","NativeIteratorPrototype","values","Gp","defineIteratorMethods","AsyncIterator","PromiseImpl","previousPromise","callInvokeWithMethodAndArg","invoke","__await","unwrapped","resultName","next","nextLoc","pushTryEntry","locs","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","iteratorMethod","displayName","isGeneratorFunction","genFun","ctor","mark","awrap","async","reverse","skipTempReset","prev","stop","rootRecord","rval","exception","handle","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","regeneratorRuntime","accidentalStrictMode","Translator","ee","cuid","throttle","prettierBytes","DefaultStore","getFileType","getFileNameAndExtension","generateFileID","supportsUploadProgress","_require","justErrorsLogger","debugLogger","RestrictionError","_len","isRestriction","Uppy","defaultLocale","strings","addBulkFilesFailed","0","1","youCanOnlyUploadX","youHaveToAtLeastSelectX","exceedsSize2","exceedsSize","youCanOnlyUploadFileTypes","noNewAlreadyUploading","noDuplicates","companionError","companionUnauthorizeHint","failedToUpload","noInternetConnection","connectedToInternet","noFilesFound","selectX","selectAllFilesFromFolderNamed","unselectAllFilesFromFolderNamed","selectFileNamed","unselectFileNamed","openFolderNamed","logOut","resetFilter","loading","authenticateWithTitle","authenticateWith","emptyFolderAdded","folderAdded","autoProceed","allowMultipleUploads","debug","restrictions","maxFileSize","maxNumberOfFiles","minNumberOfFiles","allowedFileTypes","meta","onBeforeFileAdded","currentFile","onBeforeUpload","store","logger","i18nInit","plugins","getPlugin","setFileMeta","setFileState","hideInfo","removeFile","pauseResume","_calculateProgress","leading","trailing","updateOnlineStatus","resetProgress","pauseAll","resumeAll","retryAll","cancelAll","retryUpload","preProcessors","uploaders","postProcessors","currentUploads","allowNewUpload","capabilities","uploadProgress","individualCancellation","resumableUploads","isHidden","_storeUnsubscribe","subscribe","prevState","nextState","patch","updateAll","_addListeners","callback","iteratePlugins","plugin","update","fileID","translator","locale","i18n","translate","i18nArray","translateArray","setOptions","newOpts","setMeta","defaultProgress","uploadComplete","uploadStarted","updatedFiles","updatedFile","progress","addPreProcessor","removePreProcessor","addPostProcessor","removePostProcessor","addUploader","removeUploader","updatedMeta","newMeta","getFile","getFiles","_checkMinNumberOfFiles","smart_count","_checkRestrictions","_this$opts$restrictio","some","allowedFileTypesString","types","backwardsCompat","_showOrLogErrorAndThrow","_ref$showInformer","showInformer","_ref$file","_ref$throwErr","throwErr","details","logMessageWithDetails","_assertNewUploadAllowed","_checkAndCreateFileStateObject","fileType","fileName","onBeforeFileAddedResult","fileExtension","isRemote","newFile","remote","preview","_startIfAutoProceed","scheduledAutoProceed","stack","_extends3","addFiles","fileDescriptors","newFiles","errors","subError","removeFiles","fileIDs","_this$getState4","updatedUploads","removedFiles","fileIsNotRemoved","uploadFileID","uploadsToRemove","uploadID","newFileIDs","stateUpdate","_calculateTotalProgress","removedFileIDs","isPaused","filesToRetry","forceAllowNewUpload","_runUpload","canHavePercentage","inProgress","preprocess","postprocess","sizedFiles","unsizedFiles","reduce","acc","averageSize","progressMax","currentProgress","_totalProgress","errorMsg","newError","now","uploadResp","uploadURL","wasOffline","getID","use","pluginId","existsPluginAlready","_msg","install","foundPlugin","pluginType","removePlugin","uninstall","list","updatedState","duration","isComplexMessage","infoTimeoutID","newInfo","warn","run","restore","_removeUpload","_extends4","_opts$forceAllowNewUp","_this$getState6","step","_getUpload","addResultData","_extends5","currentUpload","restoreStep","steps","lastStep","_extends6","updatedUpload","successful","failed","uploader","onBeforeUploadResult","currentlyUploadingFiles","curr","waitingFileIDs","locales","pluralize","_apply","prevLocale","interpolate","phrase","_String$prototype","dollarRegex","interpolated","replacement","insertReplacement","rx","newParts","raw","plural","pad","getRandomValue","discreteValues","pow","randomBlock","safeCounter","getTime","slug","date","counter","print","isCuid","stringToCheck","isSlug","stringLength","env","globalCount","clientId","mimeTypes","userAgent","crypto","msCrypto","lim","abs","getRandomValues","Uint32Array","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","freeGlobal","freeSelf","root","objectToString","nativeMax","max","nativeMin","min","debounce","func","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","maxing","invokeFunc","time","thisArg","leadingEdge","timerExpired","shouldInvoke","timeSinceLastCall","trailingEdge","remainingWait","debounced","isInvoking","toNumber","isObject","flush","isObjectLike","isSymbol","other","valueOf","isBinary","neg","units","exponent","Number","unit","wildcard","reMimePartSplit","pattern","WildcardMatcher","text","separator","hasWild","ii","testParts","matches","partsCount","matcher","_publish","listener","md","markdown","mp4","mp3","svg","jpg","png","gif","heic","heif","yaml","yml","csv","tsv","tab","avi","mks","mkv","mov","doc","docm","docx","dot","dotm","dotx","xla","xlam","xlc","xlf","xlm","xls","xlsb","xlsm","xlsx","xlt","xltm","xltx","xlw","txt","conf","pdf","encodeFilename","suffix","character","encodeCharacter","relativePath","_edgeVersion$split","major","minor","getTimeStamp","_console","_len2","_key2","_console2","_len3","_key3","_console3","_len4","_key4","getHours","getMinutes","getSeconds","preact","findDOMElement","mount","getPluginState","setPluginState","_updateUI","afterUpdate","onMount","calling","latestArgs","targetPlugin","callerPluginName","targetElement","isTargetDOMEl","rerender","render","replaceTargetContent","Target","addTarget","unmount","parentNode","removeChild","VNode","EMPTY_CHILDREN","h","nodeName","attributes","lastSimple","child","simple","children","vnode","extend","defer","cloneElement","IS_NON_DIMENSIONAL","enqueueRender","component","_dirty","debounceRendering","renderComponent","isSameNodeType","node","hydrating","splitText","_componentConstructor","isNamedNode","normalizedNodeName","getNodeProps","defaultProps","removeNode","setAccessor","old","isSvg","cssText","__html","useCapture","eventProxy","removeEventListener","_listeners","setProperty","removeAttribute","removeAttributeNS","setAttributeNS","mounts","diffLevel","isSvgMode","flushMounts","afterMount","componentDidMount","diff","dom","mountAll","componentRoot","ownerSVGElement","ret","idiff","prevSvgMode","_component","nodeValue","createTextNode","replaceChild","recollectNodeTree","vnodeName","originalComponent","oldDom","isDirectOwner","isOwner","_parentComponent","setComponentProps","unmountComponent","createComponent","nextBase","buildComponentFromVNode","createElementNS","firstChild","fc","vchildren","nextSibling","isHydrating","j","f","vchild","originalChildren","childNodes","keyed","keyedLen","childrenLen","vlen","_child","__key","insertBefore","innerDiffNode","dangerouslySetInnerHTML","attrs","diffAttributes","unmountOnly","ref","removeChildren","lastChild","previousSibling","components","Ctor","inst","Component","doRender","_disable","__ref","componentWillMount","componentWillReceiveProps","prevContext","prevProps","syncComponentUpdates","isChild","rendered","cbase","previousProps","previousState","previousContext","isUpdate","initialBase","initialChildComponent","shouldComponentUpdate","componentWillUpdate","getChildContext","toUnmount","childComponent","childProps","baseParent","componentRef","componentDidUpdate","_renderCallbacks","beforeUnmount","componentWillUnmount","inner","collectComponent","merge","forceUpdate","isDOMElement","nodeType","Node","ELEMENT_NODE","NetworkError","isNetworkError","request","tokenStorage","_RequestClient","provider","authProvider","toUpperCase","tokenKey","getAuthToken","token","authenticated","setAuthToken","storage","authUrl","fileUrl","directory","logout","initPlugin","defaultOpts","serverUrl","serverPattern","companionAllowedHosts","UppySocket","_queued","isOpen","_handleMessage","autoOpen","socket","WebSocket","onopen","first","action","payload","onclose","onmessage","handler","limit","ceil","createdPromise","chunks","chunkState","uploading","_initChunks","desiredChunkSize","minChunkSize","uploaded","busy","onStart","_uploadParts","_onError","PartNumber","Size","etag","ETag","need","every","_completeUpload","candidates","_uploadPart","_uploadPartBytes","total","totalUploaded","onPartComplete","ev","_onPartProgress","_onPartComplete","sort","really","pause","_abortUpload"],"mappings":"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","file":"file_form.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 18);\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","module.exports = require(\"regenerator-runtime\");\n","export const formatBytes = (bytes: number, decimals: number): string => {\n  if (bytes === 0) {\n    return \"0 Bytes\";\n  }\n\n  const k = 1024;\n  const dm = decimals <= 0 ? 0 : decimals || 2;\n  const sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\"];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  const n = parseFloat((bytes / k ** i).toFixed(dm));\n  const size = sizes[i];\n\n  return `${n} ${size}`;\n};\n\nexport const getInputNameWithPrefix = (\n  fieldName: string,\n  prefix: string | null\n): string => (prefix ? `${prefix}-${fieldName}` : fieldName);\n\nconst getInputNameWithoutPrefix = (\n  fieldName: string,\n  prefix: string | null\n): string => (prefix ? fieldName.slice(prefix.length + 1) : fieldName);\n\nexport const findInput = (\n  form: Element,\n  fieldName: string,\n  prefix: string | null\n): HTMLInputElement | null => {\n  const inputNameWithPrefix = getInputNameWithPrefix(fieldName, prefix);\n  const input = form.querySelector(`[name=\"${inputNameWithPrefix}\"]`);\n\n  if (!input) {\n    console.error(`Cannot find input with name '${inputNameWithPrefix}'`);\n    return null;\n  }\n\n  return input as HTMLInputElement;\n};\n\nexport const getPlaceholderFieldName = (\n  fieldName: string,\n  prefix: string | null\n): string => `placeholder-${getInputNameWithoutPrefix(fieldName, prefix)}`;\n\nexport const getInputValueForFormAndPrefix = (\n  form: Element,\n  fieldName: string,\n  prefix: string | null\n): string | undefined => findInput(form, fieldName, prefix)?.value;\n","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nmodule.exports = _asyncToGenerator;","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;","/**\n* Create an event emitter with namespaces\n* @name createNamespaceEmitter\n* @example\n* var emitter = require('./index')()\n*\n* emitter.on('*', function () {\n*   console.log('all events emitted', this.event)\n* })\n*\n* emitter.on('example', function () {\n*   console.log('example event emitted')\n* })\n*/\nmodule.exports = function createNamespaceEmitter () {\n  var emitter = {}\n  var _fns = emitter._fns = {}\n\n  /**\n  * Emit an event. Optionally namespace the event. Handlers are fired in the order in which they were added with exact matches taking precedence. Separate the namespace and event with a `:`\n  * @name emit\n  * @param {String} event  the name of the event, with optional namespace\n  * @param {...*} data  up to 6 arguments that are passed to the event listener\n  * @example\n  * emitter.emit('example')\n  * emitter.emit('demo:test')\n  * emitter.emit('data', { example: true}, 'a string', 1)\n  */\n  emitter.emit = function emit (event, arg1, arg2, arg3, arg4, arg5, arg6) {\n    var toEmit = getListeners(event)\n\n    if (toEmit.length) {\n      emitAll(event, toEmit, [arg1, arg2, arg3, arg4, arg5, arg6])\n    }\n  }\n\n  /**\n  * Create en event listener.\n  * @name on\n  * @param {String} event\n  * @param {Function} fn\n  * @example\n  * emitter.on('example', function () {})\n  * emitter.on('demo', function () {})\n  */\n  emitter.on = function on (event, fn) {\n    if (!_fns[event]) {\n      _fns[event] = []\n    }\n\n    _fns[event].push(fn)\n  }\n\n  /**\n  * Create en event listener that fires once.\n  * @name once\n  * @param {String} event\n  * @param {Function} fn\n  * @example\n  * emitter.once('example', function () {})\n  * emitter.once('demo', function () {})\n  */\n  emitter.once = function once (event, fn) {\n    function one () {\n      fn.apply(this, arguments)\n      emitter.off(event, one)\n    }\n    this.on(event, one)\n  }\n\n  /**\n  * Stop listening to an event. Stop all listeners on an event by only passing the event name. Stop a single listener by passing that event handler as a callback.\n  * You must be explicit about what will be unsubscribed: `emitter.off('demo')` will unsubscribe an `emitter.on('demo')` listener,\n  * `emitter.off('demo:example')` will unsubscribe an `emitter.on('demo:example')` listener\n  * @name off\n  * @param {String} event\n  * @param {Function} [fn]  the specific handler\n  * @example\n  * emitter.off('example')\n  * emitter.off('demo', function () {})\n  */\n  emitter.off = function off (event, fn) {\n    var keep = []\n\n    if (event && fn) {\n      var fns = this._fns[event]\n      var i = 0\n      var l = fns ? fns.length : 0\n\n      for (i; i < l; i++) {\n        if (fns[i] !== fn) {\n          keep.push(fns[i])\n        }\n      }\n    }\n\n    keep.length ? this._fns[event] = keep : delete this._fns[event]\n  }\n\n  function getListeners (e) {\n    var out = _fns[e] ? _fns[e] : []\n    var idx = e.indexOf(':')\n    var args = (idx === -1) ? [e] : [e.substring(0, idx), e.substring(idx + 1)]\n\n    var keys = Object.keys(_fns)\n    var i = 0\n    var l = keys.length\n\n    for (i; i < l; i++) {\n      var key = keys[i]\n      if (key === '*') {\n        out = out.concat(_fns[key])\n      }\n\n      if (args.length === 2 && args[0] === key) {\n        out = out.concat(_fns[key])\n        break\n      }\n    }\n\n    return out\n  }\n\n  function emitAll (e, fns, args) {\n    var i = 0\n    var l = fns.length\n\n    for (i; i < l; i++) {\n      if (!fns[i]) break\n      fns[i].event = e\n      fns[i].apply(fns[i], args)\n    }\n  }\n\n  return emitter\n}\n","module.exports = function pad (num, size) {\n  var s = '000000000' + num;\n  return s.substr(s.length - size);\n};\n","/**\n * Takes a full filename string and returns an object {name, extension}\n *\n * @param {string} fullFileName\n * @returns {object} {name, extension}\n */\nmodule.exports = function getFileNameAndExtension(fullFileName) {\n  var lastDot = fullFileName.lastIndexOf('.'); // these count as no extension: \"no-dot\", \"trailing-dot.\"\n\n  if (lastDot === -1 || lastDot === fullFileName.length - 1) {\n    return {\n      name: fullFileName,\n      extension: undefined\n    };\n  } else {\n    return {\n      name: fullFileName.slice(0, lastDot),\n      extension: fullFileName.slice(lastDot + 1)\n    };\n  }\n};","'use strict';\n\nvar _class, _temp;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar AuthError = require('./AuthError');\n\nvar fetchWithNetworkError = require('@uppy/utils/lib/fetchWithNetworkError'); // Remove the trailing slash so we can always safely append /xyz.\n\n\nfunction stripSlash(url) {\n  return url.replace(/\\/$/, '');\n}\n\nmodule.exports = (_temp = _class = /*#__PURE__*/function () {\n  function RequestClient(uppy, opts) {\n    this.uppy = uppy;\n    this.opts = opts;\n    this.onReceiveResponse = this.onReceiveResponse.bind(this);\n    this.allowedHeaders = ['accept', 'content-type', 'uppy-auth-token'];\n    this.preflightDone = false;\n  }\n\n  var _proto = RequestClient.prototype;\n\n  _proto.headers = function headers() {\n    var userHeaders = this.opts.companionHeaders || this.opts.serverHeaders || {};\n    return Promise.resolve(_extends({}, this.defaultHeaders, {}, userHeaders));\n  };\n\n  _proto._getPostResponseFunc = function _getPostResponseFunc(skip) {\n    var _this = this;\n\n    return function (response) {\n      if (!skip) {\n        return _this.onReceiveResponse(response);\n      }\n\n      return response;\n    };\n  };\n\n  _proto.onReceiveResponse = function onReceiveResponse(response) {\n    var state = this.uppy.getState();\n    var companion = state.companion || {};\n    var host = this.opts.companionUrl;\n    var headers = response.headers; // Store the self-identified domain name for the Companion instance we just hit.\n\n    if (headers.has('i-am') && headers.get('i-am') !== companion[host]) {\n      var _extends2;\n\n      this.uppy.setState({\n        companion: _extends({}, companion, (_extends2 = {}, _extends2[host] = headers.get('i-am'), _extends2))\n      });\n    }\n\n    return response;\n  };\n\n  _proto._getUrl = function _getUrl(url) {\n    if (/^(https?:|)\\/\\//.test(url)) {\n      return url;\n    }\n\n    return this.hostname + \"/\" + url;\n  };\n\n  _proto._json = function _json(res) {\n    if (res.status === 401) {\n      throw new AuthError();\n    }\n\n    if (res.status < 200 || res.status > 300) {\n      var errMsg = \"Failed request with status: \" + res.status + \". \" + res.statusText;\n      return res.json().then(function (errData) {\n        errMsg = errData.message ? errMsg + \" message: \" + errData.message : errMsg;\n        errMsg = errData.requestId ? errMsg + \" request-Id: \" + errData.requestId : errMsg;\n        throw new Error(errMsg);\n      }).catch(function () {\n        throw new Error(errMsg);\n      });\n    }\n\n    return res.json();\n  };\n\n  _proto.preflight = function preflight(path) {\n    var _this2 = this;\n\n    return new Promise(function (resolve, reject) {\n      if (_this2.preflightDone) {\n        return resolve(_this2.allowedHeaders.slice());\n      }\n\n      fetch(_this2._getUrl(path), {\n        method: 'OPTIONS'\n      }).then(function (response) {\n        if (response.headers.has('access-control-allow-headers')) {\n          _this2.allowedHeaders = response.headers.get('access-control-allow-headers').split(',').map(function (headerName) {\n            return headerName.trim().toLowerCase();\n          });\n        }\n\n        _this2.preflightDone = true;\n        resolve(_this2.allowedHeaders.slice());\n      }).catch(function (err) {\n        _this2.uppy.log(\"[CompanionClient] unable to make preflight request \" + err, 'warning');\n\n        _this2.preflightDone = true;\n        resolve(_this2.allowedHeaders.slice());\n      });\n    });\n  };\n\n  _proto.preflightAndHeaders = function preflightAndHeaders(path) {\n    var _this3 = this;\n\n    return Promise.all([this.preflight(path), this.headers()]).then(function (_ref) {\n      var allowedHeaders = _ref[0],\n          headers = _ref[1];\n      // filter to keep only allowed Headers\n      Object.keys(headers).forEach(function (header) {\n        if (allowedHeaders.indexOf(header.toLowerCase()) === -1) {\n          _this3.uppy.log(\"[CompanionClient] excluding unallowed header \" + header);\n\n          delete headers[header];\n        }\n      });\n      return headers;\n    });\n  };\n\n  _proto.get = function get(path, skipPostResponse) {\n    var _this4 = this;\n\n    return new Promise(function (resolve, reject) {\n      _this4.preflightAndHeaders(path).then(function (headers) {\n        fetchWithNetworkError(_this4._getUrl(path), {\n          method: 'get',\n          headers: headers,\n          credentials: 'same-origin'\n        }).then(_this4._getPostResponseFunc(skipPostResponse)).then(function (res) {\n          return _this4._json(res).then(resolve);\n        }).catch(function (err) {\n          err = err.isAuthError ? err : new Error(\"Could not get \" + _this4._getUrl(path) + \". \" + err);\n          reject(err);\n        });\n      }).catch(reject);\n    });\n  };\n\n  _proto.post = function post(path, data, skipPostResponse) {\n    var _this5 = this;\n\n    return new Promise(function (resolve, reject) {\n      _this5.preflightAndHeaders(path).then(function (headers) {\n        fetchWithNetworkError(_this5._getUrl(path), {\n          method: 'post',\n          headers: headers,\n          credentials: 'same-origin',\n          body: JSON.stringify(data)\n        }).then(_this5._getPostResponseFunc(skipPostResponse)).then(function (res) {\n          return _this5._json(res).then(resolve);\n        }).catch(function (err) {\n          err = err.isAuthError ? err : new Error(\"Could not post \" + _this5._getUrl(path) + \". \" + err);\n          reject(err);\n        });\n      }).catch(reject);\n    });\n  };\n\n  _proto.delete = function _delete(path, data, skipPostResponse) {\n    var _this6 = this;\n\n    return new Promise(function (resolve, reject) {\n      _this6.preflightAndHeaders(path).then(function (headers) {\n        fetchWithNetworkError(_this6.hostname + \"/\" + path, {\n          method: 'delete',\n          headers: headers,\n          credentials: 'same-origin',\n          body: data ? JSON.stringify(data) : null\n        }).then(_this6._getPostResponseFunc(skipPostResponse)).then(function (res) {\n          return _this6._json(res).then(resolve);\n        }).catch(function (err) {\n          err = err.isAuthError ? err : new Error(\"Could not delete \" + _this6._getUrl(path) + \". \" + err);\n          reject(err);\n        });\n      }).catch(reject);\n    });\n  };\n\n  _createClass(RequestClient, [{\n    key: \"hostname\",\n    get: function get() {\n      var _this$uppy$getState = this.uppy.getState(),\n          companion = _this$uppy$getState.companion;\n\n      var host = this.opts.companionUrl;\n      return stripSlash(companion && companion[host] ? companion[host] : host);\n    }\n  }, {\n    key: \"defaultHeaders\",\n    get: function get() {\n      return {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        'Uppy-Versions': \"@uppy/companion-client=\" + RequestClient.VERSION\n      };\n    }\n  }]);\n\n  return RequestClient;\n}(), _class.VERSION = \"1.5.0\", _temp);","/*\n *  base64.js\n *\n *  Licensed under the BSD 3-Clause License.\n *    http://opensource.org/licenses/BSD-3-Clause\n *\n *  References:\n *    http://en.wikipedia.org/wiki/Base64\n */\n;(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined'\n        ? module.exports = factory(global)\n        : typeof define === 'function' && define.amd\n        ? define(factory) : factory(global)\n}((\n    typeof self !== 'undefined' ? self\n        : typeof window !== 'undefined' ? window\n        : typeof global !== 'undefined' ? global\n: this\n), function(global) {\n    'use strict';\n    // existing version for noConflict()\n    global = global || {};\n    var _Base64 = global.Base64;\n    var version = \"2.6.3\";\n    // constants\n    var b64chars\n        = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n    var b64tab = function(bin) {\n        var t = {};\n        for (var i = 0, l = bin.length; i < l; i++) t[bin.charAt(i)] = i;\n        return t;\n    }(b64chars);\n    var fromCharCode = String.fromCharCode;\n    // encoder stuff\n    var cb_utob = function(c) {\n        if (c.length < 2) {\n            var cc = c.charCodeAt(0);\n            return cc < 0x80 ? c\n                : cc < 0x800 ? (fromCharCode(0xc0 | (cc >>> 6))\n                                + fromCharCode(0x80 | (cc & 0x3f)))\n                : (fromCharCode(0xe0 | ((cc >>> 12) & 0x0f))\n                    + fromCharCode(0x80 | ((cc >>>  6) & 0x3f))\n                    + fromCharCode(0x80 | ( cc         & 0x3f)));\n        } else {\n            var cc = 0x10000\n                + (c.charCodeAt(0) - 0xD800) * 0x400\n                + (c.charCodeAt(1) - 0xDC00);\n            return (fromCharCode(0xf0 | ((cc >>> 18) & 0x07))\n                    + fromCharCode(0x80 | ((cc >>> 12) & 0x3f))\n                    + fromCharCode(0x80 | ((cc >>>  6) & 0x3f))\n                    + fromCharCode(0x80 | ( cc         & 0x3f)));\n        }\n    };\n    var re_utob = /[\\uD800-\\uDBFF][\\uDC00-\\uDFFFF]|[^\\x00-\\x7F]/g;\n    var utob = function(u) {\n        return u.replace(re_utob, cb_utob);\n    };\n    var cb_encode = function(ccc) {\n        var padlen = [0, 2, 1][ccc.length % 3],\n        ord = ccc.charCodeAt(0) << 16\n            | ((ccc.length > 1 ? ccc.charCodeAt(1) : 0) << 8)\n            | ((ccc.length > 2 ? ccc.charCodeAt(2) : 0)),\n        chars = [\n            b64chars.charAt( ord >>> 18),\n            b64chars.charAt((ord >>> 12) & 63),\n            padlen >= 2 ? '=' : b64chars.charAt((ord >>> 6) & 63),\n            padlen >= 1 ? '=' : b64chars.charAt(ord & 63)\n        ];\n        return chars.join('');\n    };\n    var btoa = global.btoa && typeof global.btoa == 'function'\n        ? function(b){ return global.btoa(b) } : function(b) {\n        if (b.match(/[^\\x00-\\xFF]/)) throw new RangeError(\n            'The string contains invalid characters.'\n        );\n        return b.replace(/[\\s\\S]{1,3}/g, cb_encode);\n    };\n    var _encode = function(u) {\n        return btoa(utob(String(u)));\n    };\n    var mkUriSafe = function (b64) {\n        return b64.replace(/[+\\/]/g, function(m0) {\n            return m0 == '+' ? '-' : '_';\n        }).replace(/=/g, '');\n    };\n    var encode = function(u, urisafe) {\n        return urisafe ? mkUriSafe(_encode(u)) : _encode(u);\n    };\n    var encodeURI = function(u) { return encode(u, true) };\n    var fromUint8Array;\n    if (global.Uint8Array) fromUint8Array = function(a, urisafe) {\n        // return btoa(fromCharCode.apply(null, a));\n        var b64 = '';\n        for (var i = 0, l = a.length; i < l; i += 3) {\n            var a0 = a[i], a1 = a[i+1], a2 = a[i+2];\n            var ord = a0 << 16 | a1 << 8 | a2;\n            b64 +=    b64chars.charAt( ord >>> 18)\n                +     b64chars.charAt((ord >>> 12) & 63)\n                + ( typeof a1 != 'undefined'\n                    ? b64chars.charAt((ord >>>  6) & 63) : '=')\n                + ( typeof a2 != 'undefined'\n                    ? b64chars.charAt( ord         & 63) : '=');\n        }\n        return urisafe ? mkUriSafe(b64) : b64;\n    };\n    // decoder stuff\n    var re_btou = /[\\xC0-\\xDF][\\x80-\\xBF]|[\\xE0-\\xEF][\\x80-\\xBF]{2}|[\\xF0-\\xF7][\\x80-\\xBF]{3}/g;\n    var cb_btou = function(cccc) {\n        switch(cccc.length) {\n        case 4:\n            var cp = ((0x07 & cccc.charCodeAt(0)) << 18)\n                |    ((0x3f & cccc.charCodeAt(1)) << 12)\n                |    ((0x3f & cccc.charCodeAt(2)) <<  6)\n                |     (0x3f & cccc.charCodeAt(3)),\n            offset = cp - 0x10000;\n            return (fromCharCode((offset  >>> 10) + 0xD800)\n                    + fromCharCode((offset & 0x3FF) + 0xDC00));\n        case 3:\n            return fromCharCode(\n                ((0x0f & cccc.charCodeAt(0)) << 12)\n                    | ((0x3f & cccc.charCodeAt(1)) << 6)\n                    |  (0x3f & cccc.charCodeAt(2))\n            );\n        default:\n            return  fromCharCode(\n                ((0x1f & cccc.charCodeAt(0)) << 6)\n                    |  (0x3f & cccc.charCodeAt(1))\n            );\n        }\n    };\n    var btou = function(b) {\n        return b.replace(re_btou, cb_btou);\n    };\n    var cb_decode = function(cccc) {\n        var len = cccc.length,\n        padlen = len % 4,\n        n = (len > 0 ? b64tab[cccc.charAt(0)] << 18 : 0)\n            | (len > 1 ? b64tab[cccc.charAt(1)] << 12 : 0)\n            | (len > 2 ? b64tab[cccc.charAt(2)] <<  6 : 0)\n            | (len > 3 ? b64tab[cccc.charAt(3)]       : 0),\n        chars = [\n            fromCharCode( n >>> 16),\n            fromCharCode((n >>>  8) & 0xff),\n            fromCharCode( n         & 0xff)\n        ];\n        chars.length -= [0, 0, 2, 1][padlen];\n        return chars.join('');\n    };\n    var _atob = global.atob && typeof global.atob == 'function'\n        ? function(a){ return global.atob(a) } : function(a){\n        return a.replace(/\\S{1,4}/g, cb_decode);\n    };\n    var atob = function(a) {\n        return _atob(String(a).replace(/[^A-Za-z0-9\\+\\/]/g, ''));\n    };\n    var _decode = function(a) { return btou(_atob(a)) };\n    var _fromURI = function(a) {\n        return String(a).replace(/[-_]/g, function(m0) {\n            return m0 == '-' ? '+' : '/'\n        }).replace(/[^A-Za-z0-9\\+\\/]/g, '');\n    };\n    var decode = function(a){\n        return _decode(_fromURI(a));\n    };\n    var toUint8Array;\n    if (global.Uint8Array) toUint8Array = function(a) {\n        return Uint8Array.from(atob(_fromURI(a)), function(c) {\n            return c.charCodeAt(0);\n        });\n    };\n    var noConflict = function() {\n        var Base64 = global.Base64;\n        global.Base64 = _Base64;\n        return Base64;\n    };\n    // export Base64\n    global.Base64 = {\n        VERSION: version,\n        atob: atob,\n        btoa: btoa,\n        fromBase64: decode,\n        toBase64: encode,\n        utob: utob,\n        encode: encode,\n        encodeURI: encodeURI,\n        btou: btou,\n        decode: decode,\n        noConflict: noConflict,\n        fromUint8Array: fromUint8Array,\n        toUint8Array: toUint8Array\n    };\n    // if ES5 is available, make Base64.extendString() available\n    if (typeof Object.defineProperty === 'function') {\n        var noEnum = function(v){\n            return {value:v,enumerable:false,writable:true,configurable:true};\n        };\n        global.Base64.extendString = function () {\n            Object.defineProperty(\n                String.prototype, 'fromBase64', noEnum(function () {\n                    return decode(this)\n                }));\n            Object.defineProperty(\n                String.prototype, 'toBase64', noEnum(function (urisafe) {\n                    return encode(this, urisafe)\n                }));\n            Object.defineProperty(\n                String.prototype, 'toBase64URI', noEnum(function () {\n                    return encode(this, true)\n                }));\n        };\n    }\n    //\n    // export Base64 to the namespace\n    //\n    if (global['Meteor']) { // Meteor.js\n        Base64 = global.Base64;\n    }\n    // module.exports and AMD are mutually exclusive.\n    // module.exports has precedence.\n    if (typeof module !== 'undefined' && module.exports) {\n        module.exports.Base64 = global.Base64;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define([], function(){ return global.Base64 });\n    }\n    // that's it!\n    return {Base64: global.Base64}\n}));\n","'use strict';\n\nvar required = require('requires-port')\n  , qs = require('querystringify')\n  , slashes = /^[A-Za-z][A-Za-z0-9+-.]*:\\/\\//\n  , protocolre = /^([a-z][a-z0-9.+-]*:)?(\\/\\/)?([\\S\\s]*)/i\n  , whitespace = '[\\\\x09\\\\x0A\\\\x0B\\\\x0C\\\\x0D\\\\x20\\\\xA0\\\\u1680\\\\u180E\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200A\\\\u202F\\\\u205F\\\\u3000\\\\u2028\\\\u2029\\\\uFEFF]'\n  , left = new RegExp('^'+ whitespace +'+');\n\n/**\n * Trim a given string.\n *\n * @param {String} str String to trim.\n * @public\n */\nfunction trimLeft(str) {\n  return (str ? str : '').toString().replace(left, '');\n}\n\n/**\n * These are the parse rules for the URL parser, it informs the parser\n * about:\n *\n * 0. The char it Needs to parse, if it's a string it should be done using\n *    indexOf, RegExp using exec and NaN means set as current value.\n * 1. The property we should set when parsing this value.\n * 2. Indication if it's backwards or forward parsing, when set as number it's\n *    the value of extra chars that should be split off.\n * 3. Inherit from location if non existing in the parser.\n * 4. `toLowerCase` the resulting value.\n */\nvar rules = [\n  ['#', 'hash'],                        // Extract from the back.\n  ['?', 'query'],                       // Extract from the back.\n  function sanitize(address) {          // Sanitize what is left of the address\n    return address.replace('\\\\', '/');\n  },\n  ['/', 'pathname'],                    // Extract from the back.\n  ['@', 'auth', 1],                     // Extract from the front.\n  [NaN, 'host', undefined, 1, 1],       // Set left over value.\n  [/:(\\d+)$/, 'port', undefined, 1],    // RegExp the back.\n  [NaN, 'hostname', undefined, 1, 1]    // Set left over.\n];\n\n/**\n * These properties should not be copied or inherited from. This is only needed\n * for all non blob URL's as a blob URL does not include a hash, only the\n * origin.\n *\n * @type {Object}\n * @private\n */\nvar ignore = { hash: 1, query: 1 };\n\n/**\n * The location object differs when your code is loaded through a normal page,\n * Worker or through a worker using a blob. And with the blobble begins the\n * trouble as the location object will contain the URL of the blob, not the\n * location of the page where our code is loaded in. The actual origin is\n * encoded in the `pathname` so we can thankfully generate a good \"default\"\n * location from it so we can generate proper relative URL's again.\n *\n * @param {Object|String} loc Optional default location object.\n * @returns {Object} lolcation object.\n * @public\n */\nfunction lolcation(loc) {\n  var globalVar;\n\n  if (typeof window !== 'undefined') globalVar = window;\n  else if (typeof global !== 'undefined') globalVar = global;\n  else if (typeof self !== 'undefined') globalVar = self;\n  else globalVar = {};\n\n  var location = globalVar.location || {};\n  loc = loc || location;\n\n  var finaldestination = {}\n    , type = typeof loc\n    , key;\n\n  if ('blob:' === loc.protocol) {\n    finaldestination = new Url(unescape(loc.pathname), {});\n  } else if ('string' === type) {\n    finaldestination = new Url(loc, {});\n    for (key in ignore) delete finaldestination[key];\n  } else if ('object' === type) {\n    for (key in loc) {\n      if (key in ignore) continue;\n      finaldestination[key] = loc[key];\n    }\n\n    if (finaldestination.slashes === undefined) {\n      finaldestination.slashes = slashes.test(loc.href);\n    }\n  }\n\n  return finaldestination;\n}\n\n/**\n * @typedef ProtocolExtract\n * @type Object\n * @property {String} protocol Protocol matched in the URL, in lowercase.\n * @property {Boolean} slashes `true` if protocol is followed by \"//\", else `false`.\n * @property {String} rest Rest of the URL that is not part of the protocol.\n */\n\n/**\n * Extract protocol information from a URL with/without double slash (\"//\").\n *\n * @param {String} address URL we want to extract from.\n * @return {ProtocolExtract} Extracted information.\n * @private\n */\nfunction extractProtocol(address) {\n  address = trimLeft(address);\n  var match = protocolre.exec(address);\n\n  return {\n    protocol: match[1] ? match[1].toLowerCase() : '',\n    slashes: !!match[2],\n    rest: match[3]\n  };\n}\n\n/**\n * Resolve a relative URL pathname against a base URL pathname.\n *\n * @param {String} relative Pathname of the relative URL.\n * @param {String} base Pathname of the base URL.\n * @return {String} Resolved pathname.\n * @private\n */\nfunction resolve(relative, base) {\n  if (relative === '') return base;\n\n  var path = (base || '/').split('/').slice(0, -1).concat(relative.split('/'))\n    , i = path.length\n    , last = path[i - 1]\n    , unshift = false\n    , up = 0;\n\n  while (i--) {\n    if (path[i] === '.') {\n      path.splice(i, 1);\n    } else if (path[i] === '..') {\n      path.splice(i, 1);\n      up++;\n    } else if (up) {\n      if (i === 0) unshift = true;\n      path.splice(i, 1);\n      up--;\n    }\n  }\n\n  if (unshift) path.unshift('');\n  if (last === '.' || last === '..') path.push('');\n\n  return path.join('/');\n}\n\n/**\n * The actual URL instance. Instead of returning an object we've opted-in to\n * create an actual constructor as it's much more memory efficient and\n * faster and it pleases my OCD.\n *\n * It is worth noting that we should not use `URL` as class name to prevent\n * clashes with the global URL instance that got introduced in browsers.\n *\n * @constructor\n * @param {String} address URL we want to parse.\n * @param {Object|String} [location] Location defaults for relative paths.\n * @param {Boolean|Function} [parser] Parser for the query string.\n * @private\n */\nfunction Url(address, location, parser) {\n  address = trimLeft(address);\n\n  if (!(this instanceof Url)) {\n    return new Url(address, location, parser);\n  }\n\n  var relative, extracted, parse, instruction, index, key\n    , instructions = rules.slice()\n    , type = typeof location\n    , url = this\n    , i = 0;\n\n  //\n  // The following if statements allows this module two have compatibility with\n  // 2 different API:\n  //\n  // 1. Node.js's `url.parse` api which accepts a URL, boolean as arguments\n  //    where the boolean indicates that the query string should also be parsed.\n  //\n  // 2. The `URL` interface of the browser which accepts a URL, object as\n  //    arguments. The supplied object will be used as default values / fall-back\n  //    for relative paths.\n  //\n  if ('object' !== type && 'string' !== type) {\n    parser = location;\n    location = null;\n  }\n\n  if (parser && 'function' !== typeof parser) parser = qs.parse;\n\n  location = lolcation(location);\n\n  //\n  // Extract protocol information before running the instructions.\n  //\n  extracted = extractProtocol(address || '');\n  relative = !extracted.protocol && !extracted.slashes;\n  url.slashes = extracted.slashes || relative && location.slashes;\n  url.protocol = extracted.protocol || location.protocol || '';\n  address = extracted.rest;\n\n  //\n  // When the authority component is absent the URL starts with a path\n  // component.\n  //\n  if (!extracted.slashes) instructions[3] = [/(.*)/, 'pathname'];\n\n  for (; i < instructions.length; i++) {\n    instruction = instructions[i];\n\n    if (typeof instruction === 'function') {\n      address = instruction(address);\n      continue;\n    }\n\n    parse = instruction[0];\n    key = instruction[1];\n\n    if (parse !== parse) {\n      url[key] = address;\n    } else if ('string' === typeof parse) {\n      if (~(index = address.indexOf(parse))) {\n        if ('number' === typeof instruction[2]) {\n          url[key] = address.slice(0, index);\n          address = address.slice(index + instruction[2]);\n        } else {\n          url[key] = address.slice(index);\n          address = address.slice(0, index);\n        }\n      }\n    } else if ((index = parse.exec(address))) {\n      url[key] = index[1];\n      address = address.slice(0, index.index);\n    }\n\n    url[key] = url[key] || (\n      relative && instruction[3] ? location[key] || '' : ''\n    );\n\n    //\n    // Hostname, host and protocol should be lowercased so they can be used to\n    // create a proper `origin`.\n    //\n    if (instruction[4]) url[key] = url[key].toLowerCase();\n  }\n\n  //\n  // Also parse the supplied query string in to an object. If we're supplied\n  // with a custom parser as function use that instead of the default build-in\n  // parser.\n  //\n  if (parser) url.query = parser(url.query);\n\n  //\n  // If the URL is relative, resolve the pathname against the base URL.\n  //\n  if (\n      relative\n    && location.slashes\n    && url.pathname.charAt(0) !== '/'\n    && (url.pathname !== '' || location.pathname !== '')\n  ) {\n    url.pathname = resolve(url.pathname, location.pathname);\n  }\n\n  //\n  // We should not add port numbers if they are already the default port number\n  // for a given protocol. As the host also contains the port number we're going\n  // override it with the hostname which contains no port number.\n  //\n  if (!required(url.port, url.protocol)) {\n    url.host = url.hostname;\n    url.port = '';\n  }\n\n  //\n  // Parse down the `auth` for the username and password.\n  //\n  url.username = url.password = '';\n  if (url.auth) {\n    instruction = url.auth.split(':');\n    url.username = instruction[0] || '';\n    url.password = instruction[1] || '';\n  }\n\n  url.origin = url.protocol && url.host && url.protocol !== 'file:'\n    ? url.protocol +'//'+ url.host\n    : 'null';\n\n  //\n  // The href is just the compiled result.\n  //\n  url.href = url.toString();\n}\n\n/**\n * This is convenience method for changing properties in the URL instance to\n * insure that they all propagate correctly.\n *\n * @param {String} part          Property we need to adjust.\n * @param {Mixed} value          The newly assigned value.\n * @param {Boolean|Function} fn  When setting the query, it will be the function\n *                               used to parse the query.\n *                               When setting the protocol, double slash will be\n *                               removed from the final url if it is true.\n * @returns {URL} URL instance for chaining.\n * @public\n */\nfunction set(part, value, fn) {\n  var url = this;\n\n  switch (part) {\n    case 'query':\n      if ('string' === typeof value && value.length) {\n        value = (fn || qs.parse)(value);\n      }\n\n      url[part] = value;\n      break;\n\n    case 'port':\n      url[part] = value;\n\n      if (!required(value, url.protocol)) {\n        url.host = url.hostname;\n        url[part] = '';\n      } else if (value) {\n        url.host = url.hostname +':'+ value;\n      }\n\n      break;\n\n    case 'hostname':\n      url[part] = value;\n\n      if (url.port) value += ':'+ url.port;\n      url.host = value;\n      break;\n\n    case 'host':\n      url[part] = value;\n\n      if (/:\\d+$/.test(value)) {\n        value = value.split(':');\n        url.port = value.pop();\n        url.hostname = value.join(':');\n      } else {\n        url.hostname = value;\n        url.port = '';\n      }\n\n      break;\n\n    case 'protocol':\n      url.protocol = value.toLowerCase();\n      url.slashes = !fn;\n      break;\n\n    case 'pathname':\n    case 'hash':\n      if (value) {\n        var char = part === 'pathname' ? '/' : '#';\n        url[part] = value.charAt(0) !== char ? char + value : value;\n      } else {\n        url[part] = value;\n      }\n      break;\n\n    default:\n      url[part] = value;\n  }\n\n  for (var i = 0; i < rules.length; i++) {\n    var ins = rules[i];\n\n    if (ins[4]) url[ins[1]] = url[ins[1]].toLowerCase();\n  }\n\n  url.origin = url.protocol && url.host && url.protocol !== 'file:'\n    ? url.protocol +'//'+ url.host\n    : 'null';\n\n  url.href = url.toString();\n\n  return url;\n}\n\n/**\n * Transform the properties back in to a valid and full URL string.\n *\n * @param {Function} stringify Optional query stringify function.\n * @returns {String} Compiled version of the URL.\n * @public\n */\nfunction toString(stringify) {\n  if (!stringify || 'function' !== typeof stringify) stringify = qs.stringify;\n\n  var query\n    , url = this\n    , protocol = url.protocol;\n\n  if (protocol && protocol.charAt(protocol.length - 1) !== ':') protocol += ':';\n\n  var result = protocol + (url.slashes ? '//' : '');\n\n  if (url.username) {\n    result += url.username;\n    if (url.password) result += ':'+ url.password;\n    result += '@';\n  }\n\n  result += url.host + url.pathname;\n\n  query = 'object' === typeof url.query ? stringify(url.query) : url.query;\n  if (query) result += '?' !== query.charAt(0) ? '?'+ query : query;\n\n  if (url.hash) result += url.hash;\n\n  return result;\n}\n\nUrl.prototype = { set: set, toString: toString };\n\n//\n// Expose the URL parser and some additional properties that might be useful for\n// others or testing.\n//\nUrl.extractProtocol = extractProtocol;\nUrl.location = lolcation;\nUrl.trimLeft = trimLeft;\nUrl.qs = qs;\n\nmodule.exports = Url;\n","/*!\n * escape-html\n * Copyright(c) 2012-2013 TJ Holowaychuk\n * Copyright(c) 2015 Andreas Lubbe\n * Copyright(c) 2015 Tiancheng \"Timothy\" Gu\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module variables.\n * @private\n */\n\nvar matchHtmlRegExp = /[\"'&<>]/;\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = escapeHtml;\n\n/**\n * Escape special characters in the given string of html.\n *\n * @param  {string} string The string to escape for inserting into HTML\n * @return {string}\n * @public\n */\n\nfunction escapeHtml(string) {\n  var str = '' + string;\n  var match = matchHtmlRegExp.exec(str);\n\n  if (!match) {\n    return str;\n  }\n\n  var escape;\n  var html = '';\n  var index = 0;\n  var lastIndex = 0;\n\n  for (index = match.index; index < str.length; index++) {\n    switch (str.charCodeAt(index)) {\n      case 34: // \"\n        escape = '&quot;';\n        break;\n      case 38: // &\n        escape = '&amp;';\n        break;\n      case 39: // '\n        escape = '&#39;';\n        break;\n      case 60: // <\n        escape = '&lt;';\n        break;\n      case 62: // >\n        escape = '&gt;';\n        break;\n      default:\n        continue;\n    }\n\n    if (lastIndex !== index) {\n      html += str.substring(lastIndex, index);\n    }\n\n    lastIndex = index + 1;\n    html += escape;\n  }\n\n  return lastIndex !== index\n    ? html + str.substring(lastIndex, index)\n    : html;\n}\n","function _asyncIterator(iterable) {\n  var method;\n\n  if (typeof Symbol !== \"undefined\") {\n    if (Symbol.asyncIterator) {\n      method = iterable[Symbol.asyncIterator];\n      if (method != null) return method.call(iterable);\n    }\n\n    if (Symbol.iterator) {\n      method = iterable[Symbol.iterator];\n      if (method != null) return method.call(iterable);\n    }\n  }\n\n  throw new TypeError(\"Object is not async iterable\");\n}\n\nmodule.exports = _asyncIterator;","function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === \"function\" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== \"function\") { throw new TypeError(\"Super expression must either be null or a function\"); } if (typeof _cache !== \"undefined\") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction _construct(Parent, args, Class) { if (_isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf(\"[native code]\") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar DetailedError = /*#__PURE__*/function (_Error) {\n  _inherits(DetailedError, _Error);\n\n  var _super = _createSuper(DetailedError);\n\n  function DetailedError(message) {\n    var _this;\n\n    var causingErr = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var req = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    var res = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\n    _classCallCheck(this, DetailedError);\n\n    _this = _super.call(this, message);\n    _this.originalRequest = req;\n    _this.originalResponse = res;\n    _this.causingError = causingErr;\n\n    if (causingErr != null) {\n      message += \", caused by \".concat(causingErr.toString());\n    }\n\n    if (req != null) {\n      var requestId = req.getHeader(\"X-Request-ID\") || \"n/a\";\n      var method = req.getMethod();\n      var url = req.getURL();\n      var status = res ? res.getStatus() : \"n/a\";\n      var body = res ? res.getBody() || \"\" : \"n/a\";\n      message += \", originated from request (method: \".concat(method, \", url: \").concat(url, \", response code: \").concat(status, \", response text: \").concat(body, \", request id: \").concat(requestId, \")\");\n    }\n\n    _this.message = message;\n    return _this;\n  }\n\n  return DetailedError;\n}( /*#__PURE__*/_wrapNativeSuper(Error));\n\nexport default DetailedError;","/* eslint no-console: \"off\" */\nvar isEnabled = false;\nexport function enableDebugLog() {\n  isEnabled = true;\n}\nexport function log(msg) {\n  if (!isEnabled) return;\n  console.log(msg);\n}","function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n/* global window */\nimport DetailedError from \"./error\";\nimport uuid from \"./uuid\";\nimport { Base64 } from \"js-base64\";\nimport URL from \"url-parse\";\nimport { log } from \"./logger\";\nvar defaultOptions = {\n  endpoint: null,\n  uploadUrl: null,\n  metadata: {},\n  fingerprint: null,\n  uploadSize: null,\n  onProgress: null,\n  onChunkComplete: null,\n  onSuccess: null,\n  onError: null,\n  _onUploadUrlAvailable: null,\n  overridePatchMethod: false,\n  headers: {},\n  addRequestId: false,\n  onBeforeRequest: null,\n  onAfterResponse: null,\n  chunkSize: Infinity,\n  retryDelays: [0, 1000, 3000, 5000],\n  parallelUploads: 1,\n  storeFingerprintForResuming: true,\n  removeFingerprintOnSuccess: false,\n  uploadLengthDeferred: false,\n  uploadDataDuringCreation: false,\n  urlStorage: null,\n  fileReader: null,\n  httpStack: null\n};\n\nvar BaseUpload = /*#__PURE__*/function () {\n  function BaseUpload(file, options) {\n    _classCallCheck(this, BaseUpload);\n\n    // Warn about removed options from previous versions\n    if (\"resume\" in options) {\n      console.log(\"tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead.\"); // eslint-disable-line no-console\n    } // The default options will already be added from the wrapper classes.\n\n\n    this.options = options; // The storage module used to store URLs\n\n    this._urlStorage = this.options.urlStorage; // The underlying File/Blob object\n\n    this.file = file; // The URL against which the file will be uploaded\n\n    this.url = null; // The underlying request object for the current PATCH request\n\n    this._req = null; // The fingerpinrt for the current file (set after start())\n\n    this._fingerprint = null; // The key that the URL storage returned when saving an URL with a fingerprint,\n\n    this._urlStorageKey = null; // The offset used in the current PATCH request\n\n    this._offset = null; // True if the current PATCH request has been aborted\n\n    this._aborted = false; // The file's size in bytes\n\n    this._size = null; // The Source object which will wrap around the given file and provides us\n    // with a unified interface for getting its size and slice chunks from its\n    // content allowing us to easily handle Files, Blobs, Buffers and Streams.\n\n    this._source = null; // The current count of attempts which have been made. Zero indicates none.\n\n    this._retryAttempt = 0; // The timeout's ID which is used to delay the next retry\n\n    this._retryTimeout = null; // The offset of the remote upload before the latest attempt was started.\n\n    this._offsetBeforeRetry = 0; // An array of BaseUpload instances which are used for uploading the different\n    // parts, if the parallelUploads option is used.\n\n    this._parallelUploads = null; // An array of upload URLs which are used for uploading the different\n    // parts, if the parallelUploads option is used.\n\n    this._parallelUploadUrls = null;\n  }\n  /**\n   * Use the Termination extension to delete an upload from the server by sending a DELETE\n   * request to the specified upload URL. This is only possible if the server supports the\n   * Termination extension. If the `options.retryDelays` property is set, the method will\n   * also retry if an error ocurrs.\n   *\n   * @param {String} url The upload's URL which will be terminated.\n   * @param {object} options Optional options for influencing HTTP requests.\n   * @return {Promise} The Promise will be resolved/rejected when the requests finish.\n   */\n\n\n  _createClass(BaseUpload, [{\n    key: \"findPreviousUploads\",\n    value: function findPreviousUploads() {\n      var _this = this;\n\n      return this.options.fingerprint(this.file, this.options).then(function (fingerprint) {\n        return _this._urlStorage.findUploadsByFingerprint(fingerprint);\n      });\n    }\n  }, {\n    key: \"resumeFromPreviousUpload\",\n    value: function resumeFromPreviousUpload(previousUpload) {\n      this.url = previousUpload.uploadUrl || null;\n      this._parallelUploadUrls = previousUpload.parallelUploadUrls || null;\n      this._urlStorageKey = previousUpload.urlStorageKey;\n    }\n  }, {\n    key: \"start\",\n    value: function start() {\n      var _this2 = this;\n\n      var file = this.file;\n\n      if (!file) {\n        this._emitError(new Error(\"tus: no file or stream to upload provided\"));\n\n        return;\n      }\n\n      if (!this.options.endpoint && !this.options.uploadUrl) {\n        this._emitError(new Error(\"tus: neither an endpoint or an upload URL is provided\"));\n\n        return;\n      }\n\n      var retryDelays = this.options.retryDelays;\n\n      if (retryDelays != null && Object.prototype.toString.call(retryDelays) !== \"[object Array]\") {\n        this._emitError(new Error(\"tus: the `retryDelays` option must either be an array or null\"));\n\n        return;\n      }\n\n      if (this.options.parallelUploads > 1) {\n        // Test which options are incompatible with parallel uploads.\n        [\"uploadUrl\", \"uploadSize\", \"uploadLengthDeferred\"].forEach(function (optionName) {\n          if (_this2.options[optionName]) {\n            _this2._emitError(new Error(\"tus: cannot use the \".concat(optionName, \" option when parallelUploads is enabled\")));\n          }\n        });\n      }\n\n      this.options.fingerprint(file, this.options).then(function (fingerprint) {\n        if (fingerprint == null) {\n          log(\"No fingerprint was calculated meaning that the upload cannot be stored in the URL storage.\");\n        } else {\n          log(\"Calculated fingerprint: \".concat(fingerprint));\n        }\n\n        _this2._fingerprint = fingerprint;\n\n        if (_this2._source) {\n          return _this2._source;\n        } else {\n          return _this2.options.fileReader.openFile(file, _this2.options.chunkSize);\n        }\n      }).then(function (source) {\n        _this2._source = source; // If the upload was configured to use multiple requests or if we resume from\n        // an upload which used multiple requests, we start a parallel upload.\n\n        if (_this2.options.parallelUploads > 1 || _this2._parallelUploadUrls != null) {\n          _this2._startParallelUpload();\n        } else {\n          _this2._startSingleUpload();\n        }\n      })[\"catch\"](function (err) {\n        _this2._emitError(err);\n      });\n    }\n    /**\n     * Initiate the uploading procedure for a parallelized upload, where one file is split into\n     * multiple request which are run in parallel.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_startParallelUpload\",\n    value: function _startParallelUpload() {\n      var _this3 = this;\n\n      var totalSize = this._size = this._source.size;\n      var totalProgress = 0;\n      this._parallelUploads = [];\n      var partCount = this._parallelUploadUrls != null ? this._parallelUploadUrls.length : this.options.parallelUploads; // The input file will be split into multiple slices which are uploaded in separate\n      // requests. Here we generate the start and end position for the slices.\n\n      var parts = splitSizeIntoParts(this._source.size, partCount, this._parallelUploadUrls); // Create an empty list for storing the upload URLs\n\n      this._parallelUploadUrls = new Array(parts.length); // Generate a promise for each slice that will be resolve if the respective\n      // upload is completed.\n\n      var uploads = parts.map(function (part, index) {\n        var lastPartProgress = 0;\n        return _this3._source.slice(part.start, part.end).then(function (_ref) {\n          var value = _ref.value;\n          return new Promise(function (resolve, reject) {\n            // Merge with the user supplied options but overwrite some values.\n            var options = _objectSpread({}, _this3.options, {\n              // If available, the partial upload should be resumed from a previous URL.\n              uploadUrl: part.uploadUrl || null,\n              // We take manually care of resuming for partial uploads, so they should\n              // not be stored in the URL storage.\n              storeFingerprintForResuming: false,\n              removeFingerprintOnSuccess: false,\n              // Reset the parallelUploads option to not cause recursion.\n              parallelUploads: 1,\n              metadata: {},\n              // Add the header to indicate the this is a partial upload.\n              headers: _objectSpread({}, _this3.options.headers, {\n                \"Upload-Concat\": \"partial\"\n              }),\n              // Reject or resolve the promise if the upload errors or completes.\n              onSuccess: resolve,\n              onError: reject,\n              // Based in the progress for this partial upload, calculate the progress\n              // for the entire final upload.\n              onProgress: function onProgress(newPartProgress) {\n                totalProgress = totalProgress - lastPartProgress + newPartProgress;\n                lastPartProgress = newPartProgress;\n\n                _this3._emitProgress(totalProgress, totalSize);\n              },\n              // Wait until every partial upload has an upload URL, so we can add\n              // them to the URL storage.\n              _onUploadUrlAvailable: function _onUploadUrlAvailable() {\n                _this3._parallelUploadUrls[index] = upload.url; // Test if all uploads have received an URL\n\n                if (_this3._parallelUploadUrls.filter(function (u) {\n                  return !!u;\n                }).length === parts.length) {\n                  _this3._saveUploadInUrlStorage();\n                }\n              }\n            });\n\n            var upload = new BaseUpload(value, options);\n            upload.start(); // Store the upload in an array, so we can later abort them if necessary.\n\n            _this3._parallelUploads.push(upload);\n          });\n        });\n      });\n      var req; // Wait until all partial uploads are finished and we can send the POST request for\n      // creating the final upload.\n\n      Promise.all(uploads).then(function () {\n        req = _this3._openRequest(\"POST\", _this3.options.endpoint);\n        req.setHeader(\"Upload-Concat\", \"final;\".concat(_this3._parallelUploadUrls.join(\" \"))); // Add metadata if values have been added\n\n        var metadata = encodeMetadata(_this3.options.metadata);\n\n        if (metadata !== \"\") {\n          req.setHeader(\"Upload-Metadata\", metadata);\n        }\n\n        return _this3._sendRequest(req, null);\n      }).then(function (res) {\n        if (!inStatusCategory(res.getStatus(), 200)) {\n          _this3._emitHttpError(req, res, \"tus: unexpected response while creating upload\");\n\n          return;\n        }\n\n        var location = res.getHeader(\"Location\");\n\n        if (location == null) {\n          _this3._emitHttpError(req, res, \"tus: invalid or missing Location header\");\n\n          return;\n        }\n\n        _this3.url = resolveUrl(_this3.options.endpoint, location);\n        log(\"Created upload at \".concat(_this3.url));\n\n        _this3._emitSuccess();\n      })[\"catch\"](function (err) {\n        _this3._emitError(err);\n      });\n    }\n    /**\n     * Initiate the uploading procedure for a non-parallel upload. Here the entire file is\n     * uploaded in a sequential matter.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_startSingleUpload\",\n    value: function _startSingleUpload() {\n      // First, we look at the uploadLengthDeferred option.\n      // Next, we check if the caller has supplied a manual upload size.\n      // Finally, we try to use the calculated size from the source object.\n      if (this.options.uploadLengthDeferred) {\n        this._size = null;\n      } else if (this.options.uploadSize != null) {\n        this._size = +this.options.uploadSize;\n\n        if (isNaN(this._size)) {\n          this._emitError(new Error(\"tus: cannot convert `uploadSize` option into a number\"));\n\n          return;\n        }\n      } else {\n        this._size = this._source.size;\n\n        if (this._size == null) {\n          this._emitError(new Error(\"tus: cannot automatically derive upload's size from input and must be specified manually using the `uploadSize` option\"));\n\n          return;\n        }\n      } // Reset the aborted flag when the upload is started or else the\n      // _performUpload will stop before sending a request if the upload has been\n      // aborted previously.\n\n\n      this._aborted = false; // The upload had been started previously and we should reuse this URL.\n\n      if (this.url != null) {\n        log(\"Resuming upload from previous URL: \".concat(this.url));\n\n        this._resumeUpload();\n\n        return;\n      } // A URL has manually been specified, so we try to resume\n\n\n      if (this.options.uploadUrl != null) {\n        log(\"Resuming upload from provided URL: \".concat(this.options.url));\n        this.url = this.options.uploadUrl;\n\n        this._resumeUpload();\n\n        return;\n      } // An upload has not started for the file yet, so we start a new one\n\n\n      log(\"Creating a new upload\");\n\n      this._createUpload();\n    }\n    /**\n     * Abort any running request and stop the current upload. After abort is called, no event\n     * handler will be invoked anymore. You can use the `start` method to resume the upload\n     * again.\n     * If `shouldTerminate` is true, the `terminate` function will be called to remove the\n     * current upload from the server.\n     *\n     * @param {boolean} shouldTerminate True if the upload should be deleted from the server.\n     * @return {Promise} The Promise will be resolved/rejected when the requests finish.\n     */\n\n  }, {\n    key: \"abort\",\n    value: function abort(shouldTerminate, cb) {\n      var _this4 = this;\n\n      if (typeof cb === \"function\") {\n        throw new Error(\"tus: the abort function does not accept a callback since v2 anymore; please use the returned Promise instead\");\n      } // Stop any parallel partial uploads, that have been started in _startParallelUploads.\n\n\n      if (this._parallelUploads != null) {\n        this._parallelUploads.forEach(function (upload) {\n          upload.abort(shouldTerminate);\n        });\n      } // Stop any current running request.\n\n\n      if (this._req !== null) {\n        this._req.abort();\n\n        this._source.close();\n      }\n\n      this._aborted = true; // Stop any timeout used for initiating a retry.\n\n      if (this._retryTimeout != null) {\n        clearTimeout(this._retryTimeout);\n        this._retryTimeout = null;\n      }\n\n      if (!shouldTerminate || this.url == null) {\n        return Promise.resolve();\n      }\n\n      return BaseUpload.terminate(this.url, this.options) // Remove entry from the URL storage since the upload URL is no longer valid.\n      .then(function () {\n        return _this4._removeFromUrlStorage();\n      });\n    }\n  }, {\n    key: \"_emitHttpError\",\n    value: function _emitHttpError(req, res, message, causingErr) {\n      this._emitError(new DetailedError(message, causingErr, req, res));\n    }\n  }, {\n    key: \"_emitError\",\n    value: function _emitError(err) {\n      var _this5 = this;\n\n      // Do not emit errors, e.g. from aborted HTTP requests, if the upload has been stopped.\n      if (this._aborted) return; // Check if we should retry, when enabled, before sending the error to the user.\n\n      if (this.options.retryDelays != null) {\n        // We will reset the attempt counter if\n        // - we were already able to connect to the server (offset != null) and\n        // - we were able to upload a small chunk of data to the server\n        var shouldResetDelays = this._offset != null && this._offset > this._offsetBeforeRetry;\n\n        if (shouldResetDelays) {\n          this._retryAttempt = 0;\n        }\n\n        if (shouldRetry(err, this._retryAttempt, this.options)) {\n          var delay = this.options.retryDelays[this._retryAttempt++];\n          this._offsetBeforeRetry = this._offset;\n          this._retryTimeout = setTimeout(function () {\n            _this5.start();\n          }, delay);\n          return;\n        }\n      }\n\n      if (typeof this.options.onError === \"function\") {\n        this.options.onError(err);\n      } else {\n        throw err;\n      }\n    }\n    /**\n     * Publishes notification if the upload has been successfully completed.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_emitSuccess\",\n    value: function _emitSuccess() {\n      if (this.options.removeFingerprintOnSuccess) {\n        // Remove stored fingerprint and corresponding endpoint. This causes\n        // new uploads of the same file to be treated as a different file.\n        this._removeFromUrlStorage();\n      }\n\n      if (typeof this.options.onSuccess === \"function\") {\n        this.options.onSuccess();\n      }\n    }\n    /**\n     * Publishes notification when data has been sent to the server. This\n     * data may not have been accepted by the server yet.\n     *\n     * @param {number} bytesSent  Number of bytes sent to the server.\n     * @param {number} bytesTotal Total number of bytes to be sent to the server.\n     * @api private\n     */\n\n  }, {\n    key: \"_emitProgress\",\n    value: function _emitProgress(bytesSent, bytesTotal) {\n      if (typeof this.options.onProgress === \"function\") {\n        this.options.onProgress(bytesSent, bytesTotal);\n      }\n    }\n    /**\n     * Publishes notification when a chunk of data has been sent to the server\n     * and accepted by the server.\n     * @param {number} chunkSize  Size of the chunk that was accepted by the server.\n     * @param {number} bytesAccepted Total number of bytes that have been\n     *                                accepted by the server.\n     * @param {number} bytesTotal Total number of bytes to be sent to the server.\n     * @api private\n     */\n\n  }, {\n    key: \"_emitChunkComplete\",\n    value: function _emitChunkComplete(chunkSize, bytesAccepted, bytesTotal) {\n      if (typeof this.options.onChunkComplete === \"function\") {\n        this.options.onChunkComplete(chunkSize, bytesAccepted, bytesTotal);\n      }\n    }\n    /**\n     * Create a new upload using the creation extension by sending a POST\n     * request to the endpoint. After successful creation the file will be\n     * uploaded\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_createUpload\",\n    value: function _createUpload() {\n      var _this6 = this;\n\n      if (!this.options.endpoint) {\n        this._emitError(new Error(\"tus: unable to create upload because no endpoint is provided\"));\n\n        return;\n      }\n\n      var req = this._openRequest(\"POST\", this.options.endpoint);\n\n      if (this.options.uploadLengthDeferred) {\n        req.setHeader(\"Upload-Defer-Length\", 1);\n      } else {\n        req.setHeader(\"Upload-Length\", this._size);\n      } // Add metadata if values have been added\n\n\n      var metadata = encodeMetadata(this.options.metadata);\n\n      if (metadata !== \"\") {\n        req.setHeader(\"Upload-Metadata\", metadata);\n      }\n\n      var promise;\n\n      if (this.options.uploadDataDuringCreation && !this.options.uploadLengthDeferred) {\n        this._offset = 0;\n        promise = this._addChunkToRequest(req);\n      } else {\n        promise = this._sendRequest(req, null);\n      }\n\n      promise.then(function (res) {\n        if (!inStatusCategory(res.getStatus(), 200)) {\n          _this6._emitHttpError(req, res, \"tus: unexpected response while creating upload\");\n\n          return;\n        }\n\n        var location = res.getHeader(\"Location\");\n\n        if (location == null) {\n          _this6._emitHttpError(req, res, \"tus: invalid or missing Location header\");\n\n          return;\n        }\n\n        _this6.url = resolveUrl(_this6.options.endpoint, location);\n        log(\"Created upload at \".concat(_this6.url));\n\n        if (typeof _this6.options._onUploadUrlAvailable === \"function\") {\n          _this6.options._onUploadUrlAvailable();\n        }\n\n        if (_this6._size === 0) {\n          // Nothing to upload and file was successfully created\n          _this6._emitSuccess();\n\n          _this6._source.close();\n\n          return;\n        }\n\n        _this6._saveUploadInUrlStorage();\n\n        if (_this6.options.uploadDataDuringCreation) {\n          _this6._handleUploadResponse(req, res);\n        } else {\n          _this6._offset = 0;\n\n          _this6._performUpload();\n        }\n      })[\"catch\"](function (err) {\n        _this6._emitHttpError(req, null, \"tus: failed to create upload\", err);\n      });\n    }\n    /*\n     * Try to resume an existing upload. First a HEAD request will be sent\n     * to retrieve the offset. If the request fails a new upload will be\n     * created. In the case of a successful response the file will be uploaded.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_resumeUpload\",\n    value: function _resumeUpload() {\n      var _this7 = this;\n\n      var req = this._openRequest(\"HEAD\", this.url);\n\n      var promise = this._sendRequest(req, null);\n\n      promise.then(function (res) {\n        var status = res.getStatus();\n\n        if (!inStatusCategory(status, 200)) {\n          if (inStatusCategory(status, 400)) {\n            // Remove stored fingerprint and corresponding endpoint,\n            // on client errors since the file can not be found\n            _this7._removeFromUrlStorage();\n          } // If the upload is locked (indicated by the 423 Locked status code), we\n          // emit an error instead of directly starting a new upload. This way the\n          // retry logic can catch the error and will retry the upload. An upload\n          // is usually locked for a short period of time and will be available\n          // afterwards.\n\n\n          if (status === 423) {\n            _this7._emitHttpError(req, res, \"tus: upload is currently locked; retry later\");\n\n            return;\n          }\n\n          if (!_this7.options.endpoint) {\n            // Don't attempt to create a new upload if no endpoint is provided.\n            _this7._emitHttpError(req, res, \"tus: unable to resume upload (new upload cannot be created without an endpoint)\");\n\n            return;\n          } // Try to create a new upload\n\n\n          _this7.url = null;\n\n          _this7._createUpload();\n\n          return;\n        }\n\n        var offset = parseInt(res.getHeader(\"Upload-Offset\"), 10);\n\n        if (isNaN(offset)) {\n          _this7._emitHttpError(req, res, \"tus: invalid or missing offset value\");\n\n          return;\n        }\n\n        var length = parseInt(res.getHeader(\"Upload-Length\"), 10);\n\n        if (isNaN(length) && !_this7.options.uploadLengthDeferred) {\n          _this7._emitHttpError(req, res, \"tus: invalid or missing length value\");\n\n          return;\n        }\n\n        if (typeof _this7.options._onUploadUrlAvailable === \"function\") {\n          _this7.options._onUploadUrlAvailable();\n        } // Upload has already been completed and we do not need to send additional\n        // data to the server\n\n\n        if (offset === length) {\n          _this7._emitProgress(length, length);\n\n          _this7._emitSuccess();\n\n          return;\n        }\n\n        _this7._offset = offset;\n\n        _this7._performUpload();\n      })[\"catch\"](function (err) {\n        _this7._emitHttpError(req, null, \"tus: failed to resume upload\", err);\n      });\n    }\n    /**\n     * Start uploading the file using PATCH requests. The file will be divided\n     * into chunks as specified in the chunkSize option. During the upload\n     * the onProgress event handler may be invoked multiple times.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_performUpload\",\n    value: function _performUpload() {\n      var _this8 = this;\n\n      // If the upload has been aborted, we will not send the next PATCH request.\n      // This is important if the abort method was called during a callback, such\n      // as onChunkComplete or onProgress.\n      if (this._aborted) {\n        return;\n      }\n\n      var req; // Some browser and servers may not support the PATCH method. For those\n      // cases, you can tell tus-js-client to use a POST request with the\n      // X-HTTP-Method-Override header for simulating a PATCH request.\n\n      if (this.options.overridePatchMethod) {\n        req = this._openRequest(\"POST\", this.url);\n        req.setHeader(\"X-HTTP-Method-Override\", \"PATCH\");\n      } else {\n        req = this._openRequest(\"PATCH\", this.url);\n      }\n\n      req.setHeader(\"Upload-Offset\", this._offset);\n\n      var promise = this._addChunkToRequest(req);\n\n      promise.then(function (res) {\n        if (!inStatusCategory(res.getStatus(), 200)) {\n          _this8._emitHttpError(req, res, \"tus: unexpected response while uploading chunk\");\n\n          return;\n        }\n\n        _this8._handleUploadResponse(req, res);\n      })[\"catch\"](function (err) {\n        // Don't emit an error if the upload was aborted manually\n        if (_this8._aborted) {\n          return;\n        }\n\n        _this8._emitHttpError(req, null, \"tus: failed to upload chunk at offset \" + _this8._offset, err);\n      });\n    }\n    /**\n     * _addChunktoRequest reads a chunk from the source and sends it using the\n     * supplied request object. It will not handle the response.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_addChunkToRequest\",\n    value: function _addChunkToRequest(req) {\n      var _this9 = this;\n\n      var start = this._offset;\n      var end = this._offset + this.options.chunkSize;\n      req.setProgressHandler(function (bytesSent) {\n        _this9._emitProgress(start + bytesSent, _this9._size);\n      });\n      req.setHeader(\"Content-Type\", \"application/offset+octet-stream\"); // The specified chunkSize may be Infinity or the calcluated end position\n      // may exceed the file's size. In both cases, we limit the end position to\n      // the input's total size for simpler calculations and correctness.\n\n      if ((end === Infinity || end > this._size) && !this.options.uploadLengthDeferred) {\n        end = this._size;\n      }\n\n      return this._source.slice(start, end).then(function (_ref2) {\n        var value = _ref2.value,\n            done = _ref2.done;\n\n        // If the upload length is deferred, the upload size was not specified during\n        // upload creation. So, if the file reader is done reading, we know the total\n        // upload size and can tell the tus server.\n        if (_this9.options.uploadLengthDeferred && done) {\n          _this9._size = _this9._offset + (value && value.size ? value.size : 0);\n          req.setHeader(\"Upload-Length\", _this9._size);\n        }\n\n        if (value === null) {\n          return _this9._sendRequest(req);\n        } else {\n          _this9._emitProgress(_this9._offset, _this9._size);\n\n          return _this9._sendRequest(req, value);\n        }\n      });\n    }\n    /**\n     * _handleUploadResponse is used by requests that haven been sent using _addChunkToRequest\n     * and already have received a response.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_handleUploadResponse\",\n    value: function _handleUploadResponse(req, res) {\n      var offset = parseInt(res.getHeader(\"Upload-Offset\"), 10);\n\n      if (isNaN(offset)) {\n        this._emitHttpError(req, res, \"tus: invalid or missing offset value\");\n\n        return;\n      }\n\n      this._emitProgress(offset, this._size);\n\n      this._emitChunkComplete(offset - this._offset, offset, this._size);\n\n      this._offset = offset;\n\n      if (offset == this._size) {\n        // Yay, finally done :)\n        this._emitSuccess();\n\n        this._source.close();\n\n        return;\n      }\n\n      this._performUpload();\n    }\n    /**\n     * Create a new HTTP request object with the given method and URL.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_openRequest\",\n    value: function _openRequest(method, url) {\n      var req = openRequest(method, url, this.options);\n      this._req = req;\n      return req;\n    }\n    /**\n     * Remove the entry in the URL storage, if it has been saved before.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_removeFromUrlStorage\",\n    value: function _removeFromUrlStorage() {\n      var _this10 = this;\n\n      if (!this._urlStorageKey) return;\n\n      this._urlStorage.removeUpload(this._urlStorageKey)[\"catch\"](function (err) {\n        _this10._emitError(err);\n      });\n\n      this._urlStorageKey = null;\n    }\n    /**\n     * Add the upload URL to the URL storage, if possible.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_saveUploadInUrlStorage\",\n    value: function _saveUploadInUrlStorage() {\n      var _this11 = this;\n\n      // Only if a fingerprint was calculated for the input (i.e. not a stream), we can store the upload URL.\n      if (!this.options.storeFingerprintForResuming || !this._fingerprint) {\n        return;\n      }\n\n      var storedUpload = {\n        size: this._size,\n        metadata: this.options.metadata,\n        creationTime: new Date().toString()\n      };\n\n      if (this._parallelUploads) {\n        // Save multiple URLs if the parallelUploads option is used ...\n        storedUpload.parallelUploadUrls = this._parallelUploadUrls;\n      } else {\n        // ... otherwise we just save the one available URL.\n        storedUpload.uploadUrl = this.url;\n      }\n\n      this._urlStorage.addUpload(this._fingerprint, storedUpload).then(function (urlStorageKey) {\n        return _this11._urlStorageKey = urlStorageKey;\n      })[\"catch\"](function (err) {\n        _this11._emitError(err);\n      });\n    }\n    /**\n     * Send a request with the provided body while invoking the onBeforeRequest\n     * and onAfterResponse callbacks.\n     *\n     * @api private\n     */\n\n  }, {\n    key: \"_sendRequest\",\n    value: function _sendRequest(req) {\n      var _this12 = this;\n\n      var body = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n      if (typeof this.options.onBeforeRequest === \"function\") {\n        this.options.onBeforeRequest(req);\n      }\n\n      return req.send(body).then(function (res) {\n        if (typeof _this12.options.onAfterResponse === \"function\") {\n          _this12.options.onAfterResponse(req, res);\n        }\n\n        return res;\n      });\n    }\n  }], [{\n    key: \"terminate\",\n    value: function terminate(url) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var cb = arguments.length > 2 ? arguments[2] : undefined;\n\n      if (typeof options === \"function\" || typeof cb === \"function\") {\n        throw new Error(\"tus: the terminate function does not accept a callback since v2 anymore; please use the returned Promise instead\");\n      }\n\n      var req = openRequest(\"DELETE\", url, options);\n      var promise = req.send();\n      return promise.then(function (res) {\n        // A 204 response indicates a successfull request\n        if (res.getStatus() === 204) {\n          return;\n        }\n\n        throw new DetailedError(\"tus: unexpected response while terminating upload\", null, req, res);\n      })[\"catch\"](function (err) {\n        if (!(err instanceof DetailedError)) {\n          err = new DetailedError(\"tus: failed to terminate upload\", err, req, null);\n        }\n\n        if (!shouldRetry(err, 0, options)) {\n          throw err;\n        } // Instead of keeping track of the retry attempts, we remove the first element from the delays\n        // array. If the array is empty, all retry attempts are used up and we will bubble up the error.\n        // We recursively call the terminate function will removing elements from the retryDelays array.\n\n\n        var delay = options.retryDelays[0];\n        var remainingDelays = options.retryDelays.slice(1);\n\n        var newOptions = _objectSpread({}, options, {\n          retryDelays: remainingDelays\n        });\n\n        return new Promise(function (resolve) {\n          return setTimeout(resolve, delay);\n        }).then(function () {\n          return BaseUpload.terminate(url, newOptions);\n        });\n      });\n    }\n  }]);\n\n  return BaseUpload;\n}();\n\nfunction encodeMetadata(metadata) {\n  var encoded = [];\n\n  for (var key in metadata) {\n    encoded.push(key + \" \" + Base64.encode(metadata[key]));\n  }\n\n  return encoded.join(\",\");\n}\n/**\n * Checks whether a given status is in the range of the expected category.\n * For example, only a status between 200 and 299 will satisfy the category 200.\n *\n * @api private\n */\n\n\nfunction inStatusCategory(status, category) {\n  return status >= category && status < category + 100;\n}\n/**\n * Create a new HTTP request with the specified method and URL.\n * The necessary headers that are included in every request\n * will be added, including the request ID.\n *\n * @api private\n */\n\n\nfunction openRequest(method, url, options) {\n  var req = options.httpStack.createRequest(method, url);\n  req.setHeader(\"Tus-Resumable\", \"1.0.0\");\n  var headers = options.headers || {};\n\n  for (var name in headers) {\n    req.setHeader(name, headers[name]);\n  }\n\n  if (options.addRequestId) {\n    var requestId = uuid();\n    req.setHeader(\"X-Request-ID\", requestId);\n  }\n\n  return req;\n}\n/**\n * Checks whether the browser running this code has internet access.\n * This function will always return true in the node.js environment\n *\n * @api private\n */\n\n\nfunction isOnline() {\n  var online = true;\n\n  if (typeof window !== \"undefined\" && \"navigator\" in window && window.navigator.onLine === false) {\n    online = false;\n  }\n\n  return online;\n}\n/**\n * Checks whether or not it is ok to retry a request.\n * @param {Error} err the error returned from the last request\n * @param {number} retryAttempt the number of times the request has already been retried\n * @param {object} options tus Upload options\n *\n * @api private\n */\n\n\nfunction shouldRetry(err, retryAttempt, options) {\n  // We only attempt a retry if\n  // - retryDelays option is set\n  // - we didn't exceed the maxium number of retries, yet, and\n  // - this error was caused by a request or it's response and\n  // - the error is server error (i.e. no a status 4xx or a 409 or 423) and\n  // - the browser does not indicate that we are offline\n  var status = err.originalResponse ? err.originalResponse.getStatus() : 0;\n  var isServerError = !inStatusCategory(status, 400) || status === 409 || status === 423;\n  return options.retryDelays != null && retryAttempt < options.retryDelays.length && err.originalRequest != null && isServerError && isOnline();\n}\n/**\n * Resolve a relative link given the origin as source. For example,\n * if a HTTP request to http://example.com/files/ returns a Location\n * header with the value /upload/abc, the resolved URL will be:\n * http://example.com/upload/abc\n */\n\n\nfunction resolveUrl(origin, link) {\n  return new URL(link, origin).toString();\n}\n/**\n * Calculate the start and end positions for the parts if an upload\n * is split into multiple parallel requests.\n *\n * @param {number} totalSize The byte size of the upload, which will be split.\n * @param {number} partCount The number in how many parts the upload will be split.\n * @param {string[]} previousUrls The upload URLs for previous parts.\n * @return {object[]}\n * @api private\n */\n\n\nfunction splitSizeIntoParts(totalSize, partCount, previousUrls) {\n  var partSize = Math.floor(totalSize / partCount);\n  var parts = [];\n\n  for (var i = 0; i < partCount; i++) {\n    parts.push({\n      start: partSize * i,\n      end: partSize * (i + 1)\n    });\n  }\n\n  parts[partCount - 1].end = totalSize; // Attach URLs from previous uploads, if available.\n\n  if (previousUrls) {\n    parts.forEach(function (part, index) {\n      part.uploadUrl = previousUrls[index] || null;\n    });\n  }\n\n  return parts;\n}\n\nBaseUpload.defaultOptions = defaultOptions;\nexport default BaseUpload;","/**\n * Generate a UUID v4 based on random numbers. We intentioanlly use the less\n * secure Math.random function here since the more secure crypto.getRandomNumbers\n * is not available on all platforms.\n * This is not a problem for us since we use the UUID only for generating a\n * request ID, so we can correlate server logs to client errors.\n *\n * This function is taken from following site:\n * https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\n *\n * @return {string} The generate UUID\n */\nexport default function uuid() {\n  return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n        v = c == \"x\" ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}","function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n/* eslint no-unused-vars: \"off\" */\nvar NoopUrlStorage = /*#__PURE__*/function () {\n  function NoopUrlStorage() {\n    _classCallCheck(this, NoopUrlStorage);\n  }\n\n  _createClass(NoopUrlStorage, [{\n    key: \"listAllUploads\",\n    value: function listAllUploads() {\n      return Promise.resolve([]);\n    }\n  }, {\n    key: \"findUploadsByFingerprint\",\n    value: function findUploadsByFingerprint(fingerprint) {\n      return Promise.resolve([]);\n    }\n  }, {\n    key: \"removeUpload\",\n    value: function removeUpload(urlStorageKey) {\n      return Promise.resolve();\n    }\n  }, {\n    key: \"addUpload\",\n    value: function addUpload(fingerprint, upload) {\n      return Promise.resolve(null);\n    }\n  }]);\n\n  return NoopUrlStorage;\n}();\n\nexport { NoopUrlStorage as default };","function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n/* global window, localStorage */\nvar hasStorage = false;\n\ntry {\n  hasStorage = \"localStorage\" in window; // Attempt to store and read entries from the local storage to detect Private\n  // Mode on Safari on iOS (see #49)\n\n  var key = \"tusSupport\";\n  localStorage.setItem(key, localStorage.getItem(key));\n} catch (e) {\n  // If we try to access localStorage inside a sandboxed iframe, a SecurityError\n  // is thrown. When in private mode on iOS Safari, a QuotaExceededError is\n  // thrown (see #49)\n  if (e.code === e.SECURITY_ERR || e.code === e.QUOTA_EXCEEDED_ERR) {\n    hasStorage = false;\n  } else {\n    throw e;\n  }\n}\n\nexport var canStoreURLs = hasStorage;\nexport var WebStorageUrlStorage = /*#__PURE__*/function () {\n  function WebStorageUrlStorage() {\n    _classCallCheck(this, WebStorageUrlStorage);\n  }\n\n  _createClass(WebStorageUrlStorage, [{\n    key: \"findAllUploads\",\n    value: function findAllUploads() {\n      var results = this._findEntries(\"tus::\");\n\n      return Promise.resolve(results);\n    }\n  }, {\n    key: \"findUploadsByFingerprint\",\n    value: function findUploadsByFingerprint(fingerprint) {\n      var results = this._findEntries(\"tus::\".concat(fingerprint, \"::\"));\n\n      return Promise.resolve(results);\n    }\n  }, {\n    key: \"removeUpload\",\n    value: function removeUpload(urlStorageKey) {\n      localStorage.removeItem(urlStorageKey);\n      return Promise.resolve();\n    }\n  }, {\n    key: \"addUpload\",\n    value: function addUpload(fingerprint, upload) {\n      var id = Math.round(Math.random() * 1e12);\n      var key = \"tus::\".concat(fingerprint, \"::\").concat(id);\n      localStorage.setItem(key, JSON.stringify(upload));\n      return Promise.resolve(key);\n    }\n  }, {\n    key: \"_findEntries\",\n    value: function _findEntries(prefix) {\n      var results = [];\n\n      for (var i = 0; i < localStorage.length; i++) {\n        var _key = localStorage.key(i);\n\n        if (_key.indexOf(prefix) !== 0) continue;\n\n        try {\n          var upload = JSON.parse(localStorage.getItem(_key));\n          upload.urlStorageKey = _key;\n          results.push(upload);\n        } catch (e) {// The JSON parse error is intentionally ignored here, so a malformed\n          // entry in the storage cannot prevent an upload.\n        }\n      }\n\n      return results;\n    }\n  }]);\n\n  return WebStorageUrlStorage;\n}();","function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n/* global window */\nvar XHRHttpStack = /*#__PURE__*/function () {\n  function XHRHttpStack() {\n    _classCallCheck(this, XHRHttpStack);\n  }\n\n  _createClass(XHRHttpStack, [{\n    key: \"createRequest\",\n    value: function createRequest(method, url) {\n      return new Request(method, url);\n    }\n  }, {\n    key: \"getName\",\n    value: function getName() {\n      return \"XHRHttpStack\";\n    }\n  }]);\n\n  return XHRHttpStack;\n}();\n\nexport { XHRHttpStack as default };\n\nvar Request = /*#__PURE__*/function () {\n  function Request(method, url) {\n    _classCallCheck(this, Request);\n\n    this._xhr = new XMLHttpRequest();\n\n    this._xhr.open(method, url, true);\n\n    this._method = method;\n    this._url = url;\n    this._headers = {};\n  }\n\n  _createClass(Request, [{\n    key: \"getMethod\",\n    value: function getMethod() {\n      return this._method;\n    }\n  }, {\n    key: \"getURL\",\n    value: function getURL() {\n      return this._url;\n    }\n  }, {\n    key: \"setHeader\",\n    value: function setHeader(header, value) {\n      this._xhr.setRequestHeader(header, value);\n\n      this._headers[header] = value;\n    }\n  }, {\n    key: \"getHeader\",\n    value: function getHeader(header) {\n      return this._headers[header];\n    }\n  }, {\n    key: \"setProgressHandler\",\n    value: function setProgressHandler(progressHandler) {\n      // Test support for progress events before attaching an event listener\n      if (!(\"upload\" in this._xhr)) {\n        return;\n      }\n\n      this._xhr.upload.onprogress = function (e) {\n        if (!e.lengthComputable) {\n          return;\n        }\n\n        progressHandler(e.loaded);\n      };\n    }\n  }, {\n    key: \"send\",\n    value: function send() {\n      var _this = this;\n\n      var body = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      return new Promise(function (resolve, reject) {\n        _this._xhr.onload = function () {\n          resolve(new Response(_this._xhr));\n        };\n\n        _this._xhr.onerror = function (err) {\n          reject(err);\n        };\n\n        _this._xhr.send(body);\n      });\n    }\n  }, {\n    key: \"abort\",\n    value: function abort() {\n      this._xhr.abort();\n\n      return Promise.resolve();\n    }\n  }, {\n    key: \"getUnderlyingObject\",\n    value: function getUnderlyingObject() {\n      return this._xhr;\n    }\n  }]);\n\n  return Request;\n}();\n\nvar Response = /*#__PURE__*/function () {\n  function Response(xhr) {\n    _classCallCheck(this, Response);\n\n    this._xhr = xhr;\n  }\n\n  _createClass(Response, [{\n    key: \"getStatus\",\n    value: function getStatus() {\n      return this._xhr.status;\n    }\n  }, {\n    key: \"getHeader\",\n    value: function getHeader(header) {\n      return this._xhr.getResponseHeader(header);\n    }\n  }, {\n    key: \"getBody\",\n    value: function getBody() {\n      return this._xhr.responseText;\n    }\n  }, {\n    key: \"getUnderlyingObject\",\n    value: function getUnderlyingObject() {\n      return this._xhr;\n    }\n  }]);\n\n  return Response;\n}();","var isReactNative = function isReactNative() {\n  return typeof navigator !== \"undefined\" && typeof navigator.product === \"string\" && navigator.product.toLowerCase() === \"reactnative\";\n};\n\nexport default isReactNative;","var isCordova = function isCordova() {\n  return typeof window != \"undefined\" && (typeof window.PhoneGap != \"undefined\" || typeof window.Cordova != \"undefined\" || typeof window.cordova != \"undefined\");\n};\n\nexport default isCordova;","function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nimport isReactNative from \"./isReactNative\";\nimport uriToBlob from \"./uriToBlob\";\nimport isCordova from \"./isCordova\";\nimport readAsByteArray from \"./readAsByteArray\";\n\nvar FileSource = /*#__PURE__*/function () {\n  // Make this.size a method\n  function FileSource(file) {\n    _classCallCheck(this, FileSource);\n\n    this._file = file;\n    this.size = file.size;\n  }\n\n  _createClass(FileSource, [{\n    key: \"slice\",\n    value: function slice(start, end) {\n      // In Apache Cordova applications, a File must be resolved using\n      // FileReader instances, see\n      // https://cordova.apache.org/docs/en/8.x/reference/cordova-plugin-file/index.html#read-a-file\n      if (isCordova()) {\n        return readAsByteArray(this._file.slice(start, end));\n      }\n\n      var value = this._file.slice(start, end);\n\n      return Promise.resolve({\n        value: value\n      });\n    }\n  }, {\n    key: \"close\",\n    value: function close() {// Nothing to do here since we don't need to release any resources.\n    }\n  }]);\n\n  return FileSource;\n}();\n\nvar StreamSource = /*#__PURE__*/function () {\n  function StreamSource(reader, chunkSize) {\n    _classCallCheck(this, StreamSource);\n\n    this._chunkSize = chunkSize;\n    this._buffer = undefined;\n    this._bufferOffset = 0;\n    this._reader = reader;\n    this._done = false;\n  }\n\n  _createClass(StreamSource, [{\n    key: \"slice\",\n    value: function slice(start, end) {\n      if (start < this._bufferOffset) {\n        return Promise.reject(new Error(\"Requested data is before the reader's current offset\"));\n      }\n\n      return this._readUntilEnoughDataOrDone(start, end);\n    }\n  }, {\n    key: \"_readUntilEnoughDataOrDone\",\n    value: function _readUntilEnoughDataOrDone(start, end) {\n      var _this = this;\n\n      var hasEnoughData = end <= this._bufferOffset + len(this._buffer);\n\n      if (this._done || hasEnoughData) {\n        var value = this._getDataFromBuffer(start, end);\n\n        var done = value == null ? this._done : false;\n        return Promise.resolve({\n          value: value,\n          done: done\n        });\n      }\n\n      return this._reader.read().then(function (_ref) {\n        var value = _ref.value,\n            done = _ref.done;\n\n        if (done) {\n          _this._done = true;\n        } else if (_this._buffer === undefined) {\n          _this._buffer = value;\n        } else {\n          _this._buffer = concat(_this._buffer, value);\n        }\n\n        return _this._readUntilEnoughDataOrDone(start, end);\n      });\n    }\n  }, {\n    key: \"_getDataFromBuffer\",\n    value: function _getDataFromBuffer(start, end) {\n      // Remove data from buffer before `start`.\n      // Data might be reread from the buffer if an upload fails, so we can only\n      // safely delete data when it comes *before* what is currently being read.\n      if (start > this._bufferOffset) {\n        this._buffer = this._buffer.slice(start - this._bufferOffset);\n        this._bufferOffset = start;\n      } // If the buffer is empty after removing old data, all data has been read.\n\n\n      var hasAllDataBeenRead = len(this._buffer) === 0;\n\n      if (this._done && hasAllDataBeenRead) {\n        return null;\n      } // We already removed data before `start`, so we just return the first\n      // chunk from the buffer.\n\n\n      return this._buffer.slice(0, end - start);\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      if (this._reader.cancel) {\n        this._reader.cancel();\n      }\n    }\n  }]);\n\n  return StreamSource;\n}();\n\nfunction len(blobOrArray) {\n  if (blobOrArray === undefined) return 0;\n  if (blobOrArray.size !== undefined) return blobOrArray.size;\n  return blobOrArray.length;\n}\n/*\n  Typed arrays and blobs don't have a concat method.\n  This function helps StreamSource accumulate data to reach chunkSize.\n*/\n\n\nfunction concat(a, b) {\n  if (a.concat) {\n    // Is `a` an Array?\n    return a.concat(b);\n  }\n\n  if (a instanceof Blob) {\n    return new Blob([a, b], {\n      type: a.type\n    });\n  }\n\n  if (a.set) {\n    // Is `a` a typed array?\n    var c = new a.constructor(a.length + b.length);\n    c.set(a);\n    c.set(b, a.length);\n    return c;\n  }\n\n  throw new Error(\"Unknown data type\");\n}\n\nvar FileReader = /*#__PURE__*/function () {\n  function FileReader() {\n    _classCallCheck(this, FileReader);\n  }\n\n  _createClass(FileReader, [{\n    key: \"openFile\",\n    value: function openFile(input, chunkSize) {\n      // In React Native, when user selects a file, instead of a File or Blob,\n      // you usually get a file object {} with a uri property that contains\n      // a local path to the file. We use XMLHttpRequest to fetch\n      // the file blob, before uploading with tus.\n      if (isReactNative() && input && typeof input.uri !== \"undefined\") {\n        return uriToBlob(input.uri).then(function (blob) {\n          return new FileSource(blob);\n        })[\"catch\"](function (err) {\n          throw new Error(\"tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. \" + err);\n        });\n      } // Since we emulate the Blob type in our tests (not all target browsers\n      // support it), we cannot use `instanceof` for testing whether the input value\n      // can be handled. Instead, we simply check is the slice() function and the\n      // size property are available.\n\n\n      if (typeof input.slice === \"function\" && typeof input.size !== \"undefined\") {\n        return Promise.resolve(new FileSource(input));\n      }\n\n      if (typeof input.read === \"function\") {\n        chunkSize = +chunkSize;\n\n        if (!isFinite(chunkSize)) {\n          return Promise.reject(new Error(\"cannot create source for stream without a finite value for the `chunkSize` option\"));\n        }\n\n        return Promise.resolve(new StreamSource(input, chunkSize));\n      }\n\n      return Promise.reject(new Error(\"source object may only be an instance of File, Blob, or Reader in this environment\"));\n    }\n  }]);\n\n  return FileReader;\n}();\n\nexport { FileReader as default };","/**\n * readAsByteArray converts a File object to a Uint8Array.\n * This function is only used on the Apache Cordova platform.\n * See https://cordova.apache.org/docs/en/latest/reference/cordova-plugin-file/index.html#read-a-file\n */\nexport default function readAsByteArray(chunk) {\n  return new Promise(function (resolve, reject) {\n    var reader = new FileReader();\n\n    reader.onload = function () {\n      var value = new Uint8Array(reader.result);\n      resolve({\n        value: value\n      });\n    };\n\n    reader.onerror = function (err) {\n      reject(err);\n    };\n\n    reader.readAsArrayBuffer(chunk);\n  });\n}","/**\n * uriToBlob resolves a URI to a Blob object. This is used for\n * React Native to retrieve a file (identified by a file://\n * URI) as a blob.\n */\nexport default function uriToBlob(uri) {\n  return new Promise(function (resolve, reject) {\n    var xhr = new XMLHttpRequest();\n    xhr.responseType = \"blob\";\n\n    xhr.onload = function () {\n      var blob = xhr.response;\n      resolve(blob);\n    };\n\n    xhr.onerror = function (err) {\n      reject(err);\n    };\n\n    xhr.open(\"GET\", uri);\n    xhr.send();\n  });\n}","function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/* global window */\nimport BaseUpload from \"../upload\";\nimport NoopUrlStorage from \"../noopUrlStorage\";\nimport { enableDebugLog } from \"../logger\";\nimport { canStoreURLs, WebStorageUrlStorage } from \"./urlStorage\";\nimport HttpStack from \"./httpStack\";\nimport FileReader from \"./fileReader\";\nimport fingerprint from \"./fingerprint\";\n\nvar defaultOptions = _objectSpread({}, BaseUpload.defaultOptions, {\n  httpStack: new HttpStack(),\n  fileReader: new FileReader(),\n  urlStorage: canStoreURLs ? new WebStorageUrlStorage() : new NoopUrlStorage(),\n  fingerprint: fingerprint\n});\n\nvar Upload = /*#__PURE__*/function (_BaseUpload) {\n  _inherits(Upload, _BaseUpload);\n\n  var _super = _createSuper(Upload);\n\n  function Upload() {\n    var file = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Upload);\n\n    options = _objectSpread({}, defaultOptions, {}, options);\n    return _super.call(this, file, options);\n  }\n\n  _createClass(Upload, null, [{\n    key: \"terminate\",\n    value: function terminate(url, options, cb) {\n      options = _objectSpread({}, defaultOptions, {}, options);\n      return BaseUpload.terminate(url, options, cb);\n    }\n  }]);\n\n  return Upload;\n}(BaseUpload);\n\nvar _window = window,\n    XMLHttpRequest = _window.XMLHttpRequest,\n    Blob = _window.Blob;\nvar isSupported = XMLHttpRequest && Blob && typeof Blob.prototype.slice === \"function\";\nexport { Upload, canStoreURLs, defaultOptions, isSupported, enableDebugLog };","import isReactNative from \"./isReactNative\"; // TODO: Differenciate between input types\n\n/**\n * Generate a fingerprint for a file which will be used the store the endpoint\n *\n * @param {File} file\n * @param {Object} options\n * @param {Function} callback\n */\n\nexport default function fingerprint(file, options) {\n  if (isReactNative()) {\n    return Promise.resolve(reactNativeFingerprint(file, options));\n  }\n\n  return Promise.resolve([\"tus-br\", file.name, file.type, file.size, file.lastModified, options.endpoint].join(\"-\"));\n}\n\nfunction reactNativeFingerprint(file, options) {\n  var exifHash = file.exif ? hashCode(JSON.stringify(file.exif)) : \"noexif\";\n  return [\"tus-rn\", file.name || \"noname\", file.size || \"nosize\", exifHash, options.endpoint].join(\"/\");\n}\n\nfunction hashCode(str) {\n  // from https://stackoverflow.com/a/8831937/151666\n  var hash = 0;\n\n  if (str.length === 0) {\n    return hash;\n  }\n\n  for (var i = 0; i < str.length; i++) {\n    var _char = str.charCodeAt(i);\n\n    hash = (hash << 5) - hash + _char;\n    hash = hash & hash; // Convert to 32bit integer\n  }\n\n  return hash;\n}","import escape from \"escape-html\";\nimport { formatBytes } from \"./util\";\n\nclass RenderUploadFile {\n  container: Element;\n  input: HTMLInputElement;\n  translations: { [key: string]: string };\n\n  constructor({\n    parent,\n    input,\n    skipRequired,\n    translations\n  }: {\n    parent: Element;\n    input: HTMLInputElement;\n    skipRequired: boolean;\n    translations: { [key: string]: string };\n  }) {\n    this.container = this.createFilesContainer(parent);\n    this.input = input;\n    this.translations = translations;\n\n    if (skipRequired) {\n      this.input.required = false;\n    }\n  }\n\n  createFilesContainer = (parent: Element): Element => {\n    const div = document.createElement(\"div\");\n    div.className = \"dff-files\";\n    parent.appendChild(div);\n\n    return div;\n  };\n\n  addUploadedFile(\n    filename: string,\n    uploadIndex: number,\n    filesize: number\n  ): void {\n    this.addFile(filename, uploadIndex);\n    this.setSuccess(uploadIndex, filesize);\n  }\n\n  addNewUpload(filename: string, uploadIndex: number): void {\n    const div = this.addFile(filename, uploadIndex);\n\n    const progressSpan = document.createElement(\"span\");\n    progressSpan.className = \"dff-progress\";\n\n    const innerSpan = document.createElement(\"span\");\n    innerSpan.className = \"dff-progress-inner\";\n\n    progressSpan.appendChild(innerSpan);\n    div.appendChild(progressSpan);\n\n    const cancelLink = document.createElement(\"a\");\n    cancelLink.className = \"dff-cancel\";\n    cancelLink.innerHTML = this.translations.Cancel;\n    cancelLink.setAttribute(\"data-index\", `${uploadIndex}`);\n    cancelLink.href = \"#\";\n    div.appendChild(cancelLink);\n  }\n\n  addFile(filename: string, uploadIndex: number): Element {\n    const div = document.createElement(\"div\");\n    div.className = `dff-file dff-file-id-${uploadIndex}`;\n\n    const nameSpan = document.createElement(\"span\");\n    nameSpan.innerHTML = escape(filename);\n\n    div.appendChild(nameSpan);\n    this.container.appendChild(div);\n\n    this.input.required = false;\n    return div;\n  }\n\n  deleteFile(index: number): void {\n    const div = this.findFileDiv(index);\n\n    if (div) {\n      div.remove();\n    }\n  }\n\n  setError(index: number): void {\n    const span = document.createElement(\"span\");\n    span.classList.add(\"dff-error\");\n    span.innerHTML = this.translations[\"Upload failed\"];\n\n    const el = this.findFileDiv(index);\n    if (el) {\n      el.appendChild(span);\n      el.classList.add(\"dff-upload-fail\");\n    }\n\n    this.removeProgress(index);\n    this.removeCancel(index);\n  }\n\n  setDeleteFailed(index: number): void {\n    const el = this.findFileDiv(index);\n\n    if (el) {\n      const span = document.createElement(\"span\");\n      span.innerHTML = this.translations[\"Delete failed\"];\n\n      el.appendChild(span);\n    }\n  }\n\n  findFileDiv(index: number): Element | null {\n    return this.container.querySelector(`.dff-file-id-${index}`);\n  }\n\n  setSuccess(index: number, size: number): void {\n    const { translations } = this;\n\n    const el = this.findFileDiv(index);\n    if (el) {\n      el.classList.add(\"dff-upload-success\");\n\n      const fileSizeInfo = document.createElement(\"span\");\n      fileSizeInfo.innerHTML = formatBytes(size, 2);\n      fileSizeInfo.className = \"dff-filesize\";\n\n      el.appendChild(fileSizeInfo);\n\n      const deleteLink = document.createElement(\"a\");\n      deleteLink.innerHTML = translations.Delete;\n      deleteLink.className = \"dff-delete\";\n      deleteLink.setAttribute(\"data-index\", `${index}`);\n      deleteLink.href = \"#\";\n\n      el.appendChild(deleteLink);\n    }\n\n    this.removeProgress(index);\n    this.removeCancel(index);\n  }\n\n  removeProgress(index: number): void {\n    const el = this.findFileDiv(index);\n\n    if (el) {\n      const progressSpan = el.querySelector(\".dff-progress\");\n\n      if (progressSpan) {\n        progressSpan.remove();\n      }\n    }\n  }\n\n  removeCancel(index: number): void {\n    const el = this.findFileDiv(index);\n\n    if (el) {\n      const cancelSpan = el.querySelector(\".dff-cancel\");\n\n      if (cancelSpan) {\n        cancelSpan.remove();\n      }\n    }\n  }\n\n  clearInput(): void {\n    const { input } = this;\n\n    input.value = \"\";\n  }\n\n  updateProgress(index: number, percentage: string): void {\n    const el = this.container.querySelector(`.dff-file-id-${index}`);\n    if (el) {\n      const innerProgressSpan = el.querySelector(\".dff-progress-inner\");\n\n      if (innerProgressSpan) {\n        (innerProgressSpan as HTMLElement).style.width = `${percentage}%`;\n      }\n    }\n  }\n\n  renderDropHint(): void {\n    if (this.container.querySelector(\".dff-drop-hint\")) {\n      return;\n    }\n\n    const dropHint = document.createElement(\"div\");\n    dropHint.className = \"dff-drop-hint\";\n    dropHint.innerHTML = this.translations[\"Drop your files here\"];\n\n    this.container.appendChild(dropHint);\n  }\n\n  removeDropHint(): void {\n    const dropHint = this.container.querySelector(\".dff-drop-hint\");\n\n    if (dropHint) {\n      dropHint.remove();\n    }\n  }\n}\n\nexport default RenderUploadFile;\n","const getEntriesFromDirectory = async (\n  directoryEntry: FileSystemDirectoryEntry\n): Promise<FileSystemEntry[]> =>\n  new Promise((resolve, reject) =>\n    directoryEntry.createReader().readEntries(resolve, reject)\n  );\n\nconst getFileFromFileEntry = async (\n  fileEntry: FileSystemFileEntry\n): Promise<File> =>\n  new Promise((resolve, reject) => fileEntry.file(resolve, reject));\n\nconst getFilesFromFileSystemEntries = async (\n  entries: FileSystemEntry[]\n): Promise<File[]> => {\n  const result = [];\n\n  for await (const entry of entries) {\n    if (entry.isFile) {\n      const file = await getFileFromFileEntry(entry as FileSystemFileEntry);\n      result.push(file);\n    } else if (entry.isDirectory) {\n      const entriesFromDirectory = await getEntriesFromDirectory(\n        entry as FileSystemDirectoryEntry\n      );\n      const files = await getFilesFromFileSystemEntries(entriesFromDirectory);\n      files.forEach(file => result.push(file));\n    }\n  }\n\n  return result;\n};\n\nconst getFilesFromDataTransfer = async (\n  dataTransfer: DataTransfer\n): Promise<File[]> => {\n  if (dataTransfer.items) {\n    const entries = [...dataTransfer.items].map(\n      item => item.webkitGetAsEntry() as FileSystemEntry\n    );\n\n    const files = await getFilesFromFileSystemEntries(entries);\n    return files;\n  } else {\n    // backwards compatibility\n    return [...dataTransfer.files];\n  }\n};\n\nclass DropArea {\n  container: Element;\n  onUploadFiles: (files: File[]) => void;\n\n  constructor({\n    container,\n    onUploadFiles\n  }: {\n    container: Element;\n    onUploadFiles: (files: File[]) => void;\n  }) {\n    this.container = container;\n    this.onUploadFiles = onUploadFiles;\n\n    container.addEventListener(\"dragenter\", () => {\n      container.classList.add(\"dff-dropping\");\n    });\n    container.addEventListener(\"dragleave\", () => {\n      container.classList.remove(\"dff-dropping\");\n    });\n    container.addEventListener(\"dragover\", e => {\n      container.classList.add(\"dff-dropping\");\n      e.preventDefault();\n    });\n    container.addEventListener(\"drop\", this.onDrop);\n  }\n\n  onDrop = (e: Event): void => {\n    const dragEvent = e as DragEvent;\n    this.container.classList.remove(\"dff-dropping\");\n    dragEvent.preventDefault();\n    dragEvent.stopPropagation();\n\n    const uploadFiles = async (): Promise<void> => {\n      try {\n        if (dragEvent.dataTransfer) {\n          const files = await getFilesFromDataTransfer(dragEvent.dataTransfer);\n          this.onUploadFiles(files);\n        }\n      } catch (error) {\n        console.error(error);\n      }\n    };\n\n    void uploadFiles();\n  };\n}\n\nexport default DropArea;\n","import { Upload } from \"tus-js-client\";\nimport { findInput, getPlaceholderFieldName } from \"./util\";\nimport RenderUploadFile from \"./render_upload_file\";\nimport DropArea from \"./drop_area\";\n\n\nconst { Plugin } = require('@uppy/core')\nconst { Socket, Provider, RequestClient } = require('@uppy/companion-client')\n// const EventTracker = require('@uppy/utils/lib/EventTracker')\n// const emitSocketProgress = require('@uppy/utils/lib/emitSocketProgress')\n// const getSocketHost = require('@uppy/utils/lib/getSocketHost')\n// const RateLimitedQueue = require('@uppy/utils/lib/RateLimitedQueue')\nconst Uploader = require('./MultipartUploader')\n// const AwsS3Multipart = require('@uppy/aws-s3-multipart')\n\n\n     \n\n\n\nexport interface InitialFile {\n  id: string;\n  name: string;\n  placeholder?: boolean;\n  size: number;\n}\n\nexport interface UploadedFile {\n  id: string;\n  name: string;\n  placeholder: boolean;\n  size: number;\n}\n\nexport type Translations = { [key: string]: string };\n\nexport interface Callbacks {\n  onDelete?: (upload: Upload | UploadedFile) => void;\n  onError?: (error: Error, upload: Upload) => void;\n  onProgress?: (\n    bytesUploaded: number,\n    bytesTotal: number,\n    upload: Upload\n  ) => void;\n  onSuccess?: (upload: Upload) => void;\n}\n\nclass UploadFile {\n  callbacks: Callbacks;\n  fieldName: string;\n  form: Element;\n  formId: string;\n  multiple: boolean;\n  prefix: string | null;\n  renderer: RenderUploadFile;\n  retryDelays: number[] | null;\n  supportDropArea: boolean;\n  uploadIndex: number;\n  uploadUrl: string;\n  uploads: (Upload | UploadedFile)[];\n\n  constructor({\n    callbacks,\n    fieldName,\n    form,\n    formId,\n    initial,\n    input,\n    multiple,\n    parent,\n    prefix,\n    retryDelays,\n    skipRequired,\n    supportDropArea,\n    translations,\n    uploadUrl\n  }: {\n    callbacks: Callbacks;\n    fieldName: string;\n    form: Element;\n    formId: string;\n    initial: InitialFile[];\n    input: HTMLInputElement;\n    multiple: boolean;\n    parent: Element;\n    prefix: string | null;\n    retryDelays: number[] | null;\n    skipRequired: boolean;\n    supportDropArea: boolean;\n    translations: Translations;\n    uploadUrl: string;\n  }) {\n    this.callbacks = callbacks;\n    this.fieldName = fieldName;\n    this.form = form;\n    this.formId = formId;\n    this.multiple = multiple;\n    this.prefix = prefix;\n    this.retryDelays = retryDelays;\n    this.supportDropArea = supportDropArea;\n    this.uploadUrl = uploadUrl;\n\n    this.uploadIndex = 0;\n    this.uploads = [];\n\n    this.renderer = new RenderUploadFile({\n      parent,\n      input,\n      skipRequired,\n      translations\n    });\n    const filesContainer = this.renderer.container;\n\n    if (supportDropArea) {\n      this.initDropArea(filesContainer);\n    }\n\n    if (initial) {\n      this.addInitialFiles(initial);\n    }\n\n    this.checkDropHint();\n\n    input.addEventListener(\"change\", this.onChange);\n    filesContainer.addEventListener(\"click\", this.onClick);\n  }\n\n  createMultipartUpload(file){\n      // var csrftoken = jQuery(\"[name=csrfmiddlewaretoken]\").val();\n      var csrftoken = document.getElementsByName('csrfmiddlewaretoken')[0].value;\n      return fetch('/s3/multipart', {\n      method: 'post',\n      headers: {\n        accept: 'application/json',\n        'content-type': 'application/json',\n        \"X-CSRFToken\": csrftoken\n      },\n      body: JSON.stringify({\n        filename: file.name,\n        contentType: file.type\n      })\n    }).then((response) => {\n      return response.json()\n    }).then((data)=>{\n      console.log(\"createMultipartUpload \",data)\n      return data\n    })\n   }\n\n   listParts(file, {key,uploadId}){\n            const filename=encodeURIComponent(key)\n            const uploadIdEnc = encodeURIComponent(uploadId)\n              return fetch('/s3/multipart/'+uploadIdEnc+\"?key=\"+filename,{\n                method: 'get'\n              }).then((response)=>{\n              return response.json()\n            }).then((data)=>{\n              console.log(\"listParts \",data)\n              return data[\"parts\"]\n            })               \n          }\n\n   prepareUploadPart(file,{key,uploadId,number}){\n            const filename = encodeURIComponent(key)\n             // var csrftoken = jQuery(\"[name=csrfmiddlewaretoken]\").val();\n             var csrftoken = document.getElementsByName('csrfmiddlewaretoken')[0].value;\n            return fetch('/s3/multipart/'+uploadId+\"/\"+parseInt(number)+\"?key=\"+filename,{\n                method: 'get',\n                headers: {\n                    \"X-CSRFToken\": csrftoken\n                }\n            }).then((response)=>{\n              return response.json()\n            }).then((data)=>{\n              console.log(\"prepareUploadPart \",data)\n              return data\n            })   \n\n          }\n\n    completeMultipartUpload(file, { key, uploadId, parts }){\n              const filename = encodeURIComponent(key)\n              const uploadIdEnc = encodeURIComponent(uploadId)\n              // var csrftoken = jQuery(\"[name=csrfmiddlewaretoken]\").val();\n              var csrftoken = document.getElementsByName('csrfmiddlewaretoken')[0].value;\n              return fetch('/s3/multipart/'+uploadIdEnc+\"/complete?key=\"+filename,{\n                    method: 'post',\n                    headers: {\n                        \"X-CSRFToken\": csrftoken\n                    },\n                    body: JSON.stringify({\n                      parts: parts\n                   })\n                }).then((response)=>{\n                  return response.json()\n                }).then((data)=>{\n                  console.log(\"Complete multi upload \",data)\n                  return data\n                })   \n\n              }\n\n    abortMultipartUpload(file, {key, uploadId}){\n              // const filename = encodeURIComponent(key)\n              const uploadIdEnc = encodeURIComponent(uploadId)\n                // var csrftoken = jQuery(\"[name=csrfmiddlewaretoken]\").val();\n              var csrftoken = document.getElementsByName('csrfmiddlewaretoken')[0].value;\n              return fetch('/s3/multipart/'+uploadIdEnc+\"/\",{\n                    method: 'delete',\n                    headers: {\n                        \"X-CSRFToken\": csrftoken\n                    }\n                }).then((response)=>{\n                  return response.json()\n                }).then((data)=>{\n                  return data\n                })   \n            }\n\n  addInitialFiles(initialFiles: InitialFile[]): void {\n    if (initialFiles.length === 0) {\n      return;\n    }\n\n    const { multiple, renderer } = this;\n\n    const addInitialFile = (file: InitialFile, i: number): void => {\n      const { id, name, size } = file;\n      renderer.addUploadedFile(name, i, size);\n\n      if (file.placeholder) {\n        this.uploads.push({ id, name, placeholder: true, size });\n      } else {\n        const url = `${this.uploadUrl}${file.id}`;\n        this.uploads.push({ id, name, placeholder: false, size, url });\n      }\n    };\n\n    if (multiple) {\n      let uploadIndex = 0;\n\n      initialFiles.forEach((file: InitialFile): void => {\n        addInitialFile(file, uploadIndex);\n        uploadIndex += 1;\n      });\n    } else {\n      addInitialFile(initialFiles[0], 0);\n    }\n  }\n\n  uploadFiles = (files: File[]): void => {\n    if (files.length === 0) {\n      return;\n    }\n\n    if (!this.multiple && this.uploads.length !== 0) {\n      this.renderer.deleteFile(0);\n      this.uploads = [];\n    }\n\n    files.forEach(file => {\n      const { fieldName, formId, renderer, uploads, uploadUrl } = this;\n      const filename = file.name;\n      const uploadIndex = uploads.length;\n      console.log(file, fieldName,formId,uploadUrl)\n\n\n      const upload = new Uploader(file, {\n          // .bind to pass the file object to each handler.\n          createMultipartUpload: this.createMultipartUpload.bind(this,file) ,\n          listParts: this.listParts.bind(this,file) ,\n          prepareUploadPart: this.prepareUploadPart.bind(this,file) ,\n          completeMultipartUpload: this.completeMultipartUpload.bind(this,file),\n          abortMultipartUpload: this.abortMultipartUpload.bind(this,file),\n          getChunkSize: null\n          // onStart,\n          // onProgress,\n          // onError,\n          // onSuccess,\n          // onPartComplete,\n\n        })\n      upload.start();\n\n\n\n\n\n      // const upload = new Upload(file, {\n      //   endpoint: uploadUrl,\n      //   metadata: { fieldName, filename, formId },\n      //   onError: (error: Error): void => this.handleError(uploadIndex, error),\n      //   onProgress: (bytesUploaded: number, bytesTotal: number): void =>\n      //     this.handleProgress(uploadIndex, bytesUploaded, bytesTotal),\n      //   onSuccess: (): void =>\n      //     this.handleSuccess(uploadIndex, (upload.file as File).size),\n      //   retryDelays: this.retryDelays || [0, 1000, 3000, 5000]\n      // });\n      // console.log(\"start upload\")\n\n      // upload.start();\n      renderer.addNewUpload(filename, uploadIndex);\n\n      this.uploads.push(upload);\n    });\n\n    this.checkDropHint();\n  };\n\n  onChange = (e: Event): void => {\n    this.uploadFiles([...(e.target as HTMLInputElement).files]);\n  };\n\n  onClick = (e: Event): void => {\n    const target = e.target as HTMLInputElement;\n\n    const getUploadIndex = (): number | null => {\n      const dataIndex = target.getAttribute(\"data-index\");\n\n      if (!dataIndex) {\n        return null;\n      }\n\n      return parseInt(dataIndex, 10);\n    };\n\n    if (target.classList.contains(\"dff-delete\")) {\n      const uploadIndex = getUploadIndex();\n\n      if (uploadIndex !== null) {\n        this.handleDelete(uploadIndex);\n      }\n\n      e.preventDefault();\n    } else if (target.classList.contains(\"dff-cancel\")) {\n      const uploadIndex = getUploadIndex();\n\n      if (uploadIndex !== null) {\n        this.handleCancel(uploadIndex);\n      }\n\n      e.preventDefault();\n    }\n  };\n\n  handleProgress = (\n    uploadIndex: number,\n    bytesUploaded: number,\n    bytesTotal: number\n  ): void => {\n    const percentage = ((bytesUploaded / bytesTotal) * 100).toFixed(2);\n\n    this.renderer.updateProgress(uploadIndex, percentage);\n\n    const { onProgress } = this.callbacks;\n\n    if (onProgress) {\n      const upload = this.uploads[uploadIndex];\n\n      if (upload instanceof Upload) {\n        onProgress(bytesUploaded, bytesTotal, upload);\n      }\n    }\n  };\n\n  handleError = (uploadIndex: number, error: Error): void => {\n    this.renderer.setError(uploadIndex);\n\n    const { onError } = this.callbacks;\n\n    if (onError) {\n      const upload = this.uploads[uploadIndex];\n\n      if (upload instanceof Upload) {\n        onError(error, upload);\n      }\n    }\n  };\n\n  handleSuccess = (uploadIndex: number, uploadedSize: number): void => {\n    const { renderer } = this;\n\n    renderer.clearInput();\n    renderer.setSuccess(uploadIndex, uploadedSize);\n\n    const { onSuccess } = this.callbacks;\n\n    if (onSuccess) {\n      const upload = this.uploads[uploadIndex];\n\n      if (upload instanceof Upload) {\n        onSuccess(upload);\n      }\n    }\n  };\n\n  handleDelete(uploadIndex: number): void {\n    const upload = this.uploads[uploadIndex];\n\n    if (upload instanceof Upload) {\n      this.deleteFromServer(uploadIndex);\n    } else {\n      this.deletePlaceholder(uploadIndex);\n    }\n  }\n\n  deleteUpload(uploadIndex: number): void {\n    const upload = this.uploads[uploadIndex];\n\n    this.renderer.deleteFile(uploadIndex);\n    delete this.uploads[uploadIndex];\n    this.checkDropHint();\n\n    const { onDelete } = this.callbacks;\n    if (onDelete) {\n      onDelete(upload);\n    }\n  }\n\n  deleteFromServer(uploadIndex: number): void {\n    const upload = this.uploads[uploadIndex];\n\n    if (!(upload instanceof Upload)) {\n      return;\n    }\n\n    const { url } = upload;\n\n    if (!url) {\n      return;\n    }\n\n    const xhr = new window.XMLHttpRequest();\n    xhr.open(\"DELETE\", url);\n\n    xhr.onload = (): void => {\n      if (xhr.status === 204) {\n        this.deleteUpload(uploadIndex);\n      } else {\n        this.renderer.setDeleteFailed(uploadIndex);\n      }\n    };\n    xhr.setRequestHeader(\"Tus-Resumable\", \"1.0.0\");\n    xhr.send(null);\n  }\n\n  deletePlaceholder(uploadIndex: number): void {\n    this.deleteUpload(uploadIndex);\n    this.updatePlaceholderInput();\n  }\n\n  handleCancel(uploadIndex: number): void {\n    const upload = this.uploads[uploadIndex];\n\n    if (upload instanceof Upload) {\n      void upload.abort(true);\n\n      this.deleteUpload(uploadIndex);\n    }\n  }\n\n  initDropArea(container: Element): void {\n    new DropArea({\n      container,\n      onUploadFiles: this.uploadFiles\n    });\n  }\n\n  checkDropHint(): void {\n    if (!this.supportDropArea) {\n      return;\n    }\n\n    const nonEmptyUploads = this.uploads.filter(e => e);\n\n    if (nonEmptyUploads.length === 0) {\n      this.renderer.renderDropHint();\n    } else {\n      this.renderer.removeDropHint();\n    }\n  }\n\n  updatePlaceholderInput(): void {\n    const placeholdersInfo = this.uploads.filter(\n      upload => !(upload instanceof Upload) && upload.placeholder\n    ) as UploadedFile[];\n\n    const input = findInput(\n      this.form,\n      getPlaceholderFieldName(this.fieldName, this.prefix),\n      this.prefix\n    );\n    if (input) {\n      input.value = JSON.stringify(placeholdersInfo);\n    }\n  }\n}\n\nexport default UploadFile;\n","import UploadFile, {\n  Callbacks,\n  InitialFile,\n  Translations\n} from \"./upload_file\";\nimport {\n  getInputNameWithPrefix,\n  getInputValueForFormAndPrefix,\n  getPlaceholderFieldName\n} from \"./util\";\n\ninterface Options {\n  callbacks?: Callbacks;\n  prefix?: string;\n  retryDelays?: number[];\n  skipRequired?: boolean;\n  supportDropArea?: boolean;\n}\n\nconst initUploadFields = (form: Element, options: Options = {}): void => {\n  const matchesPrefix = (fieldName: string): boolean => {\n    if (!(options && options.prefix)) {\n      return true;\n    }\n\n    return fieldName.startsWith(`${options.prefix}-`);\n  };\n\n  const getPrefix = (): string | null =>\n    options && options.prefix ? options.prefix : null;\n\n  const getInputValue = (fieldName: string): string | undefined =>\n    getInputValueForFormAndPrefix(form, fieldName, getPrefix());\n\n  const getInitialFiles = (element: HTMLElement): InitialFile[] => {\n    const filesData = element.dataset.files;\n\n    if (!filesData) {\n      return [];\n    }\n\n    return JSON.parse(filesData) as InitialFile[];\n  };\n\n  const getPlaceholders = (fieldName: string): InitialFile[] => {\n    const data = getInputValue(getPlaceholderFieldName(fieldName, getPrefix()));\n\n    if (!data) {\n      return [];\n    }\n\n    return JSON.parse(data) as InitialFile[];\n  };\n\n  const uploadUrl = getInputValue(\"upload_url\");\n  const formId = getInputValue(\"form_id\");\n  const skipRequired = options.skipRequired || false;\n  const prefix = getPrefix();\n\n  if (!formId || !uploadUrl) {\n    return;\n  }\n\n  form.querySelectorAll(\".dff-uploader\").forEach(uploaderDiv => {\n    const container = uploaderDiv.querySelector(\n      \".dff-container\"\n    ) as HTMLElement;\n\n    if (!container) {\n      return;\n    }\n\n    const input = container.querySelector(\n      \"input[type=file]\"\n    ) as HTMLInputElement;\n\n    if (!(input && matchesPrefix(input.name))) {\n      return;\n    }\n\n    const fieldName = input.name;\n    const { multiple } = input;\n    const initial = getInitialFiles(container).concat(\n      getPlaceholders(fieldName)\n    );\n    const dataTranslations = container.getAttribute(\"data-translations\");\n    const translations: Translations = dataTranslations\n      ? (JSON.parse(dataTranslations) as Translations)\n      : {};\n    const supportDropArea = !(options.supportDropArea === false);\n\n    new UploadFile({\n      callbacks: options.callbacks || {},\n      fieldName,\n      form,\n      formId,\n      initial,\n      input,\n      multiple,\n      parent: container,\n      prefix,\n      retryDelays: options.retryDelays || null,\n      skipRequired,\n      supportDropArea,\n      translations,\n      uploadUrl\n    });\n  });\n};\n\nconst initFormSet = (form: Element, optionsParam: Options | string): void => {\n  let options: Options;\n\n  if (typeof optionsParam === \"string\") {\n    options = { prefix: optionsParam };\n  } else {\n    options = optionsParam;\n  }\n\n  const prefix = options.prefix || \"form\";\n\n  const totalFormsValue = getInputValueForFormAndPrefix(\n    form,\n    \"TOTAL_FORMS\",\n    prefix\n  );\n\n  if (!totalFormsValue) {\n    return;\n  }\n\n  const formCount = parseInt(totalFormsValue, 10);\n\n  for (let i = 0; i < formCount; i += 1) {\n    const subFormPrefix = getInputNameWithPrefix(`${i}`, null);\n    initUploadFields(form, {\n      ...options,\n      prefix: `${prefix}-${subFormPrefix}`\n    });\n  }\n};\n\ndeclare const global: any; // eslint-disable-line @typescript-eslint/no-explicit-any\n\nglobal.initFormSet = initFormSet; // eslint-disable-line  @typescript-eslint/no-unsafe-member-access\nglobal.initUploadFields = initUploadFields; // eslint-disable-line  @typescript-eslint/no-unsafe-member-access\n","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;","'use strict';\n\n/**\n * Check if we're required to add a port number.\n *\n * @see https://url.spec.whatwg.org/#default-port\n * @param {Number|String} port Port number we need to check\n * @param {String} protocol Protocol we need to check against.\n * @returns {Boolean} Is it a default port for the given protocol\n * @api private\n */\nmodule.exports = function required(port, protocol) {\n  protocol = protocol.split(':')[0];\n  port = +port;\n\n  if (!port) return false;\n\n  switch (protocol) {\n    case 'http':\n    case 'ws':\n    return port !== 80;\n\n    case 'https':\n    case 'wss':\n    return port !== 443;\n\n    case 'ftp':\n    return port !== 21;\n\n    case 'gopher':\n    return port !== 70;\n\n    case 'file':\n    return false;\n  }\n\n  return port !== 0;\n};\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , undef;\n\n/**\n * Decode a URI encoded string.\n *\n * @param {String} input The URI encoded string.\n * @returns {String|Null} The decoded string.\n * @api private\n */\nfunction decode(input) {\n  try {\n    return decodeURIComponent(input.replace(/\\+/g, ' '));\n  } catch (e) {\n    return null;\n  }\n}\n\n/**\n * Attempts to encode a given input.\n *\n * @param {String} input The string that needs to be encoded.\n * @returns {String|Null} The encoded string.\n * @api private\n */\nfunction encode(input) {\n  try {\n    return encodeURIComponent(input);\n  } catch (e) {\n    return null;\n  }\n}\n\n/**\n * Simple query string parser.\n *\n * @param {String} query The query string that needs to be parsed.\n * @returns {Object}\n * @api public\n */\nfunction querystring(query) {\n  var parser = /([^=?&]+)=?([^&]*)/g\n    , result = {}\n    , part;\n\n  while (part = parser.exec(query)) {\n    var key = decode(part[1])\n      , value = decode(part[2]);\n\n    //\n    // Prevent overriding of existing properties. This ensures that build-in\n    // methods like `toString` or __proto__ are not overriden by malicious\n    // querystrings.\n    //\n    // In the case if failed decoding, we want to omit the key/value pairs\n    // from the result.\n    //\n    if (key === null || value === null || key in result) continue;\n    result[key] = value;\n  }\n\n  return result;\n}\n\n/**\n * Transform a query string to an object.\n *\n * @param {Object} obj Object that should be transformed.\n * @param {String} prefix Optional prefix.\n * @returns {String}\n * @api public\n */\nfunction querystringify(obj, prefix) {\n  prefix = prefix || '';\n\n  var pairs = []\n    , value\n    , key;\n\n  //\n  // Optionally prefix with a '?' if needed\n  //\n  if ('string' !== typeof prefix) prefix = '?';\n\n  for (key in obj) {\n    if (has.call(obj, key)) {\n      value = obj[key];\n\n      //\n      // Edge cases where we actually want to encode the value to an empty\n      // string instead of the stringified value.\n      //\n      if (!value && (value === null || value === undef || isNaN(value))) {\n        value = '';\n      }\n\n      key = encodeURIComponent(key);\n      value = encodeURIComponent(value);\n\n      //\n      // If we failed to encode the strings, we should bail out as we don't\n      // want to add invalid strings to the query.\n      //\n      if (key === null || value === null) continue;\n      pairs.push(key +'='+ value);\n    }\n  }\n\n  return pairs.length ? prefix + pairs.join('&') : '';\n}\n\n//\n// Expose the module.\n//\nexports.stringify = querystringify;\nexports.parse = querystring;\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === \"function\" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== \"function\") { throw new TypeError(\"Super expression must either be null or a function\"); } if (typeof _cache !== \"undefined\") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction _construct(Parent, args, Class) { if (_isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf(\"[native code]\") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar Translator = require('@uppy/utils/lib/Translator');\n\nvar ee = require('namespace-emitter');\n\nvar cuid = require('cuid');\n\nvar throttle = require('lodash.throttle');\n\nvar prettierBytes = require('@transloadit/prettier-bytes');\n\nvar match = require('mime-match');\n\nvar DefaultStore = require('@uppy/store-default');\n\nvar getFileType = require('@uppy/utils/lib/getFileType');\n\nvar getFileNameAndExtension = require('@uppy/utils/lib/getFileNameAndExtension');\n\nvar generateFileID = require('@uppy/utils/lib/generateFileID');\n\nvar supportsUploadProgress = require('./supportsUploadProgress');\n\nvar _require = require('./loggers'),\n    justErrorsLogger = _require.justErrorsLogger,\n    debugLogger = _require.debugLogger;\n\nvar Plugin = require('./Plugin'); // Exported from here.\n\n\nvar RestrictionError = /*#__PURE__*/function (_Error) {\n  _inheritsLoose(RestrictionError, _Error);\n\n  function RestrictionError() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _Error.call.apply(_Error, [this].concat(args)) || this;\n    _this.isRestriction = true;\n    return _this;\n  }\n\n  return RestrictionError;\n}( /*#__PURE__*/_wrapNativeSuper(Error));\n/**\n * Uppy Core module.\n * Manages plugins, state updates, acts as an event bus,\n * adds/removes files and metadata.\n */\n\n\nvar Uppy = /*#__PURE__*/function () {\n  /**\n   * Instantiate Uppy\n   *\n   * @param {object} opts  Uppy options\n   */\n  function Uppy(opts) {\n    var _this2 = this;\n\n    this.defaultLocale = {\n      strings: {\n        addBulkFilesFailed: {\n          0: 'Failed to add %{smart_count} file due to an internal error',\n          1: 'Failed to add %{smart_count} files due to internal errors'\n        },\n        youCanOnlyUploadX: {\n          0: 'You can only upload %{smart_count} file',\n          1: 'You can only upload %{smart_count} files'\n        },\n        youHaveToAtLeastSelectX: {\n          0: 'You have to select at least %{smart_count} file',\n          1: 'You have to select at least %{smart_count} files'\n        },\n        // The default `exceedsSize2` string only combines the `exceedsSize` string (%{backwardsCompat}) with the size.\n        // Locales can override `exceedsSize2` to specify a different word order. This is for backwards compat with\n        // Uppy 1.9.x and below which did a naive concatenation of `exceedsSize2 + size` instead of using a locale-specific\n        // substitution.\n        // TODO: In 2.0 `exceedsSize2` should be removed in and `exceedsSize` updated to use substitution.\n        exceedsSize2: '%{backwardsCompat} %{size}',\n        exceedsSize: 'This file exceeds maximum allowed size of',\n        youCanOnlyUploadFileTypes: 'You can only upload: %{types}',\n        noNewAlreadyUploading: 'Cannot add new files: already uploading',\n        noDuplicates: 'Cannot add the duplicate file \\'%{fileName}\\', it already exists',\n        companionError: 'Connection with Companion failed',\n        companionUnauthorizeHint: 'To unauthorize to your %{provider} account, please go to %{url}',\n        failedToUpload: 'Failed to upload %{file}',\n        noInternetConnection: 'No Internet connection',\n        connectedToInternet: 'Connected to the Internet',\n        // Strings for remote providers\n        noFilesFound: 'You have no files or folders here',\n        selectX: {\n          0: 'Select %{smart_count}',\n          1: 'Select %{smart_count}'\n        },\n        selectAllFilesFromFolderNamed: 'Select all files from folder %{name}',\n        unselectAllFilesFromFolderNamed: 'Unselect all files from folder %{name}',\n        selectFileNamed: 'Select file %{name}',\n        unselectFileNamed: 'Unselect file %{name}',\n        openFolderNamed: 'Open folder %{name}',\n        cancel: 'Cancel',\n        logOut: 'Log out',\n        filter: 'Filter',\n        resetFilter: 'Reset filter',\n        loading: 'Loading...',\n        authenticateWithTitle: 'Please authenticate with %{pluginName} to select files',\n        authenticateWith: 'Connect to %{pluginName}',\n        emptyFolderAdded: 'No files were added from empty folder',\n        folderAdded: {\n          0: 'Added %{smart_count} file from %{folder}',\n          1: 'Added %{smart_count} files from %{folder}'\n        }\n      }\n    };\n    var defaultOptions = {\n      id: 'uppy',\n      autoProceed: false,\n      allowMultipleUploads: true,\n      debug: false,\n      restrictions: {\n        maxFileSize: null,\n        maxNumberOfFiles: null,\n        minNumberOfFiles: null,\n        allowedFileTypes: null\n      },\n      meta: {},\n      onBeforeFileAdded: function onBeforeFileAdded(currentFile, files) {\n        return currentFile;\n      },\n      onBeforeUpload: function onBeforeUpload(files) {\n        return files;\n      },\n      store: DefaultStore(),\n      logger: justErrorsLogger\n    }; // Merge default options with the ones set by user,\n    // making sure to merge restrictions too\n\n    this.opts = _extends({}, defaultOptions, {}, opts, {\n      restrictions: _extends({}, defaultOptions.restrictions, {}, opts && opts.restrictions)\n    }); // Support debug: true for backwards-compatability, unless logger is set in opts\n    // opts instead of this.opts to avoid comparing objects  we set logger: justErrorsLogger in defaultOptions\n\n    if (opts && opts.logger && opts.debug) {\n      this.log('You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.', 'warning');\n    } else if (opts && opts.debug) {\n      this.opts.logger = debugLogger;\n    }\n\n    this.log(\"Using Core v\" + this.constructor.VERSION);\n\n    if (this.opts.restrictions.allowedFileTypes && this.opts.restrictions.allowedFileTypes !== null && !Array.isArray(this.opts.restrictions.allowedFileTypes)) {\n      throw new TypeError('`restrictions.allowedFileTypes` must be an array');\n    }\n\n    this.i18nInit(); // Container for different types of plugins\n\n    this.plugins = {};\n    this.getState = this.getState.bind(this);\n    this.getPlugin = this.getPlugin.bind(this);\n    this.setFileMeta = this.setFileMeta.bind(this);\n    this.setFileState = this.setFileState.bind(this);\n    this.log = this.log.bind(this);\n    this.info = this.info.bind(this);\n    this.hideInfo = this.hideInfo.bind(this);\n    this.addFile = this.addFile.bind(this);\n    this.removeFile = this.removeFile.bind(this);\n    this.pauseResume = this.pauseResume.bind(this); // ___Why throttle at 500ms?\n    //    - We must throttle at >250ms for superfocus in Dashboard to work well (because animation takes 0.25s, and we want to wait for all animations to be over before refocusing).\n    //    [Practical Check]: if thottle is at 100ms, then if you are uploading a file, and click 'ADD MORE FILES', - focus won't activate in Firefox.\n    //    - We must throttle at around >500ms to avoid performance lags.\n    //    [Practical Check] Firefox, try to upload a big file for a prolonged period of time. Laptop will start to heat up.\n\n    this._calculateProgress = throttle(this._calculateProgress.bind(this), 500, {\n      leading: true,\n      trailing: true\n    });\n    this.updateOnlineStatus = this.updateOnlineStatus.bind(this);\n    this.resetProgress = this.resetProgress.bind(this);\n    this.pauseAll = this.pauseAll.bind(this);\n    this.resumeAll = this.resumeAll.bind(this);\n    this.retryAll = this.retryAll.bind(this);\n    this.cancelAll = this.cancelAll.bind(this);\n    this.retryUpload = this.retryUpload.bind(this);\n    this.upload = this.upload.bind(this);\n    this.emitter = ee();\n    this.on = this.on.bind(this);\n    this.off = this.off.bind(this);\n    this.once = this.emitter.once.bind(this.emitter);\n    this.emit = this.emitter.emit.bind(this.emitter);\n    this.preProcessors = [];\n    this.uploaders = [];\n    this.postProcessors = [];\n    this.store = this.opts.store;\n    this.setState({\n      plugins: {},\n      files: {},\n      currentUploads: {},\n      allowNewUpload: true,\n      capabilities: {\n        uploadProgress: supportsUploadProgress(),\n        individualCancellation: true,\n        resumableUploads: false\n      },\n      totalProgress: 0,\n      meta: _extends({}, this.opts.meta),\n      info: {\n        isHidden: true,\n        type: 'info',\n        message: ''\n      }\n    });\n    this._storeUnsubscribe = this.store.subscribe(function (prevState, nextState, patch) {\n      _this2.emit('state-update', prevState, nextState, patch);\n\n      _this2.updateAll(nextState);\n    }); // Exposing uppy object on window for debugging and testing\n\n    if (this.opts.debug && typeof window !== 'undefined') {\n      window[this.opts.id] = this;\n    }\n\n    this._addListeners(); // Re-enable if well need some capabilities on boot, like isMobileDevice\n    // this._setCapabilities()\n\n  } // _setCapabilities = () => {\n  //   const capabilities = {\n  //     isMobileDevice: isMobileDevice()\n  //   }\n  //   this.setState({\n  //     ...this.getState().capabilities,\n  //     capabilities\n  //   })\n  // }\n\n\n  var _proto = Uppy.prototype;\n\n  _proto.on = function on(event, callback) {\n    this.emitter.on(event, callback);\n    return this;\n  };\n\n  _proto.off = function off(event, callback) {\n    this.emitter.off(event, callback);\n    return this;\n  }\n  /**\n   * Iterate on all plugins and run `update` on them.\n   * Called each time state changes.\n   *\n   */\n  ;\n\n  _proto.updateAll = function updateAll(state) {\n    this.iteratePlugins(function (plugin) {\n      plugin.update(state);\n    });\n  }\n  /**\n   * Updates state with a patch\n   *\n   * @param {object} patch {foo: 'bar'}\n   */\n  ;\n\n  _proto.setState = function setState(patch) {\n    this.store.setState(patch);\n  }\n  /**\n   * Returns current state.\n   *\n   * @returns {object}\n   */\n  ;\n\n  _proto.getState = function getState() {\n    return this.store.getState();\n  }\n  /**\n   * Back compat for when uppy.state is used instead of uppy.getState().\n   */\n  ;\n\n  /**\n   * Shorthand to set state for a specific file.\n   */\n  _proto.setFileState = function setFileState(fileID, state) {\n    var _extends2;\n\n    if (!this.getState().files[fileID]) {\n      throw new Error(\"Can\\u2019t set state for \" + fileID + \" (the file could have been removed)\");\n    }\n\n    this.setState({\n      files: _extends({}, this.getState().files, (_extends2 = {}, _extends2[fileID] = _extends({}, this.getState().files[fileID], state), _extends2))\n    });\n  };\n\n  _proto.i18nInit = function i18nInit() {\n    this.translator = new Translator([this.defaultLocale, this.opts.locale]);\n    this.locale = this.translator.locale;\n    this.i18n = this.translator.translate.bind(this.translator);\n    this.i18nArray = this.translator.translateArray.bind(this.translator);\n  };\n\n  _proto.setOptions = function setOptions(newOpts) {\n    this.opts = _extends({}, this.opts, {}, newOpts, {\n      restrictions: _extends({}, this.opts.restrictions, {}, newOpts && newOpts.restrictions)\n    });\n\n    if (newOpts.meta) {\n      this.setMeta(newOpts.meta);\n    }\n\n    this.i18nInit();\n\n    if (newOpts.locale) {\n      this.iteratePlugins(function (plugin) {\n        plugin.setOptions();\n      });\n    }\n\n    this.setState(); // so that UI re-renders with new options\n  };\n\n  _proto.resetProgress = function resetProgress() {\n    var defaultProgress = {\n      percentage: 0,\n      bytesUploaded: 0,\n      uploadComplete: false,\n      uploadStarted: null\n    };\n\n    var files = _extends({}, this.getState().files);\n\n    var updatedFiles = {};\n    Object.keys(files).forEach(function (fileID) {\n      var updatedFile = _extends({}, files[fileID]);\n\n      updatedFile.progress = _extends({}, updatedFile.progress, defaultProgress);\n      updatedFiles[fileID] = updatedFile;\n    });\n    this.setState({\n      files: updatedFiles,\n      totalProgress: 0\n    });\n    this.emit('reset-progress');\n  };\n\n  _proto.addPreProcessor = function addPreProcessor(fn) {\n    this.preProcessors.push(fn);\n  };\n\n  _proto.removePreProcessor = function removePreProcessor(fn) {\n    var i = this.preProcessors.indexOf(fn);\n\n    if (i !== -1) {\n      this.preProcessors.splice(i, 1);\n    }\n  };\n\n  _proto.addPostProcessor = function addPostProcessor(fn) {\n    this.postProcessors.push(fn);\n  };\n\n  _proto.removePostProcessor = function removePostProcessor(fn) {\n    var i = this.postProcessors.indexOf(fn);\n\n    if (i !== -1) {\n      this.postProcessors.splice(i, 1);\n    }\n  };\n\n  _proto.addUploader = function addUploader(fn) {\n    this.uploaders.push(fn);\n  };\n\n  _proto.removeUploader = function removeUploader(fn) {\n    var i = this.uploaders.indexOf(fn);\n\n    if (i !== -1) {\n      this.uploaders.splice(i, 1);\n    }\n  };\n\n  _proto.setMeta = function setMeta(data) {\n    var updatedMeta = _extends({}, this.getState().meta, data);\n\n    var updatedFiles = _extends({}, this.getState().files);\n\n    Object.keys(updatedFiles).forEach(function (fileID) {\n      updatedFiles[fileID] = _extends({}, updatedFiles[fileID], {\n        meta: _extends({}, updatedFiles[fileID].meta, data)\n      });\n    });\n    this.log('Adding metadata:');\n    this.log(data);\n    this.setState({\n      meta: updatedMeta,\n      files: updatedFiles\n    });\n  };\n\n  _proto.setFileMeta = function setFileMeta(fileID, data) {\n    var updatedFiles = _extends({}, this.getState().files);\n\n    if (!updatedFiles[fileID]) {\n      this.log('Was trying to set metadata for a file that has been removed: ', fileID);\n      return;\n    }\n\n    var newMeta = _extends({}, updatedFiles[fileID].meta, data);\n\n    updatedFiles[fileID] = _extends({}, updatedFiles[fileID], {\n      meta: newMeta\n    });\n    this.setState({\n      files: updatedFiles\n    });\n  }\n  /**\n   * Get a file object.\n   *\n   * @param {string} fileID The ID of the file object to return.\n   */\n  ;\n\n  _proto.getFile = function getFile(fileID) {\n    return this.getState().files[fileID];\n  }\n  /**\n   * Get all files in an array.\n   */\n  ;\n\n  _proto.getFiles = function getFiles() {\n    var _this$getState = this.getState(),\n        files = _this$getState.files;\n\n    return Object.keys(files).map(function (fileID) {\n      return files[fileID];\n    });\n  }\n  /**\n   * Check if minNumberOfFiles restriction is reached before uploading.\n   *\n   * @private\n   */\n  ;\n\n  _proto._checkMinNumberOfFiles = function _checkMinNumberOfFiles(files) {\n    var minNumberOfFiles = this.opts.restrictions.minNumberOfFiles;\n\n    if (Object.keys(files).length < minNumberOfFiles) {\n      throw new RestrictionError(\"\" + this.i18n('youHaveToAtLeastSelectX', {\n        smart_count: minNumberOfFiles\n      }));\n    }\n  }\n  /**\n   * Check if file passes a set of restrictions set in options: maxFileSize,\n   * maxNumberOfFiles and allowedFileTypes.\n   *\n   * @param {object} files Object of IDs  files already added\n   * @param {object} file object to check\n   * @private\n   */\n  ;\n\n  _proto._checkRestrictions = function _checkRestrictions(files, file) {\n    var _this$opts$restrictio = this.opts.restrictions,\n        maxFileSize = _this$opts$restrictio.maxFileSize,\n        maxNumberOfFiles = _this$opts$restrictio.maxNumberOfFiles,\n        allowedFileTypes = _this$opts$restrictio.allowedFileTypes;\n\n    if (maxNumberOfFiles) {\n      if (Object.keys(files).length + 1 > maxNumberOfFiles) {\n        throw new RestrictionError(\"\" + this.i18n('youCanOnlyUploadX', {\n          smart_count: maxNumberOfFiles\n        }));\n      }\n    }\n\n    if (allowedFileTypes) {\n      var isCorrectFileType = allowedFileTypes.some(function (type) {\n        // is this is a mime-type\n        if (type.indexOf('/') > -1) {\n          if (!file.type) return false;\n          return match(file.type.replace(/;.*?$/, ''), type);\n        } // otherwise this is likely an extension\n\n\n        if (type[0] === '.') {\n          return file.extension.toLowerCase() === type.substr(1).toLowerCase();\n        }\n\n        return false;\n      });\n\n      if (!isCorrectFileType) {\n        var allowedFileTypesString = allowedFileTypes.join(', ');\n        throw new RestrictionError(this.i18n('youCanOnlyUploadFileTypes', {\n          types: allowedFileTypesString\n        }));\n      }\n    } // We can't check maxFileSize if the size is unknown.\n\n\n    if (maxFileSize && file.data.size != null) {\n      if (file.data.size > maxFileSize) {\n        throw new RestrictionError(this.i18n('exceedsSize2', {\n          backwardsCompat: this.i18n('exceedsSize'),\n          size: prettierBytes(maxFileSize)\n        }));\n      }\n    }\n  }\n  /**\n   * Logs an error, sets Informer message, then throws the error.\n   * Emits a 'restriction-failed' event if its a restriction error\n   *\n   * @param {object | string} err  Error object or plain string message\n   * @param {object} [options]\n   * @param {boolean} [options.showInformer=true]  Sometimes developer might want to show Informer manually\n   * @param {object} [options.file=null]  File object used to emit the restriction error\n   * @param {boolean} [options.throwErr=true]  Errors shouldnt be thrown, for example, in `upload-error` event\n   * @private\n   */\n  ;\n\n  _proto._showOrLogErrorAndThrow = function _showOrLogErrorAndThrow(err, _temp) {\n    var _ref = _temp === void 0 ? {} : _temp,\n        _ref$showInformer = _ref.showInformer,\n        showInformer = _ref$showInformer === void 0 ? true : _ref$showInformer,\n        _ref$file = _ref.file,\n        file = _ref$file === void 0 ? null : _ref$file,\n        _ref$throwErr = _ref.throwErr,\n        throwErr = _ref$throwErr === void 0 ? true : _ref$throwErr;\n\n    var message = typeof err === 'object' ? err.message : err;\n    var details = typeof err === 'object' && err.details ? err.details : ''; // Restriction errors should be logged, but not as errors,\n    // as they are expected and shown in the UI.\n\n    var logMessageWithDetails = message;\n\n    if (details) {\n      logMessageWithDetails += ' ' + details;\n    }\n\n    if (err.isRestriction) {\n      this.log(logMessageWithDetails);\n      this.emit('restriction-failed', file, err);\n    } else {\n      this.log(logMessageWithDetails, 'error');\n    } // Sometimes informer has to be shown manually by the developer,\n    // for example, in `onBeforeFileAdded`.\n\n\n    if (showInformer) {\n      this.info({\n        message: message,\n        details: details\n      }, 'error', 5000);\n    }\n\n    if (throwErr) {\n      throw typeof err === 'object' ? err : new Error(err);\n    }\n  };\n\n  _proto._assertNewUploadAllowed = function _assertNewUploadAllowed(file) {\n    var _this$getState2 = this.getState(),\n        allowNewUpload = _this$getState2.allowNewUpload;\n\n    if (allowNewUpload === false) {\n      this._showOrLogErrorAndThrow(new RestrictionError(this.i18n('noNewAlreadyUploading')), {\n        file: file\n      });\n    }\n  }\n  /**\n   * Create a file state object based on user-provided `addFile()` options.\n   *\n   * Note this is extremely side-effectful and should only be done when a file state object will be added to state immediately afterward!\n   *\n   * The `files` value is passed in because it may be updated by the caller without updating the store.\n   */\n  ;\n\n  _proto._checkAndCreateFileStateObject = function _checkAndCreateFileStateObject(files, file) {\n    var fileType = getFileType(file);\n    file.type = fileType;\n    var onBeforeFileAddedResult = this.opts.onBeforeFileAdded(file, files);\n\n    if (onBeforeFileAddedResult === false) {\n      // Dont show UI info for this error, as it should be done by the developer\n      this._showOrLogErrorAndThrow(new RestrictionError('Cannot add the file because onBeforeFileAdded returned false.'), {\n        showInformer: false,\n        file: file\n      });\n    }\n\n    if (typeof onBeforeFileAddedResult === 'object' && onBeforeFileAddedResult) {\n      file = onBeforeFileAddedResult;\n    }\n\n    var fileName;\n\n    if (file.name) {\n      fileName = file.name;\n    } else if (fileType.split('/')[0] === 'image') {\n      fileName = fileType.split('/')[0] + '.' + fileType.split('/')[1];\n    } else {\n      fileName = 'noname';\n    }\n\n    var fileExtension = getFileNameAndExtension(fileName).extension;\n    var isRemote = file.isRemote || false;\n    var fileID = generateFileID(file);\n\n    if (files[fileID]) {\n      this._showOrLogErrorAndThrow(new RestrictionError(this.i18n('noDuplicates', {\n        fileName: fileName\n      })), {\n        file: file\n      });\n    }\n\n    var meta = file.meta || {};\n    meta.name = fileName;\n    meta.type = fileType; // `null` means the size is unknown.\n\n    var size = isFinite(file.data.size) ? file.data.size : null;\n    var newFile = {\n      source: file.source || '',\n      id: fileID,\n      name: fileName,\n      extension: fileExtension || '',\n      meta: _extends({}, this.getState().meta, {}, meta),\n      type: fileType,\n      data: file.data,\n      progress: {\n        percentage: 0,\n        bytesUploaded: 0,\n        bytesTotal: size,\n        uploadComplete: false,\n        uploadStarted: null\n      },\n      size: size,\n      isRemote: isRemote,\n      remote: file.remote || '',\n      preview: file.preview\n    };\n\n    try {\n      this._checkRestrictions(files, newFile);\n    } catch (err) {\n      this._showOrLogErrorAndThrow(err, {\n        file: newFile\n      });\n    }\n\n    return newFile;\n  } // Schedule an upload if `autoProceed` is enabled.\n  ;\n\n  _proto._startIfAutoProceed = function _startIfAutoProceed() {\n    var _this3 = this;\n\n    if (this.opts.autoProceed && !this.scheduledAutoProceed) {\n      this.scheduledAutoProceed = setTimeout(function () {\n        _this3.scheduledAutoProceed = null;\n\n        _this3.upload().catch(function (err) {\n          if (!err.isRestriction) {\n            _this3.log(err.stack || err.message || err);\n          }\n        });\n      }, 4);\n    }\n  }\n  /**\n   * Add a new file to `state.files`. This will run `onBeforeFileAdded`,\n   * try to guess file type in a clever way, check file against restrictions,\n   * and start an upload if `autoProceed === true`.\n   *\n   * @param {object} file object to add\n   * @returns {string} id for the added file\n   */\n  ;\n\n  _proto.addFile = function addFile(file) {\n    var _extends3;\n\n    this._assertNewUploadAllowed(file);\n\n    var _this$getState3 = this.getState(),\n        files = _this$getState3.files;\n\n    var newFile = this._checkAndCreateFileStateObject(files, file);\n\n    this.setState({\n      files: _extends({}, files, (_extends3 = {}, _extends3[newFile.id] = newFile, _extends3))\n    });\n    this.emit('file-added', newFile);\n    this.log(\"Added file: \" + newFile.name + \", \" + newFile.id + \", mime type: \" + newFile.type);\n\n    this._startIfAutoProceed();\n\n    return newFile.id;\n  }\n  /**\n   * Add multiple files to `state.files`. See the `addFile()` documentation.\n   *\n   * This cuts some corners for performance, so should typically only be used in cases where there may be a lot of files.\n   *\n   * If an error occurs while adding a file, it is logged and the user is notified. This is good for UI plugins, but not for programmatic use. Programmatic users should usually still use `addFile()` on individual files.\n   */\n  ;\n\n  _proto.addFiles = function addFiles(fileDescriptors) {\n    var _this4 = this;\n\n    this._assertNewUploadAllowed(); // create a copy of the files object only once\n\n\n    var files = _extends({}, this.getState().files);\n\n    var newFiles = [];\n    var errors = [];\n\n    for (var i = 0; i < fileDescriptors.length; i++) {\n      try {\n        var newFile = this._checkAndCreateFileStateObject(files, fileDescriptors[i]);\n\n        newFiles.push(newFile);\n        files[newFile.id] = newFile;\n      } catch (err) {\n        if (!err.isRestriction) {\n          errors.push(err);\n        }\n      }\n    }\n\n    this.setState({\n      files: files\n    });\n    newFiles.forEach(function (newFile) {\n      _this4.emit('file-added', newFile);\n    });\n\n    if (newFiles.length > 5) {\n      this.log(\"Added batch of \" + newFiles.length + \" files\");\n    } else {\n      Object.keys(newFiles).forEach(function (fileID) {\n        _this4.log(\"Added file: \" + newFiles[fileID].name + \"\\n id: \" + newFiles[fileID].id + \"\\n type: \" + newFiles[fileID].type);\n      });\n    }\n\n    if (newFiles.length > 0) {\n      this._startIfAutoProceed();\n    }\n\n    if (errors.length > 0) {\n      var message = 'Multiple errors occurred while adding files:\\n';\n      errors.forEach(function (subError) {\n        message += \"\\n * \" + subError.message;\n      });\n      this.info({\n        message: this.i18n('addBulkFilesFailed', {\n          smart_count: errors.length\n        }),\n        details: message\n      }, 'error', 5000);\n      var err = new Error(message);\n      err.errors = errors;\n      throw err;\n    }\n  };\n\n  _proto.removeFiles = function removeFiles(fileIDs) {\n    var _this5 = this;\n\n    var _this$getState4 = this.getState(),\n        files = _this$getState4.files,\n        currentUploads = _this$getState4.currentUploads;\n\n    var updatedFiles = _extends({}, files);\n\n    var updatedUploads = _extends({}, currentUploads);\n\n    var removedFiles = Object.create(null);\n    fileIDs.forEach(function (fileID) {\n      if (files[fileID]) {\n        removedFiles[fileID] = files[fileID];\n        delete updatedFiles[fileID];\n      }\n    }); // Remove files from the `fileIDs` list in each upload.\n\n    function fileIsNotRemoved(uploadFileID) {\n      return removedFiles[uploadFileID] === undefined;\n    }\n\n    var uploadsToRemove = [];\n    Object.keys(updatedUploads).forEach(function (uploadID) {\n      var newFileIDs = currentUploads[uploadID].fileIDs.filter(fileIsNotRemoved); // Remove the upload if no files are associated with it anymore.\n\n      if (newFileIDs.length === 0) {\n        uploadsToRemove.push(uploadID);\n        return;\n      }\n\n      updatedUploads[uploadID] = _extends({}, currentUploads[uploadID], {\n        fileIDs: newFileIDs\n      });\n    });\n    uploadsToRemove.forEach(function (uploadID) {\n      delete updatedUploads[uploadID];\n    });\n    var stateUpdate = {\n      currentUploads: updatedUploads,\n      files: updatedFiles\n    }; // If all files were removed - allow new uploads!\n\n    if (Object.keys(updatedFiles).length === 0) {\n      stateUpdate.allowNewUpload = true;\n      stateUpdate.error = null;\n    }\n\n    this.setState(stateUpdate);\n\n    this._calculateTotalProgress();\n\n    var removedFileIDs = Object.keys(removedFiles);\n    removedFileIDs.forEach(function (fileID) {\n      _this5.emit('file-removed', removedFiles[fileID]);\n    });\n\n    if (removedFileIDs.length > 5) {\n      this.log(\"Removed \" + removedFileIDs.length + \" files\");\n    } else {\n      this.log(\"Removed files: \" + removedFileIDs.join(', '));\n    }\n  };\n\n  _proto.removeFile = function removeFile(fileID) {\n    this.removeFiles([fileID]);\n  };\n\n  _proto.pauseResume = function pauseResume(fileID) {\n    if (!this.getState().capabilities.resumableUploads || this.getFile(fileID).uploadComplete) {\n      return;\n    }\n\n    var wasPaused = this.getFile(fileID).isPaused || false;\n    var isPaused = !wasPaused;\n    this.setFileState(fileID, {\n      isPaused: isPaused\n    });\n    this.emit('upload-pause', fileID, isPaused);\n    return isPaused;\n  };\n\n  _proto.pauseAll = function pauseAll() {\n    var updatedFiles = _extends({}, this.getState().files);\n\n    var inProgressUpdatedFiles = Object.keys(updatedFiles).filter(function (file) {\n      return !updatedFiles[file].progress.uploadComplete && updatedFiles[file].progress.uploadStarted;\n    });\n    inProgressUpdatedFiles.forEach(function (file) {\n      var updatedFile = _extends({}, updatedFiles[file], {\n        isPaused: true\n      });\n\n      updatedFiles[file] = updatedFile;\n    });\n    this.setState({\n      files: updatedFiles\n    });\n    this.emit('pause-all');\n  };\n\n  _proto.resumeAll = function resumeAll() {\n    var updatedFiles = _extends({}, this.getState().files);\n\n    var inProgressUpdatedFiles = Object.keys(updatedFiles).filter(function (file) {\n      return !updatedFiles[file].progress.uploadComplete && updatedFiles[file].progress.uploadStarted;\n    });\n    inProgressUpdatedFiles.forEach(function (file) {\n      var updatedFile = _extends({}, updatedFiles[file], {\n        isPaused: false,\n        error: null\n      });\n\n      updatedFiles[file] = updatedFile;\n    });\n    this.setState({\n      files: updatedFiles\n    });\n    this.emit('resume-all');\n  };\n\n  _proto.retryAll = function retryAll() {\n    var updatedFiles = _extends({}, this.getState().files);\n\n    var filesToRetry = Object.keys(updatedFiles).filter(function (file) {\n      return updatedFiles[file].error;\n    });\n    filesToRetry.forEach(function (file) {\n      var updatedFile = _extends({}, updatedFiles[file], {\n        isPaused: false,\n        error: null\n      });\n\n      updatedFiles[file] = updatedFile;\n    });\n    this.setState({\n      files: updatedFiles,\n      error: null\n    });\n    this.emit('retry-all', filesToRetry);\n\n    var uploadID = this._createUpload(filesToRetry, {\n      forceAllowNewUpload: true // create new upload even if allowNewUpload: false\n\n    });\n\n    return this._runUpload(uploadID);\n  };\n\n  _proto.cancelAll = function cancelAll() {\n    this.emit('cancel-all');\n\n    var _this$getState5 = this.getState(),\n        files = _this$getState5.files;\n\n    var fileIDs = Object.keys(files);\n\n    if (fileIDs.length) {\n      this.removeFiles(fileIDs);\n    }\n\n    this.setState({\n      totalProgress: 0,\n      error: null\n    });\n  };\n\n  _proto.retryUpload = function retryUpload(fileID) {\n    this.setFileState(fileID, {\n      error: null,\n      isPaused: false\n    });\n    this.emit('upload-retry', fileID);\n\n    var uploadID = this._createUpload([fileID], {\n      forceAllowNewUpload: true // create new upload even if allowNewUpload: false\n\n    });\n\n    return this._runUpload(uploadID);\n  };\n\n  _proto.reset = function reset() {\n    this.cancelAll();\n  };\n\n  _proto._calculateProgress = function _calculateProgress(file, data) {\n    if (!this.getFile(file.id)) {\n      this.log(\"Not setting progress for a file that has been removed: \" + file.id);\n      return;\n    } // bytesTotal may be null or zero; in that case we can't divide by it\n\n\n    var canHavePercentage = isFinite(data.bytesTotal) && data.bytesTotal > 0;\n    this.setFileState(file.id, {\n      progress: _extends({}, this.getFile(file.id).progress, {\n        bytesUploaded: data.bytesUploaded,\n        bytesTotal: data.bytesTotal,\n        percentage: canHavePercentage // TODO(goto-bus-stop) flooring this should probably be the choice of the UI?\n        // we get more accurate calculations if we don't round this at all.\n        ? Math.round(data.bytesUploaded / data.bytesTotal * 100) : 0\n      })\n    });\n\n    this._calculateTotalProgress();\n  };\n\n  _proto._calculateTotalProgress = function _calculateTotalProgress() {\n    // calculate total progress, using the number of files currently uploading,\n    // multiplied by 100 and the summ of individual progress of each file\n    var files = this.getFiles();\n    var inProgress = files.filter(function (file) {\n      return file.progress.uploadStarted || file.progress.preprocess || file.progress.postprocess;\n    });\n\n    if (inProgress.length === 0) {\n      this.emit('progress', 0);\n      this.setState({\n        totalProgress: 0\n      });\n      return;\n    }\n\n    var sizedFiles = inProgress.filter(function (file) {\n      return file.progress.bytesTotal != null;\n    });\n    var unsizedFiles = inProgress.filter(function (file) {\n      return file.progress.bytesTotal == null;\n    });\n\n    if (sizedFiles.length === 0) {\n      var progressMax = inProgress.length * 100;\n      var currentProgress = unsizedFiles.reduce(function (acc, file) {\n        return acc + file.progress.percentage;\n      }, 0);\n\n      var _totalProgress = Math.round(currentProgress / progressMax * 100);\n\n      this.setState({\n        totalProgress: _totalProgress\n      });\n      return;\n    }\n\n    var totalSize = sizedFiles.reduce(function (acc, file) {\n      return acc + file.progress.bytesTotal;\n    }, 0);\n    var averageSize = totalSize / sizedFiles.length;\n    totalSize += averageSize * unsizedFiles.length;\n    var uploadedSize = 0;\n    sizedFiles.forEach(function (file) {\n      uploadedSize += file.progress.bytesUploaded;\n    });\n    unsizedFiles.forEach(function (file) {\n      uploadedSize += averageSize * (file.progress.percentage || 0) / 100;\n    });\n    var totalProgress = totalSize === 0 ? 0 : Math.round(uploadedSize / totalSize * 100); // hot fix, because:\n    // uploadedSize ended up larger than totalSize, resulting in 1325% total\n\n    if (totalProgress > 100) {\n      totalProgress = 100;\n    }\n\n    this.setState({\n      totalProgress: totalProgress\n    });\n    this.emit('progress', totalProgress);\n  }\n  /**\n   * Registers listeners for all global actions, like:\n   * `error`, `file-removed`, `upload-progress`\n   */\n  ;\n\n  _proto._addListeners = function _addListeners() {\n    var _this6 = this;\n\n    this.on('error', function (error) {\n      var errorMsg = 'Unknown error';\n\n      if (error.message) {\n        errorMsg = error.message;\n      }\n\n      if (error.details) {\n        errorMsg += ' ' + error.details;\n      }\n\n      _this6.setState({\n        error: errorMsg\n      });\n    });\n    this.on('upload-error', function (file, error, response) {\n      var errorMsg = 'Unknown error';\n\n      if (error.message) {\n        errorMsg = error.message;\n      }\n\n      if (error.details) {\n        errorMsg += ' ' + error.details;\n      }\n\n      _this6.setFileState(file.id, {\n        error: errorMsg,\n        response: response\n      });\n\n      _this6.setState({\n        error: error.message\n      });\n\n      if (typeof error === 'object' && error.message) {\n        var newError = new Error(error.message);\n        newError.details = error.message;\n\n        if (error.details) {\n          newError.details += ' ' + error.details;\n        }\n\n        newError.message = _this6.i18n('failedToUpload', {\n          file: file.name\n        });\n\n        _this6._showOrLogErrorAndThrow(newError, {\n          throwErr: false\n        });\n      } else {\n        _this6._showOrLogErrorAndThrow(error, {\n          throwErr: false\n        });\n      }\n    });\n    this.on('upload', function () {\n      _this6.setState({\n        error: null\n      });\n    });\n    this.on('upload-started', function (file, upload) {\n      if (!_this6.getFile(file.id)) {\n        _this6.log(\"Not setting progress for a file that has been removed: \" + file.id);\n\n        return;\n      }\n\n      _this6.setFileState(file.id, {\n        progress: {\n          uploadStarted: Date.now(),\n          uploadComplete: false,\n          percentage: 0,\n          bytesUploaded: 0,\n          bytesTotal: file.size\n        }\n      });\n    });\n    this.on('upload-progress', this._calculateProgress);\n    this.on('upload-success', function (file, uploadResp) {\n      if (!_this6.getFile(file.id)) {\n        _this6.log(\"Not setting progress for a file that has been removed: \" + file.id);\n\n        return;\n      }\n\n      var currentProgress = _this6.getFile(file.id).progress;\n\n      _this6.setFileState(file.id, {\n        progress: _extends({}, currentProgress, {\n          uploadComplete: true,\n          percentage: 100,\n          bytesUploaded: currentProgress.bytesTotal\n        }),\n        response: uploadResp,\n        uploadURL: uploadResp.uploadURL,\n        isPaused: false\n      });\n\n      _this6._calculateTotalProgress();\n    });\n    this.on('preprocess-progress', function (file, progress) {\n      if (!_this6.getFile(file.id)) {\n        _this6.log(\"Not setting progress for a file that has been removed: \" + file.id);\n\n        return;\n      }\n\n      _this6.setFileState(file.id, {\n        progress: _extends({}, _this6.getFile(file.id).progress, {\n          preprocess: progress\n        })\n      });\n    });\n    this.on('preprocess-complete', function (file) {\n      if (!_this6.getFile(file.id)) {\n        _this6.log(\"Not setting progress for a file that has been removed: \" + file.id);\n\n        return;\n      }\n\n      var files = _extends({}, _this6.getState().files);\n\n      files[file.id] = _extends({}, files[file.id], {\n        progress: _extends({}, files[file.id].progress)\n      });\n      delete files[file.id].progress.preprocess;\n\n      _this6.setState({\n        files: files\n      });\n    });\n    this.on('postprocess-progress', function (file, progress) {\n      if (!_this6.getFile(file.id)) {\n        _this6.log(\"Not setting progress for a file that has been removed: \" + file.id);\n\n        return;\n      }\n\n      _this6.setFileState(file.id, {\n        progress: _extends({}, _this6.getState().files[file.id].progress, {\n          postprocess: progress\n        })\n      });\n    });\n    this.on('postprocess-complete', function (file) {\n      if (!_this6.getFile(file.id)) {\n        _this6.log(\"Not setting progress for a file that has been removed: \" + file.id);\n\n        return;\n      }\n\n      var files = _extends({}, _this6.getState().files);\n\n      files[file.id] = _extends({}, files[file.id], {\n        progress: _extends({}, files[file.id].progress)\n      });\n      delete files[file.id].progress.postprocess; // TODO should we set some kind of `fullyComplete` property on the file object\n      // so it's easier to see that the file is uploadfully completerather than\n      // what we have to do now (`uploadComplete && !postprocess`)\n\n      _this6.setState({\n        files: files\n      });\n    });\n    this.on('restored', function () {\n      // Files may have changed--ensure progress is still accurate.\n      _this6._calculateTotalProgress();\n    }); // show informer if offline\n\n    if (typeof window !== 'undefined' && window.addEventListener) {\n      window.addEventListener('online', function () {\n        return _this6.updateOnlineStatus();\n      });\n      window.addEventListener('offline', function () {\n        return _this6.updateOnlineStatus();\n      });\n      setTimeout(function () {\n        return _this6.updateOnlineStatus();\n      }, 3000);\n    }\n  };\n\n  _proto.updateOnlineStatus = function updateOnlineStatus() {\n    var online = typeof window.navigator.onLine !== 'undefined' ? window.navigator.onLine : true;\n\n    if (!online) {\n      this.emit('is-offline');\n      this.info(this.i18n('noInternetConnection'), 'error', 0);\n      this.wasOffline = true;\n    } else {\n      this.emit('is-online');\n\n      if (this.wasOffline) {\n        this.emit('back-online');\n        this.info(this.i18n('connectedToInternet'), 'success', 3000);\n        this.wasOffline = false;\n      }\n    }\n  };\n\n  _proto.getID = function getID() {\n    return this.opts.id;\n  }\n  /**\n   * Registers a plugin with Core.\n   *\n   * @param {object} Plugin object\n   * @param {object} [opts] object with options to be passed to Plugin\n   * @returns {object} self for chaining\n   */\n  ;\n\n  _proto.use = function use(Plugin, opts) {\n    if (typeof Plugin !== 'function') {\n      var msg = \"Expected a plugin class, but got \" + (Plugin === null ? 'null' : typeof Plugin) + \".\" + ' Please verify that the plugin was imported and spelled correctly.';\n      throw new TypeError(msg);\n    } // Instantiate\n\n\n    var plugin = new Plugin(this, opts);\n    var pluginId = plugin.id;\n    this.plugins[plugin.type] = this.plugins[plugin.type] || [];\n\n    if (!pluginId) {\n      throw new Error('Your plugin must have an id');\n    }\n\n    if (!plugin.type) {\n      throw new Error('Your plugin must have a type');\n    }\n\n    var existsPluginAlready = this.getPlugin(pluginId);\n\n    if (existsPluginAlready) {\n      var _msg = \"Already found a plugin named '\" + existsPluginAlready.id + \"'. \" + (\"Tried to use: '\" + pluginId + \"'.\\n\") + 'Uppy plugins must have unique `id` options. See https://uppy.io/docs/plugins/#id.';\n\n      throw new Error(_msg);\n    }\n\n    if (Plugin.VERSION) {\n      this.log(\"Using \" + pluginId + \" v\" + Plugin.VERSION);\n    }\n\n    this.plugins[plugin.type].push(plugin);\n    plugin.install();\n    return this;\n  }\n  /**\n   * Find one Plugin by name.\n   *\n   * @param {string} id plugin id\n   * @returns {object|boolean}\n   */\n  ;\n\n  _proto.getPlugin = function getPlugin(id) {\n    var foundPlugin = null;\n    this.iteratePlugins(function (plugin) {\n      if (plugin.id === id) {\n        foundPlugin = plugin;\n        return false;\n      }\n    });\n    return foundPlugin;\n  }\n  /**\n   * Iterate through all `use`d plugins.\n   *\n   * @param {Function} method that will be run on each plugin\n   */\n  ;\n\n  _proto.iteratePlugins = function iteratePlugins(method) {\n    var _this7 = this;\n\n    Object.keys(this.plugins).forEach(function (pluginType) {\n      _this7.plugins[pluginType].forEach(method);\n    });\n  }\n  /**\n   * Uninstall and remove a plugin.\n   *\n   * @param {object} instance The plugin instance to remove.\n   */\n  ;\n\n  _proto.removePlugin = function removePlugin(instance) {\n    this.log(\"Removing plugin \" + instance.id);\n    this.emit('plugin-remove', instance);\n\n    if (instance.uninstall) {\n      instance.uninstall();\n    }\n\n    var list = this.plugins[instance.type].slice();\n    var index = list.indexOf(instance);\n\n    if (index !== -1) {\n      list.splice(index, 1);\n      this.plugins[instance.type] = list;\n    }\n\n    var updatedState = this.getState();\n    delete updatedState.plugins[instance.id];\n    this.setState(updatedState);\n  }\n  /**\n   * Uninstall all plugins and close down this Uppy instance.\n   */\n  ;\n\n  _proto.close = function close() {\n    var _this8 = this;\n\n    this.log(\"Closing Uppy instance \" + this.opts.id + \": removing all files and uninstalling plugins\");\n    this.reset();\n\n    this._storeUnsubscribe();\n\n    this.iteratePlugins(function (plugin) {\n      _this8.removePlugin(plugin);\n    });\n  }\n  /**\n   * Set info message in `state.info`, so that UI plugins like `Informer`\n   * can display the message.\n   *\n   * @param {string | object} message Message to be displayed by the informer\n   * @param {string} [type]\n   * @param {number} [duration]\n   */\n  ;\n\n  _proto.info = function info(message, type, duration) {\n    if (type === void 0) {\n      type = 'info';\n    }\n\n    if (duration === void 0) {\n      duration = 3000;\n    }\n\n    var isComplexMessage = typeof message === 'object';\n    this.setState({\n      info: {\n        isHidden: false,\n        type: type,\n        message: isComplexMessage ? message.message : message,\n        details: isComplexMessage ? message.details : null\n      }\n    });\n    this.emit('info-visible');\n    clearTimeout(this.infoTimeoutID);\n\n    if (duration === 0) {\n      this.infoTimeoutID = undefined;\n      return;\n    } // hide the informer after `duration` milliseconds\n\n\n    this.infoTimeoutID = setTimeout(this.hideInfo, duration);\n  };\n\n  _proto.hideInfo = function hideInfo() {\n    var newInfo = _extends({}, this.getState().info, {\n      isHidden: true\n    });\n\n    this.setState({\n      info: newInfo\n    });\n    this.emit('info-hidden');\n  }\n  /**\n   * Passes messages to a function, provided in `opts.logger`.\n   * If `opts.logger: Uppy.debugLogger` or `opts.debug: true`, logs to the browser console.\n   *\n   * @param {string|object} message to log\n   * @param {string} [type] optional `error` or `warning`\n   */\n  ;\n\n  _proto.log = function log(message, type) {\n    var logger = this.opts.logger;\n\n    switch (type) {\n      case 'error':\n        logger.error(message);\n        break;\n\n      case 'warning':\n        logger.warn(message);\n        break;\n\n      default:\n        logger.debug(message);\n        break;\n    }\n  }\n  /**\n   * Obsolete, event listeners are now added in the constructor.\n   */\n  ;\n\n  _proto.run = function run() {\n    this.log('Calling run() is no longer necessary.', 'warning');\n    return this;\n  }\n  /**\n   * Restore an upload by its ID.\n   */\n  ;\n\n  _proto.restore = function restore(uploadID) {\n    this.log(\"Core: attempting to restore upload \\\"\" + uploadID + \"\\\"\");\n\n    if (!this.getState().currentUploads[uploadID]) {\n      this._removeUpload(uploadID);\n\n      return Promise.reject(new Error('Nonexistent upload'));\n    }\n\n    return this._runUpload(uploadID);\n  }\n  /**\n   * Create an upload for a bunch of files.\n   *\n   * @param {Array<string>} fileIDs File IDs to include in this upload.\n   * @returns {string} ID of this upload.\n   */\n  ;\n\n  _proto._createUpload = function _createUpload(fileIDs, opts) {\n    var _extends4;\n\n    if (opts === void 0) {\n      opts = {};\n    }\n\n    var _opts = opts,\n        _opts$forceAllowNewUp = _opts.forceAllowNewUpload,\n        forceAllowNewUpload = _opts$forceAllowNewUp === void 0 ? false : _opts$forceAllowNewUp;\n\n    var _this$getState6 = this.getState(),\n        allowNewUpload = _this$getState6.allowNewUpload,\n        currentUploads = _this$getState6.currentUploads;\n\n    if (!allowNewUpload && !forceAllowNewUpload) {\n      throw new Error('Cannot create a new upload: already uploading.');\n    }\n\n    var uploadID = cuid();\n    this.emit('upload', {\n      id: uploadID,\n      fileIDs: fileIDs\n    });\n    this.setState({\n      allowNewUpload: this.opts.allowMultipleUploads !== false,\n      currentUploads: _extends({}, currentUploads, (_extends4 = {}, _extends4[uploadID] = {\n        fileIDs: fileIDs,\n        step: 0,\n        result: {}\n      }, _extends4))\n    });\n    return uploadID;\n  };\n\n  _proto._getUpload = function _getUpload(uploadID) {\n    var _this$getState7 = this.getState(),\n        currentUploads = _this$getState7.currentUploads;\n\n    return currentUploads[uploadID];\n  }\n  /**\n   * Add data to an upload's result object.\n   *\n   * @param {string} uploadID The ID of the upload.\n   * @param {object} data Data properties to add to the result object.\n   */\n  ;\n\n  _proto.addResultData = function addResultData(uploadID, data) {\n    var _extends5;\n\n    if (!this._getUpload(uploadID)) {\n      this.log(\"Not setting result for an upload that has been removed: \" + uploadID);\n      return;\n    }\n\n    var currentUploads = this.getState().currentUploads;\n\n    var currentUpload = _extends({}, currentUploads[uploadID], {\n      result: _extends({}, currentUploads[uploadID].result, data)\n    });\n\n    this.setState({\n      currentUploads: _extends({}, currentUploads, (_extends5 = {}, _extends5[uploadID] = currentUpload, _extends5))\n    });\n  }\n  /**\n   * Remove an upload, eg. if it has been canceled or completed.\n   *\n   * @param {string} uploadID The ID of the upload.\n   */\n  ;\n\n  _proto._removeUpload = function _removeUpload(uploadID) {\n    var currentUploads = _extends({}, this.getState().currentUploads);\n\n    delete currentUploads[uploadID];\n    this.setState({\n      currentUploads: currentUploads\n    });\n  }\n  /**\n   * Run an upload. This picks up where it left off in case the upload is being restored.\n   *\n   * @private\n   */\n  ;\n\n  _proto._runUpload = function _runUpload(uploadID) {\n    var _this9 = this;\n\n    var uploadData = this.getState().currentUploads[uploadID];\n    var restoreStep = uploadData.step;\n    var steps = [].concat(this.preProcessors, this.uploaders, this.postProcessors);\n    var lastStep = Promise.resolve();\n    steps.forEach(function (fn, step) {\n      // Skip this step if we are restoring and have already completed this step before.\n      if (step < restoreStep) {\n        return;\n      }\n\n      lastStep = lastStep.then(function () {\n        var _extends6;\n\n        var _this9$getState = _this9.getState(),\n            currentUploads = _this9$getState.currentUploads;\n\n        var currentUpload = currentUploads[uploadID];\n\n        if (!currentUpload) {\n          return;\n        }\n\n        var updatedUpload = _extends({}, currentUpload, {\n          step: step\n        });\n\n        _this9.setState({\n          currentUploads: _extends({}, currentUploads, (_extends6 = {}, _extends6[uploadID] = updatedUpload, _extends6))\n        }); // TODO give this the `updatedUpload` object as its only parameter maybe?\n        // Otherwise when more metadata may be added to the upload this would keep getting more parameters\n\n\n        return fn(updatedUpload.fileIDs, uploadID);\n      }).then(function (result) {\n        return null;\n      });\n    }); // Not returning the `catch`ed promise, because we still want to return a rejected\n    // promise from this method if the upload failed.\n\n    lastStep.catch(function (err) {\n      _this9.emit('error', err, uploadID);\n\n      _this9._removeUpload(uploadID);\n    });\n    return lastStep.then(function () {\n      // Set result data.\n      var _this9$getState2 = _this9.getState(),\n          currentUploads = _this9$getState2.currentUploads;\n\n      var currentUpload = currentUploads[uploadID];\n\n      if (!currentUpload) {\n        return;\n      }\n\n      var files = currentUpload.fileIDs.map(function (fileID) {\n        return _this9.getFile(fileID);\n      });\n      var successful = files.filter(function (file) {\n        return !file.error;\n      });\n      var failed = files.filter(function (file) {\n        return file.error;\n      });\n\n      _this9.addResultData(uploadID, {\n        successful: successful,\n        failed: failed,\n        uploadID: uploadID\n      });\n    }).then(function () {\n      // Emit completion events.\n      // This is in a separate function so that the `currentUploads` variable\n      // always refers to the latest state. In the handler right above it refers\n      // to an outdated object without the `.result` property.\n      var _this9$getState3 = _this9.getState(),\n          currentUploads = _this9$getState3.currentUploads;\n\n      if (!currentUploads[uploadID]) {\n        return;\n      }\n\n      var currentUpload = currentUploads[uploadID];\n      var result = currentUpload.result;\n\n      _this9.emit('complete', result);\n\n      _this9._removeUpload(uploadID);\n\n      return result;\n    }).then(function (result) {\n      if (result == null) {\n        _this9.log(\"Not setting result for an upload that has been removed: \" + uploadID);\n      }\n\n      return result;\n    });\n  }\n  /**\n   * Start an upload for all the files that are not currently being uploaded.\n   *\n   * @returns {Promise}\n   */\n  ;\n\n  _proto.upload = function upload() {\n    var _this10 = this;\n\n    if (!this.plugins.uploader) {\n      this.log('No uploader type plugins are used', 'warning');\n    }\n\n    var files = this.getState().files;\n    var onBeforeUploadResult = this.opts.onBeforeUpload(files);\n\n    if (onBeforeUploadResult === false) {\n      return Promise.reject(new Error('Not starting the upload because onBeforeUpload returned false'));\n    }\n\n    if (onBeforeUploadResult && typeof onBeforeUploadResult === 'object') {\n      files = onBeforeUploadResult; // Updating files in state, because uploader plugins receive file IDs,\n      // and then fetch the actual file object from state\n\n      this.setState({\n        files: files\n      });\n    }\n\n    return Promise.resolve().then(function () {\n      return _this10._checkMinNumberOfFiles(files);\n    }).catch(function (err) {\n      _this10._showOrLogErrorAndThrow(err);\n    }).then(function () {\n      var _this10$getState = _this10.getState(),\n          currentUploads = _this10$getState.currentUploads; // get a list of files that are currently assigned to uploads\n\n\n      var currentlyUploadingFiles = Object.keys(currentUploads).reduce(function (prev, curr) {\n        return prev.concat(currentUploads[curr].fileIDs);\n      }, []);\n      var waitingFileIDs = [];\n      Object.keys(files).forEach(function (fileID) {\n        var file = _this10.getFile(fileID); // if the file hasn't started uploading and hasn't already been assigned to an upload..\n\n\n        if (!file.progress.uploadStarted && currentlyUploadingFiles.indexOf(fileID) === -1) {\n          waitingFileIDs.push(file.id);\n        }\n      });\n\n      var uploadID = _this10._createUpload(waitingFileIDs);\n\n      return _this10._runUpload(uploadID);\n    }).catch(function (err) {\n      _this10._showOrLogErrorAndThrow(err, {\n        showInformer: false\n      });\n    });\n  };\n\n  _createClass(Uppy, [{\n    key: \"state\",\n    get: function get() {\n      return this.getState();\n    }\n  }]);\n\n  return Uppy;\n}();\n\nUppy.VERSION = \"1.11.0\";\n\nmodule.exports = function (opts) {\n  return new Uppy(opts);\n}; // Expose class constructor.\n\n\nmodule.exports.Uppy = Uppy;\nmodule.exports.Plugin = Plugin;\nmodule.exports.debugLogger = debugLogger;","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nvar has = require('./hasProperty');\n/**\n * Translates strings with interpolation & pluralization support.\n * Extensible with custom dictionaries and pluralization functions.\n *\n * Borrows heavily from and inspired by Polyglot https://github.com/airbnb/polyglot.js,\n * basically a stripped-down version of it. Differences: pluralization functions are not hardcoded\n * and can be easily added among with dictionaries, nested objects are used for pluralization\n * as opposed to `||||` delimeter\n *\n * Usage example: `translator.translate('files_chosen', {smart_count: 3})`\n */\n\n\nmodule.exports = /*#__PURE__*/function () {\n  /**\n   * @param {object|Array<object>} locales - locale or list of locales.\n   */\n  function Translator(locales) {\n    var _this = this;\n\n    this.locale = {\n      strings: {},\n      pluralize: function pluralize(n) {\n        if (n === 1) {\n          return 0;\n        }\n\n        return 1;\n      }\n    };\n\n    if (Array.isArray(locales)) {\n      locales.forEach(function (locale) {\n        return _this._apply(locale);\n      });\n    } else {\n      this._apply(locales);\n    }\n  }\n\n  var _proto = Translator.prototype;\n\n  _proto._apply = function _apply(locale) {\n    if (!locale || !locale.strings) {\n      return;\n    }\n\n    var prevLocale = this.locale;\n    this.locale = _extends({}, prevLocale, {\n      strings: _extends({}, prevLocale.strings, locale.strings)\n    });\n    this.locale.pluralize = locale.pluralize || prevLocale.pluralize;\n  }\n  /**\n   * Takes a string with placeholder variables like `%{smart_count} file selected`\n   * and replaces it with values from options `{smart_count: 5}`\n   *\n   * @license https://github.com/airbnb/polyglot.js/blob/master/LICENSE\n   * taken from https://github.com/airbnb/polyglot.js/blob/master/lib/polyglot.js#L299\n   *\n   * @param {string} phrase that needs interpolation, with placeholders\n   * @param {object} options with values that will be used to replace placeholders\n   * @returns {string} interpolated\n   */\n  ;\n\n  _proto.interpolate = function interpolate(phrase, options) {\n    var _String$prototype = String.prototype,\n        split = _String$prototype.split,\n        replace = _String$prototype.replace;\n    var dollarRegex = /\\$/g;\n    var dollarBillsYall = '$$$$';\n    var interpolated = [phrase];\n\n    for (var arg in options) {\n      if (arg !== '_' && has(options, arg)) {\n        // Ensure replacement value is escaped to prevent special $-prefixed\n        // regex replace tokens. the \"$$$$\" is needed because each \"$\" needs to\n        // be escaped with \"$\" itself, and we need two in the resulting output.\n        var replacement = options[arg];\n\n        if (typeof replacement === 'string') {\n          replacement = replace.call(options[arg], dollarRegex, dollarBillsYall);\n        } // We create a new `RegExp` each time instead of using a more-efficient\n        // string replace so that the same argument can be replaced multiple times\n        // in the same phrase.\n\n\n        interpolated = insertReplacement(interpolated, new RegExp('%\\\\{' + arg + '\\\\}', 'g'), replacement);\n      }\n    }\n\n    return interpolated;\n\n    function insertReplacement(source, rx, replacement) {\n      var newParts = [];\n      source.forEach(function (chunk) {\n        // When the source contains multiple placeholders for interpolation,\n        // we should ignore chunks that are not strings, because those\n        // can be JSX objects and will be otherwise incorrectly turned into strings.\n        // Without this condition wed get this: [object Object] hello [object Object] my <button>\n        if (typeof chunk !== 'string') {\n          return newParts.push(chunk);\n        }\n\n        split.call(chunk, rx).forEach(function (raw, i, list) {\n          if (raw !== '') {\n            newParts.push(raw);\n          } // Interlace with the `replacement` value\n\n\n          if (i < list.length - 1) {\n            newParts.push(replacement);\n          }\n        });\n      });\n      return newParts;\n    }\n  }\n  /**\n   * Public translate method\n   *\n   * @param {string} key\n   * @param {object} options with values that will be used later to replace placeholders in string\n   * @returns {string} translated (and interpolated)\n   */\n  ;\n\n  _proto.translate = function translate(key, options) {\n    return this.translateArray(key, options).join('');\n  }\n  /**\n   * Get a translation and return the translated and interpolated parts as an array.\n   *\n   * @param {string} key\n   * @param {object} options with values that will be used to replace placeholders\n   * @returns {Array} The translated and interpolated parts, in order.\n   */\n  ;\n\n  _proto.translateArray = function translateArray(key, options) {\n    var string = this.locale.strings[key];\n    var hasPluralForms = typeof string === 'object';\n\n    if (hasPluralForms) {\n      if (options && typeof options.smart_count !== 'undefined') {\n        var plural = this.locale.pluralize(options.smart_count);\n        return this.interpolate(string[plural], options);\n      } else {\n        throw new Error('Attempted to use a string with plural forms, but no value was given for %{smart_count}');\n      }\n    }\n\n    return this.interpolate(string, options);\n  };\n\n  return Translator;\n}();","module.exports = function has(object, key) {\n  return Object.prototype.hasOwnProperty.call(object, key);\n};","/**\n * cuid.js\n * Collision-resistant UID generator for browsers and node.\n * Sequential for fast db lookups and recency sorting.\n * Safe for element IDs and server-side lookups.\n *\n * Extracted from CLCTR\n *\n * Copyright (c) Eric Elliott 2012\n * MIT License\n */\n\nvar fingerprint = require('./lib/fingerprint.js');\nvar pad = require('./lib/pad.js');\nvar getRandomValue = require('./lib/getRandomValue.js');\n\nvar c = 0,\n  blockSize = 4,\n  base = 36,\n  discreteValues = Math.pow(base, blockSize);\n\nfunction randomBlock () {\n  return pad((getRandomValue() *\n    discreteValues << 0)\n    .toString(base), blockSize);\n}\n\nfunction safeCounter () {\n  c = c < discreteValues ? c : 0;\n  c++; // this is not subliminal\n  return c - 1;\n}\n\nfunction cuid () {\n  // Starting with a lowercase letter makes\n  // it HTML element ID friendly.\n  var letter = 'c', // hard-coded allows for sequential access\n\n    // timestamp\n    // warning: this exposes the exact date and time\n    // that the uid was created.\n    timestamp = (new Date().getTime()).toString(base),\n\n    // Prevent same-machine collisions.\n    counter = pad(safeCounter().toString(base), blockSize),\n\n    // A few chars to generate distinct ids for different\n    // clients (so different computers are far less\n    // likely to generate the same id)\n    print = fingerprint(),\n\n    // Grab some more chars from Math.random()\n    random = randomBlock() + randomBlock();\n\n  return letter + timestamp + counter + print + random;\n}\n\ncuid.slug = function slug () {\n  var date = new Date().getTime().toString(36),\n    counter = safeCounter().toString(36).slice(-4),\n    print = fingerprint().slice(0, 1) +\n      fingerprint().slice(-1),\n    random = randomBlock().slice(-2);\n\n  return date.slice(-2) +\n    counter + print + random;\n};\n\ncuid.isCuid = function isCuid (stringToCheck) {\n  if (typeof stringToCheck !== 'string') return false;\n  if (stringToCheck.startsWith('c')) return true;\n  return false;\n};\n\ncuid.isSlug = function isSlug (stringToCheck) {\n  if (typeof stringToCheck !== 'string') return false;\n  var stringLength = stringToCheck.length;\n  if (stringLength >= 7 && stringLength <= 10) return true;\n  return false;\n};\n\ncuid.fingerprint = fingerprint;\n\nmodule.exports = cuid;\n","var pad = require('./pad.js');\n\nvar env = typeof window === 'object' ? window : self;\nvar globalCount = Object.keys(env).length;\nvar mimeTypesLength = navigator.mimeTypes ? navigator.mimeTypes.length : 0;\nvar clientId = pad((mimeTypesLength +\n  navigator.userAgent.length).toString(36) +\n  globalCount.toString(36), 4);\n\nmodule.exports = function fingerprint () {\n  return clientId;\n};\n","\nvar getRandomValue;\n\nvar crypto = typeof window !== 'undefined' &&\n  (window.crypto || window.msCrypto) ||\n  typeof self !== 'undefined' &&\n  self.crypto;\n\nif (crypto) {\n    var lim = Math.pow(2, 32) - 1;\n    getRandomValue = function () {\n        return Math.abs(crypto.getRandomValues(new Uint32Array(1))[0] / lim);\n    };\n} else {\n    getRandomValue = Math.random;\n}\n\nmodule.exports = getRandomValue;\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = throttle;\n","// Adapted from https://github.com/Flet/prettier-bytes/\n// Changing 1000 bytes to 1024, so we can keep uppercase KB vs kB\n// ISC License (c) Dan Flettre https://github.com/Flet/prettier-bytes/blob/master/LICENSE\nmodule.exports = function prettierBytes (num) {\n  if (typeof num !== 'number' || isNaN(num)) {\n    throw new TypeError('Expected a number, got ' + typeof num)\n  }\n\n  var neg = num < 0\n  var units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB']\n\n  if (neg) {\n    num = -num\n  }\n\n  if (num < 1) {\n    return (neg ? '-' : '') + num + ' B'\n  }\n\n  var exponent = Math.min(Math.floor(Math.log(num) / Math.log(1024)), units.length - 1)\n  num = Number(num / Math.pow(1024, exponent))\n  var unit = units[exponent]\n\n  if (num >= 10 || num % 1 === 0) {\n    // Do not show decimals when the number is two-digit, or if the number has no\n    // decimal component.\n    return (neg ? '-' : '') + num.toFixed(0) + ' ' + unit\n  } else {\n    return (neg ? '-' : '') + num.toFixed(1) + ' ' + unit\n  }\n}\n","var wildcard = require('wildcard');\nvar reMimePartSplit = /[\\/\\+\\.]/;\n\n/**\n  # mime-match\n\n  A simple function to checker whether a target mime type matches a mime-type\n  pattern (e.g. image/jpeg matches image/jpeg OR image/*).\n\n  ## Example Usage\n\n  <<< example.js\n\n**/\nmodule.exports = function(target, pattern) {\n  function test(pattern) {\n    var result = wildcard(pattern, target, reMimePartSplit);\n\n    // ensure that we have a valid mime type (should have two parts)\n    return result && result.length >= 2;\n  }\n\n  return pattern ? test(pattern.split(';')[0]) : test;\n};\n","/* jshint node: true */\n'use strict';\n\n/**\n  # wildcard\n\n  Very simple wildcard matching, which is designed to provide the same\n  functionality that is found in the\n  [eve](https://github.com/adobe-webplatform/eve) eventing library.\n\n  ## Usage\n\n  It works with strings:\n\n  <<< examples/strings.js\n\n  Arrays:\n\n  <<< examples/arrays.js\n\n  Objects (matching against keys):\n\n  <<< examples/objects.js\n\n  While the library works in Node, if you are are looking for file-based\n  wildcard matching then you should have a look at:\n\n  <https://github.com/isaacs/node-glob>\n**/\n\nfunction WildcardMatcher(text, separator) {\n  this.text = text = text || '';\n  this.hasWild = ~text.indexOf('*');\n  this.separator = separator;\n  this.parts = text.split(separator);\n}\n\nWildcardMatcher.prototype.match = function(input) {\n  var matches = true;\n  var parts = this.parts;\n  var ii;\n  var partsCount = parts.length;\n  var testParts;\n\n  if (typeof input == 'string' || input instanceof String) {\n    if (!this.hasWild && this.text != input) {\n      matches = false;\n    } else {\n      testParts = (input || '').split(this.separator);\n      for (ii = 0; matches && ii < partsCount; ii++) {\n        if (parts[ii] === '*')  {\n          continue;\n        } else if (ii < testParts.length) {\n          matches = parts[ii] === testParts[ii];\n        } else {\n          matches = false;\n        }\n      }\n\n      // If matches, then return the component parts\n      matches = matches && testParts;\n    }\n  }\n  else if (typeof input.splice == 'function') {\n    matches = [];\n\n    for (ii = input.length; ii--; ) {\n      if (this.match(input[ii])) {\n        matches[matches.length] = input[ii];\n      }\n    }\n  }\n  else if (typeof input == 'object') {\n    matches = {};\n\n    for (var key in input) {\n      if (this.match(key)) {\n        matches[key] = input[key];\n      }\n    }\n  }\n\n  return matches;\n};\n\nmodule.exports = function(text, test, separator) {\n  var matcher = new WildcardMatcher(text, separator || /[\\/\\.]/);\n  if (typeof test != 'undefined') {\n    return matcher.match(test);\n  }\n\n  return matcher;\n};\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\n/**\n * Default store that keeps state in a simple object.\n */\nvar DefaultStore =\n/*#__PURE__*/\nfunction () {\n  function DefaultStore() {\n    this.state = {};\n    this.callbacks = [];\n  }\n\n  var _proto = DefaultStore.prototype;\n\n  _proto.getState = function getState() {\n    return this.state;\n  };\n\n  _proto.setState = function setState(patch) {\n    var prevState = _extends({}, this.state);\n\n    var nextState = _extends({}, this.state, patch);\n\n    this.state = nextState;\n\n    this._publish(prevState, nextState, patch);\n  };\n\n  _proto.subscribe = function subscribe(listener) {\n    var _this = this;\n\n    this.callbacks.push(listener);\n    return function () {\n      // Remove the listener.\n      _this.callbacks.splice(_this.callbacks.indexOf(listener), 1);\n    };\n  };\n\n  _proto._publish = function _publish() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    this.callbacks.forEach(function (listener) {\n      listener.apply(void 0, args);\n    });\n  };\n\n  return DefaultStore;\n}();\n\nDefaultStore.VERSION = \"1.2.1\";\n\nmodule.exports = function defaultStore() {\n  return new DefaultStore();\n};","var getFileNameAndExtension = require('./getFileNameAndExtension');\n\nvar mimeTypes = require('./mimeTypes');\n\nmodule.exports = function getFileType(file) {\n  var fileExtension = file.name ? getFileNameAndExtension(file.name).extension : null;\n  fileExtension = fileExtension ? fileExtension.toLowerCase() : null;\n\n  if (file.type) {\n    // if mime type is set in the file object already, use that\n    return file.type;\n  } else if (fileExtension && mimeTypes[fileExtension]) {\n    // else, see if we can map extension to a mime type\n    return mimeTypes[fileExtension];\n  } else {\n    // if all fails, fall back to a generic byte stream type\n    return 'application/octet-stream';\n  }\n};","// ___Why not add the mime-types package?\n//    It's 19.7kB gzipped, and we only need mime types for well-known extensions (for file previews).\n// ___Where to take new extensions from?\n//    https://github.com/jshttp/mime-db/blob/master/db.json\nmodule.exports = {\n  md: 'text/markdown',\n  markdown: 'text/markdown',\n  mp4: 'video/mp4',\n  mp3: 'audio/mp3',\n  svg: 'image/svg+xml',\n  jpg: 'image/jpeg',\n  png: 'image/png',\n  gif: 'image/gif',\n  heic: 'image/heic',\n  heif: 'image/heif',\n  yaml: 'text/yaml',\n  yml: 'text/yaml',\n  csv: 'text/csv',\n  tsv: 'text/tab-separated-values',\n  tab: 'text/tab-separated-values',\n  avi: 'video/x-msvideo',\n  mks: 'video/x-matroska',\n  mkv: 'video/x-matroska',\n  mov: 'video/quicktime',\n  doc: 'application/msword',\n  docm: 'application/vnd.ms-word.document.macroenabled.12',\n  docx: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n  dot: 'application/msword',\n  dotm: 'application/vnd.ms-word.template.macroenabled.12',\n  dotx: 'application/vnd.openxmlformats-officedocument.wordprocessingml.template',\n  xla: 'application/vnd.ms-excel',\n  xlam: 'application/vnd.ms-excel.addin.macroenabled.12',\n  xlc: 'application/vnd.ms-excel',\n  xlf: 'application/x-xliff+xml',\n  xlm: 'application/vnd.ms-excel',\n  xls: 'application/vnd.ms-excel',\n  xlsb: 'application/vnd.ms-excel.sheet.binary.macroenabled.12',\n  xlsm: 'application/vnd.ms-excel.sheet.macroenabled.12',\n  xlsx: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n  xlt: 'application/vnd.ms-excel',\n  xltm: 'application/vnd.ms-excel.template.macroenabled.12',\n  xltx: 'application/vnd.openxmlformats-officedocument.spreadsheetml.template',\n  xlw: 'application/vnd.ms-excel',\n  txt: 'text/plain',\n  text: 'text/plain',\n  conf: 'text/plain',\n  log: 'text/plain',\n  pdf: 'application/pdf'\n};","/**\n * Takes a file object and turns it into fileID, by converting file.name to lowercase,\n * removing extra characters and adding type, size and lastModified\n *\n * @param {object} file\n * @returns {string} the fileID\n */\nmodule.exports = function generateFileID(file) {\n  // It's tempting to do `[items].filter(Boolean).join('-')` here, but that\n  // is slower! simple string concatenation is fast\n  var id = 'uppy';\n\n  if (typeof file.name === 'string') {\n    id += '-' + encodeFilename(file.name.toLowerCase());\n  }\n\n  if (file.type !== undefined) {\n    id += '-' + file.type;\n  }\n\n  if (file.meta && typeof file.meta.relativePath === 'string') {\n    id += '-' + encodeFilename(file.meta.relativePath.toLowerCase());\n  }\n\n  if (file.data.size !== undefined) {\n    id += '-' + file.data.size;\n  }\n\n  if (file.data.lastModified !== undefined) {\n    id += '-' + file.data.lastModified;\n  }\n\n  return id;\n};\n\nfunction encodeFilename(name) {\n  var suffix = '';\n  return name.replace(/[^A-Z0-9]/ig, function (character) {\n    suffix += '-' + encodeCharacter(character);\n    return '/';\n  }) + suffix;\n}\n\nfunction encodeCharacter(character) {\n  return character.charCodeAt(0).toString(32);\n}","// Edge 15.x does not fire 'progress' events on uploads.\n// See https://github.com/transloadit/uppy/issues/945\n// And https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/12224510/\nmodule.exports = function supportsUploadProgress(userAgent) {\n  // Allow passing in userAgent for tests\n  if (userAgent == null) {\n    userAgent = typeof navigator !== 'undefined' ? navigator.userAgent : null;\n  } // Assume it works because basically everything supports progress events.\n\n\n  if (!userAgent) return true;\n  var m = /Edge\\/(\\d+\\.\\d+)/.exec(userAgent);\n  if (!m) return true;\n  var edgeVersion = m[1];\n\n  var _edgeVersion$split = edgeVersion.split('.'),\n      major = _edgeVersion$split[0],\n      minor = _edgeVersion$split[1];\n\n  major = parseInt(major, 10);\n  minor = parseInt(minor, 10); // Worked before:\n  // Edge 40.15063.0.0\n  // Microsoft EdgeHTML 15.15063\n\n  if (major < 15 || major === 15 && minor < 15063) {\n    return true;\n  } // Fixed in:\n  // Microsoft EdgeHTML 18.18218\n\n\n  if (major > 18 || major === 18 && minor >= 18218) {\n    return true;\n  } // other versions don't work.\n\n\n  return false;\n};","var getTimeStamp = require('@uppy/utils/lib/getTimeStamp'); // Swallow all logs, except errors.\n// default if logger is not set or debug: false\n\n\nvar justErrorsLogger = {\n  debug: function debug() {},\n  warn: function warn() {},\n  error: function error() {\n    var _console;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return (_console = console).error.apply(_console, [\"[Uppy] [\" + getTimeStamp() + \"]\"].concat(args));\n  }\n}; // Print logs to console with namespace + timestamp,\n// set by logger: Uppy.debugLogger or debug: true\n\nvar debugLogger = {\n  debug: function debug() {\n    // IE 10 doesnt support console.debug\n    var debug = console.debug || console.log;\n\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    debug.call.apply(debug, [console, \"[Uppy] [\" + getTimeStamp() + \"]\"].concat(args));\n  },\n  warn: function warn() {\n    var _console2;\n\n    for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      args[_key3] = arguments[_key3];\n    }\n\n    return (_console2 = console).warn.apply(_console2, [\"[Uppy] [\" + getTimeStamp() + \"]\"].concat(args));\n  },\n  error: function error() {\n    var _console3;\n\n    for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n      args[_key4] = arguments[_key4];\n    }\n\n    return (_console3 = console).error.apply(_console3, [\"[Uppy] [\" + getTimeStamp() + \"]\"].concat(args));\n  }\n};\nmodule.exports = {\n  justErrorsLogger: justErrorsLogger,\n  debugLogger: debugLogger\n};","/**\n * Returns a timestamp in the format of `hours:minutes:seconds`\n */\nmodule.exports = function getTimeStamp() {\n  var date = new Date();\n  var hours = pad(date.getHours().toString());\n  var minutes = pad(date.getMinutes().toString());\n  var seconds = pad(date.getSeconds().toString());\n  return hours + ':' + minutes + ':' + seconds;\n};\n/**\n * Adds zero to strings shorter than two characters\n */\n\n\nfunction pad(str) {\n  return str.length !== 2 ? 0 + str : str;\n}","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nvar preact = require('preact');\n\nvar findDOMElement = require('@uppy/utils/lib/findDOMElement');\n/**\n * Defer a frequent call to the microtask queue.\n */\n\n\nfunction debounce(fn) {\n  var calling = null;\n  var latestArgs = null;\n  return function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    latestArgs = args;\n\n    if (!calling) {\n      calling = Promise.resolve().then(function () {\n        calling = null; // At this point `args` may be different from the most\n        // recent state, if multiple calls happened since this task\n        // was queued. So we use the `latestArgs`, which definitely\n        // is the most recent call.\n\n        return fn.apply(void 0, latestArgs);\n      });\n    }\n\n    return calling;\n  };\n}\n/**\n * Boilerplate that all Plugins share - and should not be used\n * directly. It also shows which methods final plugins should implement/override,\n * this deciding on structure.\n *\n * @param {object} main Uppy core object\n * @param {object} object with plugin options\n * @returns {Array|string} files or success/fail message\n */\n\n\nmodule.exports = /*#__PURE__*/function () {\n  function Plugin(uppy, opts) {\n    this.uppy = uppy;\n    this.opts = opts || {};\n    this.update = this.update.bind(this);\n    this.mount = this.mount.bind(this);\n    this.install = this.install.bind(this);\n    this.uninstall = this.uninstall.bind(this);\n  }\n\n  var _proto = Plugin.prototype;\n\n  _proto.getPluginState = function getPluginState() {\n    var _this$uppy$getState = this.uppy.getState(),\n        plugins = _this$uppy$getState.plugins;\n\n    return plugins[this.id] || {};\n  };\n\n  _proto.setPluginState = function setPluginState(update) {\n    var _extends2;\n\n    var _this$uppy$getState2 = this.uppy.getState(),\n        plugins = _this$uppy$getState2.plugins;\n\n    this.uppy.setState({\n      plugins: _extends({}, plugins, (_extends2 = {}, _extends2[this.id] = _extends({}, plugins[this.id], {}, update), _extends2))\n    });\n  };\n\n  _proto.setOptions = function setOptions(newOpts) {\n    this.opts = _extends({}, this.opts, {}, newOpts);\n    this.setPluginState(); // so that UI re-renders with new options\n  };\n\n  _proto.update = function update(state) {\n    if (typeof this.el === 'undefined') {\n      return;\n    }\n\n    if (this._updateUI) {\n      this._updateUI(state);\n    }\n  } // Called after every state update, after everything's mounted. Debounced.\n  ;\n\n  _proto.afterUpdate = function afterUpdate() {}\n  /**\n   * Called when plugin is mounted, whether in DOM or into another plugin.\n   * Needed because sometimes plugins are mounted separately/after `install`,\n   * so this.el and this.parent might not be available in `install`.\n   * This is the case with @uppy/react plugins, for example.\n   */\n  ;\n\n  _proto.onMount = function onMount() {}\n  /**\n   * Check if supplied `target` is a DOM element or an `object`.\n   * If its an object  target is a plugin, and we search `plugins`\n   * for a plugin with same name and return its target.\n   *\n   * @param {string|object} target\n   *\n   */\n  ;\n\n  _proto.mount = function mount(target, plugin) {\n    var _this = this;\n\n    var callerPluginName = plugin.id;\n    var targetElement = findDOMElement(target);\n\n    if (targetElement) {\n      this.isTargetDOMEl = true; // API for plugins that require a synchronous rerender.\n\n      this.rerender = function (state) {\n        // plugin could be removed, but this.rerender is debounced below,\n        // so it could still be called even after uppy.removePlugin or uppy.close\n        // hence the check\n        if (!_this.uppy.getPlugin(_this.id)) return;\n        _this.el = preact.render(_this.render(state), targetElement, _this.el);\n\n        _this.afterUpdate();\n      };\n\n      this._updateUI = debounce(this.rerender);\n      this.uppy.log(\"Installing \" + callerPluginName + \" to a DOM element '\" + target + \"'\"); // clear everything inside the target container\n\n      if (this.opts.replaceTargetContent) {\n        targetElement.innerHTML = '';\n      }\n\n      this.el = preact.render(this.render(this.uppy.getState()), targetElement);\n      this.onMount();\n      return this.el;\n    }\n\n    var targetPlugin;\n\n    if (typeof target === 'object' && target instanceof Plugin) {\n      // Targeting a plugin *instance*\n      targetPlugin = target;\n    } else if (typeof target === 'function') {\n      // Targeting a plugin type\n      var Target = target; // Find the target plugin instance.\n\n      this.uppy.iteratePlugins(function (plugin) {\n        if (plugin instanceof Target) {\n          targetPlugin = plugin;\n          return false;\n        }\n      });\n    }\n\n    if (targetPlugin) {\n      this.uppy.log(\"Installing \" + callerPluginName + \" to \" + targetPlugin.id);\n      this.parent = targetPlugin;\n      this.el = targetPlugin.addTarget(plugin);\n      this.onMount();\n      return this.el;\n    }\n\n    this.uppy.log(\"Not installing \" + callerPluginName);\n    var message = \"Invalid target option given to \" + callerPluginName + \".\";\n\n    if (typeof target === 'function') {\n      message += ' The given target is not a Plugin class. ' + 'Please check that you\\'re not specifying a React Component instead of a plugin. ' + 'If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: ' + 'run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.';\n    } else {\n      message += 'If you meant to target an HTML element, please make sure that the element exists. ' + 'Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. ' + '(see https://github.com/transloadit/uppy/issues/1042)\\n\\n' + 'If you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.';\n    }\n\n    throw new Error(message);\n  };\n\n  _proto.render = function render(state) {\n    throw new Error('Extend the render method to add your plugin to a DOM element');\n  };\n\n  _proto.addTarget = function addTarget(plugin) {\n    throw new Error('Extend the addTarget method to add your plugin to another plugin\\'s target');\n  };\n\n  _proto.unmount = function unmount() {\n    if (this.isTargetDOMEl && this.el && this.el.parentNode) {\n      this.el.parentNode.removeChild(this.el);\n    }\n  };\n\n  _proto.install = function install() {};\n\n  _proto.uninstall = function uninstall() {\n    this.unmount();\n  };\n\n  return Plugin;\n}();","/** Virtual DOM Node */\nfunction VNode() {}\n\n/** Global options\n *\t@public\n *\t@namespace options {Object}\n */\nvar options = {\n\n\t/** If `true`, `prop` changes trigger synchronous component updates.\n  *\t@name syncComponentUpdates\n  *\t@type Boolean\n  *\t@default true\n  */\n\t//syncComponentUpdates: true,\n\n\t/** Processes all created VNodes.\n  *\t@param {VNode} vnode\tA newly-created VNode to normalize/process\n  */\n\t//vnode(vnode) { }\n\n\t/** Hook invoked after a component is mounted. */\n\t// afterMount(component) { }\n\n\t/** Hook invoked after the DOM is updated with a component's latest render. */\n\t// afterUpdate(component) { }\n\n\t/** Hook invoked immediately before a component is unmounted. */\n\t// beforeUnmount(component) { }\n};\n\nvar stack = [];\n\nvar EMPTY_CHILDREN = [];\n\n/**\n * JSX/hyperscript reviver.\n * @see http://jasonformat.com/wtf-is-jsx\n * Benchmarks: https://esbench.com/bench/57ee8f8e330ab09900a1a1a0\n *\n * Note: this is exported as both `h()` and `createElement()` for compatibility reasons.\n *\n * Creates a VNode (virtual DOM element). A tree of VNodes can be used as a lightweight representation\n * of the structure of a DOM tree. This structure can be realized by recursively comparing it against\n * the current _actual_ DOM structure, and applying only the differences.\n *\n * `h()`/`createElement()` accepts an element name, a list of attributes/props,\n * and optionally children to append to the element.\n *\n * @example The following DOM tree\n *\n * `<div id=\"foo\" name=\"bar\">Hello!</div>`\n *\n * can be constructed using this function as:\n *\n * `h('div', { id: 'foo', name : 'bar' }, 'Hello!');`\n *\n * @param {string} nodeName\tAn element name. Ex: `div`, `a`, `span`, etc.\n * @param {Object} attributes\tAny attributes/props to set on the created element.\n * @param rest\t\t\tAdditional arguments are taken to be children to append. Can be infinitely nested Arrays.\n *\n * @public\n */\nfunction h(nodeName, attributes) {\n\tvar children = EMPTY_CHILDREN,\n\t    lastSimple,\n\t    child,\n\t    simple,\n\t    i;\n\tfor (i = arguments.length; i-- > 2;) {\n\t\tstack.push(arguments[i]);\n\t}\n\tif (attributes && attributes.children != null) {\n\t\tif (!stack.length) stack.push(attributes.children);\n\t\tdelete attributes.children;\n\t}\n\twhile (stack.length) {\n\t\tif ((child = stack.pop()) && child.pop !== undefined) {\n\t\t\tfor (i = child.length; i--;) {\n\t\t\t\tstack.push(child[i]);\n\t\t\t}\n\t\t} else {\n\t\t\tif (typeof child === 'boolean') child = null;\n\n\t\t\tif (simple = typeof nodeName !== 'function') {\n\t\t\t\tif (child == null) child = '';else if (typeof child === 'number') child = String(child);else if (typeof child !== 'string') simple = false;\n\t\t\t}\n\n\t\t\tif (simple && lastSimple) {\n\t\t\t\tchildren[children.length - 1] += child;\n\t\t\t} else if (children === EMPTY_CHILDREN) {\n\t\t\t\tchildren = [child];\n\t\t\t} else {\n\t\t\t\tchildren.push(child);\n\t\t\t}\n\n\t\t\tlastSimple = simple;\n\t\t}\n\t}\n\n\tvar p = new VNode();\n\tp.nodeName = nodeName;\n\tp.children = children;\n\tp.attributes = attributes == null ? undefined : attributes;\n\tp.key = attributes == null ? undefined : attributes.key;\n\n\t// if a \"vnode hook\" is defined, pass every created VNode to it\n\tif (options.vnode !== undefined) options.vnode(p);\n\n\treturn p;\n}\n\n/**\n *  Copy all properties from `props` onto `obj`.\n *  @param {Object} obj\t\tObject onto which properties should be copied.\n *  @param {Object} props\tObject from which to copy properties.\n *  @returns obj\n *  @private\n */\nfunction extend(obj, props) {\n  for (var i in props) {\n    obj[i] = props[i];\n  }return obj;\n}\n\n/**\n * Call a function asynchronously, as soon as possible. Makes\n * use of HTML Promise to schedule the callback if available,\n * otherwise falling back to `setTimeout` (mainly for IE<11).\n *\n * @param {Function} callback\n */\nvar defer = typeof Promise == 'function' ? Promise.resolve().then.bind(Promise.resolve()) : setTimeout;\n\n/**\n * Clones the given VNode, optionally adding attributes/props and replacing its children.\n * @param {VNode} vnode\t\tThe virtual DOM element to clone\n * @param {Object} props\tAttributes/props to add when cloning\n * @param {VNode} rest\t\tAny additional arguments will be used as replacement children.\n */\nfunction cloneElement(vnode, props) {\n  return h(vnode.nodeName, extend(extend({}, vnode.attributes), props), arguments.length > 2 ? [].slice.call(arguments, 2) : vnode.children);\n}\n\n// DOM properties that should NOT have \"px\" added when numeric\nvar IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i;\n\n/** Managed queue of dirty components to be re-rendered */\n\nvar items = [];\n\nfunction enqueueRender(component) {\n\tif (!component._dirty && (component._dirty = true) && items.push(component) == 1) {\n\t\t(options.debounceRendering || defer)(rerender);\n\t}\n}\n\nfunction rerender() {\n\tvar p,\n\t    list = items;\n\titems = [];\n\twhile (p = list.pop()) {\n\t\tif (p._dirty) renderComponent(p);\n\t}\n}\n\n/**\n * Check if two nodes are equivalent.\n *\n * @param {Node} node\t\t\tDOM Node to compare\n * @param {VNode} vnode\t\t\tVirtual DOM node to compare\n * @param {boolean} [hydrating=false]\tIf true, ignores component constructors when comparing.\n * @private\n */\nfunction isSameNodeType(node, vnode, hydrating) {\n  if (typeof vnode === 'string' || typeof vnode === 'number') {\n    return node.splitText !== undefined;\n  }\n  if (typeof vnode.nodeName === 'string') {\n    return !node._componentConstructor && isNamedNode(node, vnode.nodeName);\n  }\n  return hydrating || node._componentConstructor === vnode.nodeName;\n}\n\n/**\n * Check if an Element has a given nodeName, case-insensitively.\n *\n * @param {Element} node\tA DOM Element to inspect the name of.\n * @param {String} nodeName\tUnnormalized name to compare against.\n */\nfunction isNamedNode(node, nodeName) {\n  return node.normalizedNodeName === nodeName || node.nodeName.toLowerCase() === nodeName.toLowerCase();\n}\n\n/**\n * Reconstruct Component-style `props` from a VNode.\n * Ensures default/fallback values from `defaultProps`:\n * Own-properties of `defaultProps` not present in `vnode.attributes` are added.\n *\n * @param {VNode} vnode\n * @returns {Object} props\n */\nfunction getNodeProps(vnode) {\n  var props = extend({}, vnode.attributes);\n  props.children = vnode.children;\n\n  var defaultProps = vnode.nodeName.defaultProps;\n  if (defaultProps !== undefined) {\n    for (var i in defaultProps) {\n      if (props[i] === undefined) {\n        props[i] = defaultProps[i];\n      }\n    }\n  }\n\n  return props;\n}\n\n/** Create an element with the given nodeName.\n *\t@param {String} nodeName\n *\t@param {Boolean} [isSvg=false]\tIf `true`, creates an element within the SVG namespace.\n *\t@returns {Element} node\n */\nfunction createNode(nodeName, isSvg) {\n\tvar node = isSvg ? document.createElementNS('http://www.w3.org/2000/svg', nodeName) : document.createElement(nodeName);\n\tnode.normalizedNodeName = nodeName;\n\treturn node;\n}\n\n/** Remove a child node from its parent if attached.\n *\t@param {Element} node\t\tThe node to remove\n */\nfunction removeNode(node) {\n\tvar parentNode = node.parentNode;\n\tif (parentNode) parentNode.removeChild(node);\n}\n\n/** Set a named attribute on the given Node, with special behavior for some names and event handlers.\n *\tIf `value` is `null`, the attribute/handler will be removed.\n *\t@param {Element} node\tAn element to mutate\n *\t@param {string} name\tThe name/key to set, such as an event or attribute name\n *\t@param {any} old\tThe last value that was set for this name/node pair\n *\t@param {any} value\tAn attribute value, such as a function to be used as an event handler\n *\t@param {Boolean} isSvg\tAre we currently diffing inside an svg?\n *\t@private\n */\nfunction setAccessor(node, name, old, value, isSvg) {\n\tif (name === 'className') name = 'class';\n\n\tif (name === 'key') {\n\t\t// ignore\n\t} else if (name === 'ref') {\n\t\tif (old) old(null);\n\t\tif (value) value(node);\n\t} else if (name === 'class' && !isSvg) {\n\t\tnode.className = value || '';\n\t} else if (name === 'style') {\n\t\tif (!value || typeof value === 'string' || typeof old === 'string') {\n\t\t\tnode.style.cssText = value || '';\n\t\t}\n\t\tif (value && typeof value === 'object') {\n\t\t\tif (typeof old !== 'string') {\n\t\t\t\tfor (var i in old) {\n\t\t\t\t\tif (!(i in value)) node.style[i] = '';\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (var i in value) {\n\t\t\t\tnode.style[i] = typeof value[i] === 'number' && IS_NON_DIMENSIONAL.test(i) === false ? value[i] + 'px' : value[i];\n\t\t\t}\n\t\t}\n\t} else if (name === 'dangerouslySetInnerHTML') {\n\t\tif (value) node.innerHTML = value.__html || '';\n\t} else if (name[0] == 'o' && name[1] == 'n') {\n\t\tvar useCapture = name !== (name = name.replace(/Capture$/, ''));\n\t\tname = name.toLowerCase().substring(2);\n\t\tif (value) {\n\t\t\tif (!old) node.addEventListener(name, eventProxy, useCapture);\n\t\t} else {\n\t\t\tnode.removeEventListener(name, eventProxy, useCapture);\n\t\t}\n\t\t(node._listeners || (node._listeners = {}))[name] = value;\n\t} else if (name !== 'list' && name !== 'type' && !isSvg && name in node) {\n\t\tsetProperty(node, name, value == null ? '' : value);\n\t\tif (value == null || value === false) node.removeAttribute(name);\n\t} else {\n\t\tvar ns = isSvg && name !== (name = name.replace(/^xlink:?/, ''));\n\t\tif (value == null || value === false) {\n\t\t\tif (ns) node.removeAttributeNS('http://www.w3.org/1999/xlink', name.toLowerCase());else node.removeAttribute(name);\n\t\t} else if (typeof value !== 'function') {\n\t\t\tif (ns) node.setAttributeNS('http://www.w3.org/1999/xlink', name.toLowerCase(), value);else node.setAttribute(name, value);\n\t\t}\n\t}\n}\n\n/** Attempt to set a DOM property to the given value.\n *\tIE & FF throw for certain property-value combinations.\n */\nfunction setProperty(node, name, value) {\n\ttry {\n\t\tnode[name] = value;\n\t} catch (e) {}\n}\n\n/** Proxy an event to hooked event handlers\n *\t@private\n */\nfunction eventProxy(e) {\n\treturn this._listeners[e.type](options.event && options.event(e) || e);\n}\n\n/** Queue of components that have been mounted and are awaiting componentDidMount */\nvar mounts = [];\n\n/** Diff recursion count, used to track the end of the diff cycle. */\nvar diffLevel = 0;\n\n/** Global flag indicating if the diff is currently within an SVG */\nvar isSvgMode = false;\n\n/** Global flag indicating if the diff is performing hydration */\nvar hydrating = false;\n\n/** Invoke queued componentDidMount lifecycle methods */\nfunction flushMounts() {\n\tvar c;\n\twhile (c = mounts.pop()) {\n\t\tif (options.afterMount) options.afterMount(c);\n\t\tif (c.componentDidMount) c.componentDidMount();\n\t}\n}\n\n/** Apply differences in a given vnode (and it's deep children) to a real DOM Node.\n *\t@param {Element} [dom=null]\t\tA DOM node to mutate into the shape of the `vnode`\n *\t@param {VNode} vnode\t\t\tA VNode (with descendants forming a tree) representing the desired DOM structure\n *\t@returns {Element} dom\t\t\tThe created/mutated element\n *\t@private\n */\nfunction diff(dom, vnode, context, mountAll, parent, componentRoot) {\n\t// diffLevel having been 0 here indicates initial entry into the diff (not a subdiff)\n\tif (!diffLevel++) {\n\t\t// when first starting the diff, check if we're diffing an SVG or within an SVG\n\t\tisSvgMode = parent != null && parent.ownerSVGElement !== undefined;\n\n\t\t// hydration is indicated by the existing element to be diffed not having a prop cache\n\t\thydrating = dom != null && !('__preactattr_' in dom);\n\t}\n\n\tvar ret = idiff(dom, vnode, context, mountAll, componentRoot);\n\n\t// append the element if its a new parent\n\tif (parent && ret.parentNode !== parent) parent.appendChild(ret);\n\n\t// diffLevel being reduced to 0 means we're exiting the diff\n\tif (! --diffLevel) {\n\t\thydrating = false;\n\t\t// invoke queued componentDidMount lifecycle methods\n\t\tif (!componentRoot) flushMounts();\n\t}\n\n\treturn ret;\n}\n\n/** Internals of `diff()`, separated to allow bypassing diffLevel / mount flushing. */\nfunction idiff(dom, vnode, context, mountAll, componentRoot) {\n\tvar out = dom,\n\t    prevSvgMode = isSvgMode;\n\n\t// empty values (null, undefined, booleans) render as empty Text nodes\n\tif (vnode == null || typeof vnode === 'boolean') vnode = '';\n\n\t// Fast case: Strings & Numbers create/update Text nodes.\n\tif (typeof vnode === 'string' || typeof vnode === 'number') {\n\n\t\t// update if it's already a Text node:\n\t\tif (dom && dom.splitText !== undefined && dom.parentNode && (!dom._component || componentRoot)) {\n\t\t\t/* istanbul ignore if */ /* Browser quirk that can't be covered: https://github.com/developit/preact/commit/fd4f21f5c45dfd75151bd27b4c217d8003aa5eb9 */\n\t\t\tif (dom.nodeValue != vnode) {\n\t\t\t\tdom.nodeValue = vnode;\n\t\t\t}\n\t\t} else {\n\t\t\t// it wasn't a Text node: replace it with one and recycle the old Element\n\t\t\tout = document.createTextNode(vnode);\n\t\t\tif (dom) {\n\t\t\t\tif (dom.parentNode) dom.parentNode.replaceChild(out, dom);\n\t\t\t\trecollectNodeTree(dom, true);\n\t\t\t}\n\t\t}\n\n\t\tout['__preactattr_'] = true;\n\n\t\treturn out;\n\t}\n\n\t// If the VNode represents a Component, perform a component diff:\n\tvar vnodeName = vnode.nodeName;\n\tif (typeof vnodeName === 'function') {\n\t\treturn buildComponentFromVNode(dom, vnode, context, mountAll);\n\t}\n\n\t// Tracks entering and exiting SVG namespace when descending through the tree.\n\tisSvgMode = vnodeName === 'svg' ? true : vnodeName === 'foreignObject' ? false : isSvgMode;\n\n\t// If there's no existing element or it's the wrong type, create a new one:\n\tvnodeName = String(vnodeName);\n\tif (!dom || !isNamedNode(dom, vnodeName)) {\n\t\tout = createNode(vnodeName, isSvgMode);\n\n\t\tif (dom) {\n\t\t\t// move children into the replacement node\n\t\t\twhile (dom.firstChild) {\n\t\t\t\tout.appendChild(dom.firstChild);\n\t\t\t} // if the previous Element was mounted into the DOM, replace it inline\n\t\t\tif (dom.parentNode) dom.parentNode.replaceChild(out, dom);\n\n\t\t\t// recycle the old element (skips non-Element node types)\n\t\t\trecollectNodeTree(dom, true);\n\t\t}\n\t}\n\n\tvar fc = out.firstChild,\n\t    props = out['__preactattr_'],\n\t    vchildren = vnode.children;\n\n\tif (props == null) {\n\t\tprops = out['__preactattr_'] = {};\n\t\tfor (var a = out.attributes, i = a.length; i--;) {\n\t\t\tprops[a[i].name] = a[i].value;\n\t\t}\n\t}\n\n\t// Optimization: fast-path for elements containing a single TextNode:\n\tif (!hydrating && vchildren && vchildren.length === 1 && typeof vchildren[0] === 'string' && fc != null && fc.splitText !== undefined && fc.nextSibling == null) {\n\t\tif (fc.nodeValue != vchildren[0]) {\n\t\t\tfc.nodeValue = vchildren[0];\n\t\t}\n\t}\n\t// otherwise, if there are existing or new children, diff them:\n\telse if (vchildren && vchildren.length || fc != null) {\n\t\t\tinnerDiffNode(out, vchildren, context, mountAll, hydrating || props.dangerouslySetInnerHTML != null);\n\t\t}\n\n\t// Apply attributes/props from VNode to the DOM Element:\n\tdiffAttributes(out, vnode.attributes, props);\n\n\t// restore previous SVG mode: (in case we're exiting an SVG namespace)\n\tisSvgMode = prevSvgMode;\n\n\treturn out;\n}\n\n/** Apply child and attribute changes between a VNode and a DOM Node to the DOM.\n *\t@param {Element} dom\t\t\tElement whose children should be compared & mutated\n *\t@param {Array} vchildren\t\tArray of VNodes to compare to `dom.childNodes`\n *\t@param {Object} context\t\t\tImplicitly descendant context object (from most recent `getChildContext()`)\n *\t@param {Boolean} mountAll\n *\t@param {Boolean} isHydrating\tIf `true`, consumes externally created elements similar to hydration\n */\nfunction innerDiffNode(dom, vchildren, context, mountAll, isHydrating) {\n\tvar originalChildren = dom.childNodes,\n\t    children = [],\n\t    keyed = {},\n\t    keyedLen = 0,\n\t    min = 0,\n\t    len = originalChildren.length,\n\t    childrenLen = 0,\n\t    vlen = vchildren ? vchildren.length : 0,\n\t    j,\n\t    c,\n\t    f,\n\t    vchild,\n\t    child;\n\n\t// Build up a map of keyed children and an Array of unkeyed children:\n\tif (len !== 0) {\n\t\tfor (var i = 0; i < len; i++) {\n\t\t\tvar _child = originalChildren[i],\n\t\t\t    props = _child['__preactattr_'],\n\t\t\t    key = vlen && props ? _child._component ? _child._component.__key : props.key : null;\n\t\t\tif (key != null) {\n\t\t\t\tkeyedLen++;\n\t\t\t\tkeyed[key] = _child;\n\t\t\t} else if (props || (_child.splitText !== undefined ? isHydrating ? _child.nodeValue.trim() : true : isHydrating)) {\n\t\t\t\tchildren[childrenLen++] = _child;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (vlen !== 0) {\n\t\tfor (var i = 0; i < vlen; i++) {\n\t\t\tvchild = vchildren[i];\n\t\t\tchild = null;\n\n\t\t\t// attempt to find a node based on key matching\n\t\t\tvar key = vchild.key;\n\t\t\tif (key != null) {\n\t\t\t\tif (keyedLen && keyed[key] !== undefined) {\n\t\t\t\t\tchild = keyed[key];\n\t\t\t\t\tkeyed[key] = undefined;\n\t\t\t\t\tkeyedLen--;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// attempt to pluck a node of the same type from the existing children\n\t\t\telse if (!child && min < childrenLen) {\n\t\t\t\t\tfor (j = min; j < childrenLen; j++) {\n\t\t\t\t\t\tif (children[j] !== undefined && isSameNodeType(c = children[j], vchild, isHydrating)) {\n\t\t\t\t\t\t\tchild = c;\n\t\t\t\t\t\t\tchildren[j] = undefined;\n\t\t\t\t\t\t\tif (j === childrenLen - 1) childrenLen--;\n\t\t\t\t\t\t\tif (j === min) min++;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t// morph the matched/found/created DOM child to match vchild (deep)\n\t\t\tchild = idiff(child, vchild, context, mountAll);\n\n\t\t\tf = originalChildren[i];\n\t\t\tif (child && child !== dom && child !== f) {\n\t\t\t\tif (f == null) {\n\t\t\t\t\tdom.appendChild(child);\n\t\t\t\t} else if (child === f.nextSibling) {\n\t\t\t\t\tremoveNode(f);\n\t\t\t\t} else {\n\t\t\t\t\tdom.insertBefore(child, f);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// remove unused keyed children:\n\tif (keyedLen) {\n\t\tfor (var i in keyed) {\n\t\t\tif (keyed[i] !== undefined) recollectNodeTree(keyed[i], false);\n\t\t}\n\t}\n\n\t// remove orphaned unkeyed children:\n\twhile (min <= childrenLen) {\n\t\tif ((child = children[childrenLen--]) !== undefined) recollectNodeTree(child, false);\n\t}\n}\n\n/** Recursively recycle (or just unmount) a node and its descendants.\n *\t@param {Node} node\t\t\t\t\t\tDOM node to start unmount/removal from\n *\t@param {Boolean} [unmountOnly=false]\tIf `true`, only triggers unmount lifecycle, skips removal\n */\nfunction recollectNodeTree(node, unmountOnly) {\n\tvar component = node._component;\n\tif (component) {\n\t\t// if node is owned by a Component, unmount that component (ends up recursing back here)\n\t\tunmountComponent(component);\n\t} else {\n\t\t// If the node's VNode had a ref function, invoke it with null here.\n\t\t// (this is part of the React spec, and smart for unsetting references)\n\t\tif (node['__preactattr_'] != null && node['__preactattr_'].ref) node['__preactattr_'].ref(null);\n\n\t\tif (unmountOnly === false || node['__preactattr_'] == null) {\n\t\t\tremoveNode(node);\n\t\t}\n\n\t\tremoveChildren(node);\n\t}\n}\n\n/** Recollect/unmount all children.\n *\t- we use .lastChild here because it causes less reflow than .firstChild\n *\t- it's also cheaper than accessing the .childNodes Live NodeList\n */\nfunction removeChildren(node) {\n\tnode = node.lastChild;\n\twhile (node) {\n\t\tvar next = node.previousSibling;\n\t\trecollectNodeTree(node, true);\n\t\tnode = next;\n\t}\n}\n\n/** Apply differences in attributes from a VNode to the given DOM Element.\n *\t@param {Element} dom\t\tElement with attributes to diff `attrs` against\n *\t@param {Object} attrs\t\tThe desired end-state key-value attribute pairs\n *\t@param {Object} old\t\t\tCurrent/previous attributes (from previous VNode or element's prop cache)\n */\nfunction diffAttributes(dom, attrs, old) {\n\tvar name;\n\n\t// remove attributes no longer present on the vnode by setting them to undefined\n\tfor (name in old) {\n\t\tif (!(attrs && attrs[name] != null) && old[name] != null) {\n\t\t\tsetAccessor(dom, name, old[name], old[name] = undefined, isSvgMode);\n\t\t}\n\t}\n\n\t// add new & update changed attributes\n\tfor (name in attrs) {\n\t\tif (name !== 'children' && name !== 'innerHTML' && (!(name in old) || attrs[name] !== (name === 'value' || name === 'checked' ? dom[name] : old[name]))) {\n\t\t\tsetAccessor(dom, name, old[name], old[name] = attrs[name], isSvgMode);\n\t\t}\n\t}\n}\n\n/** Retains a pool of Components for re-use, keyed on component name.\n *\tNote: since component names are not unique or even necessarily available, these are primarily a form of sharding.\n *\t@private\n */\nvar components = {};\n\n/** Reclaim a component for later re-use by the recycler. */\nfunction collectComponent(component) {\n\tvar name = component.constructor.name;\n\t(components[name] || (components[name] = [])).push(component);\n}\n\n/** Create a component. Normalizes differences between PFC's and classful Components. */\nfunction createComponent(Ctor, props, context) {\n\tvar list = components[Ctor.name],\n\t    inst;\n\n\tif (Ctor.prototype && Ctor.prototype.render) {\n\t\tinst = new Ctor(props, context);\n\t\tComponent.call(inst, props, context);\n\t} else {\n\t\tinst = new Component(props, context);\n\t\tinst.constructor = Ctor;\n\t\tinst.render = doRender;\n\t}\n\n\tif (list) {\n\t\tfor (var i = list.length; i--;) {\n\t\t\tif (list[i].constructor === Ctor) {\n\t\t\t\tinst.nextBase = list[i].nextBase;\n\t\t\t\tlist.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn inst;\n}\n\n/** The `.render()` method for a PFC backing instance. */\nfunction doRender(props, state, context) {\n\treturn this.constructor(props, context);\n}\n\n/** Set a component's `props` (generally derived from JSX attributes).\n *\t@param {Object} props\n *\t@param {Object} [opts]\n *\t@param {boolean} [opts.renderSync=false]\tIf `true` and {@link options.syncComponentUpdates} is `true`, triggers synchronous rendering.\n *\t@param {boolean} [opts.render=true]\t\t\tIf `false`, no render will be triggered.\n */\nfunction setComponentProps(component, props, opts, context, mountAll) {\n\tif (component._disable) return;\n\tcomponent._disable = true;\n\n\tif (component.__ref = props.ref) delete props.ref;\n\tif (component.__key = props.key) delete props.key;\n\n\tif (!component.base || mountAll) {\n\t\tif (component.componentWillMount) component.componentWillMount();\n\t} else if (component.componentWillReceiveProps) {\n\t\tcomponent.componentWillReceiveProps(props, context);\n\t}\n\n\tif (context && context !== component.context) {\n\t\tif (!component.prevContext) component.prevContext = component.context;\n\t\tcomponent.context = context;\n\t}\n\n\tif (!component.prevProps) component.prevProps = component.props;\n\tcomponent.props = props;\n\n\tcomponent._disable = false;\n\n\tif (opts !== 0) {\n\t\tif (opts === 1 || options.syncComponentUpdates !== false || !component.base) {\n\t\t\trenderComponent(component, 1, mountAll);\n\t\t} else {\n\t\t\tenqueueRender(component);\n\t\t}\n\t}\n\n\tif (component.__ref) component.__ref(component);\n}\n\n/** Render a Component, triggering necessary lifecycle events and taking High-Order Components into account.\n *\t@param {Component} component\n *\t@param {Object} [opts]\n *\t@param {boolean} [opts.build=false]\t\tIf `true`, component will build and store a DOM node if not already associated with one.\n *\t@private\n */\nfunction renderComponent(component, opts, mountAll, isChild) {\n\tif (component._disable) return;\n\n\tvar props = component.props,\n\t    state = component.state,\n\t    context = component.context,\n\t    previousProps = component.prevProps || props,\n\t    previousState = component.prevState || state,\n\t    previousContext = component.prevContext || context,\n\t    isUpdate = component.base,\n\t    nextBase = component.nextBase,\n\t    initialBase = isUpdate || nextBase,\n\t    initialChildComponent = component._component,\n\t    skip = false,\n\t    rendered,\n\t    inst,\n\t    cbase;\n\n\t// if updating\n\tif (isUpdate) {\n\t\tcomponent.props = previousProps;\n\t\tcomponent.state = previousState;\n\t\tcomponent.context = previousContext;\n\t\tif (opts !== 2 && component.shouldComponentUpdate && component.shouldComponentUpdate(props, state, context) === false) {\n\t\t\tskip = true;\n\t\t} else if (component.componentWillUpdate) {\n\t\t\tcomponent.componentWillUpdate(props, state, context);\n\t\t}\n\t\tcomponent.props = props;\n\t\tcomponent.state = state;\n\t\tcomponent.context = context;\n\t}\n\n\tcomponent.prevProps = component.prevState = component.prevContext = component.nextBase = null;\n\tcomponent._dirty = false;\n\n\tif (!skip) {\n\t\trendered = component.render(props, state, context);\n\n\t\t// context to pass to the child, can be updated via (grand-)parent component\n\t\tif (component.getChildContext) {\n\t\t\tcontext = extend(extend({}, context), component.getChildContext());\n\t\t}\n\n\t\tvar childComponent = rendered && rendered.nodeName,\n\t\t    toUnmount,\n\t\t    base;\n\n\t\tif (typeof childComponent === 'function') {\n\t\t\t// set up high order component link\n\n\t\t\tvar childProps = getNodeProps(rendered);\n\t\t\tinst = initialChildComponent;\n\n\t\t\tif (inst && inst.constructor === childComponent && childProps.key == inst.__key) {\n\t\t\t\tsetComponentProps(inst, childProps, 1, context, false);\n\t\t\t} else {\n\t\t\t\ttoUnmount = inst;\n\n\t\t\t\tcomponent._component = inst = createComponent(childComponent, childProps, context);\n\t\t\t\tinst.nextBase = inst.nextBase || nextBase;\n\t\t\t\tinst._parentComponent = component;\n\t\t\t\tsetComponentProps(inst, childProps, 0, context, false);\n\t\t\t\trenderComponent(inst, 1, mountAll, true);\n\t\t\t}\n\n\t\t\tbase = inst.base;\n\t\t} else {\n\t\t\tcbase = initialBase;\n\n\t\t\t// destroy high order component link\n\t\t\ttoUnmount = initialChildComponent;\n\t\t\tif (toUnmount) {\n\t\t\t\tcbase = component._component = null;\n\t\t\t}\n\n\t\t\tif (initialBase || opts === 1) {\n\t\t\t\tif (cbase) cbase._component = null;\n\t\t\t\tbase = diff(cbase, rendered, context, mountAll || !isUpdate, initialBase && initialBase.parentNode, true);\n\t\t\t}\n\t\t}\n\n\t\tif (initialBase && base !== initialBase && inst !== initialChildComponent) {\n\t\t\tvar baseParent = initialBase.parentNode;\n\t\t\tif (baseParent && base !== baseParent) {\n\t\t\t\tbaseParent.replaceChild(base, initialBase);\n\n\t\t\t\tif (!toUnmount) {\n\t\t\t\t\tinitialBase._component = null;\n\t\t\t\t\trecollectNodeTree(initialBase, false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (toUnmount) {\n\t\t\tunmountComponent(toUnmount);\n\t\t}\n\n\t\tcomponent.base = base;\n\t\tif (base && !isChild) {\n\t\t\tvar componentRef = component,\n\t\t\t    t = component;\n\t\t\twhile (t = t._parentComponent) {\n\t\t\t\t(componentRef = t).base = base;\n\t\t\t}\n\t\t\tbase._component = componentRef;\n\t\t\tbase._componentConstructor = componentRef.constructor;\n\t\t}\n\t}\n\n\tif (!isUpdate || mountAll) {\n\t\tmounts.unshift(component);\n\t} else if (!skip) {\n\t\t// Ensure that pending componentDidMount() hooks of child components\n\t\t// are called before the componentDidUpdate() hook in the parent.\n\t\t// Note: disabled as it causes duplicate hooks, see https://github.com/developit/preact/issues/750\n\t\t// flushMounts();\n\n\t\tif (component.componentDidUpdate) {\n\t\t\tcomponent.componentDidUpdate(previousProps, previousState, previousContext);\n\t\t}\n\t\tif (options.afterUpdate) options.afterUpdate(component);\n\t}\n\n\tif (component._renderCallbacks != null) {\n\t\twhile (component._renderCallbacks.length) {\n\t\t\tcomponent._renderCallbacks.pop().call(component);\n\t\t}\n\t}\n\n\tif (!diffLevel && !isChild) flushMounts();\n}\n\n/** Apply the Component referenced by a VNode to the DOM.\n *\t@param {Element} dom\tThe DOM node to mutate\n *\t@param {VNode} vnode\tA Component-referencing VNode\n *\t@returns {Element} dom\tThe created/mutated element\n *\t@private\n */\nfunction buildComponentFromVNode(dom, vnode, context, mountAll) {\n\tvar c = dom && dom._component,\n\t    originalComponent = c,\n\t    oldDom = dom,\n\t    isDirectOwner = c && dom._componentConstructor === vnode.nodeName,\n\t    isOwner = isDirectOwner,\n\t    props = getNodeProps(vnode);\n\twhile (c && !isOwner && (c = c._parentComponent)) {\n\t\tisOwner = c.constructor === vnode.nodeName;\n\t}\n\n\tif (c && isOwner && (!mountAll || c._component)) {\n\t\tsetComponentProps(c, props, 3, context, mountAll);\n\t\tdom = c.base;\n\t} else {\n\t\tif (originalComponent && !isDirectOwner) {\n\t\t\tunmountComponent(originalComponent);\n\t\t\tdom = oldDom = null;\n\t\t}\n\n\t\tc = createComponent(vnode.nodeName, props, context);\n\t\tif (dom && !c.nextBase) {\n\t\t\tc.nextBase = dom;\n\t\t\t// passing dom/oldDom as nextBase will recycle it if unused, so bypass recycling on L229:\n\t\t\toldDom = null;\n\t\t}\n\t\tsetComponentProps(c, props, 1, context, mountAll);\n\t\tdom = c.base;\n\n\t\tif (oldDom && dom !== oldDom) {\n\t\t\toldDom._component = null;\n\t\t\trecollectNodeTree(oldDom, false);\n\t\t}\n\t}\n\n\treturn dom;\n}\n\n/** Remove a component from the DOM and recycle it.\n *\t@param {Component} component\tThe Component instance to unmount\n *\t@private\n */\nfunction unmountComponent(component) {\n\tif (options.beforeUnmount) options.beforeUnmount(component);\n\n\tvar base = component.base;\n\n\tcomponent._disable = true;\n\n\tif (component.componentWillUnmount) component.componentWillUnmount();\n\n\tcomponent.base = null;\n\n\t// recursively tear down & recollect high-order component children:\n\tvar inner = component._component;\n\tif (inner) {\n\t\tunmountComponent(inner);\n\t} else if (base) {\n\t\tif (base['__preactattr_'] && base['__preactattr_'].ref) base['__preactattr_'].ref(null);\n\n\t\tcomponent.nextBase = base;\n\n\t\tremoveNode(base);\n\t\tcollectComponent(component);\n\n\t\tremoveChildren(base);\n\t}\n\n\tif (component.__ref) component.__ref(null);\n}\n\n/** Base Component class.\n *\tProvides `setState()` and `forceUpdate()`, which trigger rendering.\n *\t@public\n *\n *\t@example\n *\tclass MyFoo extends Component {\n *\t\trender(props, state) {\n *\t\t\treturn <div />;\n *\t\t}\n *\t}\n */\nfunction Component(props, context) {\n\tthis._dirty = true;\n\n\t/** @public\n  *\t@type {object}\n  */\n\tthis.context = context;\n\n\t/** @public\n  *\t@type {object}\n  */\n\tthis.props = props;\n\n\t/** @public\n  *\t@type {object}\n  */\n\tthis.state = this.state || {};\n}\n\nextend(Component.prototype, {\n\n\t/** Returns a `boolean` indicating if the component should re-render when receiving the given `props` and `state`.\n  *\t@param {object} nextProps\n  *\t@param {object} nextState\n  *\t@param {object} nextContext\n  *\t@returns {Boolean} should the component re-render\n  *\t@name shouldComponentUpdate\n  *\t@function\n  */\n\n\t/** Update component state by copying properties from `state` to `this.state`.\n  *\t@param {object} state\t\tA hash of state properties to update with new values\n  *\t@param {function} callback\tA function to be called once component state is updated\n  */\n\tsetState: function setState(state, callback) {\n\t\tvar s = this.state;\n\t\tif (!this.prevState) this.prevState = extend({}, s);\n\t\textend(s, typeof state === 'function' ? state(s, this.props) : state);\n\t\tif (callback) (this._renderCallbacks = this._renderCallbacks || []).push(callback);\n\t\tenqueueRender(this);\n\t},\n\n\n\t/** Immediately perform a synchronous re-render of the component.\n  *\t@param {function} callback\t\tA function to be called after component is re-rendered.\n  *\t@private\n  */\n\tforceUpdate: function forceUpdate(callback) {\n\t\tif (callback) (this._renderCallbacks = this._renderCallbacks || []).push(callback);\n\t\trenderComponent(this, 2);\n\t},\n\n\n\t/** Accepts `props` and `state`, and returns a new Virtual DOM tree to build.\n  *\tVirtual DOM is generally constructed via [JSX](http://jasonformat.com/wtf-is-jsx).\n  *\t@param {object} props\t\tProps (eg: JSX attributes) received from parent element/component\n  *\t@param {object} state\t\tThe component's current state\n  *\t@param {object} context\t\tContext object (if a parent component has provided context)\n  *\t@returns VNode\n  */\n\trender: function render() {}\n});\n\n/** Render JSX into a `parent` Element.\n *\t@param {VNode} vnode\t\tA (JSX) VNode to render\n *\t@param {Element} parent\t\tDOM element to render into\n *\t@param {Element} [merge]\tAttempt to re-use an existing DOM tree rooted at `merge`\n *\t@public\n *\n *\t@example\n *\t// render a div into <body>:\n *\trender(<div id=\"hello\">hello!</div>, document.body);\n *\n *\t@example\n *\t// render a \"Thing\" component into #foo:\n *\tconst Thing = ({ name }) => <span>{ name }</span>;\n *\trender(<Thing name=\"one\" />, document.querySelector('#foo'));\n */\nfunction render(vnode, parent, merge) {\n  return diff(merge, vnode, {}, false, parent, false);\n}\n\nvar preact = {\n\th: h,\n\tcreateElement: h,\n\tcloneElement: cloneElement,\n\tComponent: Component,\n\trender: render,\n\trerender: rerender,\n\toptions: options\n};\n\nexport default preact;\nexport { h, h as createElement, cloneElement, Component, render, rerender, options };\n//# sourceMappingURL=preact.esm.js.map\n","var isDOMElement = require('./isDOMElement');\n/**\n * Find a DOM element.\n *\n * @param {Node|string} element\n * @returns {Node|null}\n */\n\n\nmodule.exports = function findDOMElement(element, context) {\n  if (context === void 0) {\n    context = document;\n  }\n\n  if (typeof element === 'string') {\n    return context.querySelector(element);\n  }\n\n  if (isDOMElement(element)) {\n    return element;\n  }\n};","/**\n * Check if an object is a DOM element. Duck-typing based on `nodeType`.\n *\n * @param {*} obj\n */\nmodule.exports = function isDOMElement(obj) {\n  return obj && typeof obj === 'object' && obj.nodeType === Node.ELEMENT_NODE;\n};","'use strict';\n/**\n * Manages communications with Companion\n */\n\nvar RequestClient = require('./RequestClient');\n\nvar Provider = require('./Provider');\n\nvar Socket = require('./Socket');\n\nmodule.exports = {\n  RequestClient: RequestClient,\n  Provider: Provider,\n  Socket: Socket\n};","'use strict';\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === \"function\" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== \"function\") { throw new TypeError(\"Super expression must either be null or a function\"); } if (typeof _cache !== \"undefined\") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction _construct(Parent, args, Class) { if (_isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf(\"[native code]\") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar AuthError = /*#__PURE__*/function (_Error) {\n  _inheritsLoose(AuthError, _Error);\n\n  function AuthError() {\n    var _this;\n\n    _this = _Error.call(this, 'Authorization required') || this;\n    _this.name = 'AuthError';\n    _this.isAuthError = true;\n    return _this;\n  }\n\n  return AuthError;\n}( /*#__PURE__*/_wrapNativeSuper(Error));\n\nmodule.exports = AuthError;","var NetworkError = require('@uppy/utils/lib/NetworkError');\n/**\n * Wrapper around window.fetch that throws a NetworkError when appropriate\n */\n\n\nmodule.exports = function fetchWithNetworkError() {\n  return fetch.apply(void 0, arguments).catch(function (err) {\n    if (err.name === 'AbortError') {\n      throw err;\n    } else {\n      throw new NetworkError(err);\n    }\n  });\n};","function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === \"function\" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== \"function\") { throw new TypeError(\"Super expression must either be null or a function\"); } if (typeof _cache !== \"undefined\") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction _construct(Parent, args, Class) { if (_isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf(\"[native code]\") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar NetworkError = /*#__PURE__*/function (_Error) {\n  _inheritsLoose(NetworkError, _Error);\n\n  function NetworkError(error, xhr) {\n    var _this;\n\n    if (xhr === void 0) {\n      xhr = null;\n    }\n\n    _this = _Error.call(this, \"This looks like a network error, the endpoint might be blocked by an internet provider or a firewall.\\n\\nSource error: [\" + error + \"]\") || this;\n    _this.isNetworkError = true;\n    _this.request = xhr;\n    return _this;\n  }\n\n  return NetworkError;\n}( /*#__PURE__*/_wrapNativeSuper(Error));\n\nmodule.exports = NetworkError;","'use strict';\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nvar RequestClient = require('./RequestClient');\n\nvar tokenStorage = require('./tokenStorage');\n\nvar _getName = function _getName(id) {\n  return id.split('-').map(function (s) {\n    return s.charAt(0).toUpperCase() + s.slice(1);\n  }).join(' ');\n};\n\nmodule.exports = /*#__PURE__*/function (_RequestClient) {\n  _inheritsLoose(Provider, _RequestClient);\n\n  function Provider(uppy, opts) {\n    var _this;\n\n    _this = _RequestClient.call(this, uppy, opts) || this;\n    _this.provider = opts.provider;\n    _this.id = _this.provider;\n    _this.authProvider = opts.authProvider || _this.provider;\n    _this.name = _this.opts.name || _getName(_this.id);\n    _this.pluginId = _this.opts.pluginId;\n    _this.tokenKey = \"companion-\" + _this.pluginId + \"-auth-token\";\n    return _this;\n  }\n\n  var _proto = Provider.prototype;\n\n  _proto.headers = function headers() {\n    var _this2 = this;\n\n    return new Promise(function (resolve, reject) {\n      _RequestClient.prototype.headers.call(_this2).then(function (headers) {\n        _this2.getAuthToken().then(function (token) {\n          resolve(_extends({}, headers, {\n            'uppy-auth-token': token\n          }));\n        });\n      }).catch(reject);\n    });\n  };\n\n  _proto.onReceiveResponse = function onReceiveResponse(response) {\n    response = _RequestClient.prototype.onReceiveResponse.call(this, response);\n    var plugin = this.uppy.getPlugin(this.pluginId);\n    var oldAuthenticated = plugin.getPluginState().authenticated;\n    var authenticated = oldAuthenticated ? response.status !== 401 : response.status < 400;\n    plugin.setPluginState({\n      authenticated: authenticated\n    });\n    return response;\n  } // @todo(i.olarewaju) consider whether or not this method should be exposed\n  ;\n\n  _proto.setAuthToken = function setAuthToken(token) {\n    return this.uppy.getPlugin(this.pluginId).storage.setItem(this.tokenKey, token);\n  };\n\n  _proto.getAuthToken = function getAuthToken() {\n    return this.uppy.getPlugin(this.pluginId).storage.getItem(this.tokenKey);\n  };\n\n  _proto.authUrl = function authUrl() {\n    return this.hostname + \"/\" + this.id + \"/connect\";\n  };\n\n  _proto.fileUrl = function fileUrl(id) {\n    return this.hostname + \"/\" + this.id + \"/get/\" + id;\n  };\n\n  _proto.list = function list(directory) {\n    return this.get(this.id + \"/list/\" + (directory || ''));\n  };\n\n  _proto.logout = function logout() {\n    var _this3 = this;\n\n    return new Promise(function (resolve, reject) {\n      _this3.get(_this3.id + \"/logout\").then(function (res) {\n        _this3.uppy.getPlugin(_this3.pluginId).storage.removeItem(_this3.tokenKey).then(function () {\n          return resolve(res);\n        }).catch(reject);\n      }).catch(reject);\n    });\n  };\n\n  Provider.initPlugin = function initPlugin(plugin, opts, defaultOpts) {\n    plugin.type = 'acquirer';\n    plugin.files = [];\n\n    if (defaultOpts) {\n      plugin.opts = _extends({}, defaultOpts, opts);\n    }\n\n    if (opts.serverUrl || opts.serverPattern) {\n      throw new Error('`serverUrl` and `serverPattern` have been renamed to `companionUrl` and `companionAllowedHosts` respectively in the 0.30.5 release. Please consult the docs (for example, https://uppy.io/docs/instagram/ for the Instagram plugin) and use the updated options.`');\n    }\n\n    if (opts.companionAllowedHosts) {\n      var pattern = opts.companionAllowedHosts; // validate companionAllowedHosts param\n\n      if (typeof pattern !== 'string' && !Array.isArray(pattern) && !(pattern instanceof RegExp)) {\n        throw new TypeError(plugin.id + \": the option \\\"companionAllowedHosts\\\" must be one of string, Array, RegExp\");\n      }\n\n      plugin.opts.companionAllowedHosts = pattern;\n    } else {\n      // does not start with https://\n      if (/^(?!https?:\\/\\/).*$/i.test(opts.companionUrl)) {\n        plugin.opts.companionAllowedHosts = \"https://\" + opts.companionUrl.replace(/^\\/\\//, '');\n      } else {\n        plugin.opts.companionAllowedHosts = opts.companionUrl;\n      }\n    }\n\n    plugin.storage = plugin.opts.storage || tokenStorage;\n  };\n\n  return Provider;\n}(RequestClient);","'use strict';\n/**\n * This module serves as an Async wrapper for LocalStorage\n */\n\nmodule.exports.setItem = function (key, value) {\n  return new Promise(function (resolve) {\n    localStorage.setItem(key, value);\n    resolve();\n  });\n};\n\nmodule.exports.getItem = function (key) {\n  return Promise.resolve(localStorage.getItem(key));\n};\n\nmodule.exports.removeItem = function (key) {\n  return new Promise(function (resolve) {\n    localStorage.removeItem(key);\n    resolve();\n  });\n};","var ee = require('namespace-emitter');\n\nmodule.exports = /*#__PURE__*/function () {\n  function UppySocket(opts) {\n    this.opts = opts;\n    this._queued = [];\n    this.isOpen = false;\n    this.emitter = ee();\n    this._handleMessage = this._handleMessage.bind(this);\n    this.close = this.close.bind(this);\n    this.emit = this.emit.bind(this);\n    this.on = this.on.bind(this);\n    this.once = this.once.bind(this);\n    this.send = this.send.bind(this);\n\n    if (!opts || opts.autoOpen !== false) {\n      this.open();\n    }\n  }\n\n  var _proto = UppySocket.prototype;\n\n  _proto.open = function open() {\n    var _this = this;\n\n    this.socket = new WebSocket(this.opts.target);\n\n    this.socket.onopen = function (e) {\n      _this.isOpen = true;\n\n      while (_this._queued.length > 0 && _this.isOpen) {\n        var first = _this._queued[0];\n\n        _this.send(first.action, first.payload);\n\n        _this._queued = _this._queued.slice(1);\n      }\n    };\n\n    this.socket.onclose = function (e) {\n      _this.isOpen = false;\n    };\n\n    this.socket.onmessage = this._handleMessage;\n  };\n\n  _proto.close = function close() {\n    if (this.socket) {\n      this.socket.close();\n    }\n  };\n\n  _proto.send = function send(action, payload) {\n    // attach uuid\n    if (!this.isOpen) {\n      this._queued.push({\n        action: action,\n        payload: payload\n      });\n\n      return;\n    }\n\n    this.socket.send(JSON.stringify({\n      action: action,\n      payload: payload\n    }));\n  };\n\n  _proto.on = function on(action, handler) {\n    this.emitter.on(action, handler);\n  };\n\n  _proto.emit = function emit(action, payload) {\n    this.emitter.emit(action, payload);\n  };\n\n  _proto.once = function once(action, handler) {\n    this.emitter.once(action, handler);\n  };\n\n  _proto._handleMessage = function _handleMessage(e) {\n    try {\n      var message = JSON.parse(e.data);\n      this.emit(message.action, message.payload);\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  return UppySocket;\n}();","const MB = 1024 * 1024\n\nconst defaultOptions = {\n  limit: 1,\n  getChunkSize (file) {\n    return Math.ceil(file.size / 10000)\n  },\n  onStart () {},\n  onProgress () {},\n  onPartComplete () {},\n  onSuccess () {},\n  onError (err) {\n    throw err\n  }\n}\n\nfunction remove (arr, el) {\n  const i = arr.indexOf(el)\n  if (i !== -1) arr.splice(i, 1)\n}\n\nclass MultipartUploader {\n  constructor (file, options) {\n    this.options = {\n      ...defaultOptions,\n      ...options\n    }\n    // Use default `getChunkSize` if it was null or something\n    if (!this.options.getChunkSize) {\n      this.options.getChunkSize = defaultOptions.getChunkSize\n    }\n\n    this.file = file\n\n    this.key = this.options.key || null\n    this.uploadId = this.options.uploadId || null\n    this.parts = []\n\n    // Do `this.createdPromise.then(OP)` to execute an operation `OP` _only_ if the\n    // upload was created already. That also ensures that the sequencing is right\n    // (so the `OP` definitely happens if the upload is created).\n    //\n    // This mostly exists to make `_abortUpload` work well: only sending the abort request if\n    // the upload was already created, and if the createMultipartUpload request is still in flight,\n    // aborting it immediately after it finishes.\n    this.createdPromise = Promise.reject() // eslint-disable-line prefer-promise-reject-errors\n    this.isPaused = false\n    this.chunks = null\n    this.chunkState = null\n    this.uploading = []\n\n    this._initChunks()\n\n    this.createdPromise.catch(() => {}) // silence uncaught rejection warning\n  }\n\n  _initChunks () {\n    const chunks = []\n    const desiredChunkSize = this.options.getChunkSize(this.file)\n    // at least 5MB per request, at most 10k requests\n    const minChunkSize = Math.max(5 * MB, Math.ceil(this.file.size / 10000))\n    const chunkSize = Math.max(desiredChunkSize, minChunkSize)\n\n    for (let i = 0; i < this.file.size; i += chunkSize) {\n      const end = Math.min(this.file.size, i + chunkSize)\n      chunks.push(this.file.slice(i, end))\n    }\n\n    this.chunks = chunks\n    this.chunkState = chunks.map(() => ({\n      uploaded: 0,\n      busy: false,\n      done: false\n    }))\n  }\n\n  _createUpload () {\n    this.createdPromise = Promise.resolve().then(() =>\n      this.options.createMultipartUpload()\n    )\n    return this.createdPromise.then((result) => {\n      const valid = typeof result === 'object' && result &&\n        typeof result.uploadId === 'string' &&\n        typeof result.key === 'string'\n      if (!valid) {\n        throw new TypeError('AwsS3/Multipart: Got incorrect result from `createMultipartUpload()`, expected an object `{ uploadId, key }`.')\n      }\n\n      this.key = result.key\n      this.uploadId = result.uploadId\n\n      this.options.onStart(result)\n      this._uploadParts()\n    }).catch((err) => {\n      this._onError(err)\n    })\n  }\n\n  _resumeUpload () {\n    return Promise.resolve().then(() =>\n      this.options.listParts({\n        uploadId: this.uploadId,\n        key: this.key\n      })\n    ).then((parts) => {\n      parts.forEach((part) => {\n        const i = part.PartNumber - 1\n        this.chunkState[i] = {\n          uploaded: part.Size,\n          etag: part.ETag,\n          done: true\n        }\n\n        // Only add if we did not yet know about this part.\n        if (!this.parts.some((p) => p.PartNumber === part.PartNumber)) {\n          this.parts.push({\n            PartNumber: part.PartNumber,\n            ETag: part.ETag\n          })\n        }\n      })\n      this._uploadParts()\n    }).catch((err) => {\n      this._onError(err)\n    })\n  }\n\n  _uploadParts () {\n    if (this.isPaused) return\n\n    const need = this.options.limit - this.uploading.length\n    if (need === 0) return\n\n    // All parts are uploaded.\n    if (this.chunkState.every((state) => state.done)) {\n      this._completeUpload()\n      return\n    }\n\n    const candidates = []\n    for (let i = 0; i < this.chunkState.length; i++) {\n      const state = this.chunkState[i]\n      if (state.done || state.busy) continue\n\n      candidates.push(i)\n      if (candidates.length >= need) {\n        break\n      }\n    }\n\n    candidates.forEach((index) => {\n      this._uploadPart(index)\n    })\n  }\n\n  _uploadPart (index) {\n    const body = this.chunks[index]\n    this.chunkState[index].busy = true\n\n    return Promise.resolve().then(() =>\n      this.options.prepareUploadPart({\n        key: this.key,\n        uploadId: this.uploadId,\n        body,\n        number: index + 1\n      })\n    ).then((result) => {\n      const valid = typeof result === 'object' && result &&\n        typeof result.url === 'string'\n      if (!valid) {\n        throw new TypeError('AwsS3/Multipart: Got incorrect result from `prepareUploadPart()`, expected an object `{ url }`.')\n      }\n      return result\n    }).then(({ url, headers }) => {\n      this._uploadPartBytes(index, url, headers)\n    }, (err) => {\n      this._onError(err)\n    })\n  }\n\n  _onPartProgress (index, sent, total) {\n    this.chunkState[index].uploaded = sent\n\n    const totalUploaded = this.chunkState.reduce((n, c) => n + c.uploaded, 0)\n    this.options.onProgress(totalUploaded, this.file.size)\n  }\n\n  _onPartComplete (index, etag) {\n    this.chunkState[index].etag = etag\n    this.chunkState[index].done = true\n\n    const part = {\n      PartNumber: index + 1,\n      ETag: etag\n    }\n    this.parts.push(part)\n\n    this.options.onPartComplete(part)\n\n    this._uploadParts()\n  }\n\n  _uploadPartBytes (index, url, headers) {\n    const body = this.chunks[index]\n    const xhr = new XMLHttpRequest()\n    xhr.open('PUT', url, true)\n    if (headers) {\n      Object.keys(headers).map((key) => {\n        xhr.setRequestHeader(key, headers[key])\n      })\n    }\n    xhr.responseType = 'text'\n\n    this.uploading.push(xhr)\n\n    xhr.upload.addEventListener('progress', (ev) => {\n      if (!ev.lengthComputable) return\n\n      this._onPartProgress(index, ev.loaded, ev.total)\n    })\n\n    xhr.addEventListener('abort', (ev) => {\n      remove(this.uploading, ev.target)\n      this.chunkState[index].busy = false\n    })\n\n    xhr.addEventListener('load', (ev) => {\n      remove(this.uploading, ev.target)\n      this.chunkState[index].busy = false\n\n      if (ev.target.status < 200 || ev.target.status >= 300) {\n        this._onError(new Error('Non 2xx'))\n        return\n      }\n\n      this._onPartProgress(index, body.size, body.size)\n\n      // NOTE This must be allowed by CORS.\n      const etag = ev.target.getResponseHeader('ETag')\n      if (etag === null) {\n        this._onError(new Error('AwsS3/Multipart: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. Seee https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions.'))\n        return\n      }\n\n      this._onPartComplete(index, etag)\n    })\n\n    xhr.addEventListener('error', (ev) => {\n      remove(this.uploading, ev.target)\n      this.chunkState[index].busy = false\n      const error = new Error('Unknown error')\n      error.source = ev.target\n      this._onError(error)\n    })\n    xhr.send(body)\n  }\n\n  _completeUpload () {\n    // Parts may not have completed uploading in sorted order, if limit > 1.\n    this.parts.sort((a, b) => a.PartNumber - b.PartNumber)\n\n    return Promise.resolve().then(() =>\n      this.options.completeMultipartUpload({\n        key: this.key,\n        uploadId: this.uploadId,\n        parts: this.parts\n      })\n    ).then((result) => {\n      this.options.onSuccess(result)\n    }, (err) => {\n      this._onError(err)\n    })\n  }\n\n  _abortUpload () {\n    this.uploading.slice().forEach(xhr => {\n      xhr.abort()\n    })\n    this.createdPromise.then(() => {\n      this.options.abortMultipartUpload({\n        key: this.key,\n        uploadId: this.uploadId\n      })\n    }, () => {\n      // if the creation failed we do not need to abort\n    })\n    this.uploading = []\n  }\n\n  _onError (err) {\n    this.options.onError(err)\n  }\n\n  start () {\n    this.isPaused = false\n    if (this.uploadId) {\n      this._resumeUpload()\n    } else {\n      this._createUpload()\n    }\n  }\n\n  pause () {\n    const inProgress = this.uploading.slice()\n    inProgress.forEach((xhr) => {\n      xhr.abort()\n    })\n    this.isPaused = true\n  }\n\n  abort (opts = {}) {\n    const really = opts.really || false\n\n    if (!really) return this.pause()\n\n    this._abortUpload()\n  }\n}\n\nmodule.exports = MultipartUploader"],"sourceRoot":""}